function fEc(a,b){var c,d;return d=new Fm,d.target=".EditingRibbonPanel",d.content=a,d.useTeachingStyles=!1,d.showCloseIcon=!0,d.calloutProps=(c=new xha,c.directionalHint=6,c.gapSpace=4,c.isBeakVisible=!1,c.preventDismissOnScroll=!0,c.onDismiss=b,c.preventDismissOnResize=!0,c),d}function gEc(a,b,c,d){var e,f=(e=new Em,e.onShow=function(){Fl(c,"notifications")},e);b=a.callout(b);d.val=a.addNotification(b,f)}function hEc(a,b){return fEc(a.Fu,function(){Gl(b,"notifications")})}
function Fee(a,b){var c=z4;v4.iae=a?["Live","Subtitles"]:["Subtitles"];c.qlb=a;c.Gf("visible"===c.es.style.visibility);Cod(c);tod(c.D2,"clientMetadata",JSON.stringify(Yod(c,b)));tod(c.D2,"slideIndex",c.prd);tod(c.D2,"currentSpeechModes",JSON.stringify(v4.iae))}function iEc(a,b,c){window.Common.UISurfaces.tS().then(function(d){gEc(d,hEc(b,c),c,d={val:a.ZEa});a.ZEa=d.val});R(527303443,843,50,"{0} Toast is displayed",Object.getType(b).toString())}
DLd.prototype.YUa=q(-1064261291,function(a,b){if(a&&""!==a)if(b)if(this.xhb.hc(a)){var c;a=this.xhb.ng(a,c={val:c},null);c=c.val;a;c&&c.Kc(b)&&c.Mc(b)}else u(25747917,306,15,"Topic {0} doesn't exist in handler map.",a);else u(25747916,306,15,"Try to remove null handler");else u(25747915,306,15,"topic is empty or null")});HLd.prototype.YUa=q(1916449986,function(){u(51185363,306,100,"RemoveEventHandler is NYI.")});y4.prototype.aob=q(-224486859,function(a){this.qa.eb("OnTranscriberStartedEventId",a)});
x4.prototype.aob=q(-1501859882,function(a){this.qa.eb("OnTranscriberStartedEventId",a)});t4.prototype.aob=q(-431367398,function(a){this.qa.eb("OnTranscriberStartedEventId",a)});y4.prototype.$nb=q(-1194181418,function(a){this.qa.eb("OnSubtitleUpdatedEventId",a)});x4.prototype.$nb=q(17380053,function(a){this.qa.eb("OnSubtitleUpdatedEventId",a)});t4.prototype.$nb=q(-1448071663,function(a){this.qa.eb("OnSubtitleUpdatedEventId",a)});y4.prototype.afa=q(1711190907,function(a,b){this.qlb=a;Fee(a,b);Bod(this)});
x4.prototype.afa=q(614890844,function(a,b){this.gAa.Kee=a;R(41682758,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");if(C4(this))Fee(a,b),Hod(this,r4(this.Nc),this.Nc.rI);else{var c;A4(this,(c=new Uod,c.IsToggleOn=a,c.PragueSessionInfo=b,c))}Rod(this)});t4.prototype.afa=q(-1864439392,function(a,b){this.Xa.afa(a,b)});
Uhd.prototype.KBb=q(947662998,function(a,b,c){a=new kO(new Shd(a,b),null,function(){return!0},function(a){return!a.StatusCode},0,null,null,2);this.bC.M4(a,this.Hb,c)});Uhd.prototype.j9=q(1768140151,function(a,b,c,d,e,f,g,h,k){a=new kO(new Ohd(a,b,c,d,e,f,g),h,k,function(a){return!a.StatusCode},0,null,null,2);this.bC.M4(a,this.Hb,!1)});
v3.prototype.Pta=q(-600525999,function(a){var b,c;switch(a){case 22:b=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;c=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}b=this.LN.nc(b,c,null);b.Ns(a);b.pK(1);LW(b,!0);qed(this,b)});P2.prototype.RA=q(1542621168,function(){return this.Cn.ta(String,TWa,null)});
P2.prototype.YH=q(-192743680,function(){return this.Cn.nb(Number,zWa)});kX.prototype.QNc=q(1989496113,function(a){jX.KI(5018263,!!this.veb,null);Array.add(this.veb,a);jX.fx(5018264,2,"Allow free sending: {0}",a);return!0});xO.prototype.bY=q(1119380928,function(){return new iN(this.Sg(),this.get_shapeId(),this.Get_smartArtModelId())});oK.prototype.z4b=q(1542470659,function(){this.v$d(null)});Bk.prototype.WGa=q(1296755639,function(){});
Bi.prototype.WGa=q(1138606533,function(a,b,c,d,e,f){if(this.lx){var g=this;this.lx.pb(function(h){h.Ge(a,b).then(function(a){a||(g.I4(c,d,e),f&&f(c));return null})})}});F.prototype.Dxb=q(1557014499,function(){return null});
HS.prototype.Dxb=q(-554528132,function(){var a=new Xqa;a.nxb="PptJewel.New";a.Bde="PptJewel.New.Blank";a.Cde=ResourceStrings.L_NewBlank;a.Dde=ResourceStrings.L_NewBlankDescription;a.pyb=this.Fb.Dc.Lk("prt2.png");a.qyb="prt2_OLKNewButton_32x32x32";a.hea=ResourceStrings.L_New;a.pQc=this.Fk()?this.rwc+"p/":"";return a});F.prototype.Exb=q(-1371525569,function(){return null});
HS.prototype.Exb=q(1890129606,function(){var a=new Yqa;a.nxb="PptJewel.Open";a.pyb=this.Fb.Dc.Lk("prt2.png");a.qyb="prt2_SaveAsPowerPointPptx_32x32x32";return a});Th.prototype.B_a=q(-1111067053,function(){var a=1===this.Ic(),b=Yj(uj(),Mi)||Tra(uj(),Mi,F.lta),c=rj||oj||L.ia("ProtectedFile");return!(a&&b)&&!c&&F.bWa});OS.prototype.B_a=q(2041535240,function(){return Th.prototype.B_a.call(this)&&0<B().H(WM,null).il()});LT.prototype.B_a=q(-1106878778,function(){return!0});
function Ije(a,b,c,d,e){return a.pcb("AddinShared",b,!0,c,d,e,0)}function Lee(a){return a.ka.z3&&a.Gsd}
function Mee(a,b){if(!b)return R(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var c=b.split("-");if(!c.length)return R(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",b),null;var c=c[0],d=jod(a);for(a=mod(a).$$lge();a.$$mn();){var e=a.$$cu(),e=d[e.toLowerCase()];if(e.startsWith(c))return e}R(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",
b);return null}function U4d(a,b,c,d,e){b=new kO(new Nhd(b,c,d,e),null,null,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}function Nee(a,b,c,d,e,f,g,h,k,l){b=new kO(new Phd(b,c,d,e,f,null,g,h),k,l,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}function Oee(a,b,c,d){b=new kO(new Rhd(b,c),null,d,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}
function Pee(a,b,c,d,e,f,g,h,k,l,m){b=new kO(new Mhd(b,c,d,e,f,g,74,74,h,k),l,m,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}function Qee(a,b,c,d,e,f,g,h){b=new kO(new Lhd(b,c,d,e,f),g,h,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}function Ree(a,b,c,d,e,f,g,h,k){b=new kO(new Khd(b,c,d,e,f,g),h,k,function(a){return!a.StatusCode},0,null,null,2);a.bC.M4(b,a.Hb,!1)}
function jEc(a,b,c,d){if(a.gna)a.hhd=c,a.Dab=d,iEc(a.s_b,c,a.Eg);else{a=MZ.isInstanceOfType(c)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle;c=MZ.isInstanceOfType(c)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage;var e=b.toString();d=new Dj;Ej(d,0);if(F.JB){var f={featureArea:"Partial Presentation"};f.sourceContext=e;e={};e.telemetryGroup=f;f=ResourceStrings.L_GiveFeedback;
d.PKa=F.JB;d.$gc=f;d.keb=d.keb;d.WGb=!0;d.TN=e}tm(d,a,c,0,null,null)}R(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",b)}function See(a,b){if(!a.sL)return;a.R0[b]&&delete a.R0[b];a.q5[b]&&delete a.q5[b]}function Tee(a,b){a.qa.Ha("DCS",b,null)}function Uee(a,b){a.qa.Ha("IC",b,null)}function Vee(a){a.qa.Ha("AROSBSR",Sys.EventArgs.Empty,null)}function Wee(a){a.qa.Ha("AROSASR",Sys.EventArgs.Empty,null)}function Xee(a,b){J(a,VYa,b)}
function Yee(a,b,c,d,e){J(a,xVa,!0);J(a,St,!0);J(a,HWa,b);c&&J(a,mWa,c);d&&J(a,XMa,d);e&&J(a,YMa,e)}function Zee(a,b){var c;a:{c=b.n7;a=aH(a);var d;for(d=a.Jb(1);d;d=a.Rf(1))if(xFb(OP(0,d))===c){c=window.$$as(YM,d);break a}c=null}return c?window.$$as(YM,IEb(c,b.TOa))||c:null}
function $ee(a,b,c,d,e,f,g){var h=new QI("ClosePopWacSessionSync");RI(h,null);SI(h,new TI("popSessionID",a));SI(h,new TI("podSessionID",b));SI(h,new TI("presentationID",c));SI(h,new TI("podUrl",d));SI(h,new TI("podInstance",e));SI(h,new TI("fTimeoutOrUserClose",!1));SI(h,new TI("forceHardClose",!0));PI.hv(h,f,g,null,null,null,2)}
function afe(a,b,c,d){var e;a=(e=new jea,e.PresentationID=a,e.VersionID=b,e);e=new QI("RestoreFileVersion");RI(e,null);SI(e,new TI("restoreVersionParams",a));PI.hv(e,c,d,null,null,null,2)}function bfe(a,b,c){a.Dkd[b.toString()]=c}function NSd(a,b){for(a=a.eX.$$lge();a.$$mn();)a.$$cu()(b)}function dfe(a,b){for(var c=0;c<a.Ba();c++)if(!b||b(a.K(c)))return!0;return!1}var ffe=!0,gfe=null;function kfe(){if(!ffe)return null;var a=null;try{a=localStorage}catch(b){ffe=!1,a=null}return a}
function lfe(a,b,c){J(a,mQa,b.targetType===window.OSF.OsfControlTarget.InContent);J(a,nQa,b.solutionId);J(a,oQa,b.version);J(a,qQa,b.storeType);J(a,pQa,b.storeId);J(a,zWa,c.a5b(b.storeType));b.assetId&&J(a,AWa,b.assetId);J(a,BWa,b.assetStoreId);ac(b.isAddinCommands)?J(a,qWa,!1):J(a,qWa,b.isAddinCommands);b.sharedRuntimeId&&-1!==b.backgroundState&&(J(a,A_a,b.backgroundState),J(a,B_a,b.sharedRuntimeId));b.targetType===window.OSF.OsfControlTarget.InContent&&(J(a,rVa,!0),c=b.height?b.height:200,J(a,vq,
b.width?b.width:200),J(a,wq,c))}var ofe={};function pfe(a,b,c,d,e){return String.format("{0}|{1}|{2}|{3}|{4}",a.toLowerCase(),b,c.toLowerCase(),d.toLowerCase(),e.toLowerCase())}function rfe(a,b){var c=null;try{var d=kfe();if(!ac(d)&&d)var e=a+"_"+gfe+"_"+zh(F.l0)+"_"+b,c=d.getItem(e);else u(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(f){u(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",a,b)}return c}
function ZSd(a,b,c){a=document.createElement(a);b&&(a.id=b);c&&(a.className=c);a.setAttribute("Unselectable","on");return a}var mfe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");function sfe(a,b){if(!a||!b)return!a&&!b;var c;c=a.TOa&&b.TOa?a.TOa===b.TOa:!a.TOa&&!b.TOa;return CJ(a.nh,b.nh)&&a.n7===b.n7&&c}function ufe(){e9();return d9.TeamsSDXEnabledSSOList}
function yfe(a){var b=[],c;for(c in a)Array.add(b,a[c]);return b}function zfe(a){switch(a){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}function Afe(){var a=window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;return a?a:!1}
function Bfe(a,b,c){try{var d=kfe();if(!ac(d)&&d){var e=a+"_"+gfe+"_"+zh(F.l0)+"_"+c;d.setItem(e,b)}else u(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(f){u(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",a,c)}}function Dfe(a){try{window.Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(a)}catch(b){}}
function Efe(){return!!G()&&!!G().rb()&&4===G().rb().Tm()||F.B3b||F.r8b&&F.A3b&&L.ia("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&qj&&!F.Q7b}function kEc(a){if(!L.my("Microsoft.Office.SharedOnline.ChangeGate.UseSdxAllowList"))return!0;var b=xra;return!b||!b.length||1===b.length&&"all"===b[0]?!0:Array.contains(b,ce(a))}
function Ffe(a){var b=new Sys.StringBuilder,c=a.Exceptions;if(c&&0<c.length){a=c.length;for(var d=0;d<a;++d)b.appendLine(c[d].message)}else b.append(a.message);return b.toString()}Type.registerNamespace("Common.App.AccessibilitySettings");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.FEf=w.Ca.FEf||{};function Gfe(){}Gfe.registerInterface("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");function Hfe(){}Hfe.registerInterface("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");
function Ife(){}Ife.prototype={Ea:null,Xb:function(){return"Common.App.AccessibilitySettings"},wc:function(a){this.Ea=a;D(C(lc(this.Ea.ma(Mfe,null),Gfe),function(){return new Mfe}));var b=this;D(C(lc(this.Ea.ma(Lfe,null),Hfe),function(){return new Lfe(Zf(),gc(b.Ea,Gfe))}))},ub:function(){var a=gc(this.Ea,Gfe),b=gc(this.Ea,Hfe);a&&b?(b.Wb(),Nfe(a)):tb(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")},ha:function(){}};
function Mfe(){}Mfe.prototype={Geb:null};function Ofe(){var a=L.ia("IsRoamingServiceEnabled"),b=L.ia("IsAnonymousUser");return a&&!b}function Nfe(a){var b=new (bb.$$(Boolean));if(a.Geb)b.Uh(a.Geb);else if(Ofe()){var c=Pfe();c.CWo(function(){a.Geb=ab(c);Cm("setHoverableTooltipsPreference")&&window.appChrome.api.setHoverableTooltipsPreference(ab(c));b.Uh(ab(c))},8)}else b.Uh(!1)}function Qfe(a){this.Asf=Function.createDelegate(this,this.Okg);Qfe.initializeBase(this,[!1,!1,!0,!1]);this.Gcb=a}
Qfe.prototype={Gcb:null,af:function(){this.zk("",this.Asf,{id:"AccessibilitySettingsDialog",bodyControls:{tooltipPersistenceEnabled:!!this.Gcb.Geb}})},Okg:function(a,b){1===a&&(a=this.Gcb,b=b.tooltipPersistenceEnabled,b!==a.Geb&&(a.Geb=b,Cm("setHoverableTooltipsPreference")&&window.appChrome.api.setHoverableTooltipsPreference(b),Ofe()&&F.gf.lk(Rfe("saveHoverableRibbonTooltipIsEnabled"),2,b.toString().toLowerCase(),null,!0,2,null,null,null,null,!1,null,null,"8",null,!1,null,!1,null)))}};
function Lfe(a,b){this.puf=Function.createDelegate(this,this.Wng);this.Fa=a;this.Gcb=b}Lfe.prototype={Fa:null,Gcb:null,Wb:function(){this.Fa.ya(2236763780,2147483648,this.puf)},Wng:function(){(new Qfe(this.Gcb)).af();return 32}};function Pfe(){var a=new (bb.$$(Boolean));F.gf.lk(Rfe("getHoverableRibbonTooltipIsEnabled"),1,null,null,!0,2,function(b){200===b.Pa.kg?a.Uh("true"===b.Pa.Ce.toLowerCase()):a.Uh(!1)},function(){a.Uh(!1)},null,null,!1,null,null,"7",null,!1,null,!1,null);return a.Wf()}
function Rfe(a){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",ye(L).RoamingServiceHandlerWebServiceBase||"",a,F.sh)}Ife.registerClass("Common.App.AccessibilitySettings.AccessibilitySettingsPackage",null,yo,ec);Mfe.registerClass("Common.App.AccessibilitySettings.AccessibilitySettingsInfo",null,Gfe);Qfe.registerClass("Common.App.AccessibilitySettings.AccessibilitySettingsDialog",om);Lfe.registerClass("Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor",null,Hfe);
(function(){}).registerClass("Common.App.AccessibilitySettings.RoamingHelper");zo(gj(),new Ife,0,!1);Type.registerNamespace("Common.App.AddinCommands");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.pFf=w.Ca.pFf||{};function Sfe(){}Sfe.registerInterface("Common.App.AddinCommands.IAddinCommandsInitializer");function Tfe(a,b,c){this.osa=c;this.RQa=a;this.zh=b}
Tfe.prototype={zh:null,osa:0,RQa:null,X2c:function(a){var b=null;this.zh&&(b=this.zh.Di("ComponentAttach",w.r8a.toString(a)+w.pka.toString(this.osa)));if(null==this.y4c(a)?0:this.y4c(a)){var c=(new Date).getTime()-2592E5;this.RQa(a,this.osa,{ak0:c})}b&&b.Lf()}};function Ufe(a,b){Ufe.initializeBase(this,[a,b,5])}Ufe.prototype={y4c:function(){return!0}};function Vfe(a,b,c){this.osa=2;this.RQa=a;this.n8d=b;this.DPa=c}
Vfe.prototype={DPa:null,osa:0,n8d:null,RQa:null,X2c:function(a){if(L&&L.ia("AgaveSupportsLiveIdSpoofing")){var b=(new Date).getTime();this.RQa(a,this.osa,{ak0:b})}else if(window.parseInt(rfe("ak2",a)||"-1")<=(new Date).getTime()){var b=G().rb().s6(),b=String.format(b+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",G().rb().Tm(),this.n8d,F.sh),c=F.gf,d=null;this.DPa&&(d=this.DPa.Di("ComponentAttach",w.r8a.toString(a)+w.pka.toString(this.osa)));var e=this;c.lk(b,1,null,null,
!0,4,function(b){if((b=b.Pa.Ce)&&""!==b&&(b=window.Sys.Net.XMLDOM(b))){Bfe("ak2",((new Date).getTime()+144E5).toString(),a);var c=b.getElementsByTagName("update");c&&c.length||(c=b.getElementsByTagName("o:update"));c&&0<c.length&&(b=Date.parse(c[0].firstChild.nodeValue),(window.parseInt(rfe("ak0",a)||"-1")<b||Boolean.parse(rfe("ak4",a)||"false"))&&e.RQa(a,e.osa,{ak0:b}))}d&&d.Lf()},function(a){u(17438153,220,50,"GetLastUpdate request failed with {0}.",a.Pa.kg);d&&d.Lf()},null,null,!1,null,null,null,
null,!1,null,!1,null)}else Boolean.parse(rfe("ak4",a)||"false")&&(b=window.parseInt(rfe("ak0",a)||"-1"),this.RQa(a,this.osa,{ak0:b}))}};function Wfe(a,b){Wfe.initializeBase(this,[a,b,1])}Wfe.prototype={y4c:function(a){try{var b="ack3_"+gfe+"_"+zh(F.l0)+"_"+a;return Boolean.parse(Xfe(b)||"false")}catch(c){u(17306844,220,50,"LocalStorage is not allowed, {0}.",c.toString())}return null}};function Xfe(a){var b=localStorage;return ac(b)||null===b?null:b.getItem(a)}
function Yfe(a){this.ZBc=Function.createDelegate(this,this.Tkg);this.DPa=a}Yfe.prototype={DPa:null,nDa:function(){return ao(F.ag)._name},Tkg:function(a,b,c){c&&c.ak0&&(c.ack1=a,c.ack0=b,this.Gj.Pq().jb(1782110672,2,c,null),Bfe("ak0",c.ak0.toString(),a))}};function Zfe(a,b){var c=null;switch(b){case 1:c=new Wfe(a.ZBc,a.DPa);break;case 2:c=new Vfe(a.ZBc,a.nDa(),a.DPa);break;case 5:c=new Ufe(a.ZBc,a.DPa)}return c}
function $fe(){var a=B().H(age,null),b=a.MSc();if(b)if(L&&L.ia("OcpsIsEnabled"))kc(B(),Ci).pb(function(c){c.Ge("ConnectedServices",!0).then(function(c){for(var d=b.$$ge();d.$$mn();){var e=d.$$cu();if(c||e.Dg()){var f=Zfe(a,e.Aa());f&&f.X2c(e.Dg())}}return null})});else for(var c=b.$$ge();c.$$mn();){var d=c.$$cu(),e=Zfe(a,d.Aa());e&&e.X2c(d.Dg())}}Tfe.registerClass("Common.App.AddinCommands.AddinCommandsInitializerBase",null,Sfe);
Ufe.registerClass("Common.App.AddinCommands.AddinCommandsInitializer",Tfe);Vfe.registerClass("Common.App.AddinCommands.AddinCommandsAnonymousAPIInitializer",null,Sfe);Wfe.registerClass("Common.App.AddinCommands.AddinCommandsLocalCacheInitializer",Tfe);Yfe.registerClass("Common.App.AddinCommands.AddinCommandsInitializerHost");Type.registerNamespace("Common.App.DirectPrint");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.zLf=w.Ca.zLf||{};function bge(){}bge.registerInterface("Common.App.DirectPrint.IDirectPrintDialog");
function cge(){}cge.registerInterface("Common.App.DirectPrint.IDirectPrintDialogFactory");function dge(){}dge.registerInterface("Common.App.DirectPrint.IDirectPrintManager");
function ege(a){this.lA=Boolean.parse(a.DirectPrintIsEnabled||"false");this.Ree=Boolean.parse(a.DirectPrintProbeIsEnabled||"false");this.Hee=Boolean.parse(a.DirectPrintEnabledForInternetExplorer||"false");this.NHa=(a.DirectPrintSupportedMimeTypes||"").split(fge);this.wma=(a.DirectPrintSupportedPlugins||"").split(fge);this.Ude=(a.DirectPrintImmersivePreviewPlugins||"").split(fge);this.xVc=Boolean.parse(a.DirectPrintEnabledForEdge||"false");this.oee=Boolean.parse(a.ChromePrintLayoutFixIsEnabled||"false");
this.u$d=window.parseInt(a.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.s9b=14;this.ZWc=14394;if(a=a.DirectPrintMinimalSupportedEdgeVersion){var b=a.split(".");2===b.length?(this.s9b=window.parseInt(b[0]),this.ZWc=window.parseInt(b[1])):u(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",a)}else u(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
ege.prototype={lA:!1,Ree:!1,Hee:!1,NHa:null,wma:null,Ude:null,xVc:!1,s9b:0,ZWc:0,oee:!1,u$d:0};function gge(a,b,c,d){this.uGd=Function.createDelegate(this,this.rMf);this.llf=Function.createDelegate(this,this.ubg);this.gof=Function.createDelegate(this,this.pfg);this.nr=[];gge.initializeBase(this);this.MJb=b;this.eD=a;this.Jte=c;this.RKb=d;this.QZa=new qfa("LoadResource","LoadPrintablePdf")}
gge.prototype={iJa:null,Qr:null,RKb:null,MJb:null,eD:null,Jte:!1,QZa:null,$0:null,tda:function(){Ej(this,5);this.O7(40);var a=document.createElement("span");a.id=this.Yi("DirectPrintHeaderContent");var b=document.createElement("span");b.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(b,"DirectPrintHeader");this.$0=document.createElement("iframe");this.$0.name="pdfObjectFrame";this.$0.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.$0.onload=this.gof;if(this.RKb&&
0<this.RKb.Qa()){var c=r$b(this.MJb,this.RKb),d=q$b(this.MJb,this.RKb);this.Qr=document.createElement("form");this.Qr.id="printPreviewPostForm";this.Qr.method="POST";this.Qr.target=this.$0.name;this.Qr.action=d;for(c=c.GetEnumerator();c.$$mn();){var d=c.$$cu(),e=document.createElement("input");e.type="hidden";e.name=d.Dg();e.value=d.Aa();this.Qr.appendChild(e)}}else this.$0.setAttribute("src",this.MJb);Sys.UI.DomElement.addCssClass(this.$0,"ObjectInDialog");this.Jte?(Sys.UI.DomElement.addCssClass(this.$0,
"DirectPrintPdfObjectHidden"),b.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Wf(this.$0,"aria-hidden","true")):(Sys.UI.DomElement.addCssClass(this.$0,"DirectPrintPdfObject"),this.nr.push(this.$0));a.appendChild(b);a.appendChild(document.createElement("br"));a.appendChild(this.$0);this.Qr&&a.appendChild(this.Qr);a.appendChild(document.createElement("br"));a.appendChild(hge(this,this.Qr?"#":this.MJb));this.QZa.af();LHa(this,CommonUIStrings.l_AppTitle,null,null,null,null,a);gp(this,this.Yi("DirectPrintHeaderContent"));
this.Qr&&this.Qr.submit();0<this.nr.length&&(a=new hHa(this.nr),b=$f().rk())&&(this.iJa.focus(),b.qg=a,b.QK=!0);u(4771852,328,50,"Direct Print Dialog launched.")},ubg:function(a){this.Qr&&(this.Qr.target="_blank",this.Qr.submit());a.preventDefault()},rMf:function(){u(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1},pfg:function(){u(51426332,328,50,"PDF content loaded successfully");this.QZa&&this.QZa.Lf()},dispose:function(){this.iJa&&(this.eD.Sb("click",this.iJa,this.uGd),
this.iJa=null);Pd(this.$0);this.$0=null;Dj.prototype.dispose.call(this)}};
function hge(a,b){var c=document.createElement("span"),d=document.createElement("span");d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;c.appendChild(d);L&&(2===G().rb().Tm()&&L.ia("PPTDisableDirectPrintDialogDownloadPDFLink")||1===G().rb().Tm()&&L.ia("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===G().rb().Tm()?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===G().rb().Tm()&&(b.innerText=CommonUIStrings.l_InternalError_Directive,
u(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),a.iJa=b,c.appendChild(document.createElement("br")),c.appendChild(b)):(d=document.createElement("a"),d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,d.href=b,d.target="_blank",d.id="PrintPDFLink",d.className="AllowBrowserClick",a.iJa=d,c.appendChild(document.createElement("br")),c.appendChild(d),a.Qr&&hh(d,"click",a.llf),a.eD.Wa("click",a.iJa,a.uGd,null));a.nr.push(a.iJa);return c}function ige(a){this.eD=a}
ige.prototype={eD:null};function jge(a,b){this.fdc=a;this.wma=b}jge.prototype={fdc:null,wma:null};function kge(a,b,c,d,e,f,g,h,k,l){this.c6e=Function.createDelegate(this,this.FPf);this.VG=a;this.cJb=b;this.Mfd=c;this.bve=d;this.dwe=e;this.ngb=new (ga.$$(jge))(this.c6e);this.CFb=f;this.Ned=k;this.tLb=g;this.ewe=h;this.rwe=l}function lge(a){try{return new ActiveXObject(a),!0}catch(b){u(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",a)}return!1}
function mge(a){return A(a)?!1:!A(a.enabledPlugin)}function nge(a){var b=new ege(ye(L)),c=null;try{c=window.navigator.mimeTypes}catch(h){u(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var d=null;try{d=window.navigator.plugins}catch(h){u(573923533,328,15,"Failed to get Window.Navigator.plugins")}a=a.H(ige,null);var e=G().IJ(),f=oge,g=!!G()&&G().rb().YB()&&!L.ia("PrintDialogFallbackLinkEnabled");return new kge(b,c,d,mge,lge,a,e,f,function(a,b){return new odc(a,!1,b,!0,g)},hj)}
function oge(a){return ji()||di()&&a.Hee||a.xVc&&pge(a)?!0:!1}function pge(a){var b=oo();if(b){var c=b.split(".");if(2===c.length)return b=window.parseInt(c[0]),c=window.parseInt(c[1]),b>a.s9b||b===a.s9b&&c>=a.ZWc}return!1}
kge.prototype={VG:null,cJb:null,Mfd:null,bve:null,ngb:null,dwe:null,CFb:null,tLb:null,ewe:null,Ned:null,rwe:!1,ync:null,af:function(){},FPf:function(){var a=Array(this.VG.NHa.length);if(!A(this.cJb))for(var b=0;b<this.VG.NHa.length;b++)a[b]=this.VG.NHa[b]in this.cJb&&this.bve(this.cJb[this.VG.NHa[b]]);for(var b=Array(a.length),c=0;c<a.length;c++){var d;a[c]?(d=this.cJb[this.VG.NHa[c]],A(d)?d=null:(d=d.enabledPlugin,d=A(d)?null:d.name)):d=null;b[c]=d}a=Array(this.VG.wma.length);c=!A(this.Mfd);for(d=
0;d<this.VG.wma.length;d++){var e=this.VG.wma[d];a[d]=c&&e in this.Mfd?!0:this.dwe(e)}c={};d={};for(e=0;e<this.VG.NHa.length;e++)c[this.VG.NHa[e]]=b[e];for(e=0;e<this.VG.wma.length;e++)d[this.VG.wma[e]]=a[e];return new jge(c,d)}};
function qge(a,b){if(G()&&L.ia("DirectPrintDialogAsStandardDialogIsEnabled"))a.Ned(b,null);else if(a.rwe||!a.VG.lA||F.Zyb?0:rge(a)){var c;a:{c=yfe(a.ngb.Aa().fdc);for(var d=c.length,e=0;e<d;++e)if(Wn(a.VG.Ude,c[e])){c=!0;break a}c=!1}c=c&&!0;d=a.tLb.Di("UserAction","OpenDirectPrintDialog");(new gge(a.CFb.eD,b,c,null)).tda();d.Lf()}else a.Ned(b,null)}
function rge(a){if(!a.ewe(a.VG))return!1;for(var b=yfe(a.ngb.Aa().fdc),c=b.length,d=0;d<c;++d)if(!A(b[d]))return!0;a=yfe(a.ngb.Aa().wma);b=a.length;for(c=0;c<b;++c)if(a[c])return!0;return!1}function sge(a){if(null!=a.ync)return a.ync;var b=pge(a.VG);(b=a.VG.xVc&&b)||(b=ji()&&a.VG.oee&&NDa()>=a.VG.u$d?!0:!1);a.ync=b;return a.ync}function tge(){}
tge.prototype={Ea:null,Xb:function(){return"Common.App.DirectPrint"},mre:null,wc:function(a){this.Ea=a;C(D(a.ma(ige,null)),function(){return new ige(G().aN)});var b=this;C(D(a.ma(dge,null)),function(){return nge(b.Ea)})},ub:function(){this.mre=this.Ea.H(dge,null);this.mre.af()},ha:function(){}};ege.registerClass("Common.App.DirectPrint.DirectPrintBrsSettings");gge.registerClass("Common.App.DirectPrint.DirectPrintDialog",Dj,bge);
ige.registerClass("Common.App.DirectPrint.DirectPrintDialogFactory",null,cge);jge.registerClass("Common.App.DirectPrint.DirectPrintProbeResults");kge.registerClass("Common.App.DirectPrint.DirectPrintManager",null,dge);tge.registerClass("Common.App.DirectPrint.PackageManager",null,yo,ec);(function(){}).registerClass("Common.App.DirectPrint.Program");var fge=",";zo(gj(),new tge,0,!1);Type.registerNamespace("Common.App.Embed");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.GMf=w.Ca.GMf||{};
function uge(a,b,c,d){this.gac=a;this.yua=b;this.o0c=c;this.Ud=d}uge.prototype={gac:null,yua:null,o0c:null,Ud:0};function vge(a,b,c){this.Lbc=a;this.ETa=b;this.yua=c}vge.prototype={Lbc:null,ETa:null,yua:null};
function wge(a,b){this.Gmf=Function.createDelegate(this,this.Che);this.R0e=Function.createDelegate(this,this.m$d);this.hwf=Function.createDelegate(this,this.Uqg);this.m0e=Function.createDelegate(this,this.oGf);this.l0e=Function.createDelegate(this,this.nGf);this.Hmf=Function.createDelegate(this,this.jdg);this.Fmf=Function.createDelegate(this,this.idg);this.SVb={};this.sPa=[];wge.initializeBase(this,[!1,!1,b,!1]);this.Ydb=F.s$a;this.$Jb=a;this.ekc=this.Fmf;this.Zfb=this.Hmf;this.Mec=this.l0e;this.lWa=
this.m0e;this.DLb=this.hwf;this.Tve=b;this.Hp=xge.rwb;Ej(this,0);this._id="EmbedDialog"}
function yge(a,b,c){if(!zge){var d=String.format('<a target="_blank" href="{0}">{1}</a>',mh("https://office.com",p8b()),CommonUIStrings.l_Office),e=String.format('<a target="_blank" href="{0}">{1}</a>',mh("https://office.com/webapps",p8b()),CommonUIStrings.l_WebAppName);zge=String.format(CommonUIStrings.l_NoFrames,d,e)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',mh(a,p8b()),b,c,zge)}
wge.prototype={ekc:null,Zfb:null,Mec:null,lWa:null,DLb:null,Ydb:null,$Jb:null,Tre:476,Sre:288,M$c:798,kgb:null,fkc:null,GFb:null,gkc:null,Pxa:null,rL:null,Tve:!1,$Ce:function(a){for(var b={id:this._id,bodyControls:{},embedPreviewSectionTitle:CommonUIStrings.l_Preview,embedCodeSectionTitle:CommonUIStrings.l_EmbedCode,dimensionsSectionTitle:CommonUIStrings.l_Dimensions,interactionSectionTitle:CommonUIStrings.l_Interaction,initialPreviewUrl:Sj(this.$Jb,"wdPreview","1",!1),initialEmbedUrl:this.Ydb,getEmbedCode:yge,
codeCopiedText:CommonUIStrings.l_EmbedCodeCopied},c=Object.keys(a),d=c.length,e=0;e<d;++e){var f=c[e];b[f]=a[f]}Ej(this,1);Fj(this,1,CommonUIStrings.l_CopyAction);Fj(this,0,CommonUIStrings.l_Close);this.zk(CommonUIStrings.l_Embed,null,b)},dispose:function(){if(this.SVb){var a=this.SVb,b;for(b in a){var c=a[b];this.Xl.Sb("click",c.gac,this.ekc);this.uf.Sb("keydown",c.gac,this.Zfb);this.uf.Sb("keyup",c.gac,this.Zfb)}this.Zfb=this.ekc=this.SVb=null}if(this.sPa){for(a=0;a<this.sPa.length;++a)this.Xl.Sb("click",
this.sPa[a].ETa,this.Mec),this.uf.Sb("keydown",this.sPa[a].ETa,this.lWa),this.uf.Sb("keypress",this.sPa[a].ETa,this.lWa),this.uf.Sb("keyup",this.sPa[a].ETa,this.lWa);this.uf=this.Mec=this.sPa=null}this.DLb&&this.rL&&(oi(this.rL,"focus",this.DLb),this.DLb=null);this.rL=this.Pxa=this.gkc=this.GFb=this.fkc=this.kgb=null;om.prototype.dispose.call(this)},Cea:function(){ap.prototype.Cea.call(this);this.Oc.style.width=String.format("{0}px",this.M$c);this.U8a()},nGf:function(a){this.m$d(a);return!0},oGf:function(a){return QGa(this,
a,this.R0e)},m$d:function(a){a=a.sv;"visible"===a.Lbc.style.visibility?(a.Lbc.style.visibility="hidden",a.yua.className=ek("OutlookSearchChevronDown_16x16x32"),a.yua.title=CommonUIStrings.l_Expand,a.ETa.title=CommonUIStrings.l_Expand):(a.Lbc.style.visibility="visible",a.yua.className=ek("OutlookSearchChevronUp_16x16x32"),a.yua.title=CommonUIStrings.l_Collapse,a.ETa.title=CommonUIStrings.l_Collapse)},idg:function(a){this.Che(a);return!0},jdg:function(a){return QGa(this,a,this.Gmf)},Che:function(a){var b=
this.SVb[a.sv.toString()];b.Ud?(b.Ud=0,b.yua.className=ek("CheckboxUnchecked_16x16x32"),b.o0c.setAttribute("aria-checked","false")):(b.Ud=1,b.yua.className=ek("CheckboxChecked_16x16x32"),b.o0c.setAttribute("aria-checked","true"));a=a.sv.toString();b=b.Ud.toString();Ege(this,a,b)&&(this.rL&&(this.rL.innerText=yge(this.Ydb,this.Tre,this.Sre)),this.Pxa&&this.Pxa.contentWindow.location.replace(Sj(this.$Jb,"wdPreview","1",!1)))},Uqg:function(){this.rL.select()}};
function Ege(a,b,c){var d=Sj(a.Ydb,b,c,!1);return a.Ydb!==d?(a.Ydb=d,a.$Jb=Sj(a.$Jb,b,c,!1),!0):!1}function xge(){}uge.registerClass("Common.App.Embed.OptionInfo");vge.registerClass("Common.App.Embed.SectionInfo");wge.registerClass("Common.App.Embed.EmbedDialog",om);xge.registerClass("Common.App.Embed.EmbedDialogHtml");var zge=null;xge.rwb="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Type.registerNamespace("Common.App.InProductMessaging");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.cYf=w.Ca.cYf||{};function Gge(){}Gge.registerInterface("Common.App.InProductMessaging.IDependencyDownloader");function Hge(){}Hge.registerInterface("Common.App.InProductMessaging.INetworking");function Ige(){}Ige.prototype={hDf:!1,azf:!1};
function Jge(a,b,c){this.z3e=Function.createDelegate(this,this.wLf);this.ibf=Function.createDelegate(this,this.dYf);this.jbf=Function.createDelegate(this,this.eYf);this.l5e=Function.createDelegate(this,this.bOf);this.Fa=a;this.Bg=b;this.qHb=c}
Jge.prototype={Fa:null,Bg:null,qHb:null,Wb:function(){this.Fa.ua(672565674,2147483648,this.l5e,64);this.Fa.ya(1501863744,2147483648,this.jbf);this.Fa.ya(3016992658,2147483648,this.ibf);this.Fa.ya(4275690876,2147483648,this.z3e);this.Fa.ya(4142738798,2147483648,Bi.sg);this.Fa.ya(3865601672,2147483648,Bi.sg);this.Fa.ya(2275483468,2147483648,Bi.sg);this.Bg&&this.Bg.Tf(!1)},bOf:function(a,b,c,d,e){2===c&&Kge(this.qHb,e);return 32},wLf:function(a,b,c,d,e){2===c&&Lge(this.qHb,e);return 32},eYf:function(a,
b,c){return 2===c?this.qHb.jXc():32},dYf:function(a,b,c){return 2===c?this.qHb.hXc():32}};function Mge(){}function Nge(){var a=QV(String.format("ipm/{0}","inproductmessaging.js"))+cg,a=lk(a,null,null);return Oge(a)}function Pge(){var a=QV(String.format("ipm/{0}","inproductmessaging.css"))+cg,a=new eBa(a);return Oge(a)}function Oge(a){nk(a);return dn(a)}Mge.prototype={hhc:null,Tkc:null};
function Qge(a){if(!a.Tkc)try{u(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),a.Tkc=Oa.WAA(Oge(lk(L.Va("DimeUrl"),null,null))),a.Tkc.CWo(function(a){u(39978391,324,10,"{0}",Ffe(a.zm))},5)}catch(b){u(594874951,324,10,"{0}",Ffe(b))}return a.Tkc}function Rge(a){a.hhc||(u(21030598,324,50,"InProductMessagingDependenciesLoad usage"),a.hhc=Oa.WAA(Nge(),Pge()),a.hhc.CWo(function(a){u(21030599,324,10,"{0}",Ffe(a.zm))},5));return a.hhc}function Sge(){}
Sge.prototype={RFc:null,z0b:null,U6d:null,x4d:null,i4d:null};function f9(){this.tfb=Array(5);this.tfb[0]=10;this.tfb[1]=15;this.tfb[2]=50;this.tfb[3]=100;this.tfb[4]=200}f9.prototype={dFe:0};f9.prototype.ub=function(a){this.dFe=a};f9.prototype.Init=f9.prototype.ub;f9.prototype.Wbc=function(a,b){u(34182235,this.dFe,this.tfb[a],"{0}",b)};f9.prototype.SendTrace=f9.prototype.Wbc;function Tge(){}
Tge.prototype={Ea:null,Xb:function(){return"Common.App.InProductMessaging"},wc:function(a){C(D(lc(a.ma(Mge,null),Gge)),function(){return new Mge});C(D(lc(a.ma(Uge,null),kga)),function(){return new Uge($f())});C(D(lc(a.ma(Vge,null),lga)),function(){return new Vge(Zf(),a.H(kga,null),a.H(Gge,null),G().rb().Tm(),G().rb().Dib())});C(D(a.ma(Jge,null)),function(){return new Jge(Zf(),G(),a.H(lga,null))});C(D(lc(a.ma(Wge,null),fga)),function(){return new Wge});C(D(lc(a.ma(Ige,null),gga)),function(){return new Ige});
this.Ea=a},ub:function(){this.Ea.H(Jge,null).Wb();var a=this;L.Nf(function(){G().rb().pG()&&Je(window.Common.App.AppLifecycleManager.get_instance(),15,function(){kc(a.Ea,Ci).pb(function(b){Xge(a.Ea.H(Vge,null),b)})},3);L.ia("FreemiumUpsellShowDialogIsEnabled")&&v$b()&&!Rj()&&1!==G().rb().Tm()&&kc(a.Ea,Ci).pb(function(b){b.Ge("MsoPremiumBadge",!0).then(function(c){!c&&b.KTa()&&Yge(a.Ea.H(Vge,null));return null})})})},ha:function(){}};
function Vge(a,b,c,d,e){this.Fa=a;this.bLa=b;this.Cgb=c;this.rT=d;this.nQ=e}
Vge.prototype={bLa:null,Cgb:null,Fa:null,rT:0,nQ:0,qoc:!1,JMb:null,nfe:function(a,b,c){if(this.qoc&&this.JMb){var d={};d.experience=a||"gopremium";d.campaignId=c||u$b(this.rT,this.nQ,window.$$as(String,d.experience),!0);this.Fa.Ab(4142738798,2,null);u(51675403,324,50,"Launching Freemium Upsell dialog: "+d.experience);try{var e,f=this,g=(e=new Sge,e.RFc=this.JMb,e.z0b=d,e.U6d=b||function(){},e.x4d=function(a){u(51675405,324,50,"Dime launch result: "+a.status)},e.i4d=function(){u(51675406,324,10,"Dime launch error");
f.qoc=!1;f.JMb=null},e);Zge(this.bLa,g)}catch(h){u(51675407,324,10,"Dime launch error: "+h.message),this.qoc=!1,this.JMb=null,this.Fa.jb(1274543852,2,{experience:d.experience},null)}}else u(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Fa.jb(1274543852,2,{experience:a},null)},jXc:function(){return this.bLa.jXc()},hXc:function(){return this.bLa.hXc()}};
function Yge(a){Qge(a.Cgb).CWo(function(){try{var b=ce(rs),c=zfe(a.rT);if(c){var d={};d.partnerId=c;d.language=b;d.sessionId=vp;d.authHint=L.Va("UserPrincipalName");var e=L.Va("Puid")||"";""!==e&&(b={},b.puid=e,d.userInfo=b);a.JMb=new window.Dime(d);a.qoc=!0;u(592721856,324,50,"Dime initialized")}else u(51675409,324,15,"App not supported")}catch(f){u(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+f.message)}},3)}
function Lge(a,b){function c(){}var d="gopremium",e=null;b?(b.experience&&""!==window.$$as(String,b.experience)&&(d=window.$$as(String,b.experience)),b.onTaskComplete&&(c=b.onTaskComplete),b.campaignId&&""!==window.$$as(String,b.campaignId)&&(e=window.$$as(String,b.campaignId))):u(51675402,324,50,"Experience not given, using default experience");a.nfe(d,c,e)}
function Kge(a,b){Rge(a.Cgb).CW(function(){var c=a.bLa;b&&(window.InProductMessaging.Networking.NetworkingMgr=new f9,window.InProductMessaging.Networking.NetworkingMgr.Init(387),c.RUd=!0,window.InProductMessaging.Init(b.xHg,b.DEg,b.Eyg,b.aBf,b.F0b,c.Jff,b.W7d),c.O4("inProductMessagingOverlayDiv",!0))})}
function Xge(a,b){oza("getHeaderApi")?b.Ge("MsoPremiumBadge",!0).then(function(a){var d=b.KTa();d&&(window.appChrome.getHeaderApi().then(function(b){b.updatePremiumStatus(a,d);return null}),b.VGa("MsoPremiumBadge",function(a){window.appChrome.getHeaderApi().then(function(b){b.updatePremiumStatus(a.isEnabled,d);return null})}));return null}):u(593859840,324,10,"getHeaderApi not available")}function Uge(a){this.Jff=Function.createDelegate(this,this.O4f);this.Wd=a}
Uge.prototype={Wd:null,RUd:!1,O4:function(a,b){if(this.Wd&&a&&(a=document.getElementById(a),$ge(this,a),a=NB(this.Wd,"InProductMessagingFocusId"))){var c=this.Wd.kf();c&&"InProductMessagingFocusId"===c.Nd||xi(this.Wd,"InProductMessagingFocusId",!1);b&&this.Y1c(a.ZK)}},Y1c:function(a){Pl(a,$f().loa);Pl(a,$f().moa);a.kb($f().loa,1501863744);a.kb($f().moa,3016992658)},Fea:function(){this.Wd&&(qi(this.Wd,"InProductMessagingFocusId",!0),Ql(this.Wd,"InProductMessagingFocusId"))},O4f:function(a,b){this.RUd=
!1;this.Fea();var c;a=(c=new Ige,c.azf=a,c.hDf=b,c);Zf().jb(1486778386,2,a,null)},jXc:function(){var a=document.activeElement,b=this.Wd.rk();return a&&b&&b.qg&&a===b.qg.S_a()?(b.qg.xz(a),Kl(b)?32:8):4},hXc:function(){var a=document.activeElement,b=this.Wd.rk();return a&&b&&b.qg&&a===b.qg.maa()?(b.qg.xz(a),Ll(b)?32:8):4}};
function $ge(a,b){var c=a.Wd.$c("InProductMessagingFocusId");c.ic="app";var d=new Yl(function(){return b});d.kva=!1;Zl(d,3);Zl(d,2);Zl(d,4);a=Ol(a.Wd,function(){return b},c,d);Wl(a);a.QK=!0;a.Dta=!0}
function Zge(a,b){if(b&&b.RFc&&b.z0b){var c=document.getElementById("wacDimeContainer");c||(c=document.createElement("div"),c.id="wacDimeContainer",document.body.appendChild(c));L.ia("DimeFocusManagerIsEnabled")&&a.O4("wacDimeContainer",!1);b.z0b.parentElementId="wacDimeContainer";b.RFc.launch(b.z0b,b.U6d).then(function(d){a.Fea();document.body.removeChild(c);b.x4d(d)}).catch(function(d){a.Fea();document.body.removeChild(c);b.i4d(d)})}else throw Error.argument("DimeExperienceUISettings");}
function Wge(){this.W7d={}}Wge.prototype={Eyg:!0,DEg:!0,xHg:!0,W7d:null,aBf:!1,F0b:null};Ige.registerClass("Common.App.InProductMessaging.FirstRunExperienceViewData",null,gga);Jge.registerClass("Common.App.InProductMessaging.InProductMessagingActor");Mge.registerClass("Common.App.InProductMessaging.DependencyDownloader",null,Gge);Sge.registerClass("Common.App.InProductMessaging.DimeExperienceUISettings");f9.registerClass("Common.App.InProductMessaging.DefaultNetworkingManager",null,Hge);
Tge.registerClass("Common.App.InProductMessaging.InProductMessagingPackage",null,yo,ec);Vge.registerClass("Common.App.InProductMessaging.InProductMessagingUIManager",null,lga);Uge.registerClass("Common.App.InProductMessaging.InProductMessagingUIWrapper",null,kga);Wge.registerClass("Common.App.InProductMessaging.FirstRunExperienceUISettings",null,fga);zo(gj(),new Tge,0,!1);Type.registerNamespace("Common.App.NewAndOpen.UX");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.zW=w.Ca.zW||{};
w.Ca.zW.uDb=w.Ca.zW.uDb||{};w.Ca.zW.uDb.nXc=function(){};w.Ca.zW.uDb.nXc.prototype={};w.Ca.zW.uDb.nXc.registerEnum("Common.App.NewAndOpen.UX.MruActorString",!1);function ahe(){}ahe.registerInterface("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
function bhe(a,b,c,d,e,f){this.Enf=Function.createDelegate(this,this.Eeg);this.gdf=Function.createDelegate(this,this.r1f);this.nra=Function.createDelegate(this,this.lua);this.uE=a;this.Ifa=b;var g=this;this.xQ=new (ga.$$(Ec.$$(Hc)))(function(){return new (cX.$$(Hc))(c.Aa(),g.nra)});this.lye=d;this.iKa=e;this.dLb=f;this.Ugb=this.dLb.Aa();2===gX(g9(this))&&(this.Vjd=!0)}
bhe.prototype={uE:null,Ifa:null,xQ:null,lye:null,iKa:null,dLb:null,Ugb:!1,Zec:null,lo:null,Xkd:null,ekd:!1,kmc:!1,$xe:0,Edd:!1,Vjd:!1,daa:function(){switch(gX(g9(this))){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},Wb:function(){var a=g9(this).Fa.Aa();a.ya(1056925771,2147483648,this.gdf);a.ua(2074131365,2147483648,this.Enf,96)},r1f:function(a,b,c,d,e){return 1===c?32:2===c&&e&&e.MenuItemId&&e.SourceControlId?this.Yvb(e.MenuItemId,
e.SourceControlId):8},Yvb:function(a,b){var c=this.Ifa.Aa().pQc;if(null===c)return 8;var d=L.ia("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(ij&&d){u(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var e={};e.template=a;e.appID=this.daa();e.lcid=F.ag.toString();e.reason="createNew";aj().pb(function(a){a.Il("App_CreateNewDocument",e,"")})}else d=(new Date).getTime(),b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
c,nh(this.cpc()),nh(a),nh(this.daa()),nh(F.ag.toString()),nh(d.toString()),nh(b),nh(As),F.sh),(c=L.Va("ScenarioId"))&&""!==c&&(b+="&wdscenarioid="+nh(c)),b+="&"+Ona(),F.eGa&&(b+="&"+Pna()),(c=this.lo?this.lo.tP:null)&&(b+="&DestinationUrl="+nh(c)),rk(b,"_blank","","CreateNewDocument");2===gX(g9(this))&&u(24700384,202,50,"CreateNewDocument from New Menu {0}",{AppType:w.Oua.toString(gX(g9(this))),Template:a});return 32},Eeg:function(a,b,c,d,e){if(1===c)return this.Vjd&&($i("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.Vjd=!1),32;2!==c||this.Edd||(this.$xe=(new Date).getTime(),u(5849602,202,50,"File New menu flyout opened by user {0}",{ShouldShowTemplates:this.dLb.Aa(),CachedNewMenuXmlExists:!!this.Zec,ShouldCallGetMoreInfo:g9(this).TZa.Aa()}));if(e)if(this.Zec)e.PopulationXML=this.Zec;else{g9(this).TZa.Aa()&&!this.lo&&dX(this.xQ.Aa(),"Opened New menu",!0);a=che(this);var f;b=this.Ifa.Aa().fvb||"1056925771";var g,h=this.Ifa.Aa();c=f={val:f};c.val=!1;d=dhe(this);var k="";g9(this).TZa.Aa()&&(this.ekd?(k=ehe(CommonUIStrings.l_NewGenericErrorMessage,
h.hea,null,null),this.ekd=!1,u(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.lo?d?(k=this.lo,k=ehe(CommonUIStrings.l_NewCreationLocationMessage,h.hea,k.tP,k.cka)):this.lo.w_b?(c.val=!0,this.Ugb=!1,k=ehe(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,this.lo.cka,"\n\n"),h.hea,null,null),u(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(c.val=!0,k=ehe(CommonUIStrings.l_NewGenericErrorMessage,h.hea,null,
null),u(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{PersonalFileStorageUrlIsSet:!!this.lo.tP,StorageServiceDisplayNameIsSet:!!this.lo.cka})):(k=fhe(h.hea,CommonUIStrings.l_VoicedLoadingText),u(5849606,202,50,"Rendering File>New with loading spinner")));if(d){d=k;var h=ghe("menuNewBlank",h9.OWf,k?null:h.hea,hhe(h.Bde,h.Cde,h.Dde,null,h.qyb,h.pyb,b,"blank")),l;c.val=!1;if(this.dLb.Aa()){var m=k="",n="MenuTemplate";if(this.kmc)k=ihe(),this.kmc=!1,
u(5849610,202,10,"Rendering File>New with template error message");else if(a){try{l=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),k=jhe(this,l,b),u(5849612,202,50,"Rendering File>New with template buttons"),ooa&&"OneDrive"===this.cpc()&&(m=ghe("menuNewMoreTemplates",h9.Fbe,null,hhe("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,this.lye.Aa(),ooa)))}catch(r){u(5849613,202,10,"Failed to parse JSON response from template service {0}",
{JsonToConvert:a}),k=ihe()}c.val=!0}else n="MenuLoading",k=khe("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText,null,null),u(5849611,202,50,"Rendering File>New with template loading spinner");l=ghe("menuNewTemplates",n,null,k)+m}else c.val=!0,u(5849609,202,50,"Rendering File>New without template buttons due to BRS"),l="";k=d+(h+l)}l=(g=lhe("New",k),f=f.val,g);f&&(this.Zec=l,g=(new Date).getTime()-this.$xe,u(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{ElapsedMsSinceMenuOpened:g}));
e.PopulationXML=l}return 32},lua:function(a,b){u(590964757,202,50,"GetMoreInfoEventReceived");if(this.lo||3!==a.Ah())2===a.Ah()&&(u(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.ekd=!0,mhe(this));else if(this.lo=a,b||mhe(this),G()&&G().rb().Yga()&&Bm()&&qW("setFileMenuHostInformation")){var c;a=(c=new Cza,c.hostUrl=this.lo.tP,c.hostName=this.lo.cka,c.folderUrl=F.uta,c.folderName=F.Yub,c);u(590964758,202,50,"Sending HostInformation to FileMenu");window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuHostInformation(a))}},
cpc:function(){return this.iKa.Aa()}};function g9(a){return a.uE.Aa()}function mhe(a){a.Edd=!0;g9(a).Dr.Aa().kT(a.Ifa.Aa().nxb);a.Edd=!1}
function jhe(a,b,c){for(var d="",e=[],f=0;f<b.length;f++){var g=b[f],h="";if(g){var k=g.Title,l=g.AssetId,g=g.Thumbnails;if(l&&k&&g)var m,n,r,h=(r=nhe(a,g,n={val:m}),m=n.val,r),d=d+hhe("jbtnNewTemplate"+f,k,null,m,null,h,c,l)}e[f]=h}b=new Si(4,1,5E3,function(){var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=window.performance;if(c&&"undefined"!==typeof c.getEntriesByName){for(var d=0;d<e.length;d++){var f=c.getEntriesByName(e[d]);f&&0<f.length&&(f=f[0],a=Math.min(window.parseInt(f.fetchStart),a),b=Math.max(window.parseInt(f.responseEnd),
b))}b>a&&u(5849601,202,50,"Total time to download template thumbnails {0}",{TotalElapsedMs:b-a,MinFetchStart:a,MaxResponseEnd:b})}},106,null,!1,0);g9(a).td.Aa().Vb(b);return d}
function nhe(a,b,c){var d=0;c.val="";for(var e=0;e<b.length;e++)if("ST"===b[e].ImageType){d=e;break}var f=b.length?b[d]:null;b=f?f.Url||"":"";var g,h=e=d=!1;if(f&&(g=f.AspectRatio))a=window.parseFloat(g),1>a?d=!0:1.5<a?e=!0:1===a&&(h=!0);else switch(u(5849603,202,10,"Thumbnail aspect ratio missing {0}",{Url:b}),gX(g9(a))){case 3:d=!0;break;case 2:e=!0;break;case 5:h=!0}c.val=d?"95by123":e?"123by69":h?"100by100":"123by95";return b}
function che(a){if(!a.dLb.Aa()||!ohe(a))return null;if(a.Ugb&&!a.kmc){var b="9",c=ye(L);"NumberOfTemplatesInBackstage"in c&&(b=c.NumberOfTemplatesInBackstage);var d=a.daa();"TemplateCollectionId"in c&&(d=c.TemplateCollectionId);b=String.format(g9(a).s6()+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",nh(F.ag.toString()),nh(d),b);Boolean.parse(c.AppendOriginQueryParam||"false")&&(b+="&org=backstage");b+="&"+Ona();F.eGa&&(b+="&"+Pna());g9(a).eg.Aa().lk(b,1,null,null,!1,2,function(b){fX(g9(a),
"CreateNewActor.GetTemplateListJson",b.Pa,"");a.Xkd=b.Pa.Ce;a.Ugb=!1;mhe(a);if(G()&&G().rb().Yga()&&Bm()){b=L.ia("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");var c=ij;window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuTemplateJson(a.Xkd,!0,b&&c))}},function(b){fX(g9(a),"CreateNewActor.GetTemplateListJson",b.Pa,"");a.Ugb=!0;a.kmc=!0;mhe(a);G()&&G().rb().Yga()&&Bm()&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuTemplateJson("",!1,!1));Ce().recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)},null,null,!1,null,null,"5",null,!1,null,!1,null);a.Ugb=!1}return a.Xkd}function ohe(a){return G()&&G().rb().Yga()?!0:dhe(a)}function dhe(a){return!g9(a).TZa.Aa()||!!a.lo&&3===a.lo.Ah()&&!!a.lo.cka&&!!a.lo.tP}function phe(){phe.initializeBase(this)}function qhe(a){return(rhe||(rhe=new phe)).kA(a)}
phe.prototype={mFf:function(){bfe(this,0,CommonUIStrings.l_OpenMenuEmptyMruMessage);bfe(this,1,CommonUIStrings.l_OpenMenuServerErrorMessage);bfe(this,2,CommonUIStrings.l_Open);bfe(this,3,CommonUIStrings.l_OpenMenuRecentDocuments);bfe(this,4,CommonUIStrings.l_OpenMenuMoreOnHost);bfe(this,5,CommonUIStrings.l_VoicedLoadingText)}};
function she(a,b,c,d,e,f,g,h){this.Dnf=Function.createDelegate(this,this.Deg);this.ddf=Function.createDelegate(this,this.g1f);this.lb=h;this.uE=a;this.hoa=b;this.leb=c;this.Toe=d;this.Soe=e;this.xQ=new (ga.$$(Ec.$$(Hc)))(function(){return new (cX.$$(Hc))(f.Aa(),null)});var k=this;this.cte=new (ga.$$(Ec.$$(Jc)))(function(){return new (cX.$$(Jc))(g.Aa(),k.ddf)});this.Hvg=this.lb.ia("WacInTabOpenMRUIsEnabledForUiHost");this.Txg=this.lb.ia("UiHostSupportsDocRebootFeatures")}
she.prototype={uE:null,T8c:null,Jnc:!0,Yec:"",Pxg:0,ofb:null,Toe:null,Soe:null,hoa:null,leb:null,ted:3,cte:null,xQ:null,Hvg:!1,Txg:!1,lb:null,g1f:function(a,b){this.ofb=a;b||the(this)},Deg:function(a,b,c,d,e){if(1!==c&&e){c=3;a=!1;if(this.Yec&&this.Pxg===this.ofb.E7d)u(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{CacheRefresh:"Not Dirty"}),c=this.ted;else{u(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{CacheRefresh:"Starting"});b=(0,this.$L().Ofa)();
this.ofb=dX(this.cte.Aa(),"File Open opened",!0);if(this.Yec&&2!==this.ted&&3!==this.ofb.Ah())a=!0;else{var f;try{f=Id(this.ofb.S0b)}catch(t){f=null,u(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",t)}G()&&G().rb().Yga()&&Bm()&&f&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuMRUJson(f,!0));var g;d=this.ofb;f=c={val:c};if(1!==d.Ah()&&d.Ah())if(3===d.Ah()&&d.S0b){d=d.S0b;var h,k=this.leb.Aa().fvb||"2155708348";if(d.length){h=khe("lblRecentDocuments",
i9(this)(3),null,null);for(var l=0,m=0;m<d.length;m++){var n=d[m];"FileName"in n&&"DocumentUrl"in n&&"Path"in n&&(h+=hhe("MruButton"+m,n.FileName.toString(),n.Path.toString(),null,this.leb.Aa().qyb,this.leb.Aa().pyb,k,n.DocumentUrl.toString()),n.IsPinned&&l++)}h=ghe("RecentDocumentsMenuSection",h9.mge,i9(this)(2),h);u(5849665,202,50,"Open menu XML built {0}",{Display:"MRU List",TotalDocuments:d.length,NumPinnedDocuments:l})}else h=ehe(i9(this)(0),i9(this)(2),null,null),u(5849664,202,50,"Open menu XML built {0}",
{Display:"Empty MRU"});d=h;f.val=0}else u(5849634,202,50,"Open menu XML built {0}",{Display:"Server Error"}),d=ehe(i9(this)(1),i9(this)(2),null,null),f.val=1;else u(5849635,202,50,"Open menu XML built {0}",{Display:"Spinner"}),f.val=2,d=fhe(i9(this)(2),i9(this)(5));this.Yec=(g=d,c=c.val,g)}g=(0,this.$L().Ofa)()-b;u(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{CacheRefresh:"Complete",ElapsedMs:g})}2!==c&&(g={DisplayState:uhe.toString(c)},1!==c&&(g.IsStale=a),u(5849630,202,50,
"MRU section display state {0}",g));this.ted=c;if(this.Jnc){u(5849632,202,50,"Open menu Browse More Link creation necessary.");var r;b=g={val:this.Jnc};b.val=!0;a=this.Toe.Aa();c=this.Soe.Aa();a&&c||!this.$L().TZa.Aa()?b.val=!1:(f=dX(this.Eoc(),"File Open",!1),3===f.Ah()&&(a=f.tP,c=f.cka,b.val=!1));b=c?String.format(i9(this)(4),c):null;c=this.leb.Aa().fvb;f="";a&&b&&(f=ghe("BrowseMoreMenuSection",h9.Fbe,null,hhe("btnBrowseMore",b,b,null,null,null,c||"1959943459",a)));this.T8c=(r=f,this.Jnc=g.val,
r)}else u(5849631,202,50,"Open menu Browse More Link creation not required.");u(5849633,202,50,"Browse More link display state {0}",{WaitingOnLinkInfo:this.Jnc,NotDisplayingLink:!this.T8c});e.PopulationXML=lhe("Open",this.Yec+this.T8c)}return 32},$L:function(){return this.uE.Aa()},Eoc:function(){return this.xQ.Aa()}};function i9(a){return a.hoa.Aa()}function the(a){a.$L().Dr.Aa().kT(a.leb.Aa().nxb)}function vhe(a){a.$L().Fa.Aa().ua(2799130311,2147483648,a.Dnf,96)}function uhe(){}
uhe.prototype={success:0,failure:1,spinner:2,none:3};uhe.registerEnum("Common.App.NewAndOpen.UX.MruRenderer.DisplayState",!1);function h9(){}function fhe(a,b){return ghe("LoadingMenuSection",h9.g0f,a,khe("lblLoading",b,null,null))}function ehe(a,b,c,d){return ghe("MessageMenuSection",h9.mge,b,khe("lblMessage",a,c,d))}function ihe(){return khe("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage,null,null)}
function khe(a,b,c,d){var e=d;b&&0<b.length&&(e=yg(whe,b).trimEnd(),e=0<=e.indexOf("{0}")?String.format(e,d):String.format("{0} {1}",e,d));c=c&&d?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Xg(c),Xg(d),Xg(e)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Xg(a||""),yg(whe,Xg(b||"")),c)}
function hhe(a,b,c,d,e,f,g,h){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Xg(a||""),Xg(b||""),Xg(c||""),d||"32by32",Xg(e||""),Xg(f||""),g,Xg(h||""))}function lhe(a,b){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',a,b)}
function ghe(a,b,c,d){c=c?String.format('Title="{0}"',Xg(c)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Xg(a||""),Xg(b||""),c,d)}function xhe(a,b,c,d){this.Ifa=a;this.iKa=b;this.uE=c;this.bte=d}
xhe.prototype={Ifa:null,iKa:null,uE:null,bte:null,nc:function(a,b,c){return new yhe(a,b,c,this.Ifa,this.iKa,this.uE,this.bte)}};function zhe(a,b,c,d){this.cab=a;this.c0=b;this.Ole=c;this.wbe=d}zhe.prototype={cab:null,c0:null,Ole:null,wbe:null};
function yhe(a,b,c,d,e,f,g){this.hdf=Function.createDelegate(this,this.t1f);this.idf=Function.createDelegate(this,this.u1f);this.nra=Function.createDelegate(this,this.lua);this.wye=a;this.CYa=b;this.fJb=c;this.Ifa=d;this.iKa=e;this.uE=f;var h=this;this.xQ=new (ga.$$(Ec.$$(Hc)))(function(){return new (cX.$$(Hc))(g.Aa(),h.nra)})}
yhe.prototype={lo:null,wCe:!1,lpe:0,lJa:0,fJb:null,wye:null,CYa:null,Ifa:null,iKa:null,uE:null,xQ:null,Yvb:function(){!this.lo&&this.uE.Aa().TZa.Aa()?dX(this.Eoc(),"NewDocumentFromStream",!0):Ahe(this)},lua:function(a){if(!this.lo&&3===a.Ah())this.lo=a;else if(2===a.Ah()){this.wCe?u(24904471,202,10,"After second try GetMoreResult still fail."):(dX(this.Eoc(),"NewDocumentFromStream",!0),this.wCe=!0);return}Ahe(this)},u1f:function(a){if(a&&a.Pa&&a.Pa.Ce){var b,c,d;(d=vk(a.Pa.Ce,c={val:b}),b=c.val,d)?
(a=b,200!==a.StatusCode&&201!==a.StatusCode?(u(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.daa(),this.lJa,a.StatusCode),this.CYa(null)):a.NewDocumentUrl&&""!==a.NewDocumentUrl?(b=(new Date).getTime()-this.lpe,u(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.daa(),this.lJa,b),this.wye(a.NewDocumentUrl)):(u(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.daa(),this.lJa),this.CYa(null))):(u(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.daa(),this.lJa,{ResponseData:g5d(a.Pa.Ce)}),this.CYa(null))}else u(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.daa(),this.lJa),this.CYa(null)},t1f:function(a){a&&a.Pa&&u(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.daa(),
this.lJa,a.Pa.Se);this.CYa(null)},daa:function(){switch(gX(this.uE.Aa())){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},cpc:function(){return this.iKa.Aa()},Eoc:function(){return this.xQ.Aa()}};
function Ahe(a){a.lpe=(new Date).getTime();var b=a.Ifa.Aa().pQc;if(null===b)a.CYa(null);else{var c=a.fJb.cab,d=a.fJb.c0,e=a.fJb.Ole,f=a.fJb.wbe;a.lJa="streamBase64"===e?f.length/1024:0;u(35156358,202,50,"FileType:{0}, FileSize:{1}",a.daa(),a.lJa);var g=(new Date).getTime(),b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,nh(a.cpc()),nh(c),nh(a.daa()),nh(F.ag.toString()),nh(g.toString()),nh(d),nh(As),F.sh,nh(e)),b=b+("&"+Ona());
F.eGa&&(b+="&"+Pna());(c=a.lo?a.lo.tP:null)&&(b+="&DestinationUrl="+nh(c));a.uE.Aa().eg.Aa().lk(b,2,f,{"Content-Type":"application/json; charset=utf-8"},!0,2,a.idf,a.hdf,null,null,!1,null,null,"31",null,!1,null,!1,null)}}function Bhe(){this.dispose=this.ha}
Bhe.prototype={Xb:function(){return"Common.App.NewAndOpen.UX"},wc:function(a){C(D(lc(a.ma(xhe,null),ahe)),function(){return new xhe(new (ga.$$(Xqa))(function(){return G().rb().Dxb()}),new (ga.$$(String))(function(){return epa}),new (ga.$$(Kc))(function(){return gc(a,Kc)}),new (ga.$$(Fc.$$(Hc)))(function(){return gc(a,Fc.$$(Hc))}))})},ub:function(){var a=this;L.Nf(function(){a.GTa()})},GTa:function(){var a=mc(Kc,kc(B(),Kc)),b=mc(Fc.$$(Hc),kc(B(),Fc.$$(Hc)));epa&&Oa.WAA.call(null,a,b).CW(function(){var c=
new bhe(new (ga.$$(Kc))(function(){return ab(a)}),new (ga.$$(Xqa))(function(){return G().rb().Dxb()}),new (ga.$$(Fc.$$(Hc)))(function(){return ab(b)}),new (ga.$$(String))(function(){return G().rb().Exb().fvb||"1959943459"}),new (ga.$$(String))(function(){return epa}),new (ga.$$(Boolean))(function(){return fpa}));c.Wb();mhe(c)});if(gpa){var c=mc(Fc.$$(Jc),kc(B(),Fc.$$(Jc)));Oa.WAA.call(null,a,b,c).CW(function(){var d=new she(new (ga.$$(Kc))(function(){return ab(a)}),new (ga.$$(Function))(function(){return qhe}),
new (ga.$$(Yqa))(function(){return G().rb().Exb()}),new (ga.$$(String))(function(){return hpa}),new (ga.$$(String))(function(){return ipa}),new (ga.$$(Fc.$$(Hc)))(function(){return ab(b)}),new (ga.$$(Fc.$$(Jc)))(function(){return ab(c)}),L);vhe(d);the(d)})}},ha:function(){}};bhe.registerClass("Common.App.NewAndOpen.UX.CreateNewActor");phe.registerClass("Common.App.NewAndOpen.UX.MruActorIntlHelper",Co.$$(w.Ca.zW.uDb.nXc));she.registerClass("Common.App.NewAndOpen.UX.MruRenderer");h9.registerClass("Common.App.NewAndOpen.UX.NewAndOpenXmlUtilities");
xhe.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory",null,ahe);zhe.registerClass("Common.App.NewAndOpen.UX.NewDocumentParameters");yhe.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperation");(function(){}).registerClass("Common.App.NewAndOpen.UX.Program");Bhe.registerClass("Common.App.NewAndOpen.UX.UXPackageManager",null,yo,ec,Sys.IDisposable);var rhe=null;h9.mge="MenuMru";h9.g0f="MenuLoading";h9.OWf="MenuHeader";h9.Fbe="MenuFooter";var whe=vg("\n","&#10;");
zo(gj(),new Bhe,0,!1);Type.registerNamespace("Common.App.OneDriveFilePickerApi");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Tcg=w.Ca.Tcg||{};function Che(){}Che.registerInterface("Common.App.OneDriveFilePickerApi.IErrorDialog");function Dhe(){}Dhe.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper");function Ehe(){}Ehe.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager");function Fhe(a){this.olsSessionId=a}Fhe.prototype={olsSessionId:null};
function Ghe(){Ghe.initializeBase(this);Ej(this,0);Fj(this,1,CommonUIStrings.l_DialogClose)}Ghe.prototype={Zw:function(a){this.ww(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!1,!1,!1)},Pta:function(a){this.ww(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0,!1,!1)}};function Hhe(){}function Ihe(a){this.X5e=Function.createDelegate(this,this.uPf);this.Y5e=Function.createDelegate(this,this.vPf);this.eg=a;this.Clc=3}
Ihe.prototype={TB:null,eg:null,Clc:0,uPf:function(a){if(412===a.Pa.kg&&"X-NewKey"in a.Pa.Mj){u(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var b={};b["X-Key"]=a.Pa.Mj["X-NewKey"];Jhe(this,b)}else 0<this.Clc?(u(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.Clc),this.Clc--,Jhe(this,null)):(u(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.TB.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},
vPf:function(a){"PersonalFileStorageUrl"in a.Pa.Mj&&""!==a.Pa.Mj.PersonalFileStorageUrl?(u(24134239,352,50,"Successfully received an ODB endpoint"),this.TB.Uh(a.Pa.Mj.PersonalFileStorageUrl)):(u(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.TB.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}};
function Jhe(a,b){var c=String.format("GetMoreInfoHandler.ashx?{0}",F.KSa);Tk(a.eg,c,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,a.Y5e,a.X5e,null,null,null,"21",!1,null,null)}function Khe(a,b,c,d,e,f){Khe.initializeBase(this,[b,c,d,f]);this.foa=a;this.LDe=e}
Khe.prototype={foa:null,LDe:null,tk:null,Eib:function(){return this.Hra.Va("OneDriveApiUrl")},af:function(a,b){this.tk=a;this.tFd(b)},QUc:function(){window.WL.init(1===this.VCc||2===this.VCc?{client_id:ye(this.Hra).UploadToSkyDriveClientId}:{client_id:ye(this.Hra).UploadToSkyDriveClientId,env:"INT"})},tFd:function(a){this.Hla=a;!this.VJa&&kta()?(u(17909025,352,50,"User is signed in. We will show file picker."),this.Ro(this.YHd)):(u(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.LDe())},b9b:function(){try{u(17909027,352,50,"Launching file dialogue"),window.WL.fileDialog(this.tk).then(this.Opb,this.ipb)}catch(a){u(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",a,a.stack),this.xw()}},sH:function(a){if(a&&a.error){if("user_canceled"===a.error.code){u(17909058,352,50,"User canceled.");return}u(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else u(17909060,352,50,"File Dialog returned with no response");
this.Hla&&this.Hla(!1,a);this.xw()}};function Lhe(a,b,c,d,e){this.pwf=Function.createDelegate(this,this.nme);Lhe.initializeBase(this,[a,b,c,d]);this.pvg=e;this.Zh={};this.Zh.clientId=this.Hra.Va("OneDriveApiV7ClientId");this.Zh.cancel=this.pwf}
Lhe.prototype={pvg:null,Gwg:null,jcd:null,Zh:null,Eib:function(){return this.Hra.Va("OneDriveApiV72Url")},QUc:function(){var a=this;this.Zh.success=function(b){var d={};d.data=b;a.OnSuccess(d)};var b=this;this.Zh.error=function(a){var d={};d.error=a;b.sH(d)};this.Zh.advanced={};this.Zh.advanced.linkType="share";this.Zh.advanced.endpointHint=this.Gwg;this.Zh.advanced.iframeParentDiv=this.jcd},b9b:function(){try{u(22090007,352,50,"Launching OneDrive file picker dialog"),this.nme(),window.OneDrive.open(this.Zh)}catch(a){u(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",a.message),this.xw()}},sH:function(a){this.Hla&&this.Hla(!1,a);this.xw()},nme:function(){this.jcd.style.visibility="hidden"===this.jcd.style.visibility?"":"hidden"}};function j9(a,b,c,d){j9.initializeBase(this,[a,b,c,d]);this.lb=a;this.Zh={};this.Zh.advanced={};this.Zh.action="query";this.Zh.clientId=this.Hra.Va("OneDriveApiV72ClientId");this.Zh.advanced.trapFocus=!0}
j9.prototype={lb:null,Zh:null,Eib:function(){return this.Hra.Va("OneDriveApiV72Url")},af:function(a,b,c,d){this.Zh.advanced.iframeParentDiv=c;this.Zh.advanced.endpointHint=d;this.Zh.cancel=b;this.lb.ia("OneDriveApiV72RecentsViewEnabled")&&(this.Zh.advanced.navigation={},this.Zh.advanced.navigation.entryLocation={},this.Zh.advanced.navigation.entryLocation.oneDrive={},this.Zh.advanced.navigation.entryLocation.oneDrive.recent={});this.tFd(a)},tFd:function(a){this.Hla=a;this.VJa?u(24391838,216,50,"In limited edit mode, will not show Picker."):
(u(24391837,216,50,"Not in limited edit mode, will show file picker."),this.Ro(this.YHd))},QUc:function(){var a=this;this.Zh.success=function(b){var d={};d.data=b;a.OnSuccess(d)};var b=this;this.Zh.error=function(a){var d={};d.error=a;b.sH(d)}},b9b:function(){try{u(23881879,216,50,"Launching OneDrive file picker dialog"),window.OneDrive.save(this.Zh)}catch(a){u(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.xw()}},lZc:function(a){u(25180160,
216,15,"Failure during OneDrive API download: {0}",a.zm?a.zm.toString():"No error detail.");a=this.Eib();var b=gn();a in b.Kgb&&delete b.Kgb[a];this.Xfb=null},xw:function(){this.Mr().Pta(35)},sH:function(a){this.Hla&&this.Hla(!1,a)}};function Mhe(a,b,c,d){this.ipb=Function.createDelegate(this,this.sH);this.Opb=Function.createDelegate(this,this.OnSuccess);this.YHd=Function.createDelegate(this,this.s2f);this.dispose=this.ha;this.Hra=a;this.VCc=b;this.VJa=c;this.Mr=d}
Mhe.prototype={Mr:null,VCc:0,Hra:null,Hla:null,VJa:!1,HYa:null,Njd:!1,Mjd:!1,Xfb:null,Ro:function(a){this.HYa=a;if(this.Njd||this.Mjd)this.Njd&&this.HYa&&this.HYa(!0);else if(a=Nhe(this)){this.Mjd=!0;var b=this;dn(a).CW(function(a){b.Mjd=!1;if(Qa(a))b.lZc(a),b.HYa(!1);else try{b.Njd=!0,u(17909022,352,50,"Initializing OneDrive API"),b.QUc(),u(17909023,352,50,"OneDrive API is initialized."),b.HYa(!0)}catch(d){u(20555412,352,10,"Failed during OneDrive API init: {0}",d.toString()),b.HYa(!1)}});nk(a)}else u(20509837,
352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.HYa(!1)},lZc:function(a){u(20509838,352,15,"Failure during OneDrive API download: {0}",a.zm?a.zm.toString():"No error detail.")},s2f:function(a){a?this.b9b():this.xw()},xw:function(){this.Mr().Zw(34)},OnSuccess:function(a){u(17909057,352,50,"Success Callback called. Calling callback function.");this.Hla&&this.Hla(!0,a)},ha:function(){this.Xfb&&this.Xfb.ha()}};
function Nhe(a){a.Xfb||(a.Xfb=a.Eib()?lk(a.Eib(),null,null,null,!1,!1,null,!0,!1,null):null);return a.Xfb}function Ohe(a,b,c,d){Ohe.initializeBase(this,[a,b,c,d]);this.Zh.advanced.filter=a.Va("OneDriveApiV72Filter")||"folder,photo";this.Zh.advanced.linkType="download";this.Zh.multiSelect=F.A9d;a.ia("OneDriveApiV72CommandModeEnabled")&&(this.Zh.commandMode=a.Va("OneDriveApiV72CommandMode")||"none");a.ia("OneDriveApiV72QosExtraDataEnabled")&&(this.Zh.qosExtradata=new Fhe(vp))}
Ohe.prototype={Eib:function(){return this.Hra.Va("OneDriveApiV72Url")},b9b:function(){try{u(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.Zh.advanced.filter,this.Zh.commandMode,this.Zh.qosExtradata?this.Zh.qosExtradata.olsSessionId:"",vp),window.OneDrive.open(this.Zh)}catch(a){u(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.xw()}}};
function Phe(){}
Phe.prototype={Ea:null,Xb:function(){return"Common.App.OneDriveFilePickerApi"},ub:function(){},ha:function(){},wc:function(a){this.Ea=a;C(D(lc(this.Ea.ma(Khe,null),Ehe)),function(){return new Khe(lta(),L,mj,F.oN,G$b,function(){return new Ghe})});qj?C(D(this.Ea.ma(Dhe,null)),function(){return new Hhe}):C(D(this.Ea.ma(Dhe,null)),function(){return new Ihe(F.gf)});var b=this;C(D(this.Ea.ma(Lhe,null)),function(){return new Lhe(L,mj,F.oN,function(){return new Ghe},b.Ea.H(Dhe,null))});C(D(this.Ea.ma(j9,null)),
function(){return new j9(L,mj,F.oN,function(){return new Ghe})});C(D(this.Ea.ma(Ohe,null)),function(){return new Ohe(L,mj,F.oN,function(){return new Ghe})})}};Fhe.registerClass("Common.App.OneDriveFilePickerApi.IExtraData");Ghe.registerClass("Common.App.OneDriveFilePickerApi.ErrorDialog",Dj,Che);Hhe.registerClass("Common.App.OneDriveFilePickerApi.OneDriveConsumerEndpointHelper",null,Dhe);Ihe.registerClass("Common.App.OneDriveFilePickerApi.OneDriveForBusinessEndpointHelper",null,Dhe);
Mhe.registerClass("Common.App.OneDriveFilePickerApi.AOneDriveFilePickerApiManager",null,Ehe,Sys.IDisposable);Khe.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5",Mhe);Lhe.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7",Mhe);j9.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72",Mhe);Ohe.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72",j9);
Phe.registerClass("Common.App.OneDriveFilePickerApi.PackageManager",null,yo,ec);zo(gj(),new Phe,0,!1);Type.registerNamespace("Common.App.PenMinutesManager");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Sue=w.Ca.Sue||{};function lEc(){}lEc.registerInterface("Common.App.PenMinutesManager.IPenMinutesManager");
function mEc(a){this.BWd=Function.createDelegate(this,this.bqe);this.w1d=Function.createDelegate(this,this.ute);this.M0d=Function.createDelegate(this,this.tte);a?(this.ob=a,this.MQc=Date.now,this.kcc=new Si(4,2,6E4,this.BWd,0,null,!1,0),this.ob.Vb(this.kcc),window.document.body.addEventListener("pointerenter",this.M0d),window.document.body.addEventListener("pointerleave",this.w1d)):u(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}
mEc.prototype={ob:null,xab:0,mda:0,odc:0,fEa:0,Jgd:null,kcc:null,MQc:null,tte:function(a){"pen"!==a.pointerType||this.mda||(this.mda=Math.floor(this.MQc()/1E3),this.mda<=this.xab&&(this.mda=this.xab),this.odc=0)},ute:function(a){"pen"===a.pointerType&&(a=Math.ceil(this.MQc()/1E3),this.mda&&a>this.xab&&(this.odc=a,this.fEa+=this.odc-this.mda),this.xab=a,this.mda=0)},bqe:function(){if(0<this.fEa){var a=this.fEa,b=new hb;b.name=this.Jgd;var c=[];(a=hk("PenInputSec",a.toString(),3))&&Array.add(c,a);b.dataFields=
c;window.Otel.Telemetry.Z_(b)}this.fEa=0},ha:function(){this.ob.ih(this.kcc)}};function nEc(){}nEc.prototype={Ea:null,Xb:function(){return"Common.App.PenMinutesManager"},wc:function(a){this.Ea=a;var b=ke();C(D(this.Ea.ma(lEc,null)),function(){return new mEc(b)})},ub:function(){},ha:function(){var a=gc(this.Ea,lEc);a&&a.ha()}};mEc.registerClass("Common.App.PenMinutesManager.PenMinutesManager",null,lEc);nEc.registerClass("Common.App.PenMinutesManager.PenMinutesManagerPackage",null,yo,ec);
zo(gj(),new nEc,0,!1);Type.registerNamespace("Common.App.SaveAsToHost");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.ulg=w.Ca.ulg||{};function Qhe(){}Qhe.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialogFactory");function Rhe(){}Rhe.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialog");function She(){}She.registerInterface("Common.App.SaveAsToHost.IFileNameDialogFactory");function The(){}The.registerInterface("Common.App.SaveAsToHost.IFileNameDialog");function Uhe(){}Uhe.registerInterface("Common.App.SaveAsToHost.IUploadToHostManager");
function Vhe(){}function Whe(a,b){this.lb=a;this.Fa=b;this.gJa=this.lb.ia("SaveToHostWithExtraCharsInFileName")}Whe.prototype={Fa:null,lb:null,gJa:!1,nc:function(){return new Xhe(this.Fa,this.gJa)}};function Xhe(a,b){this.$Bc=Function.createDelegate(this,this.Z2c);Xhe.initializeBase(this);this.Fa=a;this.gJa=b;this.$sa=!1}
Xhe.prototype={Fa:null,gJa:!1,cgb:!1,bD:null,Zw:function(a,b,c){this.bD=b;this.cgb=c;u(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",a,c);(a=Yhe(a))?(Ej(this,0),Fj(this,1,CommonUIStrings.l_DialogClose)):(Ej(this,6),Fj(this,0,CommonUIStrings.l_DialogClose));a||u(8194009,216,50,"Show standard error dialog.");this.ww(26,Zhe(a),$he(this,a,b),this.$Bc,!0,!1,!1)},Z2c:function(a){1===a?(u(8194010,216,50,"User click to retry button in error dialog."),this.bD?this.Fa.jb(2316717900,2,[this.bD,
this.cgb],null):this.Fa.Ab(2316717900,2,null)):u(8194011,216,50,"User cancel the error dialog.")}};function Zhe(a){a=Yhe(a);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][a]}
function $he(a,b,c){b=Yhe(b);return a.gJa?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][b]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,
c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][b]}function Yhe(a){return 0>a||6<a?(u(8194012,216,15,"Unexpected error code {0}.",a),0):a}function aie(a,b,c,d,e,f){this.Fa=b;this.lb=a;this.fL=d;this.l1=f;this.Mr=e;this.Bg=c}aie.prototype={Fa:null,fL:null,l1:null,Mr:null,lb:null,Bg:null,nc:function(){return new bie(this.lb,this.Fa,this.Bg,this.fL,this.Mr,this.l1)}};
function bie(a,b,c,d,e,f){bie.initializeBase(this,[a,b,c,d,e,f,null]);this.Hp=pm(Vhe.u9a,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite);this._id="FileNameDialog-SaveAsToHost"}bie.prototype={tda:function(a,b){var c=vW(F.hz.Gt);this.zk(CommonUIStrings.L_SaveAs,this.gXb,{txtFileName:a||c,lblFolderName:CommonUIStrings.l_ToCurrentFolder,chkOverwrite:b});cie(this,a,c)}};
function die(a,b,c,d,e,f,g){this.NXb=Function.createDelegate(this,this.q5f);this.gXb=Function.createDelegate(this,this.bSc);die.initializeBase(this,[!1,!1,!1,!1]);this.Fa=b;this.fL=d;this.l1=f;this.lb=a;this.Mr=e;this.Bg=c;this.gJa=this.lb.ia("SaveToHostWithExtraCharsInFileName");this.pze=g;Fj(this,1,CommonUIStrings.l_SaveButtonLabel)}
die.prototype={FT:null,Mr:null,l1:null,Fa:null,fL:null,lb:null,Bg:null,gJa:!1,pze:null,WTc:function(){var a=vW(F.hz.Gt);hp(this,1,!!this.FT&&""!==this.FT.value&&this.FT.value!==a)},q5f:function(){if(this.FT){var a=this;window.setTimeout(function(){a.WTc()},0)}},bSc:function(a,b){if(1!==a)u(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{a=b.txtFileName;b="chkOverwrite"in b?b.chkOverwrite:!1;u(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",
Ila(a),b);var c=vh(F.qW);(a=a?a.trim():null)&&""!==a&&""!==c||1===this.Bg.Ah()?eie(this,a)?this.Mr.nc().Zw(1,a,b):this.l1.S9(a+c,b,this.pze):this.Mr.nc().Zw(2,a,b)}},dispose:function(){this.FT&&(oi(this.FT,"change",this.NXb),oi(this.FT,"input",this.NXb),this.FT=null);om.prototype.dispose.call(this)}};
function eie(a,b){return a.gJa?(new RegExp("["+'\\/:*?"<>|'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b):(new RegExp("["+'\\/:*?"<>|#{}%~&'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b)}function cie(a,b,c){hp(a,1,!!b&&b!==c);a.FT=document.getElementById("txtFileName");hh(a.FT,"change",a.NXb);hh(a.FT,"input",a.NXb);a.FT.focus()}function fie(a,b,c){this.XNd=Function.createDelegate(this,this.vlg);this.l1=c;this.qGb=b;this.lb=a}
fie.prototype={lb:null,qGb:null,l1:null,Wb:function(){2===G().rb().Tm()?Zf().ua(2316717900,2147483648,this.XNd,4):Zf().ya(2316717900,2147483648,this.XNd)},vlg:function(a,b,c,d,e){return 2147483648!==b.Ke()||2316717900!==a?2:this.lb.ia("SaveAsToHostBrsIsEnabled")?1===c?Xj().Vfa||gW?8:32:2===c?(u(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),a=this.qGb.nc(),e&&Object.getType(e)===Array&&2===e.length?a.tda(e[0],!!e[1]):a.tda(null,!1),32):8:8}};
function gie(){this.Hm=Function.createDelegate(this,this.vm)}
gie.prototype={Ea:null,Xb:function(){return"Common.App.SaveAsToHost"},ub:function(){L.Nf(this.Hm)},vm:function(){L.ia("SaveAsToHostBrsIsEnabled")&&this.Ea.H(fie,null).Wb()},wc:function(a){this.Ea=a;D(C(lc(this.Ea.ma(Whe,null),Qhe),function(){return new Whe(L,Zf())}));D(C(lc(this.Ea.ma(hie,null),Uhe),function(){return new hie(Zf(),L,F.gf,function(){return F.mg},function(){return(new jp).nc(!1)},a.H(Qhe,null),G(),G().IJ())}));D(C(lc(this.Ea.ma(aie,null),She),function(){return new aie(L,Zf(),G(),G().rb(),
a.H(Qhe,null),a.H(hie,null))}));D(C(this.Ea.ma(fie,null),function(){return new fie(L,a.H(aie,null),a.H(hie,null))}))},ha:function(){}};function hie(a,b,c,d,e,f,g,h){this.fmf=Function.createDelegate(this,this.ycg);this.gmf=Function.createDelegate(this,this.zcg);this.lb=b;this.m1=ye(this.lb).SaveAsToHostWebServiceBase;this.Tcd=d;this.DX=e;this.eg=c;this.Mr=f;this.zh=h;this.Bg=g;this.Fa=a;this.L0=b.Va("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}
hie.prototype={Bg:null,Pn:null,DX:null,Mr:null,eg:null,Fa:null,Tcd:null,lb:null,m1:null,L0:null,I0:!1,cgb:!1,bD:null,tk:null,zh:null,Qya:null,OCb:function(){1!==this.Bg.Ah()&&(this.Pn=this.DX(),this.Pn.lra(CommonUIStrings.l_CommentProgressTooltip),Ej(this.Pn,5),this.Pn.kra(!1),this.Pn.sma(CommonUIStrings.l_DefaultDialogTitle,null,null))},eT:function(a){1!==this.Bg.Ah()&&this.Mr.nc().Zw(a,vW(this.bD),this.cgb)},WUa:function(){var a=ye(this.lb).BreadcrumbFolderUrl;u(8194016,216,50,"Redirecting to OneDrive for business Folder.");
rk(a,xn(3),"","UploadToHostManager.RedirectToFolder")},VUa:function(a){var b=!1,c=!1;this.lb&&(b=this.lb.ia("SaveACopyIsEnabledForUiHost"),c=this.lb.ia("UiHostSupportsDocRebootFeatures"));u(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",a,b,c);if(b&&c){u(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;d.reason="saveAs";aj().pb(function(a){a.Il("App_DocReboot",d,"")})}else b&&
!c&&nCa?rk(a,xn(4),"","UploadToHostManager.RedirectToEditUrl"):rk(a,xn(3),"","UploadToHostManager.RedirectToEditUrl")},S9:function(a,b,c){u(8194018,216,50,"Starting to upload file");this.Tcd&&!this.Tcd()&&this.eg&&(this.zh&&(this.Qya=this.zh.Di("DialogShown","SaveAsToHostUploadTime")),this.OCb(),this.cgb=b,this.bD=a,(this.tk=c)&&"true"===this.tk.SkipSaveToHost?iie(this):this.k_())},k_:function(){if(32!==this.Fa.Ab(3070187925,1,null))u(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),
iie(this);else{var a=this,b=this;this.Fa.jb(3070187925,2,[function(){u(18989379,219,50,"Call the force save file change successfully.");iie(a)},function(a,d){u(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");b.eT(d)}],null)}},zcg:function(a){this.OSa();this.I0=!1;if(a&&a.Pa&&a.Pa.Ce){var b,c,d;if(d=vk(a.Pa.Ce,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)u(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),
b={},b.FailureReason=a.StatusCode.toString(),b.ExtraInfo=a.ExtraInfo,this.Yla(b),this.eT(window.parseInt(a.ExtraInfo));else{u(8194050,216,50,"UploadToHost execute success.");this.D2c();try{a.NewDocumentUrl&&""!==a.NewDocumentUrl?this.VUa(a.NewDocumentUrl):this.WUa()}catch(e){u(37025699,216,15,"Redirect failed with exception: {0}",e.toString())}this.$Ab()}else u(8194048,216,10,"Failed to deserialize : {0}",{ResponseData:g5d(a.Pa.Ce)}),this.Yla({FailureReason:"Failed to deserialize response"}),this.eT(0)}else u(8194019,
216,10,"UploadToHostManager failure. Response data is null"),this.Yla({FailureReason:"null response"}),this.eT(0)},ycg:function(a){5!==a.Pa.Se&&12!==a.Pa.Se||this.I0?(u(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{Status:a.Pa.Se,HttpStatus:a.Pa.kg}),this.Yla({FailureReason:a.Pa.kg.toString()}),this.OSa(),this.eT(0),this.$Ab()):(u(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.I0=!0,this.tk&&"true"===this.tk.SkipSaveToHost?iie(this):this.k_())},OSa:function(){this.Pn&&
(this.Pn.rB(),this.Pn=null)},$Ab:function(){this.Qya&&(this.Qya.Lf(),this.Qya=null)},D2c:function(){this.tk&&"VersionHistory"===this.tk.SaveEntryPoint&&this.Fa.Ab(1380507044,2,null)},Yla:function(a){this.tk&&"VersionHistory"===this.tk.SaveEntryPoint&&this.Fa.jb(951489623,2,a,null)}};
function iie(a){var b=a.m1+a.L0,b=Sj(b,"qs",nh(F.sh),!1),b=Sj(b,"n",nh((new Date).getTime().toString()),!1),b=Sj(b,"ov",nh(a.cgb.toString()),!1),b=Sj(b,"fn",nh(a.bD),!1);a.tk&&a.tk.FileDownloadUrl&&(b=Sj(b,"furl",nh(a.tk.FileDownloadUrl),!1));a.eg.lk(b,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a.gmf,a.fmf,null,null,!1,null,null,"1",null,!1,null,!1,null)}Vhe.registerClass("Common.App.SaveAsToHost.FileNameDialogHtml");
Whe.registerClass("Common.App.SaveAsToHost.ErrorRetryDialogFactory",null,Qhe);Xhe.registerClass("Common.App.SaveAsToHost.ErrorRetryDialog",Dj,Rhe);aie.registerClass("Common.App.SaveAsToHost.FileNameDialogFactory",null,She);die.registerClass("Common.App.SaveAsToHost.FileNameDialogBase",om);bie.registerClass("Common.App.SaveAsToHost.FileNameDialog",die,The);fie.registerClass("Common.App.SaveAsToHost.SaveAsToHostActor");gie.registerClass("Common.App.SaveAsToHost.SaveAsToHostPackage",null,yo,ec);
hie.registerClass("Common.App.SaveAsToHost.UploadToHostManager",null,Uhe);Vhe.u9a="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
zo(gj(),new gie,0,!1);Type.registerNamespace("Common.App.SaveToSharePoint");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Dlg=w.Ca.Dlg||{};function xie(){}xie.registerInterface("Common.App.SaveToSharePoint.IErrorDialog");function yie(){}yie.registerInterface("Common.App.SaveToSharePoint.IFileNameDialogFactory");function zie(){}zie.registerInterface("Common.App.SaveToSharePoint.IFileNameDialog");function Aie(){}Aie.registerInterface("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper");
function Bie(){}Bie.registerInterface("Common.App.SaveToSharePoint.IPickerDialog");function Cie(){}Cie.registerInterface("Common.App.SaveToSharePoint.ISharePointSaveAsCaller");function Die(){}Die.registerInterface("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory");function Eie(){}Eie.registerInterface("Common.App.SaveToSharePoint.ISaveToSharePointManager");function Fie(){}Fie.registerInterface("Common.App.SaveToSharePoint.IUploadToSharePointManager");function Gie(){}
function Hie(){Hie.initializeBase(this);Ej(this,0);Fj(this,1,CommonUIStrings.l_DialogClose)}Hie.prototype={Pta:function(a,b){u(25235986,216,15,"Show warning dialog of Picker related issue.");this.ww(37,a,b,null,!0,!1,!1)}};function Iie(a,b,c,d,e,f,g,h,k,l){this.Fa=b;this.lb=a;this.fL=d;this.l1=f;this.Mr=e;this.Bg=c;this.ojd=g;this.fxe=h;this.voa=k;this.Qgb=l}
Iie.prototype={Fa:null,fL:null,l1:null,Mr:null,lb:null,Bg:null,ojd:null,fxe:null,voa:null,Qgb:null,nc:function(a){return this.Bg&&this.Bg.rb().YB()?new Jie(this.ojd,this.Mr,this.l1,F.hz,this.Bg,this.fxe,this.voa,this.Qgb,a):new Kie(this.lb,this.Fa,this.Bg,this.fL,this.Mr,this.l1,this.ojd,a)}};
function Jie(a,b,c,d,e,f,g,h,k){this.Ssf=Function.createDelegate(this,this.tlg);this.N5e=Function.createDelegate(this,this.dPf);this.IKa=a;this.Mr=b;this.tk=k;this.l1=c;this.Bg=e;this.qx=d;this.voa=g;this.Qgb=h;f&&(this.Ked=new (ga.$$(Ec.$$(Jc)))(function(){return new (cX.$$(Jc))(f.Aa(),null)}))}
Jie.prototype={IKa:null,Mr:null,l1:null,Bg:null,Ked:null,voa:null,Qgb:null,qx:null,tk:null,bD:"",dPf:function(){var a=new (Ca.$$(Dza));a.ga(Lie(this));var b;if(this.Ked&&this.voa)if((b=dX(this.Ked.Aa(),"SaveAsToSharePointDialog",!1))&&3===b.Ah()&&b.LIc){b=b.LIc;for(var c=new (Ca.$$(Dza)),d=0,e=0,f=0;f<b.length;f++){var g=b[f];if(g&&"ClassicMru"===g.type&&g.service_info&&g.service_info.service_id&&-1!==g.service_info.service_id.indexOf("SHAREPOINT")&&(d++,g.sharepoint_info)){var h=g.url,k=g.sharepoint_info.site_url,
l=g.title,g=nhc(g);if(h&&k&&l&&g){e++;var m=new (ma.$$(String,String))(pb());m.ea("type","SharePoint");m.ea("siteUrl",k);m.ea("folderUrl",h);e++;var n;c.ga((n=new Dza,n.folderName=l,n.friendlyPath=g,n.properties=m,n))}}}n=new window.Map;n.set("NumPlaces",b.length.toString());n.set("NumSharepointPlaces",d.toString());n.set("placesWithMetadata",e.toString());Ce().recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",n);0<d&&(e?.5>1*e/d&&Ce().recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",
!1,!1,null):Ce().recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));b=c}else b=null;else b=null;b&&a.en(b);var r;return r=new Eza,r.enableMoreLocations=!L.ia("HideSaveToAnotherFolderButtonforUIHost"),r.fileName=this.bD,r.extension=vh(this.qx.Gt),r.saveLocations=a.Jd(),r.scenario="SaveToSharePoint",r},yRa:function(){var a={};a.inputPropsCallback=this.N5e;return a},tda:function(a){this.bD=a;this.bD||(this.bD=String.format(CommonUIStrings.l_SaveACopy_Filename,vW(this.qx.Gt)));
a={id:"SaveAsDialog",bodyControls:this.yRa()};var b=CommonUIStrings.L_SaveAs;2===this.Bg.rb().Tm()&&(b=CommonUIStrings.L_SaveACopy);var c=new om(!1,!1,!0,!1);Ej(c,1);c._id="SaveAsDialog";Fj(c,1,CommonUIStrings.l_SaveButtonLabel);c.zk(b,this.Ssf,a)},tlg:function(a,b){if(b&&1===a){a=b.fileName;var c=vh(this.qx.Gt);if(b.moreLocationsSelected){var d=a;if(d&&""!==d&&""!==c||1===this.Bg.Ah()){var e;this.Qgb?e=Mie():(u(572343636,216,50,"_sharedFilePickerManager is null"),e=!1);e?Nie(this,d,c):(""!==c&&(d+=
c),this.IKa.af(d,this.tk))}else u(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Mr.nc().Zw(2,d,!1)}b.locationCallback?(d=b.locationCallback())?d.properties&&"currentHost"===d.properties.K("type")?this.l1.S9(a+c,!1,this.tk):d.properties&&"SharePoint"===d.properties.K("type")?(b=d.properties.K("siteUrl"),d=d.properties.K("folderUrl"),this.voa.S9(d,a+c,b,this.tk)):u(579179799,216,10,"unknown location type sent back"):u(579179798,216,10,"selected location is empty"):
u(579179797,216,10,"locationCallback is empty")}}};
function Nie(a,b,c){Ce().recordKpiUsage("SaveACopySFP",0,"smartfio",null);var d=Oie(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2,null);a.Qgb.ZSc(d).then(function(d){if(d&&0<d.length){var f=d[0].siteUrl;d=d[0].url;if(""!==f&&""!==d)a.voa.S9(d,b+c,f,a.tk),Ce().recordKpiSuccess("SaveACopySFP",null);else{a.Mr.nc().Zw(0,b,!1);var g=LB();g&&(g.set("SiteUrlAvailable",""===f?"false":"true"),g.set("FolderUrlAvailable",""===d?"false":"true"));
var h;Ce().recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,(h=new nj,h.extendedProperties=g,h))}}else a.Mr.nc().Zw(0,b,!1),Ce().recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(a){if("Canceled"===a){(a=LB())&&a.set("IsCanceled","true");var b;Ce().recordKpiSuccess("SaveACopySFP",(b=new nj,b.extendedProperties=a,b))}else Ce().recordKpiFailure("SaveACopySFP",a,!1,!1,null)})}
function Lie(a){var b=new (ma.$$(String,String))(pb());b.ea("type","currentHost");var c;return c=new Dza,c.folderName=a.qx.Lra,c.friendlyPath=a.qx.jZb,c.properties=b,c}
function Kie(a,b,c,d,e,f,g,h){this.rLd=Function.createDelegate(this,this.t$f);this.qLd=Function.createDelegate(this,this.vhe);this.gHf=CommonUIStrings.l_SaveToAnotherFolder;Kie.initializeBase(this,[a,b,c,d,e,f,h]);this.Hp=pm(Gie.u9a,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"");this._id="FileNameDialog-SaveToSharePoint";this.IKa=g;this.tk=h}
Kie.prototype={IKa:null,tk:null,MH:null,njd:null,xJa:null,tda:function(a){var b=vW(F.hz.Gt),c=F.Yub,d=F.b4b,e={txtFileName:a||b},f=CommonUIStrings.L_SaveAs;2===G().rb().Tm()&&(f=CommonUIStrings.L_SaveACopy);this.zk(f,this.gXb,e);cie(this,a,b);(pi?pi.Oc:null).style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");if(!L.ia("HideSaveToAnotherFolderButtonforUIHost")){this.MH=document.getElementById("anotherFolder");a=document.getElementById("folderLocation");
this.njd=aac(a,this.MH,"anotherFolderDescribedBy","");this.MH.className="WACButton WACDialogButtonNormal";a=!1;if(c&&c.length){Pie(this.MH,this.njd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,d,c));f=a={val:a};f.val=!1;b=document.getElementById("currentLocation");b.innerText="";var g=Qie(b,d),h=Qie(b,c),k=255,e=255;255<g+h&&(k=Math.max(238,408-g),e=Math.max(170,408-h),f.val=!0);f=k;d&&(Rie(b,d,e),d=document.createElement("span"),d.id="FolderSeparator",e=document.createElementNS("http://www.w3.org/2000/svg",
"svg"),e.setAttribute("class","SeparatorCaret"),g=document.createElementNS("http://www.w3.org/2000/svg","polygon"),g.setAttribute("points","1 4 1 11 5 7.5"),e.appendChild(g),d.appendChild(e),b.appendChild(d));c&&Rie(b,c,f);a=a.val}else Pie(this.MH,this.njd,CommonUIStrings.l_CurrentOnlineFolder);c=this.MH;d=document.createElement("span");d.className="cui-img-cont-float cui-img-16by16 ";this.xJa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.xJa.setAttribute("class","FolderIconSVG");
b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.xJa.appendChild(b);d.appendChild(this.xJa);c.appendChild(d);c=this.MH;d=document.createElement("span");d.id="anotherFolderText";d.innerText=this.gHf;d.className="AnotherFolderTextSpan";c.appendChild(d);a?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.MH,
"SaveToAnotherLocationTwo"),u(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.MH,"SaveToAnotherLocationOne");hh(this.MH,"click",this.qLd);hh(this.MH,"keydown",this.rLd)}},t$f:function(a){!a||13!==a.keyCode&&32!==a.keyCode||this.vhe(a)},vhe:function(){if(this.FT){var a=vh(F.qW),b=this.FT.value;this.Cd();b&&""!==b&&""!==a||1===this.Bg.Ah()?(""!==a&&(b+=a),eie(this,b)?this.Mr.nc().Zw(1,b,!1):this.IKa.af(b,this.tk)):this.Mr.nc().Zw(2,b,!1)}},WTc:function(){die.prototype.WTc.call(this);
this.MH&&this.xJa&&(this.FT&&""!==this.FT.value?(this.MH.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.MH,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.xJa,"DisabledFolderIconSVG")):(this.MH.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.MH,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.xJa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.MH,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.xJa,"DisabledFolderIconSVG"))))},dispose:function(){this.MH&&
(oi(this.MH,"click",this.qLd),oi(this.MH,"keydown",this.rLd),this.MH=null);die.prototype.dispose.call(this)}};function Pie(a,b,c){c=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,c);b&&(b.innerText=c);a.tabIndex=0;a.setAttribute("role","button")}function Rie(a,b,c){var d=document.createElement("div");d.innerText=b;d.title=b;d.className="SaveToAnotherFolderBreadcrumb";d.style.maxWidth=c.toString()+"px";a.appendChild(d)}
function Qie(a,b){var c=document.createElement("div");c.innerText=b;c.style.visibility="hidden";a.appendChild(c);b=c.clientWidth;a.removeChild(c);return b}function Sie(a,b,c,d){this.nra=Function.createDelegate(this,this.lua);this.r5=a;this.Bg=c;this.nAe=d;var e=this;this.xQ=new (ga.$$(Ec.$$(Hc)))(function(){return new (cX.$$(Hc))(b.Aa(),e.nra)})}
Sie.prototype={r5:null,Bg:null,nAe:null,gga:null,lo:null,xQ:null,Fib:function(){this.gga||(dX(this.xQ.Aa(),"Save As",!0),this.lo&&this.lo.tP&&this.lo.tP.length&&(this.gga=this.iTc(this.lo.tP)));return this.gga},af:function(a){if(!this.Fib())if(F.uta&&F.uta.length)this.gga=F.uta;else return u(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.lo),!1;var b=this.nAe();b.Z4c();var c=b.mTc();if(!c)return u(24664067,
216,10,"Picker container is null, will not show picker."),!1;var d=this;this.r5.af(function(c,d){b.Cd();a(c,d)},function(){d.gYc(b)},c,this.gga);return!0},gYc:function(a){a.Cd();u(24664068,216,50,"User cancelled save to another folder.")},iTc:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},lua:function(a){this.lo||3!==a.Ah()||(this.lo=a)}};function Tie(){}
Tie.prototype={Ea:null,Cjc:null,Fjc:null,xya:null,Xb:function(){return"Common.App.SaveToSharePoint"},ub:function(){},ha:function(){},wc:function(a){this.Ea=a;this.Cjc=mc(Fc.$$(Hc),kc(a,Fc.$$(Hc)));this.Fjc=mc(Fc.$$(Jc),kc(a,Fc.$$(Jc)));this.xya=mc(No,kc(a,No));var b=this;Oa.WAA.call(null,this.Cjc,this.Fjc,this.xya).CW(function(){Uie(b)})}};
function Uie(a){D(C(lc(a.Ea.ma(Vie,null),Die),function(){return new Vie(L)}));D(C(lc(a.Ea.ma(Wie,null),Fie),function(){return new Wie(Zf(),a.Ea.H(Vie,null),function(){return(new jp).nc(!1)},function(){return new Hie},G())}));D(C(lc(a.Ea.ma(Xie,null),Eie),function(){return new Xie(a.Ea.H(Wie,null),function(){return new Hie},a.Ea.H(Aie,null),G())}));D(C(lc(a.Ea.ma(Sie,null),Aie),function(){return new Sie(a.Ea.H(j9,null),new (ga.$$(Fc.$$(Hc)))(function(){return ab(a.Cjc)}),G(),function(){return new Yie})}));
D(C(a.Ea.ma(Iie,null),function(){return new Iie(L,Zf(),G(),G().rb(),a.Ea.H(Qhe,null),a.Ea.H(Uhe,null),a.Ea.H(Eie,null),new (ga.$$(Fc.$$(Jc)))(function(){return ab(a.Fjc)}),a.Ea.H(Wie,null),a.xya?ab(a.xya):null)}));D(C(a.Ea.ma(Zie,null),function(){return new Zie(L,Zf(),a.Ea.H(Iie,null),a.Ea.H(Eie,null),a.Ea.H(j9,null),a.Ea.H(Aie,null),function(){return G().B_a()})}));L.ia("SaveToAnotherFolderBrsIsEnabled")&&a.Ea.H(Zie,null).Wb()}function Yie(){Yie.initializeBase(this,[!1,!1,!1,!1])}
Yie.prototype={Z4c:function(){this.uFb="FilePickerDialog";this.Hp="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this._id="PickerDialog-MsoSp";this.$s("",null)},mTc:function(){return document.getElementById("FilePickerDiv")},gE:function(){},Cea:function(){}};function $ie(a,b,c,d,e,f,g,h){this.m1=a;this.bD=b;this.kJa=d;this.hKb=f;this.Kfa=c;this.TDe=e;this.L0=g;this.tk=h}
$ie.prototype={m1:null,bD:null,kJa:null,hKb:null,Kfa:null,TDe:null,L0:null,tk:null,pb:function(a,b){if(!F.mg&&F.gf){var c=this.m1+this.L0,c=Sj(c,"fu",nh(this.Kfa),!1),c=Sj(c,"su",nh(this.TDe),!1),c=Sj(c,"fn",nh(this.bD),!1),c=Sj(c,"n",nh((new Date).getTime().toString()),!1);this.tk&&this.tk.FileDownloadUrl&&(c=Sj(c,"furl",nh(this.tk.FileDownloadUrl),!1));c=c+"&"+this.hKb;this.kJa&&this.kJa.length?c=Sj(c,"fnn",nh(this.kJa),!1):u(23881891,216,15,"No new file name in request.");u(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
F.gf.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a,b,null,null,!1,null,null,"9",null,!1,null,!1,null)}}};function Vie(a){this.n1=ye(a).SaveAsToHostWebServiceBase;this.bD=ye(a).FileName;this.L0=a.Va("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}Vie.prototype={n1:null,bD:null,L0:null,nc:function(a,b,c,d){return new $ie(this.n1,this.bD,a,b,c,F.sh,this.L0,d)}};
function Zie(a,b,c,d,e,f,g){this.ZNd=Function.createDelegate(this,this.Elg);this.lb=a;this.qGb=c;this.Fa=b;this.IKa=d;this.r5=e;this.nKa=f;this.rpe=g}
Zie.prototype={qGb:null,lb:null,Fa:null,IKa:null,r5:null,nKa:null,rpe:null,Wb:function(){var a=Nhe(this.r5);if(a)if(Rj()||this.lb.ia("SaveToSharePointOnDemandDownloadJsIsEnabled"))this.Fa.ua(3050207199,2147483648,this.ZNd,64);else{var b=this;dn(a).CW(function(a){Qa(a)&&b.r5.lZc(a)});this.h4b()}else u(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")},h4b:function(){var a=this.ZNd;gn().Ka(a);e5d([new hn(3050207199,2147483648,0)],Nhe(this.r5))},bod:function(){return this.lb.ia("SaveToAnotherFolderBrsIsEnabled")},
Elg:function(a,b,c,d,e){return 2147483648!==b.Ke()||3050207199!==a?2:this.bod()&&(this.nKa.Fib()||this.lb.ia("UserCanWriteRelative"))?1===c?Xj().Vfa||gW?8:this.rpe()?32:8:2===c?(a=!!e&&!!e.SaveEntryPoint&&"VersionHistory"===e.SaveEntryPoint.toString(),u(23881885,216,50,"User clicked on SaveToSharePoint button from "+(a?"version history.":"the backstage.")),this.lb.ia("UserCanWriteRelative")?(u(24524226,216,50,"Show save a copy dialog."),this.qGb.nc(e).tda(null)):(u(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.IKa.af(null,e)),32):8:8}};function Xie(a,b,c,d){this.voa=a;this.Mr=b;this.nKa=c;this.Bg=d}
Xie.prototype={Bg:null,Mr:null,voa:null,nKa:null,xye:null,tk:null,af:function(a,b){u(25180163,216,50,"Try launch Picker.");this.xye=a;this.tk=b;var c=this;this.nKa.af(function(a,b){c.OGa(a,b)})||aje(this)},OGa:function(a,b){a?this.OnSuccess(b):this.sH(b)},OnSuccess:function(a){u(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(a&&a.data&&a.data.value&&a.data.value.length&&a.data.value[0].sharePoint){var b=a.data.value[0].sharePoint.url;a=a.data.value[0].sharePoint.listUrl;
var c=null;if(b){if(a)a.endsWith("/")&&(a=a.substring(0,a.length-1)),c=a.lastIndexOf("/"),a=-1!==c?a.substring(0,c):null;else a:{a=b;a.endsWith("/")||(a+="/");for(var d=c=0;d<a.length;d++)if("/"===a.charAt(d)&&5===++c){a=a.substr(0,d);break a}a=null}if(c=a){this.voa.S9(b,this.xye,c,this.tk);return}}u(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!b,!c)}u(23881887,216,10,"Picker return invalid data or empty SharePoint url.");aje(this)},sH:function(a){u(23881888,
216,10,"Picker failure Callback called.");a&&a.error?u(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",a.error.errorCode,a.error.message):u(23881890,216,10,"File Dialog returned empty error.");aje(this)}};function aje(a){1!==a.Bg.Ah()&&a.Mr().Pta(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}
function Wie(a,b,c,d,e){this.hkf=Function.createDelegate(this,this.w$f);this.ikf=Function.createDelegate(this,this.x$f);this.dMb=b;this.DX=c;this.Mr=d;this.Bg=e;this.Fa=a}
Wie.prototype={dMb:null,JEb:null,Pn:null,Bg:null,DX:null,Mr:null,Fa:null,a8c:!1,Kfa:null,jjd:null,S9:function(a,b,c,d){this.a8c=!1;u(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.OCb();this.Kfa=a;d&&d.SaveEntryPoint&&(this.jjd=d.SaveEntryPoint);this.JEb=this.dMb.nc(a,b,c,d);d&&"true"===d.SkipSaveToHost?this.k_():bje(this)},k_:function(){u(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.JEb.pb(this.ikf,this.hkf)},x$f:function(a){if(a&&a.Pa&&
a.Pa.Ce){var b,c,d;if(d=vk(a.Pa.Ce,c={val:b}),b=c.val,d)if(200!==b.StatusCode&&201!==b.StatusCode){if(u(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",a.Pa.Se,b.StatusCode),413===b.StatusCode||!cje(this,a.Pa.Se))switch(this.Yla(b.StatusCode.toString()),a=b.StatusCode,u(25180166,216,50,"Upload fail with status code: {0}.",a),a){case 401:this.xw(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage,38);break;case 413:a=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.xw(CommonUIStrings.l_SaveAsFileTooLargeTitle,a,32);break;default:dje(this)}}else{u(23881927,216,50,"UploadToSharePointManager upload success.");this.D2c();try{b.NewDocumentUrl?this.VUa(b.NewDocumentUrl):this.WUa()}catch(e){u(37025729,216,15,"Redirect failed with exception: {0}",e.toString())}}else u(23881926,216,10,"Failed to deserialize : {0}",{ResponseData:g5d(a.Pa.Ce)}),eje(this)||(this.Yla("Failed to deserialize response"),dje(this))}else u(23881925,
216,10,"Upload failure. Response data is null"),eje(this)||(this.Yla("Unknown"),dje(this))},w$f:function(a){a&&a.Pa?cje(this,a.Pa.Se)||(u(23881929,216,10,"Upload failed."),this.Yla(w.J4.toString(a.Pa.Se)),dje(this)):(u(23881928,216,10,"Upload failure. Response data is null"),eje(this)||(this.Yla("Unknown"),dje(this)))},WUa:function(){u(23881933,216,50,"Redirecting to Folder.");rk(this.Kfa,xn(3),"","UploadToSharePointManager.RedirectToFolder")},VUa:function(a){var b=!1,c=!1;L&&(b=L.ia("SaveACopyIsEnabledForUiHost"),
c=L.ia("UiHostSupportsDocRebootFeatures"));u(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",a,b);if(b&&c){u(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;d.reason="saveAs";aj().pb(function(a){a.Il("App_DocReboot",d,"")})}else rk(a,xn(3),"","UploadToSharePointManager.RedirectToEditUrl")},OCb:function(){this.Bg&&1===this.Bg.Ah()||(this.Pn=this.DX(),this.Pn.lra(CommonUIStrings.l_CommentProgressTooltip),
Ej(this.Pn,5),this.Pn.kra(!1),this.Pn.sma(CommonUIStrings.l_DefaultDialogTitle,null,null))},OSa:function(){this.Pn&&(this.Pn.rB(),this.Pn=null)},xw:function(a,b,c){u(25180165,216,10,"Upload failure with title: {0}, message: {1}",a,b);this.OSa();if(1!==this.Bg.Ah()){var d=this.Mr();u(25180161,216,10,"Show upload error dialog with error code {0}.",c);d.ww(c,a,b,null,!1,!1,!1)}},D2c:function(){"VersionHistory"===this.jjd&&this.Fa.Ab(1380507044,2,null)},Yla:function(a){"VersionHistory"===this.jjd&&this.Fa.jb(951489623,
2,{FailureReason:a},null)}};function dje(a){a.xw(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile,38)}function cje(a,b){u(23881932,216,10,"HTTP failure with code: {0}",b);return eje(a)}function eje(a){if(!a.a8c)return u(23881930,216,10,"Upload fail. Retrying."),a.a8c=!0,a.k_(),!0;u(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}
function bje(a){function b(){u(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");a.k_()}32!==a.Fa.jb(3070187925,2,[function(){u(23881922,216,50,"Call the force save file change successfully.");a.k_()},b],null)&&b()}Gie.registerClass("Common.App.SaveToSharePoint.FileNameDialogHtml");Hie.registerClass("Common.App.SaveToSharePoint.ErrorDialog",Dj,xie);Iie.registerClass("Common.App.SaveToSharePoint.FileNameDialogFactory",null,yie);
Jie.registerClass("Common.App.SaveToSharePoint.ReactSaveAsDialog",null,zie);Kie.registerClass("Common.App.SaveToSharePoint.FileNameDialog",die,zie);Sie.registerClass("Common.App.SaveToSharePoint.OneDriveFilePickerHelper",null,Aie);Tie.registerClass("Common.App.SaveToSharePoint.PackageManager",null,yo,ec);Yie.registerClass("Common.App.SaveToSharePoint.PickerDialog",om,Bie);$ie.registerClass("Common.App.SaveToSharePoint.SharePointSaveAsCaller",null,Cie);
Vie.registerClass("Common.App.SaveToSharePoint.SharePointUploadCallerFactory",null,Die);Zie.registerClass("Common.App.SaveToSharePoint.SaveToSharePointActor");Xie.registerClass("Common.App.SaveToSharePoint.SaveToSharePointManager",null,Eie);Wie.registerClass("Common.App.SaveToSharePoint.UploadToSharePointManager",null,Fie);Gie.u9a="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
zo(gj(),new Tie,0,!1);Type.registerNamespace("Common.Search");w=window.Common||{};w.Klg=w.Klg||{};function fje(){}fje.registerInterface("Common.Search.ISearchContext");function gje(){}gje.registerInterface("Common.Search.ISearchContextFactory");function hje(a,b,c,d){this.sqe=a;this.MBe=b;this.LBe=c;this.cxg=d}hje.prototype={MBe:0,LBe:0,sqe:null,cxg:null};function URd(){}
URd.prototype={BKf:function(a,b,c,d,e){b=d-c;var f;if(100<=b)b=c,f=d;else{b=Math.max(0,c+Math.ceil(b/2)-50);f=Math.min(a.length,b+100);b=Math.max(0,f-100);var g;if(b&&" "!==a.charAt(b-1)){g=Math.min(c,b+10);for(var h=b;h<g;++h)if(" "===a.charAt(h)){b=h+1;break}}if(f!==a.length&&" "!==a.charAt(f))for(g=Math.max(d,f-10),h=f-1;h>=g;--h)if(" "===a.charAt(h)){f=h;break}}return new hje(a.substring(b,f),c-b,d-b,e)}};hje.registerClass("Common.Search.SearchContext",null,fje);
URd.registerClass("Common.Search.SearchContextFactory",null,gje);Type.registerNamespace("Common.App.SharedFilePicker");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.ix=w.Ca.ix||{};function ije(a){this.ujf=Function.createDelegate(this,this.A9f);this.nOb=a}
ije.prototype={nOb:null,Xnb:null,h0a:null,_initialized:!1,MRc:function(a){this._initialized||(a.kw("Host_FilePicker"),a.bE("Host_FilePicker",this.ujf),this._initialized=!0)},ZSc:function(a){var b=this;return this.h0a=new Promise(function(c,d){var e={};e.pickerCustomization=a;b.Xnb=function(a,b){""===b?(u(572548163,306,50,"Resolving Promise with Picker Data"),c(a)):("Canceled"===b?u(572548164,306,50,b):u(556901065,306,10,b),d(b))};b.nOb.pb(function(a){b.MRc(a);a.Il("App_FilePicker",e,"")})})},A9f:function(a){this.Xnb(a.Values.selectedItems,
A(a.Values.error)?"":a.Values.error)}};function Oie(a,b,c,d,e,f,g,h,k){var l={};l.selectButtonText=a;l.titleText=b;l.allowFileSelection=c;l.allowFolderSelection=d;l.allowMultiSelect=e;l.displayCrossSite=!0;l.fileTypeFilter=f;l.scenario=g;l.landingLocation=w.k4c.toString(h);Cm("isSharedUXDarkModeOn")&&window.appChrome.api.isSharedUXDarkModeOn()&&(l.theme="Dark");k&&(null!=k.Q8d&&(l.allowYourPhone=k.Q8d),null!=k.zNc&&(l.includeDownloadUrl=k.zNc));return l}
function Mie(){return L.ia("UiHostCommonFilePicker")}function jje(){}jje.prototype={Ea:null,Xb:function(){return"Common.App.SharedFilePicker"},wc:function(a){this.Ea=a;C(D(lc(a.ma(ije,null),No)),function(){return new ije(kc(a,tc))})},ub:function(){var a=this;L.Nf(function(){a.GTa()})},GTa:function(){this.Ea.H(No,null)},ha:function(){}};ije.registerClass("Common.App.SharedFilePicker.SharedFilePickerManager",null,No);jje.registerClass("Common.App.SharedFilePicker.SharedFilePickerPackage",null,yo,ec);
zo(gj(),new jje,0,!1);Type.registerNamespace("Common.App.WopiIdentity");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.tv=w.Ca.tv||{};w.Ca.tv.vB=function(){};w.Ca.tv.vB.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};w.Ca.tv.vB.registerEnum("Common.App.WopiIdentity.ErrorCodes",!1);
function m9(){}function n9(a,b){this.u4d=n9.sqg===Number||Type.isEnum(n9.sqg)?0:n9.sqg===Boolean?!1:null;this.ALc=a;this.u4d=b}
n9.$$=function(a){var b=w.Ca.tv.__tc=w.Ca.tv.__tc||{},c="OutstandingRequest$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];n9.apply(this,a)};d.registerClass("Common.App.WopiIdentity.__tc."+c);d.prototype.Qb={"Common.App.WopiIdentity.OutstandingRequest$1":{T:a},ctor:n9};a=n9.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};n9.prototype={ALc:null};
n9.prototype.yBg=function(){return this.ALc};n9.prototype.get_requestParameters=n9.prototype.yBg;n9.prototype.aHg=function(a){return this.ALc=a};n9.prototype.set_requestParameters=n9.prototype.aHg;n9.prototype.xBg=function(){return this.u4d};n9.prototype.get_requestCallback=n9.prototype.xBg;n9.prototype.$Gg=function(a){return this.u4d=a};n9.prototype.set_requestCallback=n9.prototype.$Gg;
function V6(a){this.nBc=Function.createDelegate(this,this.f_c);this.getAccessToken=this.GetAccessToken;this.getAuthContext=this.GetAuthContext;this.getAuthContextSync=this.GetAuthContextSync;this.getPrimaryIdentityInfo=this.GetPrimaryIdentityInfo;this.$3a={};this.PWb={};this.P7=G().IJ();this.nOb=a}
V6.prototype={nOb:null,$3a:null,PWb:null,P7:null,_initialized:!1,MRc:function(a){this._initialized||(a.kw("Host_SetAuthToken"),a.bE("Host_SetAuthToken",this.nBc),this._initialized=!0)},B6b:function(a,b,c,d){var e=[],f;Array.add(e,(f=new eb,f.name="CallerId",f.string=b,f));var g;Array.add(e,(g=new eb,g.name="CorrelationId",g.string=a.get_correlationId(),g));var h;window.Otel.Telemetry.$_((h=new fb,h.name="Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",h.dataFields=e,h));e=wl().toString();
f="getAccessToken_"+e;g=this.P7.Di("ComponentAttach",f);this.PWb[f]=g;var k={};a.get_options()&&"undefined"!==typeof a.get_options()&&a.get_options();k.RequestId=e;k.Resource=a.get_resource();k.Scope=a.get_scope();k.IdentityType=L.Va("HostAuthType");k.Upn=L.Va("UserPrincipalName");k.SilentLogin=a.get_silentLogin();k.Claims=a.get_options();k.CorrelationId=a.get_correlationId();k.ClientId=b;c&&(k.AddinName=c.AddinName,k.AddinTrustId=c.AddinTrustId);var l=this;this.nOb.pb(function(a){l.MRc(a);a.Il("App_GetAuthToken",
k,"")});this.$3a[e]=new (n9.$$(Function))(a,d)},f_c:function(a){var b=null;try{var c=a.Values.RequestId,d=a.Values.AuthToken,e=a.Values.IdentityType,f=a.Values.TokenExpiration,g=null,h=null,k=this.$3a[c];if("undefined"!==typeof k&&k){var l=[],m;Array.add(l,(m=new eb,m.name="CorrelationId",m.string=k.get_requestParameters().get_correlationId(),m));var n;window.Otel.Telemetry.$_((n=new fb,n.name="Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",n.dataFields=l,n));b=k.get_requestCallback();
delete this.$3a[c];"undefined"!==typeof d&&d&&d.length?h=new Po(d,e,f):g=w.Ca.tv.vB.toString(kje(this,a));c="getAccessToken_"+c;c in this.PWb&&(this.PWb[c].Lf(),delete this.PWb[c]);b(h,g)}else u(37856066,344,10,Id({error:"No matching outstanding request for request ID.",requestId:c}))}catch(r){c=a.Values.RequestId,c in this.$3a&&delete this.$3a[c],this.izb(),u(37856067,344,10,Id({error:r.message,stack:r.stack})),b&&b(null,w.Ca.tv.vB.toString(0))}},izb:function(){u(39068822,344,50,Id({userAgent:window.navigator.userAgent}))}};
function lje(a,b){a=a.get_resource();a=(a?a:"").replace("://","__").replace(/\./g,"_dot_").replace("/","\\");u(39921882,344,50,Id({callerId:b,resource:a}))}
function kje(a,b){b=b.Values.Error;a.izb();u(39068821,344,15,Id({error:b}));return b?-1<b.indexOf("AADSTS50058")?9:-1<b.indexOf("Popup Window is null")||-1<b.indexOf("Popup Window closed")?12:-1<b.indexOf("AADSTS50001")?10:-1<b.indexOf("13002")?8:-1<b.indexOf("AADSTS70011")||-1<b.indexOf("AADSTS65001")||"tokenRevoked"===b?11:-1<b.indexOf("Token renewal operation failed due to timeout")?6:0:13}
function mje(a){var b=Foa;a=a.toLowerCase();for(var c=b.length,d=0;d<c;++d){var e=b[d];if(a===e.toLowerCase())return!0}var b=xfe(),f;for(f in b)if(e={key:f,value:b[f]},a===e.value.toLowerCase())return!0;return!1}function nje(a){var b=L.Va("UserName"),c=L.Va("LoggableUserIdSpace"),d=new Ro;d.ED=L.Va("UserPrincipalName");d.It=b;switch(c){case "OrgIdPuid":d.EV="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":d.EV="MicrosoftAccount";break;default:d.EV=c}a(d,null)}
V6.prototype.R9a=function(a,b,c){lje(a,b);var d=this;return new Promise(function(e,f){if(mje(b))if(b in d.$3a)f(w.Ca.tv.vB.toString(4));else{var g=window.setTimeout(function(){u(37856032,344,10,Id({error:"Request timeout.",callerId:b}));f(w.Ca.tv.vB.toString(5))},12E4);d.B6b(a,b,c,function(a,b){window.clearTimeout(g);a?e(a):(u(37856033,369,15,Id({error:w.Ca.tv.vB.toString(b)})),f(b))})}else u(37856034,344,10,Id({error:"Caller is not allowed."})),f(w.Ca.tv.vB.toString(2))})};
V6.prototype.GetAccessToken=V6.prototype.R9a;V6.prototype.EPf=function(a){return new Promise(function(b,c){mje(a)?nje(function(a,e){a?b(a):(u(37856064,369,10,Id({error:e.toString()})),c(e))}):(u(37856065,344,10,Id({error:"Caller is not allowed."})),c(w.Ca.tv.vB.toString(2)))})};V6.prototype.GetPrimaryIdentityInfo=V6.prototype.EPf;V6.prototype.TOf=function(a){var b=this;return new Promise(function(c,d){var e=b.GetAuthContextSync(a);e?c(e):d(w.Ca.tv.vB.toString(2))})};V6.prototype.GetAuthContext=V6.prototype.TOf;
V6.prototype.UOf=function(a){if(mje(a)){var b=new Qo;b.c3b=L.Va("UserPrincipalName");b.e3b=L.Va("LoggableUserId");b.EV=L.Va("HostAuthAuthority");b.R7a=L.Va("TenantId");b.sca=L.ia("IsAnonymousUser");var c=nfe();a=qo()?c&&ufe()?Array.contains(ufe(),a.toLowerCase()):!1:c;b.K2b=a;a=L.Va("HostAuthType");b.hZb="aad"===a.toLowerCase()?2:"msa"===a.toLowerCase()?1:0;return b}u(40751647,344,10,Id({error:"Caller is not allowed."}));return null};V6.prototype.GetAuthContextSync=V6.prototype.UOf;
function oje(){this.Hm=Function.createDelegate(this,this.vm)}oje.prototype={Ea:null,Xb:function(){return"Common.App.WopiIdentity"},wc:function(a){this.Ea=a;C(D(lc(a.ma(V6,null),iGa)),function(){return new V6(kc(a,tc))})},ub:function(){L&&L.Nf(this.Hm)},vm:function(){try{this.Ea.H(iGa,null)}catch(a){u(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+a)}},ha:function(){}};m9.registerClass("Common.App.WopiIdentity.WopiHostErrorCodes");
V6.registerClass("Common.App.WopiIdentity.WopiIdentityManager",null,iGa);oje.registerClass("Common.App.WopiIdentity.WopiIdentityPackage",null,yo,ec);m9.CIg=w.Ca.tv.vB.toString(0);m9.qJg=w.Ca.tv.vB.toString(1);m9.CJg=w.Ca.tv.vB.toString(2);m9.VHg=w.Ca.tv.vB.toString(3);m9.IKg=w.Ca.tv.vB.toString(4);m9.kDb=w.Ca.tv.vB.toString(5);m9.RHg=w.Ca.tv.vB.toString(6);m9.UKg=w.Ca.tv.vB.toString(7);m9.stg=w.Ca.tv.vB.toString(8);m9.cpg=w.Ca.tv.vB.toString(9);m9.RYf=w.Ca.tv.vB.toString(10);m9.QYf=w.Ca.tv.vB.toString(11);
m9.pJf=w.Ca.tv.vB.toString(12);m9.kIg=w.Ca.tv.vB.toString(13);m9.pKg=w.Ca.tv.vB.toString(14);zo(gj(),new oje,0,!1);Type.registerNamespace("PowerPointWebEditor.AgendaConverter");M=window.PowerPointWebEditor||{};M.u8a=M.u8a||{};function o9(){}o9.registerInterface("PowerPointWebEditor.AgendaConverter.IAgendaConverterView");function pje(){}pje.registerInterface("PowerPointWebEditor.AgendaConverter.IAgendaDetectionNotifier");Type.registerNamespace("PowerPointWebEditor.PenMinutes");
M=window.PowerPointWebEditor||{};M.zue=M.zue||{};function oEc(){}oEc.prototype={J:null,Xb:function(){return"PowerPointWebEditor.PenMinutes"},wc:function(a){this.J=a},ub:function(){var a=gc(this.J,lEc);a&&(a.Jgd="Office.PowerPoint.Online.Data.Activity.PenInputMinutes")},ha:function(){}};oEc.registerClass("PowerPointWebEditor.PenMinutes.PPTWebEditorPenMinutesPackage",null,yo,ec);zo(gj(),new oEc,0,!1);Type.registerNamespace("Common.App.DisplayEnvironmentName");w=window.Common||{};w.Ca=w.Ca||{};
w.Ca.KLf=w.Ca.KLf||{};function qje(a,b){this.jxf=Function.createDelegate(this,this.ysg);this.Fa=a;this.lb=b}qje.prototype={Fa:null,lb:null,hGb:null,Wb:function(){(this.hGb=this.lb.Va("StatusBarEnvironmentNameToUse"))&&""!==this.hGb&&this.Fa.ua(3887408216,2147483648,this.jxf,96)},ysg:function(a,b,c,d,e){if(1===c)return 32;e.Value=this.hGb;e.LabelText=this.hGb;e[TX.Visible]=!0;return 32}};function rje(){}
rje.prototype={Ea:null,Xb:function(){return"Common.App.DisplayEnvironmentName"},wc:function(a){this.Ea=a;C(D(this.Ea.ma(qje,null)),function(){return new qje(Zf(),L)})},ub:function(){this.Ea.H(qje,null).Wb()},ha:function(){}};qje.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentName");rje.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentNamePackage",null,yo,ec);zo(gj(),new rje,0,!1);Type.registerNamespace("Common.App.PhoneLink");w=window.Common||{};w.Ca=w.Ca||{};
w.Ca.qve=w.Ca.qve||{};function H1(){}H1.registerInterface("Common.App.PhoneLink.IPhoneLinkManager");function pEc(){}pEc.prototype={rce:!1};
function qEc(a){this.sGd=Function.createDelegate(this,this.Dge);this.zGd=Function.createDelegate(this,this.Lge);u(527574681,306,50,"PhoneLinkManager - Initialize");this.Rpa=L.Va("PhoneLinkServiceEndpoint");(this.eI=a)||u(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Rpa&&this.Rpa.length||u(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}
qEc.prototype={eI:null,Rpa:null,idd:null,Dge:function(){u(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")},Lge:function(a){u(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");a=kn(a.Pa.Ce).rce+"";d7(f7(),"AccountLinkedStatusCache",a)}};function rEc(){B().H(H1,null);var a=f7().o9("AccountLinkedStatusCache");return a&&a.length?"true"===a.toLowerCase()?!0:!1:!1}
function sEc(a){u(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=new Date-a.idd)u(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{a.idd=new Date;var b=new Date;a.eI.WW("BayBridge",a.Rpa,null).then(function(c){var d=new Date-b;if(c.IsSuccess){u(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",d);var d=a.Rpa+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0",e={};e.Authorization=
"Bearer "+c.Token;e["Authorization-Type"]="AAD";e.Accept="application/json";F.gf.lk(d,1,null,e,!1,2,a.zGd,a.sGd,null,null,!1,null,null,"39",null,!1,null,!1,null)}else u(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",d,c.ErrorCode,c.ErrorMessage)}).catch(function(a){u(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",a,new Date-b)})}}
function tEc(){var a=B().H(H1,null);L.fc("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1)&&(a.Rpa="https://dcg-df.microsoft.com/",u(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));sEc(a)}function uEc(){}
uEc.prototype={Ea:null,Xb:function(){return"Common.App.PhoneLink"},wc:function(a){this.Ea=a;var b=this;C(D(this.Ea.ma(H1,null)),function(){return new qEc(b.Ea.H(v6,null))})},ub:function(){var a=this;L.Nf(function(){a.GTa()})},GTa:function(){this.Ea.H(H1,null)},ha:function(){}};pEc.registerClass("Common.App.PhoneLink.PhoneLinkStatus");qEc.registerClass("Common.App.PhoneLink.PhoneLinkManager",null,H1);uEc.registerClass("Common.App.PhoneLink.PhoneLinkPackage",null,yo,ec);zo(gj(),new uEc,0,!1);Type.registerNamespace("Common.App.SaveToCloudStorage");
w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Clg=w.Ca.Clg||{};function jie(){}jie.registerInterface("Common.App.SaveToCloudStorage.IErrorDialog");function kie(){}kie.registerInterface("Common.App.SaveToCloudStorage.ISaveToCloudManager");function lie(){}lie.registerInterface("Common.App.SaveToCloudStorage.ISignInDialogFactory");function mie(){}mie.registerInterface("Common.App.SaveToCloudStorage.ISignInDialog");function nie(){}nie.registerInterface("Common.App.SaveToCloudStorage.ISkyDriveUploadCaller");
function oie(){}oie.registerInterface("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory");function pie(){}pie.registerInterface("Common.App.SaveToCloudStorage.IUploadToCloudManager");function qie(){qie.initializeBase(this);Ej(this,0);Fj(this,1,CommonUIStrings.l_DialogClose)}qie.prototype={Zw:function(a){this.ww(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null,!1,!1,!1)}};function rie(){}
rie.prototype={Ea:null,Xb:function(){return"Common.App.SaveToCloudStorage"},ub:function(){L.ia("SaveToCloudStorageUIIsEnabled")&&this.Ea.H(sie,null).Wb()},ha:function(){},wc:function(a){this.Ea=a;D(C(lc(this.Ea.ma(tie,null),lie),function(){return new tie(Zf(),lta(),G().rb())}));D(C(lc(this.Ea.ma(uie,null),oie),function(){return new uie(L)}));D(C(this.Ea.ma(sie,null),function(){return new sie(a.H(k9,null),a.H(Ehe,null),L,G().IJ())}));D(C(this.Ea.ma(l9,null),function(){return new l9(a.H(uie,null),function(){return(new jp).nc(!1)},
function(){return new qie},G(),G().IJ())}));D(C(this.Ea.ma(k9,null),function(){return new k9(a.H(tie,null),lta(),a.H(l9,null),L,mj,function(){return new qie})}))}};function sie(a,b,c,d){this.YNd=Function.createDelegate(this,this.Blg);this.nCe=a;this.lb=c;this.Hgd=b;this.yNc=new (bb.$$(Boolean));this.zh=d}
sie.prototype={nCe:null,Hgd:null,lb:null,zh:null,Alc:null,yNc:null,$ee:function(){return this.lb.ia("SaveToCloudStorageUIIsEnabled")},Vbe:function(){return 617689800},h4b:function(){var a=this.YNd;gn().Ka(a);e5d([new hn(617689800,2147483648,0)],Nhe(this.Hgd))},Wb:function(){var a=Nhe(this.Hgd);if(a){var b=this;mk(a,function(){b.yNc.Uh(!0)});this.h4b()}else u(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")},Qie:function(){u(6590597,216,50,"User clicked on SaveToOneDrive button")},
Blg:function(a,b,c,d,e){if(2147483648!==b.Ke()||a!==this.Vbe())return 2;if(!this.$ee())return 8;if(1===c)return Xj().Vfa||gW?8:32;if(2===c){this.Qie();e&&e.FileDownloadUrl&&u(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.zh&&(this.Alc=this.zh.Di("DialogShown","SaveToOneDriveReponseTime"));var f=this;this.yNc.Wf().CW(function(){f.Alc&&(f.Alc.Lf(),f.Alc=null);f.nCe.af(e)});return 32}return 8}};
function k9(a,b,c,d,e,f){this.ipb=Function.createDelegate(this,this.sH);this.Opb=Function.createDelegate(this,this.OnSuccess);this.PDe=a;this.foa=b;this.fLa=c;this.lb=d;this.e8c=e;this.Mr=f}
k9.prototype={PDe:null,Mr:null,foa:null,fLa:null,lb:null,e8c:0,tk:null,af:function(a){this.tk=a;if("SharePointOnlineConsumer"===this.lb.Va("FileSource")){var b=B().H(Eie,null);if(b){b.af(null,a);return}}if(kta()){u(6590559,216,50,"User is signed in. We will show file picker.");try{u(6590561,216,50,"Initializing OneDrive API");var c={client_id:ye(this.lb).UploadToSkyDriveClientId,env:"INT"};if(1===this.e8c||2===this.e8c)c={client_id:ye(this.lb).UploadToSkyDriveClientId};window.WL.init(c);u(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");window.WL.fileDialog({mode:"save",lightbox:"grey"}).then(this.Opb,this.ipb)}catch(d){u(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",d,d.stack),this.xw()}}else u(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.PDe.nc().tda()},xw:function(){this.Mr().Zw(0)},OnSuccess:function(a){u(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");a&&a.data&&a.data.folders&&
this.fLa.S9(a.data.folders[0].id,a.data.folders[0].urls.viewInBrowser,null,this.tk)},sH:function(a){if(a&&a.error){if("user_canceled"===a.error.code){u(6590593,216,50,"User cancelled upload to their OneDrive.");return}u(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else u(6590595,216,50,"File Dialog returned with no response");this.xw()}};function tie(a,b,c){this.Fa=a;this.foa=b;this.fL=c}
tie.prototype={Fa:null,foa:null,fL:null,nc:function(){return new vie(this.Fa,this.foa,this.fL)}};function vie(a,b,c){this.zbf=Function.createDelegate(this,this.yYf);this.QLd=Function.createDelegate(this,this.Dag);vie.initializeBase(this);this.Fa=a;this.foa=b;this.fL=c;this.HT=!1;Ej(this,1);this.B0=1;Fj(this,1,CommonUIStrings.l_SignIn);Fj(this,0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}
vie.prototype={Fa:null,foa:null,fL:null,tda:function(){$5b(this.foa,this.QLd);tm(this,CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.zbf,null)},yYf:function(a){if(a){a=new xj("Signin.aspx");yj(a,"prompt","1");var b="2";if(this.fL)switch(this.fL.Tm()){case 3:b="0";break;case 2:b="3";break;case 1:b="1"}yj(a,"cbcxt",b);dj(a.GPa);rk(a.toString(),"LoginWindow","","SignInDialog")}else u(6590598,216,50,"User dismissed SignIn Dialog."),this.Cd()},Cd:function(){this.foa.Ua.eb("R",
this.QLd);ap.prototype.Cd.call(this)},Dag:function(){this.ZR&&this.Cd();u(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Fa.Ab(617689800,2,null)}};function wie(a,b,c,d,e,f,g){this.m1=a;this.bD=b;this.kJa=c;this.wGb=d;this.hKb=e;this.L0=f;this.tk=g}
wie.prototype={m1:null,bD:null,kJa:null,wGb:null,hKb:null,L0:null,tk:null,pb:function(a,b){if(!F.mg&&F.gf){var c=this.m1+this.L0,c=Sj(c,"fo",nh(this.wGb),!1),c=Sj(c,"fn",nh(this.bD),!1),c=Sj(c,"qs",nh(this.hKb),!1),c=Sj(c,"n",nh((new Date).getTime().toString()),!1);this.tk&&this.tk.FileDownloadUrl&&(c=Sj(c,"furl",nh(this.tk.FileDownloadUrl),!1));this.kJa&&(c=Sj(c,"fnn",nh(this.kJa),!1));F.gf.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a,b,null,null,!1,null,null,null,null,!1,
null,!1,null)}}};function uie(a){this.lb=a;this.n1=ye(a).SkyDriveUploadWebServiceBase;this.bD=ye(a).FileName;this.L0=a.Va("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}uie.prototype={n1:null,bD:null,L0:null,lb:null,nc:function(a,b,c){return new wie(this.n1,this.bD,b,a,F.sh,this.L0,c)}};function l9(a,b,c,d,e){this.fkf=Function.createDelegate(this,this.u$f);this.gkf=Function.createDelegate(this,this.v$f);this.dMb=a;this.DX=b;this.Mr=c;this.Bg=d;this.zh=e}
l9.prototype={dMb:null,JEb:null,Pn:null,Bg:null,Kfa:null,DX:null,Mr:null,I0:!1,zh:null,Qya:null,tk:null,OCb:function(){this.Bg&&1===this.Bg.Ah()||(this.Pn=this.DX(),this.Pn.lra(CommonUIStrings.l_CommentProgressTooltip),Ej(this.Pn,5),this.Pn.kra(!1),this.Pn.sma(CommonUIStrings.l_DefaultDialogTitle,null,null))},OSa:function(){this.Pn&&(this.Pn.rB(),this.Pn=null)},eT:function(){1!==G().Ah()&&this.Mr().Zw(0)},WUa:function(){u(6590599,216,50,"Redirecting to OneDrive Folder.");rk(this.Kfa,xn(3),"","UploadToCloudManager.RedirectToFolder")},
VUa:function(a){var b=!1,c=!1;L&&(b=L.ia("SaveACopyIsEnabledForUiHost"),c=L.ia("UiHostSupportsDocRebootFeatures"));u(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",a,b);if(b&&c){u(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;aj().pb(function(a){a.Il("App_DocReboot",d,"")})}else rk(a,xn(3),"","UploadToCloudManager.RedirectToEditUrl")},S9:function(a,b,c,d){u(7143886,216,50,"Starting to upload file");
this.zh&&(this.Qya=this.zh.Di("DialogShown","SaveToOneDriveUploadTime"));this.OCb();this.Kfa=b;this.JEb=this.dMb.nc(a,c,d);this.tk=d;this.k_()},k_:function(){u(6590600,216,50,"Calling SkydriveUploadHandler.");this.JEb.pb(this.gkf,this.fkf)},v$f:function(a){this.OSa();this.I0=!1;if(a&&a.Pa&&a.Pa.Ce){var b,c,d;if(d=vk(a.Pa.Ce,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)u(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.eT();else{u(6590603,
216,50,"UploadToCloudManager upload success.");try{a.NewDocumentUrl&&""!==a.NewDocumentUrl?this.VUa(a.NewDocumentUrl):this.WUa()}catch(e){u(37025728,216,15,"Redirect failed with exception: {0}",e.toString())}this.$Ab()}else u(7660114,216,10,"Failed to deserialize : {0}",{ResponseData:g5d(a.Pa.Ce)}),this.eT()}else u(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.eT()},u$f:function(a){5!==a.Pa.Se&&12!==a.Pa.Se||this.I0?(u(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",
a.Pa.Se),this.OSa(),this.eT(),this.$Ab()):(u(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.I0=!0,this.k_())},$Ab:function(){this.Qya&&(this.Qya.Lf(),this.Qya=null)}};qie.registerClass("Common.App.SaveToCloudStorage.ErrorDialog",Dj,jie);rie.registerClass("Common.App.SaveToCloudStorage.PackageManager",null,yo,ec);sie.registerClass("Common.App.SaveToCloudStorage.SaveToCloudStorageActor");k9.registerClass("Common.App.SaveToCloudStorage.SaveToCloudManager",null,kie);
tie.registerClass("Common.App.SaveToCloudStorage.SignInDialogFactory",null,lie);vie.registerClass("Common.App.SaveToCloudStorage.SignInDialog",Dj,mie);wie.registerClass("Common.App.SaveToCloudStorage.SkyDriveUploadCaller",null,nie);uie.registerClass("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory",null,oie);l9.registerClass("Common.App.SaveToCloudStorage.UploadToCloudManager",null,pie);zo(gj(),new rie,0,!1);Type.registerNamespace("Common.App.SearchOAuthManager");w=window.Common||{};
w.Ca=w.Ca||{};w.Ca.Mlg=w.Ca.Mlg||{};function jke(a,b){this.MQc=Date.now;this.Yxb=a;this.s_e=b;kke(this)}jke.prototype={HHg:9E5,IHg:1E4,s_e:0,MQc:null,Yxb:null,fmb:null,zJe:null,Dqd:0,qua:function(a){return(a=lke(this,a))?Promise.resolve(a):kke(this)}};function kke(a){a.fmb=a.fmb||new Promise(function(b){a.Yxb().then(function(c){a.fmb=null;""!==c&&c&&(a.zJe=c,a.Dqd=a.MQc(),b(c));b(null)}).catch(function(){a.fmb=null;b(null)});window.setTimeout(function(){a.fmb=null;b(null)},a.s_e)});return a.fmb}
function lke(a,b){var c=a.MQc();if(c<a.Dqd+a.HHg)return c>a.Dqd+a.IHg&&kke(a),a.zJe;b&&kke(a);return null}
function mke(a,b){var c=Date.now(),d=nke(),e=L.Va("UserPrincipalName"),f=""!==a&&a?oke[a.toLowerCase()]:"";u(593862986,1300,50,"Begin SSO Request for app: "+a);if(""===e||!e)return u(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===f||!f)return u(593862984,1300,10,"Missing AAD appId for appName: "+a),Promise.resolve("");var g=Ae().toString(),d=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",
f,window.encodeURIComponent(b),window.encodeURIComponent(e),window.encodeURIComponent(d),g),h=document.createElement("iframe");h.style.display="none";h.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");h.src=d;document.body.appendChild(h);return new Promise(function(d){pke(h.contentWindow).then(function(e){document.body.removeChild(h);for(var f=new (Da.$$(String)),g=/[#?&]+([^=&]+)=([^&]*)/gi,r;r=g.exec(e);)3!==r.length&&(u(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",
r.length),d("")),f.ea(r[1],r[2]);f.hc("access_token")?(u(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",b,a,Date.now()-c),d(f.K("access_token"))):(u(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",b,a,(Date.now()-c).toString()),d(""))}).catch(function(e){try{document.body.removeChild(h)}catch(f){}u(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",b,a,JSON.stringify(e),(Date.now()-
c).toString());d("")})})}function nke(){var a=window.location.protocol,b=window.location.host,c=L.Va("OAuthManagerHostPathOverride");if(A(c))var c=window.location.pathname,d=c.lastIndexOf("/"),c=0<=d?c.substring(0,d+1):"";return a+"//"+b+c+"WacOAuth.html"}
function pke(a){return new Promise(function(b,c){var d=0,e=0,e=window.setInterval(function(){if(200<d++)window.clearInterval(e),c("Exceeded 10000ms timeout after 200 polls");else{var f=null,g=null;try{if(!a||a.closed){window.clearInterval(e);c("Window or Frame is closed before completion");return}f=a.location.href;g=a.location.hash}catch(h){}f&&"about:blank"!==f&&g&&""!==g&&(window.clearInterval(e),b(g))}},50)})}function qke(){this.Xre={};this.yob=new (ma.$$(String,jke))(pb())}
qke.prototype={eI:null,qua:function(a,b,c){if(this.yob.hc(b))return this.yob.K(b).qua(!0);var d=this,e=new jke(function(){return c?rke(d,a,b):d.Yxb(a,b)},3E4);this.yob.ea(b,e);return e.qua(!0)},gQf:function(a,b,c){if(this.yob.hc(b))return lke(this.yob.K(b),!0);var d=this,e=new jke(function(){return c?rke(d,a,b):d.Yxb(a,b)},3E4);this.yob.ea(b,e);return null},Yxb:function(a,b){var c=Date.now(),d=this;return mke(a,b).then(function(a){return new ske(a,"SSOStack")}).then(function(e){return new Promise(function(f){e.t4a&&
""!==e.t4a?(u(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",a,e.source,Date.now()-c),d.hHa("GetTokenInternal",!0,Date.now()-c,a,!0,"","",b),f(e.t4a)):(u(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",a,Date.now()-c),d.hHa("GetTokenInternal",!1,Date.now()-c,a,!0,"GetTokenSilent Failed","SSO Token provider failed!",b),f(""))})})},hHa:function(a,b,c,d,e,f,g,h){var k="Search"===d,l=[];a=hk(k?"Event":"EventName",a,2);d=hk("AppName",d,2);Array.add(l,a);Array.add(l,
d);k&&(d=hk("LatencyType","FetchToken",2),Array.add(l,d));f&&""!==f&&(f=hk("ErrorCode",f,2),Array.add(l,f));g&&""!==g&&(g=hk("ErrorMessage",g,2),Array.add(l,g));h&&""!==h&&(g=!(h in this.Xre),this.Xre[h]=g,g=hk("WarmUpCall",g.toString(),1),Array.add(l,g),h=hk("Service",this.e7b(h),2),Array.add(l,h));k=k?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";if(e){var m,n=(m=new hb,m.name=k,m.samplingPolicy=2,m.dataFields=l,m.succeeded=b,m.durationMs=c,m);window.Otel.Telemetry.Z_(n)}else m=
(n=new fb,n.name=k,n.samplingPolicy=2,n.dataFields=l,n),window.Otel.Telemetry.$_(m)},e7b:function(a){return a===F.GWc?"Loki":a===F.C5c?"Substrate":L&&a===L.Va("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}};
function rke(a,b,c){if(!a.eI)try{a.eI=B().H(v6,null)}catch(d){u(51689675,1300,10,"Unable to resolve IOAuthManager: "+d)}return a.eI?new Promise(function(d){var e=Date.now();a.eI.WW(b,c,null).then(function(f){var g=f.Token;f.IsSuccess&&g&&g.length?(a.hHa("GetTokenInternalImplicitJS",!0,Date.now()-e,b,!0,f.ErrorCode,f.ErrorMessage,c),d(g)):(a.hHa("GetTokenInternalImplicitJS",!1,Date.now()-e,b,!0,f.ErrorCode,f.ErrorMessage,c),d(null))}).catch(function(f){f=f?Id(f):"";a.hHa("GetTokenInternalImplicitJS",
!1,Date.now()-e,b,!0,"Caught Exception",f,c);d(null)})}):new Promise(function(c){a.hHa("GetTokenInternalImplicitJS",!1,0,b,!0,"Null OAuthManager","OAuthManager not set","");c(null)})}function ske(a,b){this.t4a=a;this.source=b}ske.prototype={t4a:null,source:null};function tke(){}tke.prototype={Ea:null,Xb:function(){return"Common.App.SearchOAuthManager"},wc:function(a){this.Ea=a;C(D(this.Ea.ma($Ha,null)),function(){return new qke})},ub:function(){},ha:function(){}};jke.registerClass("Common.App.SearchOAuthManager.OAuthCacheManager");
(function(){}).registerClass("Common.App.SearchOAuthManager.OAuthHelper");qke.registerClass("Common.App.SearchOAuthManager.SearchOAuthManager",null,$Ha);ske.registerClass("Common.App.SearchOAuthManager.TokenResult");tke.registerClass("Common.App.SearchOAuthManager.SearchOAuthPackage",null,yo,ec);var oke={smartlookup:"4d5c2d63-cf83-4365-853c-925fd1a64357",search:"a9b49b65-0a12-430b-9540-c80b3332c127"};zo(gj(),new tke,0,!1);Type.registerNamespace("Common.App.SmartLookup");w=window.Common||{};
w.Ca=w.Ca||{};w.Ca.BVa=w.Ca.BVa||{};window.Common.App.SmartLookup.EntryPoint=w.Ca.BVa.ORc=function(){};
w.Ca.BVa.ORc.prototype={other:0,searchBoxSearch:1,searchBoxDictionary:2,searchBoxQuickAnswer:3,smartLookupRibbon:4,smartLookupContextMenu:5,entity:6,dictionary:7,web:8,pictures:9,files:10,bookmarks:11,help:12,chartRecommendation:13,linkSkill:14,searchBoxFindInDocument:15,searchBoxEntity:16,searchSkill:17,controlF:18,ribbonFindButton:19,reuseSlides:20,data:21,contextMenuDictionary:22,contextMenuSearchSuggestion:23,contextMenuSynonyms:24,contextMenuSearchBoxSearch:25,searchBoxSearchZeroTerm:26,contextMenuSearchZeroTerm:27,
note:28,smartLookupAutoLaunch:29,contextMenuSmartLookupInSubMenu:30,dataDisambiguate:31,linkFiles:32,searchBoxNoteL2:33,contextMenuLaunchL2Document:34};window.Common.App.SmartLookup.EntryPoint.registerEnum("Common.App.SmartLookup.EntryPoint",!1);window.Common.App.SmartLookup.LaunchMode=w.Ca.BVa.r_f=function(){};w.Ca.BVa.r_f.prototype={"default":0,documentsView:1,objectsView:2};window.Common.App.SmartLookup.LaunchMode.registerEnum("Common.App.SmartLookup.LaunchMode",!1);Type.registerNamespace("Common.App.AppsForOfficeOauth");
w=window.Common||{};w.Ca=w.Ca||{};w.Ca.kGf=w.Ca.kGf||{};function cle(a){this.nYe=a}cle.prototype={nYe:null};function dle(a){this.eI=a;this.HFb=L.fc("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}
dle.prototype={eI:null,HFb:!1,JNc:function(a,b,c,d,e,f,g,h){if(!this.eI)return e=new EW,e.LI=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(e);var k=new Bha;k.AddinName=g;k.AddinTrustId=h;var l=-1;a=null;if(e&&(this.HFb||1!==JLd()))a=Ije(this.eI,b,e,String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,g),k);else{var m=Date.now(),n=this;a=this.eI.WW("AddinShared",b,k).then(function(a){l=Date.now()-m;var e=(c||d)&&"login_required"===a.ErrorCode;
return(!c||"interaction_required"!==a.ErrorCode&&"consent_required"!==a.ErrorCode&&"invalid_grant"!==a.ErrorCode)&&!e||!n.HFb&&1===JLd()?Promise.resolve(a):Ije(n.eI,b,null,String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,g),k)})}return a.then(function(a){var b=new EW;if(a.IsSuccess)b.i0=a.Token,a.Telemetry&&(b.QVa=a.Telemetry.fromCache,b.f6b=a.Telemetry.expiresOn);else{var c;switch(a.ErrorCode){case "UserCancelled":case "interaction_required":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;
break;case "consent_required":case "invalid_grant":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":c=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:c=a.ErrorCode===m9.stg?window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:a.ErrorCode===m9.cpg?window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:a.ErrorCode===m9.RYf?window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:a.ErrorCode===m9.QYf?window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:a.ErrorCode===m9.pJf?window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}b.LI=
c;c="";(a=/AADSTS(\d+)/.exec(a.ErrorMessage))&&1<a.length&&(c=a[1]);b.ndc=c}return b}).catch(function(){var a=new EW;a.LI=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(a)}).then(function(a){a.x8a="OauthManager";0<=l&&(a.Zxb=l);return a})},BVc:function(a){var b=(L.Va("UiHost")||"").toLowerCase();if(b=qo()||"teams"===b&&nfe()){a:{if(a){a=a.toLowerCase();for(var b=mfe.length,c=0;c<b;++c)if(mfe[c]===a){a=!0;break a}}a=!1}b=!a}return b||!this.eI||1!==this.eI.m0?!1:
!0}};cle.registerClass("Common.App.AppsForOfficeOauth.AppsForOfficeOauthManagerFactory",null,Ebc);dle.registerClass("Common.App.AppsForOfficeOauth.AppsforOfficeTokenFromOauthManager",null,Fbc);Type.registerNamespace("Common.App.LivePersonaUtils");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Y_f=w.Ca.Y_f||{};function ele(){}
ele.prototype={Xb:function(){return"Common.App.LivePersonaUtils"},ub:function(){B().H(pga,null)},ha:function(){},wc:function(a){C(D(lc(a.ma(fle,null),pga)),function(){return new fle(mc(v6,kc(a,v6)))})}};function fle(a){this.lJb=a}
fle.prototype={lJb:null,qPf:function(){var a=gle();if(!a){var b;return Promise.resolve((b=new oga,b.isSuccess=!1,b.token=null,b.errorMessage=String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",L.Va("HostAuthType")||""),b))}if(!L.ia("IsO365CommercialHost")&&!L.ia("IsO365ConsumerHost")){var c;return Promise.resolve((c=new oga,c.isSuccess=!1,c.token=null,c.errorMessage="Not attempting to fetch token because host is not an O365 host.",c))}var d=this;return new Promise(function(b,c){d.lJb.CW(function(){Ra(d.lJb)||
Qa(d.lJb)?c(Error.create("Error downloading auth library")):ab(d.lJb).WW("Loki",a,null).then(function(a){if(L.ia("ForceLokiFallbackToACLPTokenIsEnabled")){var c=L.Va("LokiUserDataSignature")||"",d;a=(d=new oga,d.isSuccess=!0,d.token=c,d.errorMessage=null,d)}else if(a.IsSuccess&&a.Token)a=(c=new oga,c.isSuccess=!0,c.token=a.Token,c.errorMessage=null,c);else{var f;a=(f=new oga,f.isSuccess=!1,f.token=null,f.errorMessage=JSON.stringify(a),f)}b(a);return a})})})}};
function gle(){var a=null,b=JLd();2===b?a=L.Va("LokiAADAppId"):1===b&&(a=L.Va("LokiMSAAppId"));return a}ele.registerClass("Common.App.LivePersonaUtils.LivePersonaUtilsPackage",null,yo,ec);fle.registerClass("Common.App.LivePersonaUtils.LokiTokenManager",null,pga);zo(gj(),new ele,0,!1);Type.registerNamespace("Common.App.SaveACopy");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.rlg=w.Ca.rlg||{};function Zje(){}Zje.registerInterface("Common.App.SaveACopy.IFileNameDialogFactory");function $je(){}$je.registerInterface("Common.App.SaveACopy.IFileNameDialog");
function ake(a,b,c){this.Fa=a;this.fL=b;this.fLa=c}ake.prototype={Fa:null,fL:null,fLa:null,nc:function(a){return new bke(this.Fa,this.fL,this.fLa,a)}};function bke(a,b,c,d){this.gXb=Function.createDelegate(this,this.bSc);bke.initializeBase(this,[!1,!1,!1,!1]);this.Fa=a;this.fL=b;this.fLa=c;Fj(this,1,CommonUIStrings.l_SaveButtonLabel);this.Hp=pm(cke,CommonUIStrings.l_SaveACopyFileName);this._id="FileNameDialog-SaveACopy";this.tk=d}
bke.prototype={Fa:null,fL:null,fLa:null,Kfa:null,wGb:null,tk:null,tda:function(a,b,c){this.wGb=a;this.Kfa=c;a={txtFileName:vW(F.hz.Gt),lblFolderName:String.format(CommonUIStrings.l_DestinationFolder,b)};this.zk(CommonUIStrings.l_SaveToOneDrive,this.gXb,a);u(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()},bSc:function(a,b){1!==a?u(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(a=b.txtFileName.trim(),u(7165651,
216,50,"User click save to upload file with new name."),b=vh(F.qW),a&&""!==a&&""!==b&&(a+=b),this.fLa.S9(this.wGb,this.Kfa,a,this.tk))}};function dke(){this.Hm=Function.createDelegate(this,this.vm)}
dke.prototype={Ea:null,Xb:function(){return"Common.App.SaveACopy"},ub:function(){L.Nf(this.Hm)},vm:function(){L.ia("SaveACopyBrsIsEnabled")&&this.Ea.H(eke,null).Wb()},ha:function(){},wc:function(a){this.Ea=a;D(C(this.Ea.ma(fke,null),function(){return new fke(Zf(),a.H(uie,null),function(){return(new jp).nc(!1)},function(){return new gke(Zf())},G(),G().IJ())}));D(C(lc(this.Ea.ma(ake,null),Zje),function(){return new ake(Zf(),G().rb(),a.H(fke,null))}));D(C(this.Ea.ma(eke,null),function(){return new eke(a.H(hke,
null),a.H(Ehe,null),L,G().IJ())}));D(C(this.Ea.ma(hke,null),function(){return new hke(a.H(ake,null),a.H(tie,null),lta(),a.H(fke,null),L,mj,function(){return new gke(Zf())})}))}};function gke(a){this.$Bc=Function.createDelegate(this,this.Z2c);gke.initializeBase(this);Ej(this,1);Fj(this,1,CommonUIStrings.l_RetryButtonLabel);Fj(this,0,CommonUIStrings.l_DialogClose);this.Fa=a}
gke.prototype={Fa:null,Zw:function(a){u(7165652,216,50,"Show error dialog here {0}.",a);this.ww(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.$Bc,!1,!1,!1)},Z2c:function(a){1===a?(u(7165653,216,50,"User click to retry the action."),this.Fa.Ab(4246497969,2,null)):u(7165654,216,50,"User cancel the error dialog.")}};function eke(a,b,c,d){eke.initializeBase(this,[a,b,c,d]);this.mze=b}
eke.prototype={mze:null,$ee:function(){return this.lb.ia("SaveACopyBrsIsEnabled")},Vbe:function(){return 4246497969},h4b:function(){var a=this.YNd;gn().Ka(a);e5d([new hn(4246497969,2147483648,0)],Nhe(this.mze))},Qie:function(){u(7205456,216,50,"User clicked on SaveAs button from the backstage.")}};function hke(a,b,c,d,e,f,g){hke.initializeBase(this,[b,c,d,e,f,g]);this.sse=a}
hke.prototype={sse:null,OnSuccess:function(a){a&&a.data&&a.data.folders?(u(7165655,216,50,"User selected which folder to upload file to."),this.sse.nc(this.tk).tda(a.data.folders[0].id,a.data.folders[0].name,a.data.folders[0].urls.viewInBrowser)):(u(7165656,216,10,"Fail to select folder to upload file."),this.xw())},sH:function(a){a&&a.error&&"user_canceled"===a.error.code&&u(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");k9.prototype.sH.call(this,a)},xw:function(){u(7205458,
216,50,"Error occur in Save A Copy Manager.");k9.prototype.xw.call(this)}};function fke(a,b,c,d,e,f){fke.initializeBase(this,[b,c,d,e,f]);this.Fa=a}
fke.prototype={Fa:null,eT:function(){u(7205459,216,50,"Display Error for Save A Copy.");ike(this)&&this.Fa.jb(951489623,2,{FailureReason:"Unknown"},null);l9.prototype.eT.call(this)},WUa:function(){u(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");ike(this)&&this.Fa.Ab(1380507044,2,null);l9.prototype.WUa.call(this)},VUa:function(a){u(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",a);ike(this)&&this.Fa.Ab(1380507044,2,null);l9.prototype.VUa.call(this,a)},k_:function(){if(this.tk&&
"true"===this.tk.SkipSaveToHost)l9.prototype.k_.call(this);else if(32!==this.Fa.Ab(3070187925,1,null))u(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),l9.prototype.k_.call(this);else{var a=this,b=this;this.Fa.jb(3070187925,2,[function(){u(8741712,216,50,"Call the force save file change successfully.");l9.prototype.k_.call(a)},function(){u(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");b.eT()}],null)}}};
function ike(a){return!!a.tk&&!!a.tk.SaveEntryPoint&&"VersionHistory"===a.tk.SaveEntryPoint.toString()}ake.registerClass("Common.App.SaveACopy.FileNameDialogFactory",null,Zje);bke.registerClass("Common.App.SaveACopy.FileNameDialog",om,$je);dke.registerClass("Common.App.SaveACopy.PackageManager",null,yo,ec);gke.registerClass("Common.App.SaveACopy.RetryDialog",Dj,jie);eke.registerClass("Common.App.SaveACopy.SaveACopyActor",sie);hke.registerClass("Common.App.SaveACopy.SaveACopyManager",k9);
fke.registerClass("Common.App.SaveACopy.SaveACopyUploadToCloudManager",l9);(function(){}).registerClass("Common.App.SaveACopy.FileNameDialogHtml");var cke="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
zo(gj(),new dke,0,!1);Type.registerNamespace("Box4.Media");Zp=window.Box4||{};Zp.Kua=Zp.Kua||{};function Pme(){}Pme.registerInterface("Box4.Media.IInsertMediaHelper");function Qme(){}Qme.registerInterface("Box4.Media.IOneDriveFilePickerHelper");function Rme(){}Rme.registerInterface("Box4.Media.IImageFilePickerHelper");function Sme(){}Sme.registerInterface("Box4.Media.IInsertOnlineMediaHelper");function Tme(){}Tme.registerInterface("Box4.Media.IInsertOnlineMediaHandler");function Ume(){}Ume.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessenger");
function E9(){}E9.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessengerFactory");function Vme(){}Vme.registerInterface("Box4.Media.IInsertMediaDialog");function Wme(){}Wme.registerInterface("Box4.Media.IInsertMediaDialogFactory");function Xme(){}Xme.registerInterface("Box4.Media.IInsertMediaFromHostManagerFactory");function Yme(){}Yme.registerInterface("Box4.Media.IInsertMediaFromHostOneDriveHostFrame");Zp.Kua.dVc=function(){};
Zp.Kua.dVc.prototype={unknown:0,bing:1,m365:2,icons:3,oneDrive:4,hubbleVideos:5};Zp.Kua.dVc.registerEnum("Box4.Media.InsertMediaProviders",!1);Zp.Kua.QWc=function(){};Zp.Kua.QWc.prototype={Image:0,Video:1};Zp.Kua.QWc.registerEnum("Box4.Media.MediaType",!1);function pRd(){}function Zme(){}Zme.registerInterface("Box4.Media.IPickerDialog");function bne(a,b){bne.resolveInheritance();this.dispose=this.ha;bne.initializeBase(this,[a,$m(b),null])}bne.prototype={};
function F9(a,b,c){a.lA()&&tic(a,a.M3)&&(a.kw(b),a.bE(b,c))}function cne(a,b){cne.resolveInheritance();this.dispose=this.ha;cne.initializeBase(this,[a,"*"===b?b:$m(b),null]);kX.prototype.QNc.call(this,"UI_InsertImage");kX.prototype.QNc.call(this,"UI_InsertFileLink")}cne.prototype={tje:function(){}};function dne(){}dne.prototype={ou:function(a,b){return new bne(a,b)}};
function ene(a,b,c,d,e){this.Lhf=Function.createDelegate(this,this.g7f);this.Bef=Function.createDelegate(this,this.t3f);this.wgf=Function.createDelegate(this,this.P5f);this.Fgf=Function.createDelegate(this,this.a6f);this.zgf=Function.createDelegate(this,this.T5f);this.rhf=Function.createDelegate(this,this.K6f);this.Wz=Function.createDelegate(this,this.lz);ene.initializeBase(this,[!1,!1,!1,!1]);if(!a)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");
this.Hcd=a;this.K$c="";this.CJa=c;this.gL=d;this.doa=[];this.tKa=b;this.Hp=e||fne;this._id="InsertMediaDialog";this.h_b=!1;Ej(this,5)}
ene.prototype={doa:null,K$c:null,BL:null,tKa:null,CJa:null,gL:null,Hcd:null,Vgc:!1,PU:null,Oed:null,XQb:null,Qmd:"KeepFocusDiv",foc:"KeepFocusStartDiv",nd:null,uPa:function(a){return this.nd=a},w8:0,yWb:function(a){return this.w8=a},psa:null,g_e:function(a){return this.psa=a},JZb:0,b_e:function(a){return this.JZb=a},AVa:function(a,b){this.K$c=a;this.Vgc=!1;this.$s(this.K$c,null);this.PU=gne(this.Yi("insertmediaframe"));if(!this.PU)throw ep(this,this.NB,0),Error.invalidOperation("Couldn't get InsertMediaIframe.");
(a=document.getElementById(this.Yi("WACDialogPanel")))&&a.setAttribute("role","dialog");a=document.createElement("div");a.setAttribute("Id",this.foc);a.setAttribute("tabindex","0");a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","-1000px");this.PU.parentNode.insertBefore(a,this.PU.parentNode.firstChild);a=document.createElement("div");a.setAttribute("Id",this.Qmd);a.setAttribute("tabindex","0");this.PU.parentNode.appendChild(a);a.setAttribute("position",
"absolute");a.setAttribute("width","-1000px");a.setAttribute("top","10000px");window.$addHandler(pi?pi.Oc:null,"keydown",this.Wz);this.PU.setAttribute("src",this.Hcd);this.PU.setAttribute("width","100%");this.PU.setAttribute("height","100%");this.PU.setAttribute("frameborder","0");L.ia("ShowInsertMediaIframeWhenIframeIsReady")&&(gi()||Aj(1))?(this.PU.style.visibility="hidden",this.XQb=this.rhf,hh(this.PU,"load",this.XQb)):this.PU.style.visibility="visible";gne(this.Yi("WACDialogTitleText")).style.display=
"none";if(2===this.w8||5===this.w8)gne(this.Yi("WACDialogTitlePanel")).style.display="none",gne(this.Yi("WACDialogBodyPanel")).style.padding="0";$f().rk().ZK.wK=!0;this.BL=this.tKa.ou(this.PU.contentWindow,this.Hcd);var c=this;F9(this.BL,"AddItem",function(a){var d=b.xAc||(b.xAc=Function.createDelegate(b,b.Aua));u(7135752,352,100,"OnAddItem : Got message.");if(a=hne(a))50<c.doa.length?u(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(c.doa,a),c.Vgc&&(d(c.doa),c.Vgc=!1))});
var d=this;F9(this.BL,"Insert",function(a){d.gZc(a,b.xAc||(b.xAc=Function.createDelegate(b,b.Aua)))});F9(this.BL,"AddOtelEvent",function(a){if(a&&a.Values){a=a.Values;delete a.m_Origin;delete a.m_Source;delete a.m_ReceivedTime;u(51652562,352,50,"Received OTel event: "+a.eventName||"Unknown");var b;window.Otel.Telemetry.sendOtelEvent((b=new Paa,b.otelEvent=a,b))}});F9(this.BL,"GetCustomHeaders",this.zgf);F9(this.BL,"GetSessionId",this.Fgf);F9(this.BL,"GetCID",this.wgf);F9(this.BL,"CancelDialog",this.Bef);
if(2===this.w8&&!this.JZb){F9(this.BL,"LaunchM365Upsell",this.Lhf);var e=this;this.Oed=this.gL.VGa("MsoPremiumStockImages",function(a){u(541172692,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");e.BL.Il("UpgradeFeatureTier",{LicenseTier:a.toString()},"")})}ine(this,3)},K6f:function(){if(this.PU){this.PU.style.visibility="visible";var a=this;window.setTimeout(function(){if(a.Fh){var b=a.Fh.getElementById("insertmediaframe");b&&b.focus()}},0)}},lz:function(a){9===a.keyCode&&(a.target.id!==this.Qmd||
a.shiftKey?a.target.id===this.foc&a.shiftKey&&(a.preventDefault(),this.Fh.getElementById(this.Qmd).focus()):(a.preventDefault(),this.Fh.getElementById(this.foc).focus()))},dispose:function(){this.gL&&this.Oed&&this.gL.jbc("MsoPremiumStockImages",this.Oed);this.BL&&(this.BL.dispose(),this.BL=null);this.XQb&&(oi(this.PU,"load",this.XQb),this.XQb=null);om.prototype.dispose.call(this)},t3f:function(){u(17662422,352,100,"OnCancelDialog : Got message.");ep(this,this.NB,0);ine(this,1)},PUa:function(){var a=
new XMLHttpRequest;a.open("POST",this.psa,!0);a.setRequestHeader("Content-Type","");return a},gZc:function(a,b){u(7135754,352,100,"OnInsert : Got message.");ep(this,this.NB,0);b?this.doa&&0<this.doa.length?(b(this.doa),ine(this,0)):(u(23078422,352,15,"Empty search result."),this.Vgc=!0,b(this.doa),ine(this,2)):ine(this,2)},T5f:function(){this.BL&&(u(7135755,352,100,"OnGetCustomHeaders : Got message."),this.BL.Il("SetCustomHeaders",{CustomHeaders:""},""))},a6f:function(){this.BL&&(u(7135756,352,100,
"OnGetSessionId : Got message."),this.BL.Il("SetSessionId",{SessionId:vp||"00000000-0000-0000-0000-000000000000"},""))},P5f:function(){this.BL&&(u(7135757,352,100,"OnGetCID : Got message."),this.BL.Il("SetCID",{CID:""},""))},g7f:function(){this.gL&&(u(541172693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.gL.Gua("stockimages",null))}};
function gne(a){var b=document.getElementById(a);if(!b)throw Error.invalidOperation(String.format("Couldn't get {0}.",a));return b}
function ine(a,b){var c=/hubble/gi;if(a.psa&&0<a.psa.search(c)&&a.nd){var c=F.od,d={};d.InsertedFiles=a.doa.length;d.DialogResult=jne.toString(b);d.DialogMode=3===a.w8?"Icons":"Images";d.CorrelationId="{"+a.nd.toString()+"}";d.Platform="Wac";d.Provider=Zp.Kua.dVc.toString(a.w8)||"Unknown";d.AudienceGroup=c&&"AudienceGroup"in c?c.AudienceGroup.toString():"Unknown";d.Ring=c&&"Ring"in c?c.Ring.toString():"Unknown";d.AppId=window.Box4.App.Rg;d.Build=Jp;d.Locale=ao(F.ag)._name;a.PUa().send(JSON.stringify(d))}if((2===
a.w8||5===a.w8)&&(c=L.Va("InsertMediaDialogAriaTenantNameSpace"))&&""!==c){var d=[],e="InsertUnknownContent";if(2===a.w8){var f;Array.add(d,(f=new eb,f.name="DialogMode",f.string="M365Content",f));var g;Array.add(d,(g=new eb,g.name="Provider",g.string="M365Content",g));e="InsertM365Content"}else if(5===a.w8){var h;Array.add(d,(h=new eb,h.name="DialogMode",h.string="HubbleVideo",h));var k;Array.add(d,(k=new eb,k.name="Provider",k.string="HubbleVideo",k));e="InsertHubbleVideo"}var l;Array.add(d,(l=
new eb,l.name="InsertedFiles",l.int64=a.doa.length,l));var m;Array.add(d,(m=new eb,m.name="DialogResult",m.string=jne.toString(b),m));var n;Array.add(d,(n=new eb,n.name="CorrelationId",n.string=a.nd.toString(),n));var r;window.Otel.Telemetry.$_((r=new fb,r.name=String.format("{0}.{1}",c,e),r.dataFields=d,r))}}function jne(){}jne.prototype={OK:0,cancel:1,error:2,open:3};jne.registerEnum("Box4.Media.InsertMediaDialog.HubbleAction",!1);function kne(a,b,c){this.Lvg=a;this.CJa=b;this.gL=c}
kne.prototype={Lvg:null,CJa:null,gL:null,ou:function(){throw Error.notImplemented();}};function lne(a,b,c){this.dispose=this.ha;this.Rte=a;this.Chb=[];this.Qte=b;this.Ikd=c.split(";")}
lne.prototype={Rte:null,Chb:null,Qte:null,Ikd:null,nd:null,uPa:function(a){return this.nd=a},w8:0,yWb:function(a){return this.w8=a},psa:null,g_e:function(a){return this.psa=a},JZb:0,b_e:function(a){return this.JZb=a},AVa:function(a,b){Array.clear(this.Chb);a=this.Rte.Aa();See(a,b.dib());tic(a,this.Qte);a.kw(b.dib());var c=this;a.bE(b.dib(),function(a){c.gZc(a,b)});u(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");a.Il(b.RGe(),{FileExtensionFilterList:this.Ikd},
"")},gZc:function(a,b){u(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");a=b.Qhe(a);for(var c=[],d=0;d<a.length;d++){var e=a[d];b.E8b(e,this.Ikd)?Array.add(c,e):(e=b.Jce(e),Array.contains(this.Chb,e)||Array.add(this.Chb,e))}c&&c.length?b.Aua(c):u(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.Chb.length&&(b=this.Chb.join(", "),u(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",b),a=new Dj,Ej(a,
0),lp(a,CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null))},ha:function(){}};function mne(a){this.sue=a}mne.prototype={sue:null,ou:function(){return this.sue}};function G9(){this.rX=document.createElement("iframe");this.rX.src="about:blank";this.rX.style.visibility="hidden";this.rX.style.position="absolute";this.rX.style.zIndex=-100}G9.prototype={rX:null};function H9(){}
H9.prototype={E8b:function(a,b){if(!a)return!1;for(var c=0;c<b.length;c++)if(0<=a.toLowerCase().indexOf(b[c]))return!0;return!1}};function nne(a){return(a=one.exec(a))&&2<a.length?a[2].trim():""}
function hne(a){if(!a||!a.Values)return null;a=a.Values;if(!a)return null;var b="";"sourceProvider"in a&&(b=a.sourceProvider||"");var c;return c=new pRd,c.Action=a.action||"",c.Caption=a.caption||"",c.ContentType=a.contentType||"",c.Type=a.extension||"",c.PageUrl=a.pageUrl||"",c.OriginalUrl=a.sourceUrl||"",c.ContentProvider=b,c.ThumbnailUrl=a.thumbnailUrl||"",c.LicenseUrl=a.licenseUrl||"",c.LicenseDisplayName=a.licenseDisplayName||"",c.Height=a.height||0,c.Width=a.width||0,c.SvgContent=a.svgContent||
"",c.Description=a.description||"",c}function pne(a,b,c,d,e){var f=ao(F.ag)._name;a=String.format(b,F.ag,f,Jp,c,qne(a),d);e&&(a+="&flipgrid=1");return a}function rne(a){var b=qne(window.Box4.App.Rg),c=Jp,d=0<c.indexOf(".")?c.substring(0,c.indexOf(".")):"16";return String.format(a,F.ag,F.ag,F.ag,b,d,c,Zp.Kua.QWc.toString(1),0,0)}function qne(a){switch(a){case 1:a=8;break;case 4:a=3;break;case 2:a=0;break;default:a=0}return a}function sne(a,b,c,d){this.BZf=a;this.Fee=b;this.HVc=c;this.Eee=d}
sne.prototype={BZf:!1,Fee:!1,HVc:!1,Eee:!1};function I9(a){I9.initializeBase(this,[a])}
I9.prototype={RGe:function(){return"UI_InsertFileLink"},dib:function(){return"Host_InsertFileLink"},Qhe:function(a){return a&&a.Values&&"Items"in a.Values?a.Values.Items:null},Jce:function(){ub(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""},E8b:function(){return!0},s1c:function(a,b,c){a=c(a);a.length&&(c={},c.Items=a,b.Il(this.dib(),c,""))},She:function(a){for(var b=[],c=0;c<a.data.value.length;c++){var d=a.data.value[c];
if(d){var e={};e.DisplayText=d.name;e.Url=d.urls.download;e.sourceUrl=d.urls.download;e.caption=d.name;Array.add(b,e)}}return b},Rhe:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e={};e.DisplayText=String.format("{0}{1}",d.name,d.extension);var f=e;a:{for(var d=[d.urls.viewInBrowser,d.urls.open,d.urls.download],g=0;g<d.length;g++)if(d[g]&&""!==d[g]){d=d[g];break a}u(21764229,352,10,"None of the URLs we received are valid");d=""}f.Url=d;Array.add(b,e)}}return b}};
function tne(a){this.Fa=a}tne.prototype={Fa:null,uX:2711544537,cja:function(a){return this.uX=a},Aua:function(a){try{u(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length);for(var b=0;b<a.length;b++)this.Fa.jb(this.uX,2,a[b],null);u(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length)}catch(c){u(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",c.toString())}}};
function J9(a,b,c){J9.initializeBase(this,[a,b,c])}
J9.prototype={RGe:function(){return"UI_InsertImage"},dib:function(){return"Host_InsertImage"},Qhe:function(a){var b=[];if(a&&a.Values&&a.Values.Items){a=a.Values.Items;for(var c=0;c<a.length;c++){var d=a[c];if(d){var e,d=(e=new pRd,e.Type=d.Extension||"",e.OriginalUrl=d.SourceUrl||"",e.Caption=d.caption,e.Description=d.description||"",e.Height=d.Height||0,e.Width=d.Width||0,e);Array.add(b,d)}}}return b},Jce:function(a){return a.Type},E8b:function(a,b){return this.CJa.E8b(a.Type,b)},She:function(a){var b=
[];if(a&&a.data&&a.data.value&&0<a.data.value.length)for(var c=0;c<a.data.value.length;c++)if(a.data.value[c]&&a.data.value[c].urls&&a.data.value[c].urls.download){var d=a.data.value[c],e,d=(e=new pRd,e.OriginalUrl=d.urls.download,e.Type=d.extension||"",e.Caption=d.name,e.ContentType="",e.Height=d.driveItem||d.driveItem.image?d.driveItem.image.height:0,e.Width=d.driveItem||d.driveItem.image?d.driveItem.image.width:0,e);Array.add(b,d)}b.length||u(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");
return b},Rhe:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e,d=(e=new pRd,e.ContentType=d.itemType||"",e.Type=d.extension||"",e.OriginalUrl=d.urls&&d.urls.open?d.urls.open:"",e.Height=d.photo?d.photo.height:0,e.Width=d.photo?d.photo.width:0,e);Array.add(b,d)}}return b},s1c:function(a,b,c){c=c(a);if(c.length){a=[];for(var d=0;d<c.length;d++){var e=c[d],f={};f.Extension=e.Type;f.SourceUrl=e.OriginalUrl;f.SourceUrl=e.OriginalUrl;f.Width=e.Width;f.Height=e.Height;
Array.add(a,f)}c={};c.Items=a;b.Il(this.dib(),c,"")}}};function une(a,b,c){this.Fa=a;this.CJa=b;this.e6=c}
une.prototype={Fa:null,CJa:null,e6:null,uX:4034531111,MB:null,Eoa:function(){return this.MB||(this.MB=B().H(fc,null))},cja:function(a){return this.uX=a},Aua:function(a){try{u(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",a.length);var b,c="";if(a)for(var d=0;d<a.length;d++){var e=a[d];e&&(c+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',e.OriginalUrl,e.Width,e.Height))}b=c;c=2;if(b&&0<b.length){var f=new Qf;J(f,dr,b);J(f,bOa,!0);if(this.e6){var g=
L5b(this.e6);g.IYa.insertOnlineImage=!0;J(f,hOa,g)}L.ia("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.Eoa().wN(Box4Intl.Box4Strings.l_ImageUploading,!0,!1);c=this.Fa.jb(this.uX,2,f,null)}u(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",a.length,32===c,""===b)}catch(h){u(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",h.toString())}}};
function vne(a,b){this.r5=a;this.tKa=b}
vne.prototype={r5:null,tKa:null,af:function(a){var b=this;this.r5.af({mode:"open",select:"multi",lightbox:"white"},function(c,d){b.OGa(c,d,a)})},OGa:function(a,b,c){u(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.files&&0<b.data.files.length?(a=this.tKa.ou(window.frames[0].parent,window.document.URL),c.s1c(b,a,c.Ymf||(c.Ymf=Function.createDelegate(c,c.Rhe)))):u(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}};
function wne(a,b,c){this.nra=Function.createDelegate(this,this.lua);this.r5=a;this.tKa=c;var d=this;this.xQ=new (ga.$$(Ec.$$(Hc)))(function(){return new (cX.$$(Hc))(b.Aa(),d.nra)})}
wne.prototype={r5:null,tKa:null,gga:null,lo:null,xQ:null,Fib:function(){this.gga||(dX(this.xQ.Aa(),"InsertFromOneDrive",!0),this.lo&&this.lo.tP&&this.lo.tP.length&&(this.gga=this.iTc(this.lo.tP)));return this.gga},iTc:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},lua:function(a){this.lo||3!==a.Ah()||(this.lo=a)},af:function(a){if(!this.Fib())if(F.uta&&F.uta.length)this.gga=F.uta;else{u(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.lo);return}var b=new xne;b.Z4c();var c=b.mTc();if(c){var d=this,e=this;this.r5.af(function(c,e){b.Cd();d.OGa(c,e,a)},function(){e.gYc(b)},c,this.gga)}else u(26071186,352,10,"Picker container is null, will not show picker.")},gYc:function(a){a.Cd();u(26071187,352,50,"User cancelled to insert picture from onedrive.")},OGa:function(a,b,c){u(26071188,352,
50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.value&&0<b.data.value.length?(a=this.tKa.ou(window.frames[0].parent,window.document.URL),c.s1c(b,a,c.Zmf||(c.Zmf=Function.createDelegate(c,c.She)))):u(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}};function xne(){xne.initializeBase(this,[!1,!1,!1,!1])}
xne.prototype={Z4c:function(){this.uFb="FilePickerDialog";this.Hp="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this._id="PickerDialog-Livebooks";this.$s("",null)},mTc:function(){return document.getElementById("OpenFilePickerDiv")},gE:function(){},Cea:function(){}};function yne(){}
yne.prototype={Ea:null,Xb:function(){return"Box4.Media"},wc:function(a){this.Ea=a;if(P().K(99)){C(D(lc(a.ma(G9,null),Yme)),function(){return new G9});Boolean.parse(ye(L).InsertOnlinePictureEnabled||"false");L.ia("OneNoteInsertOneDriveFileIsEnabled");Efe();if(Boolean.parse(ye(L).OneNoteInsertOneDriveFileIsEnabled||"false")){var b=mc(Fc.$$(Hc),kc(a,Fc.$$(Hc)));C(D(lc(a.ma(wne,null),Qme)),function(){return new wne(a.H(Ohe,null),new (ga.$$(Fc.$$(Hc)))(function(){return ab(b)}),a.H(E9,null))})}else C(D(lc(a.ma(vne,
null),Qme)),function(){return new vne(a.H(Khe,null),a.H(E9,null))});C(D(lc(a.ma(kne,null),Wme)),function(){return new kne(a.H(E9,null),a.H(H9,null),a.H(Ci,null))});C(D(lc(a.ma(mne,null),Xme)),function(){return new mne(a.H(lne,null))});C(D(a.ma(lne,null)),function(){return new lne(new (ga.$$(tc))(function(){var a;Efe()?(a=B().H(Yme,null).rX,a=new cne(a.contentWindow,"*")):a=F.xUc;return a}),Efe()?$m(window.document.URL):$m(F.dva),ye(L).ImageFetcherSupportedExtensions)});D(lc(a.ma(dne,null),E9));D(a.ma(H9,
null));C(D(a.ma(J9,null)),function(){return new J9(Zf(),a.H(H9,null),a.H(lIa,null))});C(D(a.ma(I9,null)),function(){return new I9(Zf())});u(526516305,324,15,"Box4.Media configured due to InsertOnlineMedia being enabled")}},ub:function(){},ha:function(){}};pRd.registerClass("Box4.Media.OnlineMediaSearchResult");bne.registerClass("Box4.Media.InsertMediaCrossDocumentMessenger",vic,Ume,rfa,Sys.IDisposable);cne.registerClass("Box4.Media.InsertMediaFromOneDriveCrossDocumentMessenger",vic,tc,rfa,Sys.IDisposable);
dne.registerClass("Box4.Media.InsertMediaCrossDocumentMessengerFactory",null,E9);ene.registerClass("Box4.Media.InsertMediaDialog",om,Vme,Sys.IDisposable);kne.registerClass("Box4.Media.InsertMediaDialogFactory",null,Wme);lne.registerClass("Box4.Media.InsertMediaFromHostManager",null,Vme,Sys.IDisposable);mne.registerClass("Box4.Media.InsertMediaFromHostManagerFactory",null,Xme,Wme);G9.registerClass("Box4.Media.InsertMediaFromHostOneDriveHostFrame",null,Yme);
H9.registerClass("Box4.Media.InsertMediaHelper",null,Pme);sne.registerClass("Box4.Media.InsertMediaSettingsManager");tne.registerClass("Box4.Media.InsertOneDriveFileHandler",null,Tme);I9.registerClass("Box4.Media.InsertOneDriveFileHelper",tne,Sme,Tme);une.registerClass("Box4.Media.InsertOnlineImageHandler",null,Tme);J9.registerClass("Box4.Media.InsertOnlineImageHelper",une,Sme,Tme);vne.registerClass("Box4.Media.OneDriveFilePickerHelperV5",null,Qme);
wne.registerClass("Box4.Media.OneDriveFilePickerHelperV7",null,Rme,Qme);xne.registerClass("Box4.Media.PickerDialog",om,Zme);(function(){}).registerClass("Box4.Media.Program");yne.registerClass("Box4.Media.MediaPackage",null,yo,ec);(function(){}).registerClass("Box4.Media.InsertMediaDialogHtml");(function(){}).registerClass("Box4.Media.InsertMediaM365DialogHtml");var one=/<iframe\s(.*\s)*src=[\"|'](.*?)[\"|'].*\/(iframe)?>/im,fne="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
zo(gj(),new yne,0,!1);Type.registerNamespace("Common.App.AccessibilityChecker");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.AEa=w.Ca.AEa||{};function IVd(){}function JVd(){}w.Ca.AEa.j8a=function(){};w.Ca.AEa.j8a.prototype={error:0,warning:1,tip:2,intelligentService:3};w.Ca.AEa.j8a.registerEnum("Common.App.AccessibilityChecker.AccessibilityRuleCategory",!1);function KVd(){}KVd.registerInterface("Common.App.AccessibilityChecker.IAccessibilityCheckManager");function LVd(){}LVd.registerInterface("Common.App.AccessibilityChecker.IAccessibilityCheckPane");
function MVd(){}MVd.registerInterface("Common.App.AccessibilityChecker.IAccessibilityCheckService");function NVd(){}NVd.registerInterface("Common.App.AccessibilityChecker.IAccessibilityCheckStringsProvider");function OVd(){}OVd.prototype={AccessibilityRules:null,IsPartialResult:!1,IsSuccess:!1,Results:null};
function PVd(a,b,c){this.N1e=Function.createDelegate(this,this.eN);this.dispose=this.ha;this.oec=null;this.wHb=this.Xcd=!1;this.mta=a;this.aEb=b;this.Fa=c;this.Pq().ya(1895329487,2147483648,this.N1e)}
PVd.prototype={mta:null,aEb:null,Xcd:!1,oec:null,Fa:null,wHb:!1,Pq:function(){return this.Fa||(this.Fa=Zf())},nYc:function(){tb(19969184,200,50,"{0}",{AccCheckInvoked:1});var a=this.aEb,b=new kO(new QVd,a.wdf,a.vdf,null,0,null,null,2);a.Cf.Vb(b)},Lq:function(a,b,c){if(1===c)return Xj().Vfa?8:32;this.mta.lf()||this.Xcd||(this.mta.Qd(this),this.aEb.Qd(this),this.Xcd=!0);vEc(this);return 32},eN:function(a,b,c){1!==c&&this.mta.yB();return 32},j_c:function(){RVd(this.mta,!0)},E5b:function(a){if(a){if(a.AccessibilityRules&&
Object.keys(a.AccessibilityRules).length){var b=a.AccessibilityRules,c;for(c in b){var d={key:c,value:b[c]},e=d.value.RuleId+"";d.key!==e&&tb(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",d.key,e)}this.oec=b}else!this.oec&&a.Results&&0<a.Results.length?(tb(18993251,200,15,"No accessibility rule definitions available"),a.IsSuccess=!1):a.AccessibilityRules=this.oec;a.IsSuccess||tb(19969185,200,50,"{0}",{accCheckFailed:1});b=a.AccessibilityRules;if(c=a.Results)for(d=
c.length-1;0<=d;d--){var e=c[d],f="",g=e.RuleId;e.ContentName||(f+="Result does not have content name. ");g in b||(f+=String.format("No accessibility check rule exists for ID {0}.",g));0<f.length&&(tb(36214999,200,15,"Omitting invalid accessibility check result: "+f),Array.removeAt(c,d))}c={};var b={},e=a.Results,d=[],h;Array.add(d,(h=new eb,h.name="FinalViolationCount",h.int64=0,h));var k;Array.add(d,(k=new eb,k.name="FinalErrorCount",k.string="0",k));var l;Array.add(d,(l=new eb,l.name="FinalWarningCount",
l.string="0",l));var m;Array.add(d,(m=new eb,m.name="FinalTipCount",m.string="0",m));var n;Array.add(d,(n=new eb,n.name="FinalIntelligentServiceCount",n.string="0",n));if(e){h=e.length;for(k=0;k<h;++k)if(l=e[k],a.AccessibilityRules&&(m=a.AccessibilityRules[l.RuleId]))c[w.Ca.AEa.j8a.toString(m.Category)]?(n=c[w.Ca.AEa.j8a.toString(m.Category)],c[w.Ca.AEa.j8a.toString(m.Category)]=++n):c[w.Ca.AEa.j8a.toString(m.Category)]=1,b[l.RuleId]?(n=b[l.RuleId],b[l.RuleId]=++n):b[l.RuleId]=1;d[0].int64=e.length;
for(var r in c)switch(h={key:r,value:c[r]},k=h.key,k="Final"+k.charAt(0).toUpperCase()+k.substring(1,k.length)+"Count",k){case "FinalErrorCount":d[1].string=h.value.toString();break;case "FinalWarningCount":d[2].string=h.value.toString();break;case "FinalTipCount":d[3].string=h.value.toString();break;case "FinalIntelligentServiceCount":d[4].string=h.value.toString()}}var t;window.Otel.Telemetry.$_((t=new fb,t.name=String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),t.dataFields=
d,t));for(var v in b){r={key:v,value:b[v]};t=[];var x;Array.add(t,(x=new eb,x.name="RuleID",x.string=r.key,x));var y;Array.add(t,(y=new eb,y.name="FinalViolationCount",y.string=r.value.toString(),y));var z;window.Otel.Telemetry.$_((z=new fb,z.name=String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),z.dataFields=t,z))}this.mta.E5b(a)}},ha:function(){this.mta&&this.mta.dispose();this.aEb&&this.aEb.dispose()}};
function vEc(a){a.wHb?a.mta.Lq():(L.ia("DynamicBundlesIsEnabled")?window.appResourceLoader.loadChunk("accessibility-checker-pane-strings"):B().H(Cc,null).Rp.Ni("accessibility-checker-pane-strings")).then(function(){a.wHb=!0;a.mta.Lq()}).catch(function(a){return u(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",a)})}function SVd(a){this.dispose=this.ha;this.Evg=a}SVd.prototype={$va:null,Evg:null,Qd:function(a){this.$va=a}};function TVd(){}TVd.prototype={};
function UVd(a,b){this.nja=Function.createDelegate(this,this.rea);this.Aq=Function.createDelegate(this,this.oz);this.dispose=this.ha;this.Bk=b;this.uf=a}
UVd.prototype={_element:null,lh:function(){this._element||(this._element=this.ISa(),this.nv());return this._element},Bk:null,uf:null,ha:function(){this.lh()&&(this.YW(),this._element=null)},nv:function(){this.Bk&&this.uf?(this.Bk.Wa("click",this.lh(),this.Aq),this.uf.Wa("keydown",this.lh(),this.nja)):vb(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.lh().id))},YW:function(){this.Bk&&this.uf&&(this.Bk.Sb("click",this.lh(),
this.Aq),this.uf.Sb("keydown",this.lh(),this.nja))},oz:function(){this.Bgd();return!0},rea:function(a){a=a.xb.keyCode;return 32===a||13===a?(this.Bgd(),!0):!1}};function VVd(a,b,c){VVd.resolveInheritance();this.dispose=this.ha;VVd.initializeBase(this,[a,b]);this.Bgd=c}
VVd.prototype={Bgd:null,ISa:function(){var a=ZSd("div",this.sHe(),"AccCheckerNotification");Wf(a,"aria-atomic","true");Wf(a,"aria-labelledby",this.iod());a.tabIndex=0;var b=ZSd("span",this.rHe(),"AccCheckerNotificationIcon"),c=Zj(16,16,"Info_16x16x32","","");b.appendChild(c);c=ZSd("span",this.iod(),"AccCheckerNotificationText");IV(c,this.tHe());a.appendChild(b);a.appendChild(c);return a}};
function WVd(a,b,c,d,e,f,g){this.B3e=Function.createDelegate(this,this.yLf);this.A3e=Function.createDelegate(this,this.xLf);Function.createDelegate(this,this.WYf);Function.createDelegate(this,this.x8b);Function.createDelegate(this,this.iee);this.dispose=this.ha;this.uf=d;this.Bk=a;this.Wd=b;this.xy=c;this.hoa=g||new TVd;this.mkc=e||new XVd(this.Woc(),this.Bk,this.A3e,this.hoa);this.Bkc=f||new YVd(this.Woc(),this.Bk,this.B3e,this.hoa)}
WVd.prototype={$va:null,Bk:null,xy:null,Wd:null,uf:null,hoa:null,mkc:null,Bkc:null,KBe:null,Woc:function(){return this.uf||(this.uf=G().pB)},yB:function(){},ha:function(){},pHa:function(){},iee:function(a){var b=this.KBe[a];a=b.S$d;if((b=b.Qje+"")&&b.length){var c=[],d;Array.add(c,(d=new eb,d.name="RuleID",d.string=b,d));var e;window.Otel.Telemetry.$_((e=new fb,e.name=String.format("{0}.{1}","Office.UX.AccChecker","ViolationSelected"),e.dataFields=c,e))}a&&ZVd(this.$va,a)||(xi(this.Wd,"AccessibilityCheckerPane",
!1),$Vd(this))},WYf:function(){this.yB();this.Wd.Qf(this.Wd.kP,!1)},xLf:function(){RVd(this,!1);this.pHa()},yLf:function(){this.Akc=!1;aWd(this);this.pHa()},q0f:function(){window.Otel.Telemetry.aFf();var a;window.Otel.Telemetry.$_((a=new fb,a.name=String.format("{0}.{1}","Office.UX.AccChecker","ShowTaskpane"),a))}};
function $Vd(a){var b,c=(b=new Dj(!0),b.Bv=F.A9,Ej(b,1),b.$sa=!1,b);c.B0=1;Fj(c,1,CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton);Fj(c,0,CommonUIStrings.l_DialogCancel);lp(c,CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle,CommonUIStrings.l_AccCheckerContentNotFoundDialogBody,function(b){1===b&&a.x8b()})}function bWd(){}bWd.prototype={S$d:null,Qje:null};function XVd(a,b,c,d){XVd.initializeBase(this,[a,b,c]);this.hoa=d}
XVd.prototype={hoa:null,sHe:function(){return"AccCheckerOutOfSyncNotificationId"},rHe:function(){return"AccCheckerOutOfSyncNotificationIconId"},iod:function(){return"AccCheckerOutOfSyncNotificationTextId"},tHe:function(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}};function YVd(a,b,c,d){YVd.initializeBase(this,[a,b,c]);this.hoa=d}
YVd.prototype={hoa:null,sHe:function(){return"AccCheckerPartialResultNotificationId"},rHe:function(){return"AccCheckerPartialResultNotificationIconId"},iod:function(){return"AccCheckerPartialResultNotificationTextId"},tHe:function(){return CommonUIStrings.l_AccCheckerPartialResultNotification}};
function cWd(a,b,c,d,e,f,g,h,k){this.Tkd=!!G()&&!!G().rb()&&G().rb().tib();cWd.initializeBase(this,[b,c,d,f,null,null,h]);this.Kec=e;k&&(this.kfa=k.WFe,this.Sad=k.JGe,this.bcd=k.WHe);this.sga=new (xAa.$$(dWd))}
cWd.prototype={sga:null,Fne:null,Blc:!1,Klc:!1,lkc:!1,Akc:!1,jBe:!1,Ild:null,Kec:null,kfa:null,Sad:null,bcd:0,kXa:null,lf:function(){return this.jBe},iB:function(a){return this.jBe=a},E5b:function(a){if(a){this.Fne=a;if(a.IsSuccess){var b=null;if(a.Results&&0<a.Results.length)for(var b={},c=0,d=a.Results,e=d.length,f=0;f<e;++f){var g=d[f];g.ResultId="AccCheckResult"+ ++c;var h=new bWd;h.S$d=g.ContentId;h.Qje=g.RuleId;b[g.ResultId]=h}this.KBe=b;a.IsPartialResult&&(this.Akc=!0,aWd(this))}this.Blc=!0;
this.Klc=!1;aWd(this)}},Lq:function(){if(!this.Klc){var a=this;window.Common.UISurfaces.rw().then(function(b){Ke(te(),"AccessibilityCheckerPane:PaneOpen:Start");b.showTaskPane("AccessibilityCheckerPane",a.Dka());a.x8b();return null})}this.lf()?window.Common.UISurfaces.rw().then(function(a){a.setSelectedTaskPane("AccessibilityCheckerPane",2);return null}):WVd.prototype.q0f.call(this)},Dka:function(){var a=new dWd;NSd(this.sga,a);var b,c=this,d=this,a=(b=new Im,b.title=CommonUIStrings.l_AccCheckerPaneTitle,
b.hideHeader=!1,b.width=320,b.location=2,b.contentProps=a,b.onOpen=function(){c.Wd.Qf("AccessibilityCheckerPane",!1);c.iB(!0);G().Tf(!1)},b.onClose=function(){d.hcc();d.iB(!1);d.Blc=!1;d.Klc=!1;aWd(d);G().Tf(!1)},b.isModernPane=!0,b);this.Tkd&&(a.enableResize=!0,a.minResizeWidth=268,a.maxResizeWidth=920);return a},Qd:function(a){var b=this.Wd.$c("AccessibilityCheckerPane");b.ic="main";b.wK=!0;this.$va=a;this.sga.eX.ga(eWd(this));this.sga.eX.ga(fWd(this));this.sga.eX.ga(gWd(this));this.sga.eX.ga(hWd(this));
this.sga.eX.ga(iWd(this));this.sga.eX.ga(jWd(this));this.sga.eX.ga(kWd(this));this.sga.eX.ga(lWd(this));a=this.P4c();this.sga.eX.ga(a)},ha:function(){this.mkc&&(this.mkc.dispose(),this.mkc=null);this.Bkc&&(this.Bkc.dispose(),this.Bkc=null);WVd.prototype.ha.call(this)},P4c:function(){var a=this;return function(b){b.showHelpPane=function(){L&&L.my("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?!apa&&a.Kec&&a.Kec.Aa()?wEc(a):a.kXa?a.kXa():a.kfa.Aa()&&a.Sad&&a.bcd&&a.kfa.Aa().jb(a.bcd,2,
a.Sad,null):a.Kec&&a.Kec.Aa()?wEc(a):a.kXa?a.kXa():a.kfa.Aa()&&a.Sad&&a.bcd&&a.kfa.Aa().jb(a.bcd,2,a.Sad,null)}}},x8b:function(){this.Akc=this.lkc=this.Blc=!1;this.Ild&&this.Ild();aWd(this);this.Klc=!0;this.$va.nYc()},hcc:function(){this.fWc()&&this.Wd.Qf(this.Wd.kP,!1)},fWc:function(){return!!this.Wd.kf()&&"AccessibilityCheckerPane"===this.Wd.kf().Nd}};function wEc(a){if(a=a.Kec.Aa()){var b,c=(b=new cEc,b.QIc={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"},b);a.hog("FA000000012",c,!1)}}
function lWd(a){return function(b){b.updateLastScanTime=function(b){a.Ild=b}}}function kWd(a){return function(b){b.partialResult=a.Akc}}function jWd(a){return function(b){b.outOfSync=a.lkc}}function iWd(a){return function(b){b.helpLink=a.xIe}}function hWd(a){return function(b){b.onInvokeNavigateExecute=function(b){a.iee(b)}}}function gWd(a){return function(b){b.resultsReady=a.Blc}}function fWd(a){return function(b){b.accessibilityCheckResultCollection=a.Fne}}
function eWd(a){return function(b){b.onRecheckExecute=function(){a.x8b()}}}function aWd(a){window.Common.UISurfaces.rw().then(function(b){b.updateTaskPane("AccessibilityCheckerPane",a.Dka());return null})}function RVd(a,b){a.lf()&&b!==a.lkc&&(a.lkc=b,aWd(a))}function mWd(a,b,c){this.WFe=a;this.JGe=b;this.WHe=c}mWd.prototype={WFe:null,JGe:null,WHe:0};function dWd(){}
dWd.prototype={type:"AccCheckerTaskPaneProps",onRecheckExecute:null,accessibilityCheckResultCollection:null,resultsReady:!1,onInvokeNavigateExecute:null,helpLink:null,outOfSync:!1,partialResult:!1,updateLastScanTime:null,showHelpPane:null};IVd.registerClass("Common.App.AccessibilityChecker.AccessibilityCheckResult");JVd.registerClass("Common.App.AccessibilityChecker.AccessibilityCheckRule");OVd.registerClass("Common.App.AccessibilityChecker.AccessibilityCheckResultCollection");
PVd.registerClass("Common.App.AccessibilityChecker.AAccessibilityCheckManager",null,KVd,Sys.IDisposable);SVd.registerClass("Common.App.AccessibilityChecker.AAccessibilityCheckService",null,MVd,Sys.IDisposable);TVd.registerClass("Common.App.AccessibilityChecker.AccessibilityCheckStringsProvider",null,NVd);UVd.registerClass("Common.App.AccessibilityChecker.AInteractivePaneElement",null,Sys.IDisposable);VVd.registerClass("Common.App.AccessibilityChecker.APopupNotification",UVd,Sys.IDisposable);
WVd.registerClass("Common.App.AccessibilityChecker.BaseAccessibilityCheckPane",null,LVd,Sys.IDisposable);bWd.registerClass("Common.App.AccessibilityChecker.BaseAccessibilityCheckPane.ResultIds");XVd.registerClass("Common.App.AccessibilityChecker.OutOfSyncNotification",VVd);YVd.registerClass("Common.App.AccessibilityChecker.PartialResultNotification",VVd);cWd.registerClass("Common.App.AccessibilityChecker.ReactAccessibilityCheckPane",WVd);mWd.registerClass("Common.App.AccessibilityChecker.ReactAccessibilityCheckPane.HelpPaneProperties");
dWd.registerClass("Common.App.AccessibilityChecker.ReactAccessibilityCheckPane.AccCheckerTaskPaneProps");Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function sde(){}sde.registerInterface("PowerPointWebEditor.IImageDescriptionPane");function tde(){}tde.registerInterface("PowerPointWebEditor.IImageDescriptionBarView");function ude(a,b,c,d){this.dz=a;this.WEc=b;this.RVd=c;this.yTd=d}ude.prototype={dz:null,RVd:!1,WEc:!1,yTd:null};ude.registerClass("PowerPointWebEditor.ImageDescriptionCache");
Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function AWd(a,b,c,d,e,f,g,h,k){this.Xof=Function.createDelegate(this,this.Yfg);this.X0e=Function.createDelegate(this,this.NHf);this.JNd=Function.createDelegate(this,this.Tig);this.dispose=this.ha;this.fa=a;this.ka=b;this.yIe=c;this.zIe=d;this.bpa=e;this.wo=g;this.rqa=f;this.Ia=h;this.qc=k;this.rqa.qa.Ka("AccCheckRuleInfoListLoaded",this.JNd)}
AWd.prototype={fa:null,ka:null,yIe:null,zIe:null,bpa:null,wo:null,rqa:null,Ia:null,qc:null,Wb:function(){this.ka.YDa&&(this.fa.ua(2295549531,1,this.X0e,4),this.fa.ua(3297627577,1,this.Xof,97))},Of:function(){this.ka.YDa&&this.Ia.$c("main").kb(ag(118,Il()|1),2295549531)},NHf:function(a,b,c,d,e){return 1===c?this.qc.il()?0<this.zIe.rqa.bjb.length?32:8:8:this.yIe.Lq(a,b,c,d,e)},Yfg:function(a,b,c,d,e){e.On=this.bpa.lf();return 32},ha:function(){this.rqa.qa.eb("AccCheckRuleInfoListLoaded",this.JNd)},
Tig:function(){this.wo.CB()}};Type.registerNamespace("PowerPointWebEditor.Accessibility");M.HNc=M.HNc||{};function BWd(){}BWd.registerInterface("PowerPointWebEditor.Accessibility.IPptAccCheckService");function CWd(a,b,c,d,e,f,g,h,k){this.lBc=Function.createDelegate(this,this.c_c);this.D4a=Function.createDelegate(this,this.MXc);CWd.initializeBase(this,[a,b,null]);this.Ia=c;this.ob=d;this.Ul=e;this.yR=f;this.ra=g;this.pa=h;this.Mb=k;this.Kxc=!1}
CWd.prototype={Ia:null,ob:null,Ul:null,yR:null,ra:null,pa:null,Mb:null,vBa:null,U2a:null,Kxc:!1,nYc:function(){this.Kxc=!1;PVd.prototype.nYc.call(this)},j_c:function(){this.Kxc=!0;PVd.prototype.j_c.call(this)},MXc:function(){zR(this.Ul,this.D4a);this.vBa||(this.vBa=new Si(2,1,0,this.lBc,90,"20",!1,0),this.ob.Vb(this.vBa))},c_c:function(){this.vBa=null;DWd(this)},ne:function(){mx(this.yR).Ho()||this.Ia.ne()}};
function DWd(a){if(a.U2a){var b=window.$$as(tQ,Fy(a.U2a,mx(a.yR).Eb()));b?b.Hv()?R(19227931,334,50,"Shape view element of node {0} has been disposed",a.U2a.Ta()):b.XB()?GHb(b):a.pa.Hl(a.U2a,!0,!0):R(19227933,334,50,"Try select node {0} but cannot find its shape view element",a.U2a.Ta());a.ne();a.U2a=null}}
function ZVd(a,b){if(!b)return R(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(b.sldIdField){var c,d=new zJ((c=new Ob,c.Sid=b.sldIdField.sidField,c.Cid=b.sldIdField.cidField,c));c=FO(a.Mb,d);if(!c)return!1;d=null;if(b.spIdFieldSpecified&&(d=c.JF(b.spIdField),!d&&a.Kxc))return!1;b=d;c&&(d=a.ra.Ma()!==c?!0:!1,b&&(a.U2a=b,d?aR(a.Ul,a.D4a):DWd(a)),d&&a.yR.pC(c),uR(a.pa),a.Ia.ne())}else R(19227929,334,15,"There is no slide id info in violation data");return!0}
AWd.registerClass("PowerPointWebEditor.AccCheckActor",null,J2,Sys.IDisposable);CWd.registerClass("PowerPointWebEditor.Accessibility.PptAccCheckManager",PVd);Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function K9(){}K9.registerInterface("PowerPointWebEditor.IDesignerContext");function Mne(){}Mne.registerInterface("PowerPointWebEditor.IRenderSuggestionsArgs");function Nne(){}Nne.registerInterface("PowerPointWebEditor.IDesignerViewHelper");function One(){}One.registerInterface("PowerPointWebEditor.IFixItContext");
Type.registerNamespace("PowerPointWebEditor.Designer");M.owb=M.owb||{};function Pne(){}Pne.registerInterface("PowerPointWebEditor.Designer.IDesignerPreviewImageView");function Qne(){}Qne.registerInterface("PowerPointWebEditor.Designer.IImageToTablePane");function Rne(){}Rne.registerInterface("PowerPointWebEditor.Designer.IImageToTablePaneMessenger");function Sne(a){this.cHf=a;this.mFa=[]}Sne.prototype={cHf:0,mFa:null};function Tne(){}Tne.prototype={ZRd:null,M3d:null,tTd:null,gh:0,Wu:0,WG:0};
function Une(){}Une.prototype={aZd:null,bZd:null,JXd:0,IXd:0};function Vne(){}Vne.prototype={PW:null,RCb:0,BCb:0,Jfe:null,Image:null};function Wne(a){Wne.initializeBase(this);this.Mo=a}Wne.prototype={Mo:null};Type.registerNamespace("PowerPointWebEditor.Infrared");M.jz=M.jz||{};M.jz.Rde=function(){};M.jz.Rde.prototype={};M.jz.Rde.registerEnum("PowerPointWebEditor.Infrared.IdeasCardType",!1);M.jz.Qde=function(){};M.jz.Qde.prototype={};
M.jz.Qde.registerEnum("PowerPointWebEditor.Infrared.IdeasCardAction",!1);function DRd(){}DRd.registerInterface("PowerPointWebEditor.Infrared.IIdeasContext");(function(){}).registerClass("PowerPointWebEditor.Designer.ImageToTableResponse");(function(){}).registerClass("PowerPointWebEditor.Designer.MessageEventArgs");(function(){}).registerClass("PowerPointWebEditor.Designer.ImageToTablePaneMessage");Sne.registerClass("PowerPointWebEditor.Designer.BucketedEditorData");Tne.registerClass("PowerPointWebEditor.Designer.ImageToTableALv2ResponseWrapper");
Une.registerClass("PowerPointWebEditor.Designer.ImageLocationInfo");Vne.registerClass("PowerPointWebEditor.Designer.ImageToTableTile");Wne.registerClass("PowerPointWebEditor.Designer.ImageToTablePaneMessageReceivedArgs",Sys.EventArgs);Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};
function vde(a,b,c,d,e,f,g,h,k,l,m,n){this.yra=Function.createDelegate(this,this.vUa);this.OLd=Function.createDelegate(this,this.Aag);this.DGd=Function.createDelegate(this,this.JOf);this.MFd=Function.createDelegate(this,this.DFf);this.LFd=Function.createDelegate(this,this.CFf);this.G4a=Function.createDelegate(this,this.b5f);this.bXb=Function.createDelegate(this,this.xvb);this.lja=Function.createDelegate(this,this.ITa);this.WNd=Function.createDelegate(this,this.glg);this.Uvd=new (Wb.$$(String,Number))(0);
this.yy=!!G()&&!!G().rb()&&G().rb().JE();this.dispose=this.ha;this.Eg=a;this.Fb=b;this.Dc=c;this.Ia=l;this.Cf=d;this.Yc=e;this.wb=f;this.uq=g;this.EO=h;this.Cb=k;this.ppa=m;this.vr=n;this.zb=document.createElement("div");this.zb.className="ImageDescriptionPane";this.zb.id="ImageDescriptionPane";this.zb.style.position="absolute";this.zb.setAttribute("role","region");this.zb.setAttribute("aria-labelledby","ImageDescriptionPaneLabel");this.Yc.Wa("click",this.zb,this.WNd);this.EO.Ka(this.zb,"keydown",
this.lja);this.mc=!1;this.Gpa=iM();this.Gpa.className="ImageDescriptionPaneLayoutRoot";this.Io=this.Tvb("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.Io,"ImageDescriptionPaneCloseButton");this.Io.setAttribute("role","button");this.Gpa.appendChild(this.Io);this.Yc.Wa("click",this.Io,this.bXb);this.EO.Ka(this.Io,"focus",this.G4a);this.Jkb=iM();this.Jkb.id="ImageDescriptionPaneLabel";this.Jkb.className="PaneLabel";this.Jkb.innerText=ResourceStrings.L_ShapeAltText;this.Gpa.appendChild(this.Jkb);
this.ZQb=iM();this.ZQb.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.ZQb.className="ImageDescriptionLabel";this.Gpa.appendChild(this.ZQb);this.YQb=iM();this.YQb.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.YQb.className="ImageDescriptionHint";this.Gpa.appendChild(this.YQb);this.wtc=iM();this.cR=document.createElement("textarea");this.cR.className="AltTextTextArea";this.cR.setAttribute("aria-label",ResourceStrings.L_ShapeAltText);this.cR.tabIndex=0;this.wtc.appendChild(this.cR);
this.Gpa.appendChild(this.wtc);this.Yc.Wa("click",this.cR,this.LFd);this.EO.Ka(this.cR,"keydown",this.MFd);this.EO.Ka(this.cR,"focus",this.G4a);a=jM();a.className="GenerateDescriptionButtonText";a.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;a.setAttribute("Unselectable","on");this.kR=kM();this.kR.className="ImageDescriptionPaneButton cui-ctl";this.kR.setAttribute("role","button");this.kR.tabIndex=0;this.kR.appendChild(a);this.Gpa.appendChild(this.kR);this.Yc.Wa("click",this.kR,this.DGd);
this.EO.Ka(this.kR,"focus",this.G4a);var r=this,t=this;this.uq.wS("EditingImageDescriptionPaneFocus","main",this.zb,function(){r.qN(!0)},function(){t.qN(!1)},!0,null);var v=this,x=this;this.uq.wS("EditingAltTextFocus","main",this.cR,function(){v.mc&&v.Fb.Tf(!1)},function(){x.mc&&(wde(x),x.Fb.Tf(!1))},!0,null);this.ppa.qa.Ka("OnShowHideAltTextPane",this.OLd)}
vde.prototype={Fb:null,Eg:null,Dc:null,Cf:null,Yc:null,wb:null,EO:null,Cb:null,Ia:null,uq:null,ppa:null,zb:null,Gpa:null,Jkb:null,ZQb:null,YQb:null,wtc:null,cR:null,kR:null,va:null,mc:!1,Io:null,fR:0,vr:null,ha:function(){xde(this);this.ppa.qa.eb("OnShowHideAltTextPane",this.OLd);this.Yc.Sb("click",this.zb,this.WNd);this.EO.eb(this.zb,"keydown",this.lja);this.Yc.Sb("click",this.Io,this.bXb);this.EO.eb(this.Io,"focus",this.G4a);this.Yc.Sb("click",this.cR,this.LFd);this.EO.eb(this.cR,"keydown",this.MFd);
this.EO.eb(this.cR,"focus",this.G4a);this.Yc.Sb("click",this.kR,this.DGd);this.EO.eb(this.kR,"focus",this.G4a);this.kR=this.cR=this.wtc=this.YQb=this.ZQb=this.Jkb=null;R(25454224,815,50,"ImageDescriptionPane::Dispose")},MF:function(a,b){var c=b?dM(a,this.$f()):cM(a,this.$f());this.mc&&(b?(Sys.UI.DomElement.addCssClass(this.zb,"ImageDescriptionPaneRTL"),dM(c,1)):(Sys.UI.DomElement.addCssClass(this.zb,"ImageDescriptionPaneLTR"),cM(c,1)));gM(this.zb,c);return a},Zc:function(){return this.zb},aM:function(){return 10},
qN:function(a){this.mc&&(a?this.fR||yde(this):this.fR=0)},DFf:function(a){117===a.keyCode&&a.ctrlKey?this.Fbb():(2!==this.fR&&zde(this),this.fR=2)},ITa:function(a){this.mc&&(13===a.keyCode||32===a.keyCode?1===this.fR?this.eN():3===this.fR?this.Q9a():2===this.fR&&(this.kR.style.display="block"):2===this.fR&&(this.kR.style.display="block"))},Fbb:function(){this.Ia.vz("EditingImageDescriptionPaneFocus")},xvb:function(){this.eN();return!0},eN:function(){this.mc&&(xde(this),DT(this.Ia,"EditingImageDescriptionPaneFocus",
!1),R(25454226,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))},glg:function(){this.mc&&(this.Fbb(),this.fR=0);return!0},CFf:function(){zde(this);this.fR=2;return!0},JOf:function(){this.Fbb();this.Q9a();return!0},Q9a:function(){this.fR=3;this.kR.style.display="none";yde(this);var a=this.va?window.$$as(tQ,Uy(this.va,0)):null;a?(this.Uvd.ga(this.va.Ta().toString(),this.va.Sm()),U4d(this.Cf,this.va.Ta(),a.Jg?a.Jg.S9a():"",this.va.get_isSVGBlipFilled(),
!0)):R(25798609,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.va)},Aag:function(){if(this.mc)xde(this);else{var a;a=this.wb.Tb();!a||1<a.length||!YO(a[0])?(R(25798606,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",!a),a=!1):(this.va=a[0],a=!0);a&&(this.cR.value=this.va.get_alt(),this.zb.appendChild(this.Gpa),LO(this.va)?this.kR.style.display="none":this.kR.style.display="block",this.mc=!0,this.zb.style.display="block",
this.yy?(this.q3b(this.zb),this.vr.yN(this,this.mc,ResourceStrings.L_ShapeAltText,"EditingImageDescriptionPaneFocus")):this.Fb.np(),uz(this.wb,this.yra),R(25454222,815,50,"ImageDescriptionPane::InitializeAndShow"));this.fR=0}DT(this.Ia,"EditingImageDescriptionPaneFocus",this.mc);R(25454228,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.mc)},vUa:function(){xde(this);Gl(this.Eg,"EditingImageDescriptionPaneFocus")},b5f:function(a){this.mc&&(a.target===this.Io?this.fR=1:a.target===this.cR?this.fR=
2:a.target===this.kR&&(this.fR=3))},q3b:function(a){Di?Sys.UI.DomElement.addCssClass(a,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(a,"ImageDescriptionPaneLTR")},Tvb:function(a,b){return this.Svb(a,"cui-img-16by16","cui-ctl-iconContainer",b,CommonUIStrings.l_DialogClose,null)},Svb:function(a,b,c,d,e,f){var g=VL();g.alt=e;g.className=ck(a,d);g.src=this.Dc.Lk(a+".png");g.setAttribute("Unselectable","on");a=jM();a.className=b+" cui-img-cont-float";a.appendChild(g);b=jM();b.className=c;b.setAttribute("Unselectable",
"on");b.appendChild(a);c=kM();c.className="ImageDescriptionPaneNoBorderButton cui-ctl";c.title=e;c.setAttribute("role","button");c.tabIndex=0;c.appendChild(b);f&&(e=jM(),e.className="cui-ctl-mediumlabel",e.setAttribute("Unselectable","on"),e.innerText=f,c.appendChild(e));return c},$f:function(){return this.mc?264+PS:0}};function wde(a){var b=a.cR.value;if(b!==a.va.get_alt()){var c=a.Cb.Ue(15,0);c.Jc(a.va);Y1b(a.va,!1);a.va.set_alt(b);c.dispose()}}
function xde(a){a.mc&&(SC(a.wb,a.yra),wde(a),a.mc=!1,a.zb.removeChild(a.Gpa),a.zb.style.display="none",a.yy?(a.q3b(a.zb),a.vr.yN(a,a.mc,ResourceStrings.L_ShapeAltText,"EditingImageDescriptionPaneFocus")):a.Fb.np(),R(25454230,815,50,"ImageDescriptionPane::CleanUpAndHide"))}function zde(a){a.Ia.vz("EditingAltTextFocus")}function yde(a){if(vl(a.Io)){a.Fbb();a.fR=1;return}R(33609551,815,50,"Fail to set focus on close button")}
function Ade(a,b,c,d,e,f,g,h){this.ehf=Function.createDelegate(this,this.B6f);this.E3e=Function.createDelegate(this,this.FLf);this.yra=Function.createDelegate(this,this.vUa);this.WY=new zL;this.dB=new zL;this.dispose=this.ha;this.va=a;this.ob=b;this.Dc=c;this.ka=d;this.fa=e;this.Yc=f;this.wb=g;this.Vz=h}
Ade.prototype={va:null,ob:null,Dc:null,ka:null,fa:null,Yc:null,wb:null,Vz:null,Bd:1,aBd:null,Xn:null,Ep:!1,Krc:null,$Ne:"",q7:!1,cAa:!1,Raa:null,Sjb:null,bAa:null,LMa:null,MMa:null,j3a:null,ita:!1,Mm:function(a){this.j3a=a.Ja;this.Raa=new EL;this.bAa=new TL;this.bAa.Rea("ImageDescriptionBarBackground");this.Yc.Wa("click",this.bAa.Ja,this.ehf);this.Sjb=new RL;this.Sjb.jf(this.bAa);this.LMa=new dyb;GL(this.LMa,"ImageDescriptionBarText");this.LMa.Ja.style.fontSize=qG(this.Vz,29);this.MMa=new EL;GL(this.MMa,
"ImageDescriptionBarTextWrappingDiv");this.MMa.jf(this.LMa);this.Raa.jf(this.Sjb);this.Raa.jf(this.MMa)},QC:function(a){if(this.q7&&!this.Ep)switch(a){case 1:a=this.Dc.Lk("formatpainterobject.cur");this.bAa.Wl(lM(a,"pointer"));break;case 0:this.bAa.Wl("pointer")}},$w:function(){return null},xB:function(){return!1},hx:function(a){this.Ep=a},ha:function(){Bde(this);this.Raa&&(this.MMa=this.LMa=this.Sjb=this.bAa=this.Raa=null)},ez:function(){},dx:function(){return null},MC:function(){return[]},uB:function(){this.q7&&
Cde(this,!0)},rj:function(){return this.cAa},hf:function(a){if(!this.q7)return a;this.cAa!==a&&(this.cAa=a,this.Raa.Gf(this.cAa));this.cAa||Bde(this);return a},te:function(){},$j:function(a){this.Bd=a;this.q7&&(Dde(this),this.LMa.Ja.style.fontSize=qG(this.Vz,29))},pq:function(a){this.WY=a;this.q7&&Dde(this)},uu:function(a){this.dB=a;this.q7&&Dde(this)},vs:function(a){this.q7&&this.Raa.eE(a)},ry:function(a,b){this.q7&&(Cde(this,!a&&b||!b),a||this.ob.MW(this.Krc,this.ka.lMc))},Hd:function(){},B6f:function(){this.fa.Ab(3296909722,
2,null);return!0},vUa:function(){Bde(this)},FLf:function(){Bde(this)},W3:function(a){return"rotate("+a.toString()+"deg)"}};function Ede(a){a=window.parseFloat(a);return window.isNaN(a)?0:a}
function Dde(a){if(a.q7&&a.Xn){var b=a.Xn.Lh();a.WY.Fn(b);a.dB.Fn(b);a.aBd=Ah(QJ(b.K(0),b.K(1)));var c=sJ(b,new uJ(6)),d=sJ(b,new uJ(4)),b=sJ(b,new uJ(2)),b=PJ(d,b)*a.Bd,d=PJ(c,d)*a.Bd;if(60>d||80>b)a.cAa=!1;else{b=a.j3a.children[0].style;a.Sjb.te(Ede(b.left),Ede(b.top));a.Sjb.vi(Ede(b.width),Ede(b.height));var e=kA(a.Vz,mg(40,1),1);a.MMa.te(c.x*a.Bd,c.y*a.Bd-e);a.MMa.vi(d,e);a.MMa.Ja.style.transform=a.W3(a.aBd);a.LMa.vi(d-9,e-6);var f=new zL;BL(f,a.aBd,new pJ(0,e));CL(f,c.x*a.Bd-Ede(b.left),c.y*
a.Bd-Ede(b.top)-e);a.bAa.QF(f,1);a.bAa.vi(d,e)}}}function Bde(a){a.q7&&(a.q7=!1,a.cAa=!1,SC(a.wb,a.yra),a.ita&&(a.ob.ih(a.Krc),a.ita=!1),a.j3a&&a.j3a.contains(a.Raa.Ja)&&a.j3a.removeChild(a.Raa.Ja))}function Cde(a,b){a.Xn=a.va.Hz();a.cAa=b;Dde(a);a.Raa.Gf(a.cAa);a.ita||(a.ita=!0,a.ob.Vb(a.Krc))}function Fde(a,b){var c=b.indexOf("\n");a.$Ne=-1===c?b:b.substring(0,c);a.LMa.Ja.textContent=ResourceStrings.L_ShapeAltText+": "+a.$Ne;Cde(a,!0)}
function Gde(a,b,c,d,e,f,g,h,k,l,m){this.JJd=Function.createDelegate(this,this.A6f);this.cKd=Function.createDelegate(this,this.u7f);this.V4a=Function.createDelegate(this,this.A_c);this.xr=Function.createDelegate(this,this.Tj);this.N6=new (Wb.$$(Km,ude))(null);this.dispose=this.ha;this.Lb=a;this.Cf=b;this.Ul=g;this.ppa=c;this.wb=d;this.kM=f;this.aOe=e;this.Bp=h;this.Cb=k;this.jc=l;this.vtc=m}
Gde.prototype={Lb:null,Cf:null,ppa:null,wb:null,aOe:null,kM:null,Ul:null,Bp:null,Cb:null,jc:null,vtc:null,Qd:function(){iH(this.Bp,this.xr);this.Ul.qa.Ka("SIFD",this.V4a);this.Ul.qa.Ka("LID",this.cKd);this.ppa.qa.Ka("OnImageDescriptionReady",this.JJd)},ha:function(){hH(this.Bp,this.xr);this.Ul.qa.eb("SIFD",this.V4a);this.Ul.qa.eb("LID",this.cKd);this.ppa.qa.eb("OnImageDescriptionReady",this.JJd)},Tj:function(a,b){(a=b.xc)&&YO(a)&&(b=b.oh,b===lWa?((b=window.$$as(tQ,Uy(a,this.Lb.Eb())))&&KQ(b)&&a.get_alt()&&
(b=WU(this.vtc,a),b.va===a&&b.q7&&Fde(b,b.va.get_alt())),b=this.aOe,b.va&&a===b.va&&b.mc&&(b.Uvd.hc(a.Ta().toString())&&b.va.Sm()!==b.Uvd.K(a.Ta().toString())&&R(33609549,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),2!==b.fR&&(b.cR.value=b.va.get_alt())),a.get_alt()&&Hde(this,a,a.get_alt())):b===Tt?a.ta(String,Tt,"")&&(b=window.$$as(tQ,Uy(a,this.Lb.Eb())))&&KQ(b)&&(b=WU(this.vtc,a),b.hf(!1)):b===Zt&&-2!==a.Sm()&&(b=window.$$as(tQ,Uy(a,
this.Lb.Eb())))&&KQ(b)&&!a.yib()&&this.N6.K(a.Ta())&&this.N6.K(a.Ta()).WEc&&(this.Q9a(a,b),this.N6.Mc(a.Ta())))},A6f:function(a,b){if(a=b.fde){var c=b.Fvb,d=b.Y7b,e=b.Cee,f=b.pbe,g=(b=fU(this.kM,a))?window.$$as(tQ,Uy(b,this.Lb.Eb())):null;f?g&&KQ(g)&&!LO(b)&&!b.ta(String,Tt,"")?this.Q9a(b,g):this.N6.ga(a,new ude(b,!0,!0,d)):!d||!e&&60>c?R(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",e,c):(d+=String.fromCharCode(10,10),d=80<=c?d+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:
60<=c?d+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=c?d+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=c?d+ResourceStrings.L_ImageDescriptionWithLowConfidence:d+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence,e?Ide(this,b,d,!1):(R(34194368,815,50,"Image description ready for show and save"),g&&KQ(g)?(R(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",a.toString(),(new Date).getTime()),Hde(this,b,d),LO(b)?this.N6.ga(a,new ude(b,!1,
!1,d)):(R(34194372,815,50,"Save image description immediately"),Ide(this,b,d,!0))):this.N6.ga(a,new ude(b,!1,!0,d))))}else R(33609503,815,15,"Graph node id is null")},A_c:function(a,b){a=b.rFc;R(34194374,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",a?a.toString():"",(new Date).getTime());this.N6.hc(a)?Jde(this,a):(a=fU(this.kM,a))&&a.get_alt()&&Hde(this,a,a.get_alt())},u7f:function(a,b){(a=b.h6d)&&this.N6.hc(a.Ta())&&Jde(this,a.Ta())},Q9a:function(a,b){U4d(this.Cf,a.Ta(),b.Jg?b.Jg.S9a():
"",a.get_isSVGBlipFilled(),!1)}};
function Hde(a,b,c){if(YO(b)){a.jc.$d(b)&&R(34079445,815,50,"Graph node or parents blocked");var d=a.wb.Tb();d&&uN(a.wb,b)?(R(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",b.Ta().toString(),(new Date).getTime()),a=WU(a.vtc,b),a.Raa&&a.j3a&&(a.q7=!0,a.j3a.appendChild(a.Raa.Ja),uz(a.wb,a.yra),a.Krc=new Si(3,1,a.ka.lMc,a.E3e,90,"19",!1,0),Fde(a,c))):R(33609543,815,50,"Is selected shapes empty: {0}",!d)}else R(33609541,815,50,"ShapeNode.IsPicture: {0}",
YO(b))}function Ide(a,b,c,d){if(!d||!b.get_alt()){var e=a.Cb.Ue(d?7:15,0);e.Jc(b);Y1b(b,d);b.set_alt(ph(c));e.dispose();d&&a.Cf.FC()}}function Jde(a,b){var c=a.N6.K(b).dz;if(c){var d=a.N6.K(b).WEc,e=a.N6.K(b).RVd,f=a.N6.K(b).yTd;d?(d=window.$$as(tQ,Uy(c,a.Lb.Eb())))&&a.Q9a(c,d):(e&&Hde(a,c,f),LO(c)?R(33609539,815,15,"Try to save alt text for local picture"):Ide(a,c,f,!0));a.N6.Mc(b)}else R(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}Type.registerNamespace("PowerPointWebEditor.ImageDescription");
M.Y7b=M.Y7b||{};function Kde(){this.yy=!!G()&&!!G().rb()&&G().rb().JE()}
Kde.prototype={J:null,Xb:function(){return"PowerPointWebEditor.ImageDescription"},wc:function(a){this.J=a;var b=this;C(D(this.J.ma(fR.$$(tde),null)),function(){return new (lR.$$(tde))(function(c){var d=null,g=window.$$as(tQ,Uy(c,a.H(Yv,null).Eb()));g&&!g.Hv()&&(d=new Ade(c,b.J.H(Dd,null),b.J.H(sK,null),b.J.H(T,null),b.J.H(dd,null),b.J.H(xd,null),b.J.H(UM,null),b.J.H(Yv,null).Ve()),d.Mm(g.$r),TQ(g,d,4));return d})});var c=this;C(D(this.J.ma(sde,null)),function(){return new vde(c.J.H(ud,null),c.J.H(iu,
null),c.J.H(sK,null),c.J.H(i2,null),c.J.H(xd,null),c.J.H(UM,null),c.J.H(ZR,null),c.J.H(fK,null),c.J.H(BN,null),c.J.H(cL,null),c.J.H(jbd,null),c.J.H(sL,null))});var d=this;C(D(this.J.ma(Gde,null)),function(){return new Gde(d.J.H($R,null),d.J.H(i2,null),d.J.H(jbd,null),d.J.H(UM,null),d.J.H(sde,null),d.J.H(SN,null),d.J.H(iR,null),iA(d.J.H(Ow,null),10),d.J.H(BN,null),d.J.H(mQ,null),d.J.H(fR.$$(tde),null))})},ub:function(){this.J.H(T,null).Lja&&(this.yy||this.J.H(JR,null).xC(this.J.H(sde,null)),this.J.H(Gde,
null).Qd())},ha:function(){this.J.H(T,null).Lja&&this.J.H(Gde,null).ha()}};vde.registerClass("PowerPointWebEditor.ImageDescriptionPane",null,sde,rL,Sys.IDisposable);Ade.registerClass("PowerPointWebEditor.ImageDescriptionBarView",null,tde,sQ,YK,Sys.IDisposable);Gde.registerClass("PowerPointWebEditor.ImageDescriptionManager",null,Sys.IDisposable);Kde.registerClass("PowerPointWebEditor.ImageDescription.PPTWebEditorImageDescriptionPackage",null,yo,ec);zo(gj(),e7(new Kde,0),0,!1);Type.registerNamespace("PowerPointWebEditor");
M=window.PowerPointWebEditor||{};function EWd(){this.Ecf=Function.createDelegate(this,this.Z_f)}
EWd.prototype={J:null,HOb:null,Xb:function(){return"PowerPointWebEditor.LazyActors"},wc:function(a){this.J=a},ub:function(){var a=this;mPb(this.J.H(AM,null),function(){a.x$a()})},x$a:function(){var a=this.J.H(F,null).ud.za,b=this.J.H(dd,null);a.YDa&&(this.HOb=new AWd(b,a,this.J.H(KVd,null),this.J.H(BWd,null),this.J.H(YR,null),this.J.H(hO,null),this.J.H(b2,null),this.J.H(cL,null),this.J.H(WM,null)),this.HOb.Wb(),this.HOb.Of());a.TXd&&Je(window.Common.App.AppLifecycleManager.get_instance(),7,this.Ecf,
3)},Z_f:function(){var a=Ni("internal.hermes"+RU(this.J.H(wS,null)),1),a=mU(this.J.H(rS,null),a);nk(a)},ha:function(){this.HOb&&this.HOb.ha()}};EWd.registerClass("PowerPointWebEditor.PptLazyActorsPackage",null,yo,ec);zo(gj(),new EWd,0,!1);Type.registerNamespace("PowerPointWebEditor.PresentToTeams");M=window.PowerPointWebEditor||{};M.nfg=M.nfg||{};function xEc(){}
xEc.prototype={Xb:function(){return"PowerPointWebEditor.PresentToTeams"},J:null,wc:function(a){this.J=a},ub:function(){var a=this;L.Nf(function(){(new yEc(a.J.H(dd,null),a.J.H(iu,null),a.J.H(T,null),a.J.H(cL,null),a.J.H(sK,null),a.J.H(UM,null),a.J.H(jv,null),a.J.H(j2,null),a.J.H(K2,null),a.J.H(vS,null),mc(Zc,kc(B(),Zc)))).Wb()})},ha:function(){}};
function yEc(a,b,c,d,e,f,g,h,k,l,m){this.Ypb=Function.createDelegate(this,this.kBb);this.$Ca=Function.createDelegate(this,this.nfg);this.fa=a;this.Fb=b;this.ka=c;this.Ia=d;this.Dc=e;this.pa=f;this.pk=g;this.$v=h;this.Fp=k;this.Gj=l;this.kV=m}
yEc.prototype={fa:null,Fb:null,ka:null,Ia:null,Dc:null,pa:null,pk:null,$v:null,Fp:null,Gj:null,djb:0,kV:null,Wb:function(){this.fa.ua(455397214,1,this.$Ca,4);this.fa.ua(3640090982,1,this.$Ca,4);this.fa.ua(1609144644,1,this.$Ca,4);if(this.ka.hLc&&this.Dc.u1()){var a=this;this.kV.CW(function(){ab(a.kV).Jn("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled",null)})}},$s:function(){var a=new Dj;Ej(a,4);Fj(a,1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);Fj(a,2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);
tm(a,ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,this.Ypb,null)},kBb:function(a){1!==a&&a?2===a&&(u(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.fa.Ab(1609144644,2,null)):(u(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.aHa())},aHa:function(){this.fa.jb(2054778433,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"},null)},nfg:function(a,b,c){if(!this.Dc.u1())return u(523084879,838,10,"PresentToTeamsActor: Document not supported"),
8;if(1===c)return 32;this.djb=a;if(0<this.pk.HQ)return this.Ia.ne(),(a=Lne(this))?32:8;xR(this.pa);this.Ia.ne();if(1609144644===a||1===this.Fb.Ic())return(a=Lne(this))?32:8;var d=this,e=this;M2(this.$v,!0,!0,!0,function(){d.Fp.Cd();Lne(d)},function(){u(523084880,838,15,"PresentToTeamsActor: ForceSave failed");e.Fp.Cd();Lne(e);return!0},1);this.Fp.xf(!1,this.djb);return 32},L_:function(){},K_:function(){}};
function Lne(a){var b;qI(bI);a:{jOb(a.Gj,!0);b=Ae().toString();var c=a.Dc.u1();try{var d,e={},f;if(c){for(var g=/%([0-9A-F]{2})/g,c=window.encodeURIComponent(c),h="",k=0,l;l=g.exec(c);){var m=g.lastIndex-3;m>k&&(h+=c.substring(k,m));h+=xh(window.parseInt("0x"+l[1]));k=g.lastIndex}k<c.length&&(h+=c.substring(k,c.length));f=btoa(h)}else f=null;e.pptSharingUrl=f;var n=window.encodeURIComponent(Id(e));d=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",b,n);u(556541766,838,
50,"actionId: {0}, deepLinkId: {1}",a.djb,b);window.open(d,"_top")}catch(r){u(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",r);b=!1;break a}b=!0}a.$s();return b}xEc.registerClass("PowerPointWebEditor.PresentToTeams.PPTWebEditorPresentToTeamsPackage",null,yo,ec);yEc.registerClass("PowerPointWebEditor.PresentToTeams.PresentToTeamsActor",null,ed);(function(){}).registerClass("PowerPointWebEditor.PresentToTeams.PresentToTeamsHelper");zo(gj(),new xEc,0,!1);Type.registerNamespace("PowerPointWebEditor.Accessibility");
M=window.PowerPointWebEditor||{};M.HNc=M.HNc||{};function QVd(){QVd.initializeBase(this)}QVd.prototype={yk:function(){return 56}};function GWd(){GWd.initializeBase(this)}GWd.prototype={ACResult:null};function HWd(a,b){this.vdf=Function.createDelegate(this,this.Z1f);this.wdf=Function.createDelegate(this,this.$1f);this.dispose=this.ha;HWd.initializeBase(this,[null]);this.Cf=a;this.rqa=b}
HWd.prototype={Cf:null,rqa:null,ha:function(){},$1f:function(a){if(a&&a.ACResult){a:{if(a=a.ACResult){var b=null;try{b=JSON.parse(a)}catch(n){R(19227939,334,10,"Cannot parse acc-check result json: {0}",n.toString());a=null;break a}if(b){a=new OVd;a.IsSuccess=!0;a.IsPartialResult=b.isPartialResultField;a.AccessibilityRules={};if(b.violatedRulesField){for(var c=new (Ca.$$(IVd)),b=b.violatedRulesField,d=b.length,e=0;e<d;++e){var f=b[e],g;if(g=f)if(g.ruleIdField>=this.rqa.bjb.length)R(19227971,334,10,
"Rule id {0} is bigger than total rule info list count {1}",g.ruleIdField,this.rqa.bjb.length),g=null;else{var h=new JVd;h.RuleId=g.ruleIdField.toString();h.RuleName=this.rqa.bjb[g.ruleIdField].ruleTextField;switch(this.rqa.bjb[g.ruleIdField].ruleTypeField){case 0:h.Category=0;break;case 1:h.Category=1;break;case 2:h.Category=2;break;case 3:h.Category=3}g=h}else g=null;if(g){a.AccessibilityRules[g.RuleId]=g;for(var f=f.violationsField,h=f.length,k=0;k<h;++k){var l=f[k],m=new IVd;m.RuleId=g.RuleId;
m.ContentName=l.labelField;m.ContentId=l;c.ga(m)}}}a.Results=c.Jd()}break a}}a=null}if(a){this.$va.E5b(a);R(19227935,334,50,"Acc-check succeeded");return}}IWd(this,"Succeeded but response is invalid")},Z1f:function(a){IWd(this,a.toString());return!0}};function IWd(a,b){R(19227937,334,50,String.format("Acc-check failed: {0}",b));b=new OVd;b.IsSuccess=!1;a.$va.E5b(b)}function JWd(){}
JWd.prototype={J:null,Xb:function(){return"PowerPointWebEditor.Accessibility"},wc:function(a){this.J=a;var b=this;C(D(lc(lc(this.J.ma(HWd,null),BWd),MVd)),function(){return new HWd(b.J.H(i2,null),b.J.H(hO,null))});var c=this;C(D(this.J.ma(LVd,null)),function(){return new KWd(c.J.H(YR,null),c.J.H(xd,null),c.J.H(wd,null),c.J.H(ud,null),c.J.H(T,null).z1d,c.J.H(sL,null),ic(c.J,dd),c.J.H(b2,null))});var d=this;C(D(this.J.ma(KVd,null)),function(){return new CWd(d.J.H(LVd,null),d.J.H(MVd,null),d.J.H(cL,
null),d.J.H(Dd,null),d.J.H(iR,null),d.J.H(tS,null),d.J.H(GN,null),d.J.H(UM,null),d.J.H(WM,null))})},ub:function(){},ha:function(){this.J.H(T,null).YDa&&(this.J.H(MVd,null).dispose(),this.J.H(LVd,null).dispose(),this.J.H(KVd,null).dispose())}};
function KWd(a,b,c,d,e,f,g,h){var k={};k.W9=ResourceStrings.L_Help;k.AP="FA000000012";k.AW={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};KWd.initializeBase(this,[null,b,c,d,null,null,null,null,new mWd(g,k,2123786558)]);this.wmb=a;this.xIe=e;this.vr=f;this.iyd=g;this.wo=h}
KWd.prototype={wmb:null,xIe:null,vr:null,iyd:null,wo:null,lf:function(){return!!this.wmb&&this.wmb.lf()},iB:function(a){this.wmb&&this.wmb.iB(a);return a},Lq:function(){this.iB(!0);this.vr.yN(this.wmb,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,"AccessibilityCheckerPane");cWd.prototype.Lq.call(this);if(this.iyd){var a=this.iyd.Aa();if(a){a.Ab(906344264,1,null);a=!1;try{zwc("AccessibleAuthoring"),a=!0}catch(b){R(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",
b.toString())}De("AccessibleAuthoringTab",a,0,null)}else R(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else R(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")},j$b:function(){},Bla:function(){},zGa:function(){this.$va&&this.$va.j_c()}};QVd.registerClass("PowerPointWebEditor.Accessibility.AccCheckRequest",aq);
GWd.registerClass("PowerPointWebEditor.Accessibility.AccCheckResponse",window.PowerPointWebEditor.APPTServerResponse);HWd.registerClass("PowerPointWebEditor.Accessibility.PptAccCheckService",SVd,BWd,MVd,Sys.IDisposable);JWd.registerClass("PowerPointWebEditor.Accessibility.PptAccessibilityPackage",null,yo,ec);KWd.registerClass("PowerPointWebEditor.Accessibility.PptReactAccCheckControl",cWd,LH);zo(gj(),new JWd,0,!1);Type.registerNamespace("PowerPointLive");R3=window.PowerPointLive||{};
window.PowerPointLive.SessionCurrentState=R3.lmg=function(){};R3.lmg.prototype={};window.PowerPointLive.SessionCurrentState.registerEnum("PowerPointLive.SessionCurrentState",!1);window.PowerPointLive.ILiveSessionURL=R3.wXf=function(){};R3.wXf.prototype={participantUrl:null,sessionQRCode:null};window.PowerPointLive.ILiveSessionState=R3.vXf=function(){};R3.vXf.prototype={isPrivate:!1,isPaused:!1,participantsCount:0,sessionURLPromise:null,sessionCurrentState:0};
window.PowerPointLive.ILiveActorSettings=R3.tXf=function(){};
R3.tXf.prototype={hostElement:null,welcomeScreenBackgroundImageUrl:null,welcomeScreenErrorImageUrl:null,baseZIndex:0,urlBarHeightInPercentage:0,welcomeScreenLayerHostId:null,calloutContainerId:null,urlBarLayerHostId:null,dialogLayerHostId:null,reactionsBarLayerHostId:null,showTryAgainButton:!1,isPowerpointLiveReactionEnabled:!1,onboardingScreenHostId:null,resourceCDNPath:null,enablePrefetchLiveResource:!1,enableNewLiveWelcomeScreen:!1,userSessionId:null,podsUrl:null};
window.PowerPointLive.ILiveReaction=R3.uXf=function(){};R3.uXf.prototype={react:null,reactionCount:0,reactionImagePath:null,numberOfAnimationFrames:0};function Xne(){}Xne.prototype={TTe:null,UTe:null};
function Yne(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.qef=Function.createDelegate(this,this.k3f);this.sef=Function.createDelegate(this,this.m3f);this.HAc=Function.createDelegate(this,this.eYc);this.enf=Function.createDelegate(this,this.$dg);this.yJd=Function.createDelegate(this,this.S5f);this.vpb=Function.createDelegate(this,this.CZc);this.rMd=Function.createDelegate(this,this.vbg);this.Mpb=Function.createDelegate(this,this.J_c);this.Sif=Function.createDelegate(this,this.D8f);this.PKd=Function.createDelegate(this,
this.X8f);this.LMd=Function.createDelegate(this,this.jcg);this.cMd=Function.createDelegate(this,this.Zag);this.e2e=Function.createDelegate(this,this.rJf);this.ldf=Function.createDelegate(this,this.z1f);this.SCa=Function.createDelegate(this,this.mUa);this.bMd=Function.createDelegate(this,this.Yag);this.aMd=Function.createDelegate(this,this.Wag);this.Apb=Function.createDelegate(this,this.sAb);this.i3=Function.createDelegate(this,this.uUa);this.qa=new re;this.qSb=this.Plb=-1;this.aDd=new window.Set;
this.$Cd=new window.Map;this.Dc=d;this.ka=a;this.tQb=!1;this.Xa=c;this.qc=f;this.Cl=g;this.uc=h;this.gu=k;this.Ya=l;this.Nc=m;this.Yj=n;this.$pa=r;this.Ia=t;if(this.tr=b)this.mha=b.wB();this.eI=e;this.VGe()?this.zaa=1:this.zaa=0;this.ka.C8&&(this.Prd=new Zne(this.ka));nK(this.uc,this.i3);this.gu.qa.Ka("PODSU",this.Apb);L9(this)&&this.Yj.pb(function(a){a.xf(ResourceStrings.L_LivePresentations_Disconnected,Q3.hab);a.Cd()});R(51459524,833,50,"LivePresenter: Host auth type is: "+this.ka.yZ)}
Yne.prototype={ka:null,tr:null,uc:null,gu:null,Ya:null,Nc:null,Yj:null,tQb:!1,l1a:!1,m1a:!1,zsc:!1,okb:!1,pAa:!1,Asc:!0,eud:!0,sQb:!0,Xa:null,Dc:null,$pa:null,nnb:!1,KTb:!1,Sn:null,mha:null,Ij:null,yq:null,eI:null,zaa:0,Kmb:30,lY:null,Eia:null,Rd:null,sxc:0,vxc:0,tZe:0,eWe:0,cMa:null,Zoa:null,TOb:null,N0a:0,Yxd:0,p4a:null,Suc:null,KSb:1,Prd:null,qc:null,Cl:null,MDd:null,gra:null,Hc:null,YKe:null,pSb:null,Ia:null,pr:function(){return this.ka.C8&&this.Asc},Tq:function(){return!!this.yq},vPa:function(a){return this.tQb=
a},c_e:function(a){return this.l1a=a},DLa:function(){return!!this.yq&&this.yq.isPaused},oWb:function(a){return this.sQb=a},yAg:function(){return this.m1a&&this.pr()&&!!this.Sn},nzc:function(a){return this.zaa=a},VGe:function(){return"true"===$ne("wdDisablePrivateSession")?!1:"aad"===this.ka.yZ},UGe:function(){return this.pr()&&this.Tq()&&this.Ij?this.Ij.isWelcomeScreenVisible():!1},I9a:function(){return this.ka.RGc&&this.ka.Lsb&&Lee(this.Nc)?this.Nc.Dud?this.KTb=!0:this.Nc.Hsc||this.KTb:!0},K_c:function(a,
b,c,d,e,f,g,h,k){if(this.pr()){this.Xa.BMb(this.aMd);this.Xa.CMb(this.bMd);this.Xa.Ihb(this.SCa);this.okb=!1;this.pAa=!0;try{this.ka.Xsb&&aoe(this);var l=boe(this,e,d);if(this.Sn)(this.l1a||this.DLa())&&this.Sn.FetchDocumentDownloadURL(l);else{R(42869313,833,50,"Creating Broadcast monitor ...");var m=new window.PowerPointLive.PPTBroadcastMonitorSettings;m.isBlueChicken=this.ka.UQa;m.fileDownloadUrl=l;m.rendezvousSvcBaseUri=this.ka.XJc;m.broadcastSubtitlesFromSpeechFrontDoor=!0;m.pragueInitTimeoutInMS=
this.ka.Y1d;m.preferredSubtitleLanguage=eod(this.Nc);m.useStateService=this.ka.g2d;m.numMaxAttempts=this.ka.a2d;m.delayInSecsToCloseBroadcasterOnPause=this.ka.U1d;m.batchedRequestsEnabled=this.ka.R1d;m.sharedSessionSettings={};m.websocketAliveTimeAfterLoseFocusInMs=this.ka.h2d;m.pingTimeoutInMs=this.ka.Z1d;m.pongTimeoutInMs=this.ka.$1d;m.enableTransientSessionHandling=this.ka.b_d;m.maxStateServiceRoundtripRaw=L.fd("PPTLiveMaxStateServiceRoundtripRaw",300);m.sharedSessionSettings.MaxStateServiceRoundtripRaw=
m.maxStateServiceRoundtripRaw;if(this.ka.ZZd){var n=this;m.documentSnapshotRequestUrlGenerator=function(){return boe(n,n.Ya.Hc,n.Ya.el)}}else m.documentSnapshotRequestUrlGenerator=null;this.ka.BKc&&(m.sharedSessionSettings.IsAutomation=!0);this.Sn=new window.PowerPointLive.PPTBroadcastMonitor(m);var r=this;this.Sn.RegisterParticipantsCountChangeEventListener(function(a){r.Rd.telemetryData.maxParticipantCount=Math.max(r.Rd.telemetryData.maxParticipantCount,a);r.Ij&&r.Ij.setParticipantCount(a);r.qa.Ha("ParticipantsCountChanged",
Sys.EventArgs.Empty,null)});this.Sn.RegisterNewReactionEventListener(this.ldf);this.Sn.RegisterConnectionStateEventListener(this.e2e)}this.Sn.SetCurrentPosition(a,b-1,null);this.N0a=a;if(this.l1a&&!this.yq&&k){var t=!!G()&&G().rb().ro();this.XCb(t?1:2,g,c,e,h);coe(this,a);this.Zoa=new window.Set}else this.lY&&doe(this);this.Zoa&&this.Zoa.add(a)}catch(v){R(42869315,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",v.toString())}}},Xag:function(){if(this.pr()&&(this.Xa.dzc(this.aMd),
this.Xa.ezc(this.bMd),this.Xa.WVb(this.SCa),this.pAa=this.okb=!1,this.Tq()&&this.Ij)){this.Ij.hideAll();if(!eoe(this)&&(foe(this),!this.lY&&this.tr&&!F.mg&&this.yq.sessionCurrentState)){var a=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Kmb.toString()),a=new JW(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,a,null);LW(a,!0);MW(a,this.HAc);a.pK(3);KW(a,ResourceStrings.l_LiveBusinessBarButton_ResumeSession,this.sef,"",!1);Ucc(a,ResourceStrings.l_LiveBusinessBarButton_EndSession,
this.qef);this.tr.VQ().xk(a,!1,null,null,null);this.tr.np();this.lY=a}L9(this)&&this.Yj.Da().Cd()}},XCb:function(a,b,c,d,e){this.MDd=b;this.gra=c;this.Hc=d;this.YKe=e;this.vxc=this.NI();this.sxc=this.NI();var f=$ne("wdSetLiveSessionId"),f="rdvSession_"+(f.length?f:Ae().toString());this.Rd=new window.PowerPointLive.LiveSessionTelemetry;this.Rd.telemetryData.sessionId=f;this.Rd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Rd.telemetryData.accessControl=R3.GNc.toString(this.zaa);
this.Rd.telemetryData.sessionEntryPoint=R3.wWc.toString(a);this.Rd.telemetryData.isSubtitleStartedByLive=this.tQb;this.Rd.telemetryData.isAutomation=this.ka.BKc;this.Rd.telemetryData.correlationId=Ae().toString();M9(this,"StartLiveBroadcasting");try{if(this.pr()&&this.Sn&&goe(this)&&!this.yq){try{!this.pSb&&(this.ka.l1b&&!hoe()||this.ka.Msb)&&(this.pSb=wZ(B())("liveActorLazy"))}catch(k){R(592541262,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Rd.telemetryData.sessionId,
k.toString())}this.Xa.t_a(this.yJd);this.Xa.V9a();if(this.ka.l1b&&!hoe()&&this.Ij&&this.pSb){var g=this;this.pSb.then(function(){g.Ij.showOnboardingScreen();Be("PPTLivePresentationOnboarded",(!0).toString(),365)||R(593373381,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",(!0).toString())})}var h=this;ioe(this,b,c,d,e,f,function(){return zEc(h,"StartLiveBroadcasting",h.Rd.telemetryData.sessionId)})}else this.Rd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),
R(50648476,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!");a="";N3.isInstanceOfType(this.Xa)&&(a=window.$$as(N3,this.Xa).kca);this.Rd.telemetryData.isMordernSlideShow=!!this.Xa&&this.Xa.gGa()&&""===a}catch(k){this.Rd.telemetryData.SetErrorCode(4,k.toString()),R(593842909,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Rd.telemetryData.sessionId,k.toString())}finally{M9(this,"StartLiveBroadcasting")}},
Mwb:function(a){if(this.pr()&&this.Tq()&&this.Sn&&goe(this)){joe(this,3);try{var b=this;koe(this,a,function(){b.Rd.telemetryData.sessionExitPoint=R3.xWc.toString(a);b.yq.isPaused||(b.Rd.telemetryData.sessionActiveDurationInMS+=b.NI()-b.sxc);b.lY&&doe(b);loe(b);L9(b)&&b.Yj.Da().Cd();R(42869329,833,50,"SessionId: {0}, Message: End live broadcasting ...",b.Rd.telemetryData.sessionId);b.Ij.actOnSessionEnded();b.Xa.XVb(b.cMd);b.Xa.b4a(b.Mpb);b.Xa.$nb(b.rMd);b.Xa.aob(b.LMd);b.$pa.qa.eb("NCCE",b.vpb);b.Xa.fzc(b.PKd);
b.pAa&&b.Xa.afa(!1,"");b.yq=null;b.TOb=null;b.qa.Ha("OnLiveSessionEnded",Sys.EventArgs.Empty,null);b.ka.Lsb&&Lee(b.Nc)&&(b.nnb=!1,b.KTb=!1);if(3!==a){var c=b.Sn.EndLiveBroadcasting(function(){return zEc(b,"EndLiveBroadcasting",b.Rd.telemetryData.sessionId)});c?c.then(function(){M9(b,"EndLiveBroadcasting");R(42869331,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",b.Rd.telemetryData.sessionId)}).catch(function(a){b.Rd.telemetryData.SetErrorCode(7,a.toString());M9(b,
"EndLiveBroadcasting");R(50452498,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",b.Rd.telemetryData.sessionId,a.toString())}):(b.Rd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),R(42869333,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else b.Sn.CleanUpBroadcastBeforeEnd(),R(594061319,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");
M9(b,"EndLiveBroadcasting")})}catch(c){this.Rd.telemetryData.SetErrorCode(7,""),R(42869335,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Rd.telemetryData.sessionId,c.toString())}finally{3!==a&&this.Edc(),M9(this,"EndLiveBroadcasting")}}},xke:function(){this.pr()&&this.Sn&&this.Sn.SetPresenterState("muted")},yke:function(){this.pr()&&this.Sn&&this.Sn.SetPresenterState("unmuted")},CHa:function(a){this.pr()&&this.Ij&&(this.zsc=!0,this.Ij.showCallout(a))},mle:function(){this.pr()&&
this.Ij&&(this.Ij.showWelcomeScreen(),moe(this))},O4c:function(a,b){this.pr()&&this.Tq()&&this.Ij&&this.Ij.showEndSessionDialogWithCallbacks(a,b)},yva:function(a){if(this.mha&&this.Ij){var b=this;window.setTimeout(function(){vl(b.mha.ownerDocument.getElementById(a))},50)}},mde:function(){this.ka.Lsb&&Lee(this.Nc)&&(L9(this)&&this.nnb&&(this.Yj.Da().Cd(),this.nnb=!1),this.KTb=!0)},Zag:function(){if(this.pr()&&this.Sn)if(this.DLa()){var a=this;window.setTimeout(function(){a.qa.Ha("OnRelaunchPausedSession",
Sys.EventArgs.Empty,null)},500);noe(this)}else this.yq&&this.Ij&&this.Ij.isWelcomeScreenVisible()&&ooe(this)},J_c:function(a,b){this.pr()&&this.Sn&&(this.Sn.SetCurrentPosition(b.gh,b.Sd,b.$Ra),this.N0a!==b.gh&&poe(this),this.N0a=b.gh,this.Zoa&&(this.cMa&&10>this.KSb&&10*this.Zoa.size>=this.KSb*this.cMa.size&&(joe(this,4),this.KSb+=1),this.Zoa.add(b.gh)),this.ka.Xsb&&qoe(this),a=!!this.cMa&&this.cMa.size>=this.ka.b2d,this.N0a===this.Yxd&&a&&roe(this))},Wag:function(){this.okb=!0;this.pr()&&this.Tq()&&
this.Ij&&(this.Ij.hideURLBar(),soe(this,1),joe(this,1))},Yag:function(){this.okb=!1;this.pr()&&this.Tq()&&this.Ij&&this.Ij.showURLBar()},vbg:function(a,b){this.pr()&&this.Tq()&&this.Sn&&(b.EUd?this.Sn.UpdateFinalSubtitles(b.hNc):this.Sn.UpdatePartialSubtitles(b.hNc))},jcg:function(a,b){this.Rd.telemetryData.transcriberSessionIds+=b.gNc+",";this.pr()&&this.Tq()&&this.Xa.afa(!0,this.Sn.GetPragueSessionInfoJSONString())},$dg:function(){--this.Kmb;0>=this.Kmb?(R(590403653,833,50,"SessionId: {0}, Ending long paused session.",
this.Rd.telemetryData.sessionId),doe(this),this.Mwb(3)):this.lY&&this.lY.lra(String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Kmb.toString()))},eYc:function(a){a===this.lY&&(this.lY=null)},m3f:function(a){a===this.lY&&this.Ij&&(doe(this),eoe(this)||Zf().Ab(1989200744,2,null))},k3f:function(a){a===this.lY&&this.Ij&&(eoe(this)?doe(this):this.Ij.showEndSessionDialog())},D8f:function(){var a=this.NI(),b=window.document.hidden;R(590917781,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",
b?"hidden":"visible",a);b||this.DLa()&&18E5<=a-this.eWe&&doe(this)},NI:function(){return(new Date).getTime()},S5f:function(a,b){this.Xa&&this.Sn&&b&&(this.Xa.rPa(this.yJd),this.Sn.SetCurrentPosition(b.gh,b.Sd,b.$Ra))},mUa:function(a,b){this.Ij&&this.Ij.actOnCurrentSlideDimensionChange(b.Dtb,b.qMc,b.B7a,b.rMc)},VOf:function(){return goe(this)?this.Ij.getCalloutMenuDefinition():null},z1f:function(a){if(this.p4a){var b=this.p4a.has(a.slideId)?this.p4a.get(a.slideId)+1:1;this.p4a.set(a.slideId,b)}if(this.Eia&&
!this.DLa()&&this.eud){for(var b=this.Eia,c=b.length,d=0;d<c;++d){var e=b[d];if(e.react===a.react){e.reactionCount+=1;break}}if(this.Ij){a=Array(this.Eia.length);for(b=0;b<this.Eia.length;b++){var f;a[b]=(f=new window.PowerPointLive.ILiveReaction,f.react=this.Eia[b].react,f.reactionCount=this.Eia[b].reactionCount,f.reactionImagePath=this.Eia[b].reactionImagePath,f.numberOfAnimationFrames=this.Eia[b].numberOfAnimationFrames,f)}this.Ij.setReactions(a)}}},rJf:function(a){if(L9(this))switch(a){case 0:this.pAa&&
this.Yj.Da().xf(ResourceStrings.L_LivePresentations_Disconnected,Q3.vGa);this.Rd.telemetryData.SetErrorCode(3,"");M9(this,"DisconnectdToPrague");break;case 1:this.Yj.Da().Cd();break;case 2:this.pAa&&this.Yj.Da().xf(ResourceStrings.L_LivePresentations_Connecting,Q3.hab);break;default:R(594416918,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Rd.telemetryData.sessionId)}else R(594416920,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Rd.telemetryData.sessionId)},
CZc:function(a,b){L9(this)?b.tca?this.Yj.Da().Cd():this.pAa&&this.Yj.Da().xf(ResourceStrings.L_LivePresentations_InternetDisconnected,Q3.hab):R(594416916,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Rd.telemetryData.sessionId)},uUa:function(){try{if(R(592310413,833,15,"Pods session rehydrated!"),this.Asc=!0,this.pr()&&this.Tq()&&this.Sn){R(51423366,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Rd.telemetryData.sessionId,
this.Ya.el);var a=boe(this,this.Ya.Hc,this.Ya.el);this.Sn.OnPodSessionUpdated(a)}}catch(b){R(51496722,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",b.toString())}},sAb:function(){this.Asc=!1},X8f:function(){this.Asc=!1},Edc:function(){if(this.ka.h_d)try{var a=kc(B(),Zc);a&&(R(594409295,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),a.pb(function(a){a.Jn("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled",null)}))}catch(b){R(594409293,
833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",b)}},vyg:function(a){this.qa.Ka("OnLiveResourcesLoaded",a)},DFg:function(a){this.qa.eb("OnLiveResourcesLoaded",a)},$Fe:function(a){this.qa.Ka("OnLiveSessionStarted",a)},OZe:function(a){this.qa.eb("OnLiveSessionStarted",a)},ZFe:function(a){this.qa.Ka("OnLiveSessionEnded",a)},NZe:function(a){this.qa.eb("OnLiveSessionEnded",a)},syg:function(a){this.qa.Ka("OnCalloutDismissed",a)},AFg:function(a){this.qa.eb("OnCalloutDismissed",
a)},YFe:function(a){this.qa.Ka("OnRelaunchPausedSession",a)},MZe:function(a){this.qa.eb("OnRelaunchPausedSession",a)},tyg:function(a){this.qa.Ka("CalloutMenuDefinitionChanged",a)},BFg:function(a){this.qa.eb("CalloutMenuDefinitionChanged",a)}};function qoe(a){for(var b=GO(a.qc,a.N0a).jn(!1),c=b.length,d=0;d<c;++d){var e=b[d];e.ta(String,H_a,"")&&(e=uoe(e.ta(String,H_a,"")),(e=a.$Cd.get(e))&&a.Sn.SetCurrentPollInfoState(e,a.N0a))}}
function aoe(a){var b;var c=EO(a.qc);if(c&&c.oc()){b=[];for(var c=aH(c),d=0,e=c.Jb(2);e;e=c.Rf(2))b[d++]=window.$$as($M,e)}else b=null;c=1;a.aDd.clear();d=b.length;for(e=0;e<d;++e)for(var f=b[e].jn(!1),g=f.length,h=0;h<g;++h){var k=f[h];if(k.ta(String,H_a,"")){var k=uoe(k.ta(String,H_a,"")),l=new Xne;l.TTe=k;l.UTe=c.toString();a.aDd.add(l);c+=1}}}function uoe(a){var b=document.createElement("a");b.setAttribute("href",a);return(a=b.search.match(/[\?&]Id=([^&#]*)/))&&2===a.length?a[1]:""}
function hoe(){var a=nc("PPTLivePresentationOnboarded");return a?"true"===a.toLowerCase():!1}function koe(a,b,c){try{var d=new (Ca.$$(Promise));if(1===b||2===b||4===b)d.ga(soe(a,3)),d.ga(joe(a,3));d.Qa()?Promise.all(d.Jd()).then(function(){return c()}).catch(function(){return c()}):c()}catch(e){R(594367971,833,10,"failed to create end session task promises, error : {0}",e),c()}}
function boe(a,b,c){b=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",a.ka.zr,b,c);a.ka.f2d&&(b+="&shareable=true");return b}function L9(a){return a.ka.F3&&a.Yj&&a.Yj.Da()?!0:!1}
function joe(a,b){return new Promise(function(c){if(a.pr()&&a.Sn&&a.yq)try{if(1>a.p4a.size)R(595121249,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",a.Rd.telemetryData.sessionId,b),c(!0);else if(2===b&&(!a.Zoa||1>a.Zoa.size))R(595121247,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",a.Rd.telemetryData.sessionId,b),c(!0);else{var d=null,e=0;a.p4a.forEach(function(a,b){a>e&&(d=b.toString(),e=a)});if(a.Suc&&
d===a.Suc)R(592515078,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",a.Rd.telemetryData.sessionId,b),c(!0);else{var f=a.Sn.TriggerSaveThumbnails(function(){return zEc(a,"SaveThumbnails",a.Rd.telemetryData.sessionId)},d);f?f.then(function(){a.Suc=d;R(595121245,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",a.Rd.telemetryData.sessionId,b);c(!0)}).catch(function(d){R(595121243,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",
a.Rd.telemetryData.sessionId,d.toString(),b);c(!1)}):(a.Rd.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),R(595121241,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),c(!1))}}}catch(g){a.Rd.telemetryData.SetErrorCode(15,g.toString()),R(595121239,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",a.Rd.telemetryData.sessionId,g.toString()),c(!1)}else c(!0)})}
function poe(a){if(a.Eia){for(var b=a.Eia,c=b.length,d=0;d<c;++d)b[d].reactionCount=0;a.Ij&&a.Ij.resetReactions()}}
function voe(a){var b=String.format("{0}{1}",a.ka.RDa,"reactions/heart/default/240_anim_f/heart.png"),c=String.format("{0}{1}",a.ka.RDa,"reactions/yes/default/240_anim_f/yes.png"),d=String.format("{0}{1}",a.ka.RDa,"reactions/clap/default/240_anim_f/clap.png"),e=String.format("{0}{1}",a.ka.RDa,"reactions/laugh/default/240_anim_f/laugh.png"),f=String.format("{0}{1}",a.ka.RDa,"reactions/surprised/default/240_anim_f/surprised.png"),g=String.format("{0}{1}",a.ka.RDa,"reactions/wonder/default/240_anim_f/wonder.png"),
h,k,l,m,n,r;a.Eia=[(h=new window.PowerPointLive.ILiveReaction,h.react="yes",h.reactionCount=0,h.reactionImagePath=c,h.numberOfAnimationFrames=40,h),(k=new window.PowerPointLive.ILiveReaction,k.react="heart",k.reactionCount=0,k.reactionImagePath=b,k.numberOfAnimationFrames=16,k),(l=new window.PowerPointLive.ILiveReaction,l.react="clap",l.reactionCount=0,l.reactionImagePath=d,l.numberOfAnimationFrames=40,l),(m=new window.PowerPointLive.ILiveReaction,m.react="laugh",m.reactionCount=0,m.reactionImagePath=
e,m.numberOfAnimationFrames=77,m),(n=new window.PowerPointLive.ILiveReaction,n.react="surprised",n.reactionCount=0,n.reactionImagePath=f,n.numberOfAnimationFrames=68,n),(r=new window.PowerPointLive.ILiveReaction,r.react="wonder",r.reactionCount=0,r.reactionImagePath=g,r.numberOfAnimationFrames=70,r)];a.p4a=new window.Map;a.KSb=1;a.Suc=null}
function soe(a,b){return new Promise(function(c){if(a.pr()&&a.Sn&&a.yq&&a.TOb)try{a.TOb.then(function(d){var e=!1;switch(b){case 2:if(!a.Zoa||!a.cMa||10*a.Zoa.size<8*a.cMa.size){c(!0);return}break;case 3:e=!0}var f={triggeredSurveyType:"Survey.AudienceFeedback"};f.isMandatory=e;f.triggerEventId=Ae().toString();f.surveyeeName=F.l0;d?(f.surveyId=d.surveyId,f.surveyResponseUrl=d.surveyResponseUrl):R(51168984,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",a.Rd.telemetryData.sessionId);
a.Sn.TriggerSurvey(JSON.stringify(f));R(50860052,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",a.Rd.telemetryData.sessionId,b);c(!0)}).catch(function(b){R(51168987,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",a.Rd.telemetryData.sessionId,b.toString());a.Rd.telemetryData.SetErrorCode(13,b.toString());c(!1)})}catch(d){a.Rd.telemetryData.SetErrorCode(17,d.toString()),R(50860054,833,10,
"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",a.Rd.telemetryData.sessionId,d.toString()),c(!1)}else c(!0)})}
function coe(a,b){if(a.qc)try{var c=a.Cl.Ed;if(!c)throw Error.argumentNull("Presentation is null");var d=c.Rj||[];a.Yxd=d[d.length-1].Pc();var e=c=!1;a.cMa=new window.Set;for(var f=d.length,g=0;g<f;++g){var h=d[g];c||h.Pc()!==b||(c=!0,e=h.UL());!c||h.UL()&&!e||a.cMa.add(h.Pc());e&&!h.UL()&&(e=!1)}}catch(k){a.Rd.telemetryData.SetErrorCode(16,k.toString()),R(50860050,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",a.Rd.telemetryData.sessionId,
k.toString())}}
function M9(a,b){a.Rd.telemetryData.action=b;a.Rd.telemetryData.sessionDurationInMS=a.NI()-a.vxc;a.Rd.telemetryData.hostAuthType=a.ka.yZ;a.Rd.SetStateServiceMetrics();a.Rd.telemetryData.errorCode.length&&(!a.Rd.telemetryData.errorMessage.length||0>Array.indexOf(a.ka.AKc,a.Rd.telemetryData.errorMessage))&&(a.Rd.telemetryData.hasUnexpectedError=!0);b=a.ka.XJc.toLowerCase();-1!==b.indexOf("pptservicescast.officeapps.live.com")?a.Rd.telemetryData.rendezvousServiceEnvironment="prod":-1!==b.indexOf("pptservicescast.edog.officeapps.live.com")?
a.Rd.telemetryData.rendezvousServiceEnvironment="edog":-1!==b.indexOf("pptservicescast.officeapps.live-int.com")?a.Rd.telemetryData.rendezvousServiceEnvironment="int":a.Rd.telemetryData.rendezvousServiceEnvironment="dev";R(50706442,833,a.Rd.telemetryData.hasUnexpectedError?15:50,JSON.stringify(a.Rd.telemetryData))}
function woe(a,b,c,d,e,f,g,h,k,l){var m={};m.SessionId=a;m.Action=b;m.HostAuthType=c;m.UseDirectAuth=d;m.IsAnonymousUser=e;m.UiHost=f;m.IsSuccess=g;m.Latency=h;m.ErrorCode=k;m.ErrorMessage=l;R(51197915,833,50,JSON.stringify(m))}
function zEc(a,b,c){return!a.ka.C8||!a.zaa&&a.ka.UQa?new Promise(function(a){a(null)}):"msa"===a.ka.yZ?toe(a,b,c,!1):new Promise(function(d,e){toe(a,b,c,!0).then(function(a){d(a)}).catch(function(){toe(a,b,c,!1).then(function(a){R(592213320,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");d(a)}).catch(function(a){e(a)})})})}
function toe(a,b,c,d){return!a.ka.C8||!a.zaa&&a.ka.UQa?new Promise(function(a){a(null)}):!d&&!a.eI||d&&!a.Prd?(R(50452300,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",b,c,d),new Promise(function(a,b){b("AuthHelperNotSet")})):new Promise(function(e,f){var g=a.ka.yZ,h="";if("aad"===g||a.ka.UQa)h=a.ka.i_d;else if("msa"===g)h=a.ka.f_d;else{R(51512226,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",
b,c);f("HostAuthTypeInvalid");return}var k="true"===L.Va("IsAnonymousUser").toLowerCase(),l=L.Va("UiHost");!l&&(l="Unset");var m=new Date,n=null,n=d?xoe(a.Prd,a.ka.T1d,a.ka.S1d,h,a.ka.d2d,a.ka.W1d&&"StartLiveBroadcasting"===b&&!a.ka.wJc):a.eI.WW(a.ka.c_d,h,null);n.then(function(a){woe(c,b,g,d,k,l,a.IsSuccess,new Date-m,a.ErrorCode,a.ErrorMessage);a.IsSuccess?e(a.Token):f(a.ErrorCode)}).catch(function(a){woe(c,b,g,d,k,l,!1,new Date-m,"exception",a.toString());f("exception")})})}
function doe(a){try{a.tr&&a.lY?(loe(a),a.tr.VQ().$P(a.lY),a.tr.np(),R(590917783,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!a.lY.VQ()),a.lY=null):R(590403649,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!a.tr,!!a.lY)}catch(b){R(590403619,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",b.toString())}}
function eoe(a){var b=6E4*a.ka.g_d;a=0<b?a.NI()-a.vxc>=b:!1;R(590917785,833,50,"LivePresenter::IsSessionStale {0}",a);return a}function loe(a){-1!==a.Plb&&(R(590403655,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",a.Rd.telemetryData.sessionId),window.clearInterval(a.Plb),a.Plb=-1)}function yoe(a){R(590403657,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",a.Rd.telemetryData.sessionId);-1!==a.Plb&&window.clearInterval(a.Plb);a.Kmb=30;a.Plb=window.setInterval(a.enf,6E4)}
function zoe(a){window.clearInterval(a.qSb);a.qSb=-1}function moe(a){a.Ij&&-1===a.qSb&&(a.qSb=window.setInterval(function(){var b=document.getElementById("LiveWelcomeScreenLayerHost"),c=document.getElementById("LiveOnboardingScreenLayerHost"),d=!1;b&&(d=b.contains(document.activeElement));document.activeElement===c||document.activeElement===b||d||ooe(a)},500))}
function ooe(a){a.Ij&&(a.ka.l1b&&!hoe()&&a.Ij.isOnboardingScreenVisible()?a.yva("LiveOnboardingScreenLayerHost"):a.Ij.isWelcomeScreenVisible()?a.yva("LiveWelcomeScreenLayerHost"):(-1!==a.qSb&&zoe(a),a.Xa.uz()))}
function goe(a){if(a.pr()&&!a.Ij&&a.mha){var b=new window.PowerPointLive.ILiveActorSettings;b.hostElement=a.mha;b.baseZIndex=50005;b.welcomeScreenBackgroundImageUrl=a.Dc.Lk("LiveWelcomeScreenBackground.png");b.welcomeScreenErrorImageUrl=a.Dc.Lk("LiveWelcomeScreenError.png");b.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";b.calloutContainerId="LiveCalloutContainer";b.urlBarLayerHostId="LiveURLBarLayerHost";b.dialogLayerHostId="LiveDialogLayerHost";b.reactionsBarLayerHostId="LiveReactionBarLayerHost";
b.showTryAgainButton=!0;b.isPowerpointLiveReactionEnabled=!$H("PPTLive.ReactionToggleInLiveCallout");b.onboardingScreenHostId="LiveOnboardingScreenLayerHost";b.resourceCDNPath=a.ka.RDa;b.enablePrefetchLiveResource=a.ka.Msb;b.enableNewLiveWelcomeScreen=a.ka.Msb;b.userSessionId=a.MDd;b.podsUrl=a.gra;a.Ij=window.liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(b);a.Ij.on("OnWelcomeScreenOpenedAction",function(){a.yva("LiveWelcomeScreenLayerHost");moe(a);a.tZe=Date.now();a.Rd.telemetryData.welcomeShownCount+=
1});a.Ij.on("OnWelcomeScreenClosedAction",function(){a.okb&&a.Ij.hideURLBar();zoe(a);a.Xa.uz();a.Rd.telemetryData.welcomeScreenDurations.push(Date.now()-a.tZe);a.Rd.telemetryData.welcomeScreenFirstTimeDuration=a.Rd.telemetryData.welcomeScreenDurations[0];M9(a,"OnWelcomeScreenClosedAction");a.Sn.SetWelcomeScreenState(!1);a.ka.Xsb&&qoe(a);a.nnb&&L9(a)&&window.setTimeout(function(){a.Yj.Da().Cd();a.nnb=!1},5E3)});a.Ij.on("ResumeSessionAction",function(){noe(a);a.okb||a.Ij.showURLBar()});a.Ij.on("EndSessionAction",
function(){a.Mwb(a.pAa?1:2);a.Xa.uz()});a.Ij.on("OnCalloutOpenedAction",function(){a.zsc=!0;a.qa.Ha("OnCalloutOpened",Sys.EventArgs.Empty,null);a.Rd.telemetryData.calloutShownCount+=1});a.Ij.on("OnCalloutClosedAction",function(){a.zsc=!1;a.qa.Ha("OnCalloutDismissed",Sys.EventArgs.Empty,null);a.Xa.uz()});a.Ij.on("OnEndSessionDialogOpenedAction",function(){a.pAa?a.yva("LiveDialogLayerHost"):(P0b(a.Ia,"PPTLiveEndSessionDialogFocus",document.getElementById("LiveDialogLayerHost")),DT(a.Ia,"PPTLiveEndSessionDialogFocus",
!0))});a.Ij.on("OnEndSessionDialogClosedAction",function(){a.pAa?a.Xa.uz():DT(a.Ia,"PPTLiveEndSessionDialogFocus",!1)});a.Ij.on("OnCalloutMenuDefinitionChangedAction",function(){a.qa.Ha("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty,null)});a.Ij.on("OnTryAgainAction",function(){R(594587674,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",a.Rd.telemetryData.sessionId);a.XCb(5,a.MDd,a.gra,a.Hc,a.YKe)});a.Ij.on("PresenterDisabledReactions",function(){a.eud=!1});a.Ij.on("PresenterEnabledReactions",
function(){a.eud=!0});a.Ij.on("OnOnboardingScreenOpenedAction",function(){a.yva("LiveOnboardingScreenLayerHost");moe(a)});a.Ij.on("OnOnboardingScreenClosedAction",function(){ooe(a)})}return!!a.Ij}function Aoe(a){a.Ij.isWelcomeScreenVisible()||a.yq.isPaused||a.mle();a.yq=null;a.Ij.onSessionRequestError()}
function noe(a){if(a.pr()&&a.Tq()&&a.Sn&&goe(a)&&a.yq.isPaused)try{a.sxc=a.NI(),a.Rd.telemetryData.sessionResumeCount+=1,R(50452492,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",a.Rd.telemetryData.sessionId),poe(a),a.Ij.actOnSessionResumed(),a.Sn.ResumeLiveBroadcasting(function(){return zEc(a,"ResumeLiveBroadcasting",a.Rd.telemetryData.sessionId)}),a.yq.isPaused=!1,a.qa.Ha("OnLiveSessionResumed",Sys.EventArgs.Empty,null),loe(a),a.Xa.afa(!0,a.Sn.GetPragueSessionInfoJSONString())}catch(b){a.Rd.telemetryData.SetErrorCode(6,
b.toString()),R(50452494,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",a.Rd.telemetryData.sessionId,b.toString())}finally{M9(a,"ResumeLiveBroadcasting")}}
function foe(a){if(a.pr()&&a.Tq()&&a.Sn&&goe(a)&&!a.yq.isPaused){soe(a,2);joe(a,2);try{a.Rd.telemetryData.sessionPauseCount+=1,a.Rd.telemetryData.sessionActiveDurationInMS+=a.NI()-a.sxc,R(42869327,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",a.Rd.telemetryData.sessionId),a.Ij.actOnSessionPaused(),a.yq.isPaused=!0,a.eWe=a.NI(),a.Sn.PauseLiveBroadcasting(function(){return zEc(a,"PauseLiveBroadcasting",a.Rd.telemetryData.sessionId)}),a.qa.Ha("OnLiveSessionPaused",Sys.EventArgs.Empty,
null),yoe(a),a.Xa.afa(!1,"")}catch(b){a.Rd.telemetryData.SetErrorCode(5,b.toString()),R(50452490,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",a.Rd.telemetryData.sessionId,b.toString())}finally{M9(a,"PauseLiveBroadcasting")}}}function $ne(a){a=new RegExp(String.format("[\\?&]{0}=([^&#]*)",a));return(a=window.location.search.match(a))&&2===a.length?a[1]:""}
function Boe(a,b){var c=Mee(a.Nc,a.Nc.Oia);c?a.Sn.SetDefaultSubtitlesLanguage(c):R(595140894,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",a.Rd.telemetryData.sessionId);a.Xa.afa(!0,a.Sn.GetPragueSessionInfoJSONString());a.Xa.Xya(a.Mpb);a.Xa.Wnc(a.rMd);a.ka.m1b&&!a.Ij.isWelcomeScreenVisible()||ooe(a);a.qa.Ha("OnLiveSessionStarted",b.sessionInfo,null);a.I9a()||!Lee(a.Nc)||a.Nc.Hsc||a.KTb||!L9(a)||(a.nnb=!0,a.Yj.Da().xf(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
ao(rs).GE()),Q3.hab));a.TOb=a.Sn.CreateSurvey(b.authToken,null,null,null);a.TOb.then(function(b){if(b){var c={};c.surveyeeName=F.l0;c.surveyId=b.surveyId;c.surveyResponseUrl=b.surveyResponseUrl;a.Sn.SetAudienceFeedbackInfo(JSON.stringify(c))}});a.ka.Xsb&&(a.$Cd.clear(),a.aDd.forEach(function(c){try{var e=c.TTe;a.Sn.CreateSurvey(b.authToken,null,e,c.UTe).then(function(b){b?a.$Cd.set(e,b.surveyId):R(556613722,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",a.Rd.telemetryData.sessionId)}).catch(function(c){R(556613723,
833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",a.Rd.telemetryData.sessionId,c.toString());a.Rd.telemetryData.SetErrorCode(13,b.toString())})}catch(f){R(556613724,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",a.Rd.telemetryData.sessionId,f.toString())}}));a.$pa.ub()?a.$pa.qa.Ka("NCCE",a.vpb):R(594416981,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",a.Rd.telemetryData.sessionId)}
function ioe(a,b,c,d,e,f,g){try{var h=new window.PowerPointLive.RendezvousSessionConfig;h.userSessionId=b;h.webServiceBase=c;h.podSessionId=d;h.docId=e;h.sessionId=f;h.accessControl=1===a.zaa?"organization":"anyone";h.authTokenFunc=g;h.locale=rs;h.presentationName=vW(F.qW);h.slideHeight=a.qc.pu(!0).Ld;h.slideWidth=a.qc.pu(!0).ld;h.correlationId=a.Rd.telemetryData.correlationId;h.showQRCodeAfterFetchingDocDownloadUrl=a.ka.j_d;h.presenterTenantId=!a.ka.UQa&&a.ka.wJc?L.Va("TenantId"):null;h.fileSource=
L.Va("FileHost");a.ka.e2d||(h.fileName=F.qW,h.bootstrapperUrl=a.ka.mJc);var k=a.Sn.StartLiveBroadcasting(h,a.Rd,!a.ka.m1b);voe(a);if(k){a.yq=new window.PowerPointLive.ILiveSessionState;a.yq.isPrivate=1===a.zaa;a.yq.isPaused=!1;a.yq.participantsCount=0;a.yq.sessionCurrentState=0;var l=k.then(function(b){var c=new window.PowerPointLive.ILiveSessionURL;c.participantUrl=b.sessionInfo.shortParticipantUrl;c.sessionQRCode=b.sessionInfo.sessionQRCode;a.yq.sessionCurrentState=1;return c});a.yq.sessionURLPromise=
l;a.ka.Msb?a.pSb.then(function(){a.Ij.actOnSessionRequested(a.yq)}):a.Ij.actOnSessionRequested(a.yq);a.Xa.Jhb(a.cMd);a.Xa.Ync(a.LMd);a.Xa.DMb(a.PKd);k.then(function(b){a.Rd.telemetryData.pragueDocId=b.sessionInfo.pragueDocId;a.Rd.telemetryData.sessionCreationWebServiceCallTimeInMS=a.NI()-a.vxc;a.Rd.telemetryData.startAttemptCount=b.numAttempt;R(50452483,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",a.Rd.telemetryData.sessionId,a.Rd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());
a.ka.m1b?(ooe(a),a.Sn.InitializeStateService().then(function(){Boe(a,b);M9(a,"StartLiveBroadcasting")}).catch(function(b){a.Rd.telemetryData.sessionEndedBeforePragueInitialized||a.Rd.telemetryData.sessionId!==f||(R(594330467,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",a.Rd.telemetryData.sessionId,b?b.toString():""),a.Rd.telemetryData.SetErrorCode(2,b?b.toString():""),M9(a,"StartLiveBroadcasting"),Aoe(a))})):Boe(a,b);a.ka.a_d&&window.$addHandler(window,
"visibilitychange",a.Sif);M9(a,"StartLiveBroadcasting")}).catch(function(b){R(42869319,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",a.Rd.telemetryData.sessionId,b.toString());a.Rd.telemetryData.SetErrorCode(4,b.toString());M9(a,"StartLiveBroadcasting");Aoe(a)})}else Aoe(a),a.Rd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),R(42869321,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(m){Aoe(a),a.Rd.telemetryData.SetErrorCode(4,
m.toString()),R(42869323,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",a.Rd.telemetryData.sessionId,m.toString())}finally{M9(a,"StartLiveBroadcasting")}}function roe(a){window.setTimeout(function(){var b=a.N0a===a.Yxd;a.pr()&&a.Tq()&&b&&a.yq&&!a.yq.isPaused&&(R(592486672,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),soe(a,0),joe(a,0))},6E4*a.ka.c2d)}function Coe(){}
Coe.prototype={id:null,Kmd:null,FMb:null,AEd:null,FFd:null,Mba:null,frame:null,resolve:null,reject:null,AFd:0,yEd:null,TVb:0,t_e:!1};function Doe(){}Doe.prototype={timeStamp:null,t4a:null};function Eoe(a){this.Aqd={};this.BLe=a}Eoe.prototype={BLe:10};function Foe(a,b){return b in a.Aqd&&(b=window.$$as(Doe,a.Aqd[b]),new Date-b.timeStamp<6E4*a.BLe)?b.t4a:null}function Goe(a,b,c){if(b&&c){var d=new Doe;d.t4a=c;d.timeStamp=new Date;a.Aqd[b]=d}}
function Zne(a){this.isf=Function.createDelegate(this,this.vkg);this.lTb={};this.ka=a;this.I3a=new Eoe(this.ka.V1d);window.addEventListener("message",this.isf,!1)}Zne.prototype={I3a:null,ka:null,vkg:function(a){if("data"in a){var b,c,d;(d=vk(a.data,c={val:b}),b=c.val,d)&&b&&"DirectAuthRequestID"in b&&Hoe(this,b)}}};
function Ioe(a,b){return new Promise(function(c,d){var e=b/50,f=0;a.TVb=window.setInterval(function(){try{f++>e&&(window.clearInterval(a.TVb),R(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",b,e),d(""));var g=a.frame?a.frame.contentWindow:a.Mba;if(!g||g.closed)window.clearInterval(a.TVb),R(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),d("WindowClosed");var h=null,k=null;try{h=g.location.href,k=g.location.hash}catch(l){}h&&
"about:blank"!==h?k&&(window.clearInterval(a.TVb),c(k)):R(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===h)}catch(l){R(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",l.message)}},50)})}
function xoe(a,b,c,d,e,f){var g=L.Va("UserPrincipalName");if(!b)throw Error.argumentNull("authority");if(!c)throw Error.argumentNull("appId");if(!d)throw Error.argumentNull("resource");if(!g)throw Error.argumentNull("userUPN");var h=!!g&&g.indexOf("@")<g.indexOf("."),k=Joe(),l=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",b,c,window.encodeURIComponent(d),window.encodeURIComponent(k));if(a.I3a){var m=
Foe(a.I3a,l);if(m)return R(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(function(a){var b=new Ed;b.IsSuccess=!0;b.ErrorCode="";b.ErrorMessage="";b.Token=m;a(b)})}var n=Ae().toString(),k=h?String.format("{0}&login_hint={1}&state={2}",l,window.encodeURIComponent(g),n):String.format("{0}&state={1}",l,n),r=document.createElement("iframe");r.style.display="none";r.src=k;return new Promise(function(k,m){var x=new Coe;x.Kmd=b;x.FMb=c;x.AEd=d;x.FFd=g;x.frame=r;x.resolve=
k;x.reject=m;x.id=n;x.yEd=l;x.t_e=f;document.body.appendChild(r);R(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",n,h);Ioe(x,1E3*e).then(function(){var b={};b.DirectAuthRequestID=n;b.FromPolling=!0;Hoe(a,b)});x.AFd=window.setTimeout(function(){var b={};b.DirectAuthRequestID=n;b.Timeouted=!0;R(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+n);Hoe(a,b)},1E3*e);a.lTb[n]=x})}
function Koe(a,b,c,d,e,f){if(!b)throw Error.argumentNull("authority");if(!c)throw Error.argumentNull("appId");if(!d)throw Error.argumentNull("resource");if(!e)throw Error.argumentNull("userUPN");var g=!!e&&e.indexOf("@")<e.indexOf("."),h=Joe(),k=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",b,c,window.encodeURIComponent(d),window.encodeURIComponent(h));if(a.I3a){var l=Foe(a.I3a,k);if(l)return R(593782154,
833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(function(a){var b=new Ed;b.IsSuccess=!0;b.ErrorCode="";b.ErrorMessage="";b.Token=l;a(b)})}var m=Ae().toString(),n=String.format("{0}&state={1}",k,m);return new Promise(function(h,l){var v=new Coe;v.Kmd=b;v.FMb=c;v.AEd=d;v.FFd=e;v.resolve=h;v.reject=l;v.id=m;v.yEd=k;v.Mba=window.open("",m,"width=400, height=600");v.Mba?(a.lTb[m]=v,v.Mba.location.replace(n),R(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",
m,g),Ioe(v,1E3*f).then(function(){var b={};b.DirectAuthRequestID=m;b.FromPolling=!0;Hoe(a,b)}).catch(function(b){"WindowClosed"===window.$$as(String,b)&&(b={},b.DirectAuthRequestID=m,b.PopupWindowClosed=!0,R(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+m),Hoe(a,b))}),v.AFd=window.setTimeout(function(){var b={};b.DirectAuthRequestID=m;b.Timeouted=!0;R(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+m);Hoe(a,b)},1E3*f)):(R(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",
m),l=new Ed,l.IsSuccess=!1,l.ErrorCode="fail_to_open_popup",l.ErrorMessage="Failed to create popup window!",l.Token="",h(l))})}
function Joe(){var a=window.location.protocol,b=window.location.host,c="/p/";R(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",a,b,"ffc-powerpoint.officeapps.live.com"===b||"ppc-powerpoint.officeapps.live.com"===b);if(A(c))var c=window.location.pathname,d=c.lastIndexOf("/"),c=0<=d?c.substring(0,d+1):"";return a+"//"+b+c+"WacDirectAuth.html"}
function Hoe(a,b){try{var c=b.DirectAuthRequestID;if(c in a.lTb){var d=null,e=window.$$as(Coe,a.lTb[c]);if(e&&e.id===c){R(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",c,"Timeouted"in b,"FromPolling"in b);window.clearTimeout(e.AFd);delete a.lTb[c];window.clearTimeout(e.TVb);var f=new Ed;f.IsSuccess=!1;f.ErrorCode="";f.ErrorMessage="";f.Token="";"Timeouted"in b?(R(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),
f.ErrorCode="Timeout",f.ErrorMessage="No response received in time for the authentcation request",e.resolve(f)):"PopupWindowClosed"in b&&e.Mba?(f.ErrorCode="User_aborted",f.ErrorMessage="User aborted log in by closing the popup window",e.resolve(f)):(e.frame?d=Loe(e.frame.contentWindow.location.hash):e.Mba&&!e.Mba.closed&&(d=Loe(e.Mba.location.hash)),"access_token"in d?(f.IsSuccess=!0,f.Token=window.$$as(String,d.access_token),a.I3a&&Goe(a.I3a,e.yEd,f.Token),e.resolve(f)):(f.ErrorCode="error"in d?
window.$$as(String,d.error):"unknown",0<=Array.indexOf(a.ka.zKc,f.ErrorCode)&&e.t_e&&e.frame&&!e.Mba?Koe(a,e.Kmd,e.FMb,e.AEd,e.FFd,a.ka.X1d).then(function(a){e.resolve(a)}).catch(function(a){e.reject(a)}):(f.ErrorMessage="error_description"in d?window.$$as(String,d.error_description):"unknown",e.resolve(f))));e.frame?document.body.removeChild(e.frame):e.Mba&&!e.Mba.closed&&e.Mba.close()}else R(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",c)}else R(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+
JSON.stringify(b))}catch(g){R(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+g.message)}}function Loe(a){for(var b={},c=/[#?&]+([^=&]+)=([^&]*)/gi,d;d=c.exec(a);)b[window.$$as(String,d[1])]=window.$$as(String,d[2]);return b}Type.registerNamespace("PowerPointWebEditor.Live");M=window.PowerPointWebEditor||{};M.X_f=M.X_f||{};function Moe(){this.Hm=Function.createDelegate(this,this.vm)}
Moe.prototype={J:null,tTe:0,Xb:function(){return"PowerPointWebEditor.Live"},wc:function(a){this.J=a;var b=this.J.H(GK,null),c=this;C(D(this.J.ma(S3,null)),function(){return new Yne(c.J.H(T,null),b,c.J.H(M3,null),c.J.H(sK,null),c.J.H(v6,null),c.J.H(WM,null),c.J.H(GN,null),c.J.H(EK,null),c.J.H(KK,null),c.J.H(iK,null),c.J.H(O3,null),kc(B(),P3),c.J.H(Twb,null),c.J.H(cL,null))})},vm:function(){try{if(this.J.H(T,null).C8){if(this.J.H(T,null).$Zd){var a=vh((F.qW||"").toLowerCase());if(".ppt"===a||".pps"===
a){R(592238732,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==a&&R(592238730,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+a)}if(this.J.H(T,null).d_d&&xM(this.J.H(LK,null),4))R(592328917,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format.");else if(this.J.H(T,null).e_d&&(xM(this.J.H(LK,null),32)||xM(this.J.H(LK,null),32768)))R(592189026,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file.");
else if(this.J.H(T,null).vJc&&"msa"===this.J.H(T,null).yZ)R(591685859,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users.");else{var b=this;kc(this.J,Ci).pb(function(a){a.Ge("PowerPointLivePresentations",!1).then(function(a){a?Noe(b):(R(592472007,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),window.appChrome.api.dispatch(window.appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}}else R(592472009,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(c){R(592472005,
833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",c)}},ub:function(){L.Nf(this.Hm)},ha:function(){}};
function Noe(a){try{a.J.H(T,null).C8?(a.tTe=Date.now(),R(42869339,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Je(window.Common.App.AppLifecycleManager.get_instance(),7,function(){var b=a.J.H(Cc,null).Rp,c=wZ(a.J),d=new (Ca.$$(Promise));d.ga(b.Ni("PPTLiveBroadcast"));d.ga(b.Ni("BroadcastMonitor"));d.ga(c("liveActor"));G().rb().ro()||d.ga(c("uiFabricLazy"));Promise.all(d.Jd()).then(function(){R(50860060,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-a.tTe);
var b=a.J.H(S3,null);b.m1a=!0;b.m1a&&b.qa.Ha("OnLiveResourcesLoaded",Sys.EventArgs.Empty,null);a.J.H(T,null).vJc||"msa"!==a.J.H(T,null).yZ||window.appChrome.api.dispatch(window.appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}).catch(function(a){return R(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",a)})},3)):R(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(b){R(42869343,
833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",b)}}window.PowerPointLive.ILiveSessionURL.registerClass("PowerPointLive.ILiveSessionURL");window.PowerPointLive.ILiveSessionState.registerClass("PowerPointLive.ILiveSessionState");window.PowerPointLive.ILiveActorSettings.registerClass("PowerPointLive.ILiveActorSettings");window.PowerPointLive.ILiveReaction.registerClass("PowerPointLive.ILiveReaction");Xne.registerClass("PowerPointLive.PollObjectInfo");
Yne.registerClass("PowerPointLive.LivePresenter",null,S3);Coe.registerClass("PowerPointLive.DirectAuthRequest");Doe.registerClass("PowerPointLive.CachedAccessToken");Eoe.registerClass("PowerPointLive.AccessTokenCache");Zne.registerClass("PowerPointLive.DirectAuthHelper");Moe.registerClass("PowerPointWebEditor.Live.PPTWebEditorLivePackage",null,yo,ec);zo(gj(),new Moe,0,!1);Type.registerNamespace("PowerPointWebEditor.AgendaConverter");M=window.PowerPointWebEditor||{};M.u8a=M.u8a||{};
function Ooe(){}Ooe.prototype={Slides:null};function Poe(){}Poe.prototype={outlineRequestContent:null,slideIndex:0,slideSId:0,slideCId:0,score:0};function Qoe(){}Qoe.prototype={body:null,id:null};function Roe(){}Roe.prototype={KIe:0,POb:0,OOb:0,Uvc:null,Vyd:null,fqc:null,lBd:null};function Soe(a){return!!a.Uvc&&!!a.fqc}function Toe(a,b){return b===a.fqc?(a.Uvc=null,a.fqc=null,!0):!1}function Uoe(a,b){this.f1c=[];this.kwb=a;this.lbe=b}Uoe.prototype={kwb:null,URc:!1,lbe:!1};
function Voe(){this.IMa=[]}Voe.prototype={zDd:0,yDd:0};function Woe(a,b,c){var d=Xoe,e=new (Ca.$$(Uoe));if(b)for(var f=0;f<d-1&&f<b.length;f++)e.ga(new Uoe(b[f],!1));!c||e.ga(new Uoe(c,!0));a.IMa=e.Jd()}
function N9(a,b,c,d,e,f,g,h,k,l,m){this.KPa=Function.createDelegate(this,this.yTa);this.Iif=Function.createDelegate(this,this.nhe);this.Jif=Function.createDelegate(this,this.s8f);this.Kif=Function.createDelegate(this,this.t8f);this.mBc=Function.createDelegate(this,this.m9f);this.yKd=Function.createDelegate(this,this.o8f);this.Hif=Function.createDelegate(this,this.r8f);this.Eif=Function.createDelegate(this,this.n8f);this.Gif=Function.createDelegate(this,this.q8f);this.Dif=Function.createDelegate(this,
this.mhe);this.Fif=Function.createDelegate(this,this.p8f);this.dispose=this.ha;this.fY=new (Ca.$$(pje));this.Gtc=!1;this.Cf=a;this.Mb=b;this.ra=c;this.jc=d;this.za=e;this.Pl=f;this.fa=g;this.Le=h;this.wb=k;this.Fs=l;this.Cwc=m;a=this.Fs;if(b=this.za)a.Ad.za=b,a.Ad.hR=b.VM?"NewDocument":b.zsa?"ViewOnlyDocument":"EditDocument",(b=a.Ad.za)&&b.VM&&oia(Yoe,null,0,!0,null,!1),a.Ad.Zo.IsDocumentOpenTypeCreateNew=a.Ad.za.VM.toString()}
N9.prototype={Mb:null,Cf:null,ra:null,jc:null,za:null,Pl:null,fa:null,Le:null,wb:null,Fs:null,Cwc:null,UA:null,fY:null,Gtc:!1,QE:null,mqc:0,bR:null,$mb:"",xsc:!1,cpa:0,m9f:function(a,b){if(b.oh===I_a&&this.mqc){a=window.$$as(TM,b.xc);if(a.nb(Number,I_a)===Zoe)for(a=this.fY.$$lge();a.$$mn();){if(b=a.$$cu())b.Ky.showMergeSlidesError(),$oe(b.Fs)}else if(a.nb(Number,I_a)===ape){for(a=this.fY.$$lge();a.$$mn();)(b=a.$$cu())&&bpe(b);this.xsc=!0}hH(this.Cwc,this.mBc);this.mqc=0}},p8f:function(){xR(this.wb);
var a=this.ra.Ed;if(a){var b=this.Pl.Ue(15,0);try{b.Jc(a);b.xe(546960226);var c,d=(c=new Vba,c.CorrelationId=this.QE,c.AgendaSlideSid=this.UA.POb,c.AgendaSlideCid=this.UA.OOb,c);TT(a,m_a,d)}finally{b&&b.dispose()}this.jc.mu(a,546960226);this.jc.JN(a)}else cpe(this);this.xsc=!0;for(a=this.fY.$$lge();a.$$mn();)(b=a.$$cu())&&bpe(b)},q8f:function(a){this.bR.yDd=this.NI();var b=dpe(this),c=new (Ca.$$(String));if(a.Images)for(var d=a.Images,e=d.length,f=0;f<e;++f)c.ga("data:image/jpg;base64, "+d[f]);c.ga(b);
!a.BlankSuggestionId&&(a.BlankSuggestionId=Ae().toString());Woe(this.bR,a.DeckSuggestionId,a.BlankSuggestionId);for(a=this.fY.$$lge();a.$$mn();)if(b=a.$$cu())d=c.Jd(),epe(b,d),fpe(b.Fs,!0);gpe(this,0)},r8f:function(){this.bR.yDd=this.NI();Woe(this.bR,null,Ae().toString());gpe(this,0)},s8f:function(a){if(a.Images&&a.Images.length){for(var b=new (Ca.$$(String)),c=a.Images,d=c.length,e=0;e<d;++e)b.ga("data:image/jpg;base64, "+c[e]);hpe(this,b.Jd(),a.DeckSuggestionId);var f,g,h;if(a=(h=ipe(this,a.DeckSuggestionId,
g={val:f}),f=g.val,h))a.f1c=b.Jd(),a.URc=!0;jpe(this.Fs,f,!1)}else this.nhe(a)},t8f:function(a){a.Images&&a.Images.length?kpe(this,0):cpe(this)},nhe:function(a){try{var b,c,d,e=(d=ipe(this,a.DeckSuggestionId,c={val:b}),b=c.val,d);e&&(e.URc=!1,e.f1c=[]);var f=this.Fs,g=lpe(f.Ad.G1,"TriggerDeckLevelDesigner_"+b);O9(f,"OnAgendaDeckPreviewError");f.Ad.eR="AgendaDeckPreviewError";c="";"DeckPreviewFailure"in f.Ad.Zo&&(c=f.Ad.Zo.DeckPreviewFailure.toString());f.Ad.Zo.DeckPreviewFailure=c+b.toString()+";";
var h=P9(mpe(Q9(R9(new S9(f.Ad.eM,f.Ad.vG),f.Ad.QE),f.Ad.eR),b),f.Ad.hR).yF();De(T9,!1,g,h);if(this.$mb!==a.DeckSuggestionId)return!0}catch(k){R(571483968,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+k.message)}for(a=this.fY.$$lge();a.$$mn();)(f=a.$$cu())&&npe(f);return!0},mhe:function(){cpe(this);return!0},o8f:function(a){return this.mhe(a)},n8f:function(){var a=dpe(this),b=new (Ca.$$(String));b.ga(a);for(a=this.fY.$$lge();a.$$mn();){var c=a.$$cu();if(c){var d=c,e=b.Jd();epe(d,
e);fpe(d.Fs,!1);npe(c)}}return!0},yTa:function(a,b){try{this.UA||(this.UA=new Roe);var c=!1;b?Toe(this.UA,a.id)&&(this.Gtc=!1,c=!0):(a&&(this.UA.KIe=a.body.slideIndex),a.body&&a.body.outlineRequestContent&&(this.UA.Uvc=JSON.stringify(a.body.outlineRequestContent)),a.body&&(this.UA.OOb=a.body.slideCId),a.body&&(this.UA.POb=a.body.slideSId),this.UA.fqc=a.id,this.UA.lBd=a.body.score,ope(this),Soe(this.UA)&&(this.Gtc=this.za.brb?!0:!!this.cpa,a.body&&a.body.outlineRequestContent&&a.body.outlineRequestContent.Slides&&
(this.UA.Vyd=a.body.outlineRequestContent.Slides.length)));if(!(0>=this.fY.Qa()))for(var d=this.fY.$$lge();d.$$mn();){var e=d.$$cu();try{e&&(c?window.setTimeout(function(){ppe(e)},100):ppe(e))}catch(f){R(577865432,813,10,"Exception message: "+f.message)}}}catch(f){R(578331549,813,10,"Exception message: "+f.message)}},h0c:function(a){this.xsc=!a},il:function(){return this.ra.Ed.Rj.length+this.UA.Vyd},ha:function(){hH(this.Cwc,this.mBc);this.mqc=0},NI:function(){return(new Date).getTime()}};
function ipe(a,b,c){c.val=0;a=a.bR.IMa;for(var d=a.length,e=0;e<d;++e){var f=a[e];if(f.kwb===b)return f;c.val++}R(561541730,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+b);return null}
function qpe(a){try{var b=HO(a.Mb);if(b&&0<b.length)for(var c=b.length,d=0;d<c;++d){var e=b[d];if(e){var f=e.ThemeFamilyId;if(a.za.arb&&f.toLowerCase()===rpe.toLowerCase())return 2;if(0<=Array.indexOf(a.za.OCc,f))return 1}}return 0}catch(g){return R(577640031,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+g.message),0}}
function ope(a){a.cpa=qpe(a);var b=a.Fs,c=spe.toString(a.cpa);O9(b,"ReportInitialUserThemeType");b.Ad.Zo.InitialUserThemeType=c;b.Ad.eM=c;tpe(a)?upe(a.Fs,"V3"):1!==a.cpa||a.za.brb?2===a.cpa&&a.za.arb&&upe(a.Fs,"V2"):upe(a.Fs,"V1")}function vpe(a){return a.Gtc&&!a.xsc}function dpe(a){var b=IO(a.Mb,0);return a.Le.o4(b.gc()).jj.src}function hpe(a,b,c){for(var d=a.fY.$$lge();d.$$mn();){var e=d.$$cu();e&&c===a.$mb&&e.Ky&&e.hMa&&e.Ky.populatePreviewSlidesInAgendaDialog(b)}}
function wpe(a,b,c,d){if(a.bR.yDd<a.bR.zDd)xpe(a);else{var e=a.Fs;"V2"===e.Ad.vG&&(O9(e,"OnTriggerDifferentThemeWorkflow"),e.Ad.eR="ThemeSuggestions",ype(e.Ad.G1,"TriggerDeckLevelDesigner_"+b),e=P9(U9(mpe(Q9(R9(new S9(e.Ad.eM,e.Ad.vG),e.Ad.QE),e.Ad.eR),b),"ThemeSelected"),e.Ad.hR).yF(),De(T9,!0,0,e));a.$mb=a.bR.IMa[b].kwb;(e=a.bR.IMa[b])?e=!e.URc:(R(561541731,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),e=!1);if(e){var e=Ae().toString(),f=a.Cf,g=a.UA.OOb,h=a.UA.POb,
k=a.QE,l=a.$mb,m={};m.SlideCount=a.il().toString();m.isBlankThemeRequest=(a.bR.IMa[b].lbe&&!tpe(a)).toString();m.isRequestForDeckDesignerForNonBlankSlides=tpe(a);b=JSON.stringify(m);Ree(f,g,h,e,k,l,b,c,d);R(572524035,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",e,a.$mb)}else hpe(a,a.bR.IMa[b].f1c,a.$mb),jpe(a.Fs,b,!0)}}function gpe(a,b){tpe(a)?wpe(a,b,a.Kif,a.yKd):wpe(a,b,a.Jif,a.Iif)}
function cpe(a){for(var b=a.fY.$$lge();b.$$mn();){var c=b.$$cu();c&&(c.Eyc>=c.ka.PCc?c.Ky.showAgendaToPptDismissCard():(c.Eyc+=1,c.Ky.showAgendaToPptFailureCard()),$oe(c.Fs))}a.jc.JN(a.ra.Ed)}
function kpe(a,b){xR(a.wb);var c=a.Fs,d=a.bR.IMa[b].kwb;O9(c,"ThemeDeckSuggestionId");c.Ad.Zo.SelectedDeckSuggestionId=d;if(c=a.ra.Ed){d=a.Pl.Ue(15,0);try{d.Jc(c);d.xe(546960226);J(c,I_a,zpe);a.mqc=a.NI();iH(a.Cwc,a.mBc);var e,f=(e=new Wba,e.DeckSuggestionId=a.bR.IMa[b].kwb,e.AgendaSessionId=a.QE,e.CorrelationId=Ae().toString(),e);TT(c,t_a,f)}finally{d&&d.dispose()}a.jc.mu(c,546960226);a.jc.JN(c)}else cpe(a)}function tpe(a){return a.za.brb&&(1===a.cpa||!a.cpa)}
function Ape(a,b,c){if(a.UA){if(!a.UA.POb||!a.UA.OOb){var d=IO(a.Mb,a.UA.KIe);a.UA.POb=d.gc().Pc();a.UA.OOb=d.gc().Be()}var e=IO(a.Mb,0),d=a.Cf,f=e.gc().Be(),e=e.gc().Pc(),g=a.QE,h=a.UA.Uvc,k={};a.za.arb&&2===a.cpa&&(k.shouldGenerateThemes="true",k.themeCount="3");tpe(a)&&(k.shouldNotConvertToGVMLBytes="true",k.shouldInsertBlankSlides="true");a=JSON.stringify(k);Qee(d,f,e,g,h,a,b,c)}else c(null)}
function xpe(a){ope(a);a.QE=Ae().toString();var b=a.Fs,c=a.QE;O9(b,"ReportCorrelationID");b.Ad.Zo.CorrelationId=c;b.Ad.QE=c;b=a.Fs;b.Ad.lQb?(b=P9(Bpe(U9(Cpe(R9(new S9(b.Ad.eM,b.Ad.vG),b.Ad.QE),"AgendaMergeError"),"TryAgain"),"Tried"),b.Ad.hR).yF(),De(T9,!0,0,b)):(O9(b,"OnAddSlidesClicked"),b.UBa.Lf(),b.Ad.Zo.Tried="true",ype(b.Ad.G1,"OnAddSlidesClicked"),R(576746628,813,50,"AgendaCard tried in MS:{0}",b.UBa.GQa),c=P9(Bpe(U9(Cpe(R9(new S9(b.Ad.eM,b.Ad.vG),b.Ad.QE),"AgendaCardShown"),"AddSlides"),"Tried"),
b.Ad.hR).yF(),De(T9,!0,b.UBa.GQa,c),b=b.Ad.fQb,b.Q_b&&!b.eUd&&(b.eUd=!0,oia(Dpe,null,0,!0,null,!1)));if(tpe(a))a.bR=new Voe,a.bR.zDd=a.NI(),Ape(a,a.Hif,a.yKd),a.jc.$Z(a.ra.Ed,"ApplyAgenda",!0);else if(1===a.cpa&&!a.za.brb)Ape(a,a.Fif,a.Dif),a.jc.$Z(a.ra.Ed,"ApplyAgenda",!0);else if(2===a.cpa&&a.za.arb){a.bR=new Voe;a.bR.zDd=a.NI();for(b=a.fY.$$lge();b.$$mn();)if((c=b.$$cu())&&c.Ky){var d=c.Fs;O9(d,"OnAgendaDialogShown");d.Ad.eR="Loading";R(556602440,813,50,"AgendaDialog shown");d=P9(Q9(R9(new S9(d.Ad.eM,
d.Ad.vG),d.Ad.QE),d.Ad.eR),d.Ad.hR).yF();De(T9,!0,0,d);c.Ky.showAgendaToPptDialog(c.uG.il());P0b(c.Ia,"AgendaToPPTDialogFocus",document.getElementById("AgendaToPptDialogHostElement"));DT(c.Ia,"AgendaToPPTDialogFocus",!0);c.hMa=!0}Ape(a,a.Gif,a.Eif)}}function spe(){}spe.prototype={unsupported:0,designer:1,blank:2};spe.registerEnum("PowerPointWebEditor.AgendaConverter.AgendaConverterManager.AgendaSlideThemeType",!1);function Epe(){this.qrf=Function.createDelegate(this,this.fjg)}
Epe.prototype={J:null,za:null,OUe:!0,JIe:"AugLoop_AgendaDetection_AgendaDetectionAnnotation",uG:null,Xb:function(){return"PowerPointWebEditor.AgendaConverter"},wc:function(a){this.J=a;C(D(this.J.ma(Q2,null)),function(){return new Fpe});var b=this;C(D(this.J.ma(N9,null)),function(){return new N9(b.J.H(i2,null),b.J.H(WM,null),b.J.H(GN,null),b.J.H(mQ,null),b.J.H(T,null),b.J.H(CN,null),b.J.H(dd,null),b.J.H(xQ,null),b.J.H(UM,null),b.J.H(Q2,null),iA(b.J.H(Ow,null),7))});var c=this;C(D(this.J.ma(H$c,null)),
function(){return new Gpe(c.J.H(Q2,null),c.J.H(fS,null),c.J.H(N9,null))});this.J.H(H$c,null);var d=wZ(this.J);if($H("AgendaToPPT.DisableLocalizedStrings")){var e=this;d("agendaConverter").then(function(){C(D(e.J.ma(o9,null)),function(){return new Hpe(e.J.H(N9,null),e.J.H(GK,null),e.J.H(T,null),e.J.H(Q2,null),e.J.H(cL,null))});e.J.H(o9,null)}).catch(function(){})}else{var f=this;d("powerpoint-agenda-to-ppt-strings").then(function(){d("agendaConverter").then(function(){C(D(f.J.ma(o9,null)),function(){return new Hpe(f.J.H(N9,
null),f.J.H(GK,null),f.J.H(T,null),f.J.H(Q2,null),f.J.H(cL,null))});f.J.H(o9,null)}).catch(function(){})}).catch(function(){})}},ub:function(){this.J.H(md,null).Nf(this.qrf)},ha:function(){},fjg:function(){this.za=this.J.H(T,null);this.uG=this.J.H(N9,null);var a=this.J.H(GK,null);if(this.za.ORd&&this.OUe&&2===a.Ic()){var b=this;kc(this.J,e3).pb(function(a){a.wub(b.JIe);a.gjg(b.JIe,b.uG.KPa)});this.OUe=!1}}};
function Gpe(a,b,c){this.pja=Function.createDelegate(this,this.CUa);this.Fs=a;this.xd=b;this.uG=c;this.nv()}Gpe.prototype={Fs:null,xd:null,uG:null,nv:function(){this.xd.qa.Ka("UR",this.pja)},hyb:function(a,b){546960226===a&&(this.Fs.h0c(b),this.uG.h0c(b))},CUa:function(a,b){this.hyb(b.b3b,b.s0b)}};window.PowerPointWebEditor.AgendaConverter.IAgendaSettings=M.u8a.eXf=function(){};M.u8a.eXf.prototype={isEntryState:!1,pptAppFrameDomElement:null,maxTryAgainCount:0};
function Hpe(a,b,c,d,e){this.qa=new re;this.ka=c;this.tr=b;this.Ia=e;this.Ky||(b=new window.PowerPointWebEditor.AgendaConverter.IAgendaSettings,b.isEntryState=!0,b.pptAppFrameDomElement=this.tr.wB(),b.maxTryAgainCount=this.ka.PCc,this.Ky=window.agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(b));Ipe(this);this.uG=a;this.ka&&this.ka.$qb&&this&&this.uG.fY.ga(this);this.Fs=d;this.hMa=!1}
Hpe.prototype={kGe:"HighConfidenceAgendaDetected",uG:null,ka:null,Fs:null,Ky:null,tr:null,Ia:null,gjb:null,Eyc:0,hMa:!1,z4b:function(){this.gjb=null;this.Eyc=0;this.Ky.cleanup()}};function Jpe(a,b,c){var d=a.Fs;O9(d,"OnAgendaDialogThemeApply");d.Ad.eR=c?"AgendaDeckMergeError":d.Ad.eR;ype(d.Ad.G1,"AgendaToPptDialogThemeApply");c=P9(U9(Q9(mpe(R9(new S9(d.Ad.eM,d.Ad.vG),d.Ad.QE),b),d.Ad.eR),c?"TryAgain":"Apply"),d.Ad.hR).yF();De(T9,!0,0,c);a.hMa=!1;a.Ky.hideAgendaToPptDialog();kpe(a.uG,b)}
function Ipe(a){a.Ky.on(Kpe,function(){xpe(a.uG)});a.Ky.on(Lpe,function(){var b=a.Fs;b.Ad.lQb=!0;O9(b,"OnTryAgainClicked");b.Ad.Zo.Tried="true";b.Ad.Zo.Event="AgendaTryAgain";ype(b.Ad.G1,"OnTryAgainClicked");R(556561858,813,50,"AgendaCard retry attempt");xpe(a.uG)});a.Ky.on(Mpe,function(){a.z4b();a.uG.fY.Mc(a);Npe(a.Fs)});a.Ky.on(Ope,function(){a.z4b();a.uG.fY.Mc(a);var b=a.Fs;O9(b,"OnDismissClicked");b.Ad.oAa=!0;b.Ad.Zo.Kept="false";b.Ad.Zo.Event="AgendaDismissed";R(556607430,813,50,"AgendaToPPT clicked Dismiss button");
var c=P9(U9(R9(new S9(b.Ad.eM,b.Ad.vG),b.Ad.QE),"Dismiss"),b.Ad.hR);"V2"===b.Ad.vG?Q9(c,b.Ad.eR):Cpe(c,"AgendaMergeError");De(T9,!0,0,c.yF())});a.Ky.on(Ppe,function(b){gpe(a.uG,b)});a.Ky.on(Qpe,function(b){Jpe(a,b,!1)});a.Ky.on(Rpe,function(){a.hMa=!1;a.Ky.hideAgendaToPptDialog();Npe(a.Fs)});a.Ky.on(Spe,function(b){Jpe(a,b,!0)})}
function Tpe(a){if(a.ka.B1d)try{var b=kc(B(),Zc);b&&(R(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),b.pb(function(a){a.Jn("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled",null)}))}catch(c){R(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",c)}}function epe(a,b){a.Ky&&a.hMa&&a.Ky.populateThemesInAgendaDialog(b)}
function Upe(a){R(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");a.Ky&&!a.hMa&&(a.Ky.hideAgendaCard(),a.gjb=null)}
function Vpe(a,b){a.ka.$qb&&(a.gjb=b,a.Ky&&a.gjb&&a.uG&&vpe(a.uG)&&(a.Ky.showAgendaCard(a.gjb,a.uG.UA.Vyd),a=a.Fs,a.Ad.lQb=!1,"Seen"in a.Ad.Zo||(O9(a,"OnAgendaCardShown"),a.UBa.af(),a.Ad.Zo.Seen="true",R(576746627,813,50,"AgendaCard shown"),b=P9(Bpe(Cpe(new S9(a.Ad.eM,a.Ad.vG),"AgendaCardShown"),"Seen"),a.Ad.hR).yF(),De(T9,!0,0,b),a=a.Ad.fQb,a.Q_b&&!a.dUd&&(a.dUd=!0,oia(Wpe,null,0,!0,null,!1)))))}function npe(a){a.Ky&&a.hMa&&a.Ky.showSlidePreviewError()}
function bpe(a){Upe(a);Xpe(a.Fs);window.setTimeout(function(){Tpe(a)},8E3)}function ppe(a){if(a.uG)if(vpe(a.uG)){var b=a.Fs,c=a.uG.UA.lBd;O9(b,"ReportAgendaScore");b.Ad.Zo.AgendaScore=c.toString();1===c&&(O9(b,"ReportHighConfidenceAgendaDetected"),b.Ad.Zo.HighConfidenceAgendaDetected="true",b.Ad.fQb.Q_b=!0);Vpe(a,a.gjb);1===a.uG.UA.lBd&&a.qa.Ha(a.kGe,null,null)}else Upe(a)}function Ype(){this.K2a={}}Ype.prototype={};
function lpe(a,b){if(b in a.K2a){var c=a.K2a[b];c.Lf();c=c.GQa;delete a.K2a[b];return c}return-1}function ype(a,b){a.K2a[b]=new rtb(b,!0)}function S9(a,b){if(!a)throw Error.argumentNull("AgendaThemetype is null");if(!b)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Dha=new cta;var c;uk(this.Dha,(c=new eb,c.name="AgendaThemeType",c.string=a,c));var d;uk(this.Dha,(d=new eb,d.name="AgendaFlowVersion",d.string=b,d))}S9.prototype={Dha:null,yF:function(){return this.Dha.CQa}};
function P9(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="DocumentOpenType",c.string=b,c))}return a}function Bpe(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="AgendaSeenTriedKept",c.string=b,c))}return a}function U9(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="AgendaButtonClickedType",c.string=b,c))}return a}function Q9(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="AgendaDialogState",c.string=b,c))}return a}
function Cpe(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="AgendaCardState",c.string=b,c))}return a}function mpe(a,b){var c;uk(a.Dha,(c=new eb,c.name="AgendaThemeIndexSelected",c.int64=b,c));return a}function R9(a,b){if(b){var c;uk(a.Dha,(c=new eb,c.name="AgendaSessionId",c.string=b,c))}return a}function Zpe(){}Zpe.prototype={dUd:!1,eUd:!1,cUd:!1,Q_b:!1};function $pe(){this.$Ub="";this.oAa=!1;this.eM=""}
$pe.prototype={$Ub:null,oAa:!1,eM:null,QE:null,vG:null,eR:null,hR:null,lQb:!1,za:null,Zo:null,G1:null,fQb:null,Fd:function(){this.Zo={};this.G1=new Ype;this.fQb=new Zpe;this.$Ub="";this.oAa=!1;this.eM="";this.hR=this.eR=this.vG=this.QE=null;this.lQb=!1}};function Fpe(){this.UBa=new rtb("AgendaToPpt",!1);aqe(this)}
Fpe.prototype={UBa:null,Ad:null,h0c:function(a){var b=!1;O9(this,"OnUndoRedoClicked");var c=P9(R9(new S9(this.Ad.eM,this.Ad.vG),this.Ad.QE),this.Ad.hR);if("Kept"in this.Ad.Zo){this.Ad.Zo.Kept=(!a).toString();var d=a?"UndoClicked":"RedoClicked";this.Ad.Zo.Event=d;c=U9(c,d)}else b=!0,U9(c,"UndoRedoPostAgendaKept");De(T9,!0,0,c.yF());R(576746629,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!a).toString(),b.toString())}};
function O9(a,b){a.Ad.Zo||(R(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",b),aqe(a))}function upe(a,b){O9(a,"ReportAgendaToPptFlowVersion");a.Ad.Zo.AgendaToPptFlowVersion=b;a.Ad.vG=b}function $oe(a){O9(a,"OnMergingErrorInAgenda");a.Ad.oAa=!0;a.Ad.Zo.Kept="false";a.Ad.Zo.Event="AgendaError";var b=P9(R9(new S9(a.Ad.eM,a.Ad.vG),a.Ad.QE),a.Ad.hR);"V2"===a.Ad.vG?(a.Ad.eR="AgendaMergeError",Q9(b,"AgendaMergeError")):Cpe(b,"AgendaMergeError");bqe(a,!1,b.yF())}
function Npe(a){O9(a,"OnCancelClicked");a.Ad.oAa=!0;a.Ad.Zo.Kept="false";a.Ad.Zo.Event="AgendaCancelled";R(572842051,813,50,"AgendaToPPT clicked Cancel button");var b=P9(U9(R9(new S9(a.Ad.eM,a.Ad.vG),a.Ad.QE),"Cancel"),a.Ad.hR);"V2"===a.Ad.vG?Q9(b,a.Ad.eR):Cpe(b,"AgendaMergeError");De(T9,!0,0,b.yF())}
function jpe(a,b,c){O9(a,"OnAgendaDeckPreviewLoaded");a.Ad.eR=c?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";c=lpe(a.Ad.G1,"TriggerDeckLevelDesigner_"+b);a.Ad.Zo["DeckPreviewLoadTime_"+b]=c.toString();a=P9(mpe(Q9(R9(new S9(a.Ad.eM,a.Ad.vG),a.Ad.QE),a.Ad.eR),b),a.Ad.hR).yF();De(T9,!0,c,a)}
function fpe(a,b){O9(a,"OnAgendaThemePaneLoadedSuccess");a.Ad.eR=b?"ThemeSuggestions":"ThemeSuggestionsFailure";b=lpe(a.Ad.G1,"OnAddSlidesClicked");a.Ad.Zo.ThemePaneLoadingTime=b.toString();a=P9(Q9(R9(new S9(a.Ad.eM,a.Ad.vG),a.Ad.QE),a.Ad.eR),a.Ad.hR).yF();De(T9,!0,b,a)}
function Xpe(a){O9(a,"OnAgendaToPPTApply");a.Ad.oAa=!0;a.Ad.Zo.Kept="true";a.Ad.Zo.Event="AgendaCompleted";var b=P9(Cpe(R9(new S9(a.Ad.eM,a.Ad.vG),a.Ad.QE),"AgendaCompleted"),a.Ad.hR).yF();bqe(a,!0,b);R(572842050,813,50,"AgendaToPPT Completed successfully")}
function bqe(a,b,c){if("AgendaToPptDialogThemeApply"in a.Ad.G1.K2a&&"V2"===a.Ad.vG){var d=lpe(a.Ad.G1,"AgendaToPptDialogThemeApply");a.Ad.Zo.TotalTimeTakenToMerge=d.toString();De(T9,b,d,c)}else"OnAddSlidesClicked"in a.Ad.G1.K2a?(d=lpe(a.Ad.G1,"OnAddSlidesClicked"),a.Ad.Zo.TotalTimeTakenToMerge=d.toString(),De(T9,b,d,c)):"OnTryAgainClicked"in a.Ad.G1.K2a&&(d=lpe(a.Ad.G1,"OnTryAgainClicked"),a.Ad.Zo.TotalTimeTakenToMerge=d.toString(),De(T9,b,d,c));a.Ad.lQb=!1}
function aqe(a){a.Ad=new $pe;a.Ad.Fd();a.Ad.Zo.Flights="";L.fc("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)&&(a.Ad.Zo.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");a.Ad.Zo.InitialUserThemeType=a.Ad.eM}Ooe.registerClass("PowerPointWebEditor.AgendaConverter.OutlineRequestContent");Poe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaDetectedAnnotationEventBody");Qoe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaDetectedAnnotationEvent");
Roe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaDetection");Uoe.registerClass("PowerPointWebEditor.AgendaConverter.DeckOptionInformation");Voe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaDeckSessionInformation");N9.registerClass("PowerPointWebEditor.AgendaConverter.AgendaConverterManager",null,Sys.IDisposable);Epe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaConverterPackage",null,yo,ec);
Gpe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaConverterUndoRedoController",null,H$c);window.PowerPointWebEditor.AgendaConverter.IAgendaSettings.registerClass("PowerPointWebEditor.AgendaConverter.IAgendaSettings");Hpe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaConverterView",null,o9,pje);Ype.registerClass("PowerPointWebEditor.AgendaConverter.AgendaPerfLogger");S9.registerClass("PowerPointWebEditor.AgendaConverter.AgendaToPptActivityDataPointBuilder");Zpe.registerClass("PowerPointWebEditor.AgendaConverter.ExperimentationMetrics");
$pe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaMetricsState");Fpe.registerClass("PowerPointWebEditor.AgendaConverter.AgendaMetrics",null,Q2);
var Xoe=4,rpe="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F",ape=1,Zoe=2,zpe=0,Kpe="AgendaCardAddSlides",Lpe="AgendaCardTryAgain",Mpe="AgendaCardCancel",Ope="AgendaCardDismiss",Ppe="AgendaToPptDialogThemeSuggestionSelected",Qpe="AgendaToPptDialogApply",Rpe="AgendaToPptDialogCancel",Spe="AgendaToPptDialogMergeTryAgain",Wpe="WAC_Exp_AgendaToPPTHighConfidenceSeen",Dpe="WAC_Exp_AgendaToPPTHighConfidenceTried",Yoe="WAC_Exp_AgendaToPPTIsCreateNew",T9="AgendaToPptEvents";zo(gj(),new Epe,0,!1);Type.registerNamespace("Common.App.VersionHistory");
w=window.Common||{};w.Ca=w.Ca||{};w.Ca.Dcb=w.Ca.Dcb||{};w.Ca.Dcb.pne=function(){};w.Ca.Dcb.pne.prototype={};w.Ca.Dcb.pne.registerEnum("Common.App.VersionHistory.VersionHistoryFullAppErrorCode",!1);(function(){}).registerInterface("Common.App.VersionHistory.IVersionHistoryController");(function(){}).registerInterface("Common.App.VersionHistory.IFocusTrapZoneComponent");function cqe(){}
cqe.prototype={appName:0,wdEnableDownloadTokens:!1,retryCount:0,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:null,wacCluster:null,uiLocale:null,isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,disabledChangeGates:null,wdEnableSaveACopyOverFlowMenu:!1,wdEnableDeleteVersions:!1,wdEnableAppColorUpdate:null,wdExperimentWithIteratorLocation:null};function dqe(){}
dqe.prototype={telemetryEventKey:null,telemetryEventData:null};function eqe(){}eqe.prototype={revisionID:null,authorID:null,authors:null,time:null,downloadUrl:null,wopiInfo:null,events:null};function fqe(){}fqe.prototype={ulsLogger:null,serviceBase:null,latestStreamServiceBase:null,docId:null,appSettings:null,perfTelemetryInfos:null};function gqe(){}gqe.prototype={currentVersion:null,baseVersion:null,correlationID:null,groupName:null,noBaseToCompareTo:!1};function hqe(){}
hqe.prototype={versions:null,containerDiv:null,correlationID:null};function iqe(){}iqe.prototype={updatedVersions:null,versionSelected:null};Type.registerNamespace("PowerPointWebEditor.VersionHistory");M=window.PowerPointWebEditor||{};M.Dcb=M.Dcb||{};function jqe(){}jqe.registerInterface("PowerPointWebEditor.VersionHistory.IVersionHistoryPaneActor");function kqe(){this.Hm=Function.createDelegate(this,this.vm)}
kqe.prototype={Ea:null,skc:null,Xb:function(){return"PowerPointWebEditor.VersionHistory"},wc:function(a){this.Ea=a},ub:function(){L.Nf(this.Hm)},vm:function(){if(F.R7b&&F.C3b&&!rj)if(this.Ea.H(T,null).WGc)u(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected");else{u(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package");var a=this;Je(window.Common.App.AppLifecycleManager.get_instance(),
7,function(){wZ(a.Ea)("versionHistory").catch(function(a){return u(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",a)}).then(function(){a.HSa();return null}).catch(function(a){return u(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",a)})},3)}else u(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")},HSa:function(){var a=this;D(C(this.Ea.ma(lqe,
null),function(){return new lqe(Zf(),a.Ea.H(yQ,null),a.Ea.H(Bo,null),a.Ea.H(T,null),a.Ea.H(WM,null),$f(),ri(),a.Ea.H(GK,null),a.Ea.H(LK,null),a.Ea.H(YH,null),a.Ea.H(iK,null),kc(a.Ea,Y2),a.Ea.H(a5,null),a.Ea.H(HR,null).vg,a.Ea.H(aM,null),a.Ea.H(c5,null))}));this.skc=this.Ea.H(lqe,null);this.skc.Wb()},ha:function(){this.skc&&this.skc.ha()}};
function lqe(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x){this.s2e=Function.createDelegate(this,this.RJf);this.V_e=Function.createDelegate(this,this.oFf);this.cAc=Function.createDelegate(this,this.n5b);this.uV=Function.createDelegate(this,this.dH);this.Wz=Function.createDelegate(this,this.lz);this.Paf=Function.createDelegate(this,this.EWf);this.CBc=Function.createDelegate(this,this.s0c);this.hvf=Function.createDelegate(this,this.apg);this.upa=-1;this.dispose=this.ha;this.fa=a;this.E7=b;this.Ug=c;this.za=d;this.qc=
e;this.Ria={};this.Ia=f;this.Eg=g;this.k3a={};this.Ub=k;this.yVb={};this.dUe=h;this.C2=l;this.Ya=m;this.wrc=[];if(n){this.UMe=n;var y=this;this.UMe.pb(function(a){y.Rx=a})}this.ZH=r;this.vg=t;this.wqd=v;this.WOa=x}function mqe(a){return a.RevisionID?a.RevisionID:a.revisionID?a.revisionID:""}
lqe.prototype={fa:null,AG:null,pV:null,E7:null,Ug:null,za:null,qc:null,Ria:null,ADd:null,C6:null,kjb:null,pTb:null,Ia:null,Eg:null,Ub:null,dUe:null,C2:null,Ya:null,UMe:null,Rx:null,wrc:null,k3a:null,zVb:null,yVb:null,Zjb:null,ZH:null,vg:null,wqd:null,WOa:null,Wb:function(){this.fa.ya(466976539,2147483648,this.hvf);this.za.tJc||this.fa.ya(4281380812,2147483648,this.CBc);this.fa.ya(2758158609,2147483648,this.Paf)},apg:function(a,b,c){if(1===c){var d=!1;this.Ya.E1&&(d=!0);return d?2:32}if(2===c){$i("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings");
$i("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions");this.zVb=Ae().toString();u(40144898,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.zVb);gk(3828599598,!0,"",0,0,0,null);this.Ria.VersionHistoryLaunchSessionId=this.zVb;this.k3a.VersionHistoryLaunchSessionId=this.zVb;this.Ria.ShowVersionHistoryDialog=(new Date).getTime().toString();this.pTb=[];if(!this.AG){var e,f;this.AG=window.versionHistory.FactoryGlobal.getVersionHistoryControllerInstance((f=
new fqe,f.ulsLogger=new window.UlsExternalLogger,f.serviceBase=ye(L).VersionHistoryWebServiceBase,f.latestStreamServiceBase=L.ia("PPTVHPodsBootEnabled")?ye(L).PODSLatestServiceBase+"&PodSID="+ye(L).PodSID:"",f.docId=F.sh,f.appSettings=(e=new cqe,e.appName=100,e.wdEnableDownloadTokens=!0,e.retryCount=ye(L).PodVHRetryCount,e.wdEnableSaveACopy=zM(this.Ub),e.wdEnableRestore=zM(this.Ub),e.userSessionId=vp,e.wacCluster=L.Va("WacCluster"),e.uiLocale=this.za.Wja?this.za.Wja:"en-us",e.isRtl=Di,e.disabledChangeGates=
L.Va("VHSDisabledChangeGates"),e.wdEnableSaveACopyOverFlowMenu=L.ia("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),e.wdEnableDeleteVersions=L.ia("PPTVersionHistoryDeleteVersionsIsEnabled"),e),f.perfTelemetryInfos=this.pTb,f))}this.AG&&this.AG.setDisableSaveACopy(oj);document.getElementById("VersionHistoryOverlay")||(nqe(this),oqe(this),pqe(this),qqe(this),rqe(this),sqe(this),tqe(this),uqe(this),a=document.createElement("div"),a.id="VersionHistoryOverlay",a.style.width="100%",a.style.zIndex=998,
a.style.display="block",a.style.position="absolute",a.style.top="0px",L.ia("RegionComposerIsEnabled")?(b=document.getElementById("HeaderRegion"),a.style.top=b.offsetHeight+"px",a.style.bottom="0px"):a.style.height="calc(100% + 23px)",document.getElementById("WACInnerFrame").appendChild(a),this.ADd=this.AG.createVersionHistoryDialog(a),this.Eva());document.getElementById("VersionHistoryOverlay").style.display="block";this.AG.getTipVersion&&L.ia("PPTVHPodsBootEnabled")&&this.AG.getTipVersion();this.AG.getVersions("");
try{var g=this.dUe;try{a=[];var h=g.YSc();for(b=0;b<h.length;b++)Rwa(g.Ar,h[b])&&a.push(h[b]);d=a}catch(k){R(41698500,822,10,"AppFrame::GetCurrentActiveF6Focuses, Exception: {0}",k),d=null}this.Zjb=d;for(d=0;d<this.Zjb.length;d++)Gl(this.Eg,this.Zjb[d]);Fl(this.Eg,"VersionHistoryOverlay")}catch(k){u(41698513,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",k)}}return 32},s0c:function(a,b,c){return 1===c&&this.Ya.E1?2:this.fa.Ab(3681556347,c,null)},EWf:function(a,b,
c){if(1===c)return 32;this.pV.onCopySlides();return 32},lz:function(a){try{if(a.shiftKey&&121===a.keyCode||93===a.keyCode){var b=Kva("contextmenu",a,1);this.dH(b)}}catch(c){u(587313282,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",c)}},dH:function(a){if(1===a.ye){var b=vqe(this,2);b&&(a.get_clientPoint().x=$l(b).x+5,a.get_clientPoint().y=$l(b).y+5)}return 32===this.fa.jb(3824854658,2,a,null)},K2c:function(a){try{if(this.pV)Dfe(!1),this.pV.switchParentViewContainer(a);else{Dfe(!0);
var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase="";b.IsRtl=Di;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.E7;c.animationDecoratorCallback=d.bAc||(d.bAc=Function.createDelegate(d,d.$Pc));c.notesIconDecoratorCallback=this.cAc;c.addToF6LoopCallback=this.V_e;c.copySlideCallback=this.s2e;var e=this;c.reportViewerErrorCallback=function(a){e.k3a[wqe]=xqe().fra.K(a);106===a&&e.AG.setViewerError(!0);u(40125919,822,50,"Versions viewer error: {0}",a);a&&(Vi(5341590,
null,null,null),Ce().recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};b.IsHighContrast=!1;this.Ug&&(b.IsHighContrast=this.Ug.UH());b.IsHighContrast&&(b.ClientColorSettings=this.Ug.To.q8+"_"+this.Ug.To.MM+"_"+this.Ug.To.MDa);if(this.qc){var f=eDb(this.qc);b.DefaultSlideWidth=f.ld;b.DefaultSlideHeight=f.Ld}b.UserSessionId=vp;b.VersionViewerCssUrl=this.za.pNc;b.ProgressImageResourceUrl=dg("progress.gif");b.ThumbnailShareOptimizationEnabled=this.za.U_d;var g;b.SlidePrefetchSettings=
(g=new window.PowerPointVersionHistory.SlidePrefetchSettings,g.SlidePrefetchEnabled=L.ia("PPTVHSlidePrefetchEnabled"),g.SlidePrefetchAhead=ye(L).PPTVHSlidePrefetchAhead,g.SlidePrefetchBehind=ye(L).PPTVHSlidePrefetchBehind,g.SlidePrefetchChunkSize=ye(L).PPTVHSlidePrefetchChunkSize,g.SlidePrefetchDelay=ye(L).PPTVHSlidePrefetchDelay,g);b.FileExtension=A(this.za.Nsa)?"":vh(this.za.Nsa).toLowerCase();b.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;b.NotesButtonLabel=ResourceStrings.L_Notes;
b.SynchronizerTimeout=ye(L).PptVersionHistorySynchronizerTimeout;b.IsRtl=Di;b.IsCopySlidesEnabled=!0;b.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;b.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;b.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;b.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;b.Lcid=F.ag;b.EnableOverflowXOnSlideAndNotePane=L.ia("PodVHEnableOverflowXOnSlideAndNotePane");b.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;b.IsModernCatchUpUxEnable=L.ia(S(1166));
b.IsRevisionTrackingFlyoutEnabled=$H("EnableRevisionTrackingFlyoutForVH");b.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.pV=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(h){this.AG.setViewerError(!0),u(39711112,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",h)}},n5b:function(){return Zj(14,14,"ToolbarNotesActiveDark_14x14x32",null,ResourceStrings.L_Notes)},Eva:function(){var a=this.Ia.$c("VersionHistoryOverlay");
a.ic="main";a.wK=!0;a.S2c=!0;var b=this;Tl(a,function(a){a&&"dialog/modal"===a.Nd?b.AG.setSaveACopyCanceled():a&&"ReactTransientUI"===a.Nd||(b.upa=-1,yqe(b,!0))});El(this.Eg,"VersionHistoryOverlay",!0);var c=this;Nwa(this.Eg,"VersionHistoryOverlay",function(a){yqe(c,a)});var d=this;Mwa(this.Eg,"VersionHistoryOverlay",function(){2===d.upa&&Sys.UI.DomElement.addCssClass(vqe(d,2),"PPTVHViewerElementSelected");3===d.upa&&Sys.UI.DomElement.addCssClass(vqe(d,3),"PPTVHViewerElementSelected")})},oFf:function(a){try{var b=
zqe(this);b&&b.push(a)}catch(c){u(40743826,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",c)}return!0},RJf:function(a){var b=Ae().toString();u(591663697,832,50,"Execute CopySlideCallback - correlationid : {0}",b);var c=HBd(this.ZH,1,a.SlideIds.length,!1,!1),d={};d.WacSessionId=vp;d.CallerCorrelationId=b;var e={};e.Source=a.Source;e.SlideIds=a.SlideIds;e.CcpId=c.Yy;e.PackageAccessKey=c.FZ;a=JSON.stringify(e);var e=String.format("{0}{1}",this.za.zr,"vhcopyslide.ashx"),f=Date.now();
try{if(F.gf.lk(e,2,a,d,!1,0,function(a){var c=Date.now();try{JSON.parse(a.Pa.Ce).IsCopied?u(591197340,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",c-f,b):u(591197339,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",c-f,b)}catch(d){u(591197338,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",d,b)}},function(a){var c=Date.now();u(591663692,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
c-f,a.Pa?a.Pa.kg:-1,b)},null,null,!1,null,null,null,null,!1,null,!1,null),this.vg.contentWindow&&this.vg.contentWindow.document&&this.vg.contentWindow.document.body){H8b(this.vg);var g=kM();g.innerText="&nbsp;";g.setAttribute("data-clipservice-ccpid",c.Yy);g.setAttribute("data-clipservice-dc",c.RM);g.setAttribute("data-clipservice-count",c.Jsa.toString());g.setAttribute("data-clipservice-type",VV(c.rF));g.setAttribute("data-clipservice-location",c.xK);g.setAttribute("data-pkey",c.FZ);this.vg.contentWindow.document.body.appendChild(g);
fM(this.vg);this.WOa.Lh(this.vg)}else u(591663696,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(h){u(591663695,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",h)}return!0},ha:function(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&Aqe(this);var a=vqe(this,2);a&&(oi(a,"keydown",this.Wz),li().Sb(a,this.uV))}};
function vqe(a,b){return(a=zqe(a))&&a.length>b?document.getElementById(a[b]):null}function zqe(a){if(!a.C6)return a.za.Gfb?["VersionListPane","vhHeader"]:null;var b=mqe(a.C6);return a.yVb[b]?a.yVb[b]:null}function Bqe(a){var b=mqe(a.C6);a.yVb[b]||(a.yVb[b]=["VersionListPane","vhHeader"],a.upa=-1)}function Cqe(a,b){var c=zqe(a),d=a.upa;do if(b?c&&(d=(d+1)%c.length):c&&(d=0<d?d-1:c.length-1),!d||1===d||c&&"none"!==document.getElementById(c[d]).style.display)return d;while(d!==a.upa);return 0}
function yqe(a,b){try{var c=zqe(a);a.upa=Cqe(a,b);a.upa?1===a.upa?a.ADd.then(function(a){a.enterHeaderFocusTrapZone();return null}):c&&vl(document.getElementById(c[a.upa])):a.ADd.then(function(a){a.enterFocusTrapZone();return null})}catch(d){u(40743825,822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",d)}}
function Aqe(a){try{if(a.Zjb)for(var b=0;b<a.Zjb.length;b++)Fl(a.Eg,a.Zjb[b]);else u(41698514,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");Gl(a.Eg,"VersionHistoryOverlay")}catch(c){u(41698515,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",c)}qi(a.Ia,"VersionHistoryOverlay",!0);document.getElementById("VersionHistoryOverlay").style.display="none";a.za.Gfb&&(a.C6=null);u(40208089,822,50,Id(a.k3a))}
function rqe(a){a.AG.getCloseSelectedEvent().addListener(function(){if(L.ia("PowerPointVersionHistoryFloodGateIsEnabled")){var b=gc(B(),Zc);b?(b.Jn("VersionHistoryExited",null,null),b.Jn("VersionHistoryCheckExited",null,null)):u(41523081,822,50,"ISystemInitiatedFeedback was null")}Aqe(a)})}
function Dqe(a){for(var b=a.pTb,c=b.length,d=0;d<c;++d){var e=b[d],f=e.TelemetryEventKey?e.TelemetryEventKey:e.telemetryEventKey?e.telemetryEventKey:"",e=e.TelemetryEventData?e.TelemetryEventData:e.telemetryEventData?e.telemetryEventData:"";f&&e&&(a.Ria[f]=e)}}
function uqe(a){a.AG.getDownloadVersionSelectedEvent().addListener(function(b){u(577307482,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");b=new xj(b);yj(b,"fn",F.qW);b=b.toString();b=a.fa.jb(3555692408,2,{FileDownloadUrl:b},null);32!==b?(gk(1316171850,!1,"",0,0,0,null),u(577307481,832,10,"Download version failed with result: {0}",b)):gk(1316171850,!0,"",0,0,0,null)})}
function tqe(a){a.AG.getRestoreVersionSelectedEvent().addListener(function(b){u(41022552,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",b);var c=Date.now();a.Rx?(a.wrc=a.Rx.wxb(),0<a.wrc.length?(u(41706369,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",a.wrc.length),gk(2138207060,!1,"",0,0,0,null),a.AG.setCoauthRestoreError(),L.ia("PPTVersionHistoryRestoreSurveyEnabled")&&((b=gc(B(),Zc))?b.Jn("VersionHistoryRestoreCoauthFailed",null,null):
u(576583424,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null"))):Eqe(a,b,c)):(u(41706368,832,10,"VersionHistoryPaneActor: presence manager is null"),Eqe(a,b,c))})}
function Eqe(a,b,c){try{(new Promise(function(b,c){a.AG.setRestoreInProgress();$ee(a.Ya.Al,a.Ya.Hc,a.Ya.uk().ql,ye(L)[S(361)],a.Ya.kba,function(){b(!0)},function(a){c("ClosePopWacSessionSync:: "+a.Ai.Ypa)})})).then(function(){(new Promise(function(c,e){afe(a.Ya.uk().ql,b,function(){c(!0)},function(a){e("RestoreFileVersion:: "+a.Ai.Ypa)})})).then(function(){var b=Date.now()-c;u(41997769,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",b);a.k3a.RestoreSucceededTime=
b;a.fa.Ab(2054778433,2,null);gk(2138207060,!0,"",0,0,0,null)}).catch(function(b){var e=Date.now()-c;a.AG.setRestoreFailedAtServer(function(){a.fa.Ab(2054778433,2,null)});u(41706370,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",b,e);a.k3a.RestoreFailedTime=e;gk(2138207060,!1,"",0,0,0,null)})})}catch(d){u(41706371,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",d.message),gk(2138207060,!1,"",0,0,0,null)}}
function sqe(a){a.AG.getSaveACopySelectedEvent().addListener(function(b){u(40417503,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",b);if(L.ia("PowerPointVersionHistoryFloodGateIsEnabled")){var c=gc(B(),Zc);c?c.Jn("VersionHistoryExited",null,null):u(41754647,822,10,"ISystemInitiatedFeedback was null")}c=qj;L.ia("VHSaveACopyForOdcOnSpoEnabled")&&(c=32===a.fa.Ab(1924572812,1,null));b=c?a.fa.jb(1924572812,2,{FileDownloadUrl:b},null):a.fa.jb(3050207199,2,{FileDownloadUrl:b},
null);32!==b?(gk(2623258827,!1,"",0,0,0,null),u(40974167,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",b)):gk(2623258827,!0,"",0,0,0,null)})}
function qqe(a){a.AG.getDownloadTokenReadyEvent().addListener(function(b){try{if(u(40481121,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),a.kjb)if(b&&b.updatedVersions&&2<=b.updatedVersions.length){var c=null,d=null,e=mqe(a.C6),f=mqe(a.kjb),g=b.updatedVersions,h=g.length;for(b=0;b<h;++b){var k=g[b],l=mqe(k);e===l?c=k:f===l&&(d=k);if(c&&d)break}c&&d?(a.C6=c,a.kjb=d,a.pV.diff(a.C6,a.kjb)):u(40665475,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
e,f)}else u(40665476,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else u(40665474,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(m){u(40481123,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",m)}})}
function pqe(a){a.AG.getVersionSelectedEvent().addListener(function(b){a.C6=b.currentVersion;a.kjb=b.baseVersion;if(a.pV&&a.C6.DownloadUrl.length)try{Dqe(a);Bqe(a);a.pV.onVersionSelected(b.currentVersion,b.baseVersion,a.Ria);var c=vqe(a,2);c&&(hh(c,"keydown",a.Wz),li().Wa(c,a.uV));a.pTb=[];a.Ria={}}catch(d){u(40122449,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",d)}})}
function oqe(a){a.AG.getVersionsReadyEvent().addListener(function(b){a.K2c(b.containerDiv);b=b.versions;for(var c=a.pV.getAppDataStore(),d=b.length,e=0;e<d;++e)c.AddVersionInfoToStore(b[e]);xi(a.Ia,"VersionHistoryOverlay",!0);try{a.C6&&a.C6.DownloadUrl.length&&a.pV&&(Dqe(a),Bqe(a),a.pV.onVersionSelected(a.C6,a.kjb,a.Ria),a.pTb=[],a.Ria={})}catch(f){u(40122448,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",f)}})}
function nqe(a){a.AG.getFullAppErrorEvent().addListener(function(b){try{var c=xqe().Jqa.K(b);a.k3a[wqe]=c;u(40489094,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",c,a.zVb)}catch(d){u(40489095,822,10,"Exception in FullAppErrorEvent call back: {0}.",d)}})}
function Fqe(){this.Jqa=new (Wb.$$(Number,String))(null);this.Jqa.ga(0,Gqe);this.Jqa.ga(100,Hqe);this.Jqa.ga(101,Iqe);this.Jqa.ga(102,Jqe);this.Jqa.ga(103,Kqe);this.Jqa.ga(104,Lqe);this.Jqa.ga(105,Mqe);this.Jqa.ga(106,Nqe);this.fra=new (Wb.$$(Number,String))(null);this.fra.ga(0,Gqe);this.fra.ga(100,Oqe);this.fra.ga(101,Pqe);this.fra.ga(102,Qqe);this.fra.ga(103,Rqe);this.fra.ga(104,Sqe);this.fra.ga(105,Tqe);this.fra.ga(106,Uqe)}function xqe(){Vqe||(Vqe=new Fqe);return Vqe}Fqe.prototype={Jqa:null,fra:null};
Type.registerNamespace("PowerPointVersionHistory");(function(){}).registerInterface("PowerPointVersionHistory.IDataStore");function Wqe(){}Wqe.prototype={sid:0,cid:0};function Xqe(){}Xqe.prototype={Source:null,SlideIds:null};function Yqe(){}Yqe.prototype={IsCopied:!1};cqe.registerClass("Common.App.VersionHistory.AppSettings");dqe.registerClass("Common.App.VersionHistory.TelemetryInfo");eqe.registerClass("Common.App.VersionHistory.VersionInfo");fqe.registerClass("Common.App.VersionHistory.ControllerFactoryParameters");
gqe.registerClass("Common.App.VersionHistory.VersionSelectedObject");hqe.registerClass("Common.App.VersionHistory.VersionsReadyObject");iqe.registerClass("Common.App.VersionHistory.DownloadTokenReadyObject");(function(){}).registerClass("PowerPointWebEditor.VersionHistory.Program");kqe.registerClass("PowerPointWebEditor.VersionHistory.PPTWebEditorVersionHistoryPackageManager",null,yo,ec);lqe.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor",null,jqe,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.VersionHistory.ErrorName");
Fqe.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryTelmetryHelper");Wqe.registerClass("PowerPointVersionHistory.SlideID");Xqe.registerClass("PowerPointVersionHistory.VHCopySlideRequest");Yqe.registerClass("PowerPointVersionHistory.VHCopySlideResult");
var Gqe="None",Hqe="VHFailedToLoadVersionList",Iqe="VHFailedToGetDownloadToken",Jqe="VHFailedToParseVersionList",Kqe="VHFetchFailed",Lqe="VHVersioningNotEnabled",Mqe="VHFileNotFound",Nqe="VHVersionTooOld",Oqe="VHFailedToRenderThumbnails",Pqe="VHFailedToRenderSlide",Qqe="VHFailedToRenderNotes",Rqe="VHFailedToRenderDiff",Sqe="VHFailedToShowAnimaitonIcon",Tqe="VHFailedToShowHiddenEffect",Uqe="VHFailedToRenderInitPresInfo",wqe="ErrorCode",Vqe=null;zo(gj(),e7(new kqe,0),0,!1);Type.registerNamespace("PowerPointWebEditor");
M=window.PowerPointWebEditor||{};function age(){}age.registerInterface("PowerPointWebEditor.IAddinCommandsInitService");function Zqe(){}Zqe.registerInterface("PowerPointWebEditor.IPptInsertMediaDialogFactory");function $qe(){}$qe.registerInterface("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory");function are(){this.LSe=[];this.KMa=[new bre];this.hI=[]}function dre(){B().H(AS,null).W8a();zo(gj(),new ere,0,!1)}
function fre(){var a=!1;try{window.self.requestIdleCallback(dre)}catch(b){a=!0}a&&window.setTimeout(dre,0)}
are.prototype={hI:null,KMa:null,J:null,E2:null,rg:null,PG:null,Xb:function(){return"PowerPointWebEditor.Chronos2"},wc:function(a){this.J=a;this.E2=this.J.H(CK,null);this.rg=this.E2.Jda(5,this.Xb());this.PG=this.J.H(rS,null);for(var b=0;b<this.KMa.length;++b)Array.add(this.hI,e7(this.KMa[b],5));for(var b=this.hI,c=b.length,d=0;d<c;++d)b[d].wc(a);this.J.H(vS,null);var e=L.ia("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),f=mc(Fc.$$(Hc),kc(this.J,Fc.$$(Hc))),g=this;D(C(lc(this.J.ma(gre,null),
AS),function(){return new gre(g.J.H(cd,null),g.J.H(tS,null),g.J.H(Qw,null),g.J.H(wS,null),g.J.H(rS,null))}));var h=this;C(D(lc(this.J.ma(V9,null),Iga)),function(){return new V9(h.J.H(yQ,null),h.J.H(Bo,null),h.J.H(T,null),h.J.H(WM,null))});C(D(lc(this.J.ma(wne,null),Rme)),function(){return new wne(a.H(Ohe,null),new (ga.$$(Fc.$$(Hc)))(function(){return ab(f)}),a.H(E9,null))});C(D(this.J.ma(I9,null)),function(){return new I9(Zf())});C(D(lc(this.J.ma(H9,null),Pme)),function(){return new H9});var k=this;
C(D(this.J.ma(hre,null)),function(){return new hre(k.J.H(dd,null),k.J.H(H9,null),k.J.H(T,null))});var l=this;C(D(this.J.ma(ire,null)),function(){return new ire(l.J.H(dd,null),l.J.H(H9,null),l.J.H(T,null))});var m=this;C(D(lc(this.J.ma(mne,null),Xme)),function(){return new mne(new lne(new (ga.$$(tc))(function(){var a;Efe()?(a=m.J.H(Yme,null).rX,a=new cne(a.contentWindow,"*")):a=F.xUc;return a}),e?$m(window.document.URL):$m(F.dva),ye(L).ImageFetcherSupportedExtensions))});D(lc(this.J.ma(dne,null),E9));
C(D(lc(this.J.ma(G9,null),Yme)),function(){return new G9});D(lc(this.J.ma(jre,null),Zqe));C(D(this.J.ma($qe,null)),function(){return new kre});var n=this;C(D(this.J.ma(lre,null)),function(){return new lre(n.J.H(EN,null),iA(n.J.H(Ow,null),8),n.J.H(M3,null),n.J.H(GN,null),n.J.H(aN,null),n.J.H(Dd,null),n.J.H(T,null),n.J.H(tBb,null))})},ub:function(){var a=this.rg.jq("resolvechronos2"),b=this.J.H(F,null),c=this.J.H(vS,null),d=c.za,e=b.Fb,f=this.J.H($qe,null),g=this.J.H(dd,null),h=this.J.H(AS,null),k=
this.J.H(uS,null),l=this.J.H(cL,null),m=e.me,n=this.J.H(BN,null),r=this.J.H(XM,null),t=ic(this.J,CS),v=this.J.H(UM,null),x=this.J.H(Qw,null),y=this.J.H(mQ,null),z=this.J.H(A3,null),E=this.J.H(WM,null),H=e.Dc,O=this.J.H(j2,null),Q=this.J.H(PM,null),U=this.J.H(K2,null),V=this.J.H(c2,null),Z=this.J.H(ZM,null),Y=this.J.H($R,null);this.rg.lq(a);a=this.rg.jq("regactorschronos2");k=[new mre(d,g,h,kc(this.J,uNb)),new nre(d,k,g,m,this.J.H(GN,null),n,t,h,kc(this.J,zS),x,y,z),new ore(d,g,y,v,l,this.J.H(GN,null),
n,this.J.H(Zqe,null),this.J.H(Xme,null),this.J.H(E9,null),this.J.H(H9,null),kc(this.J,Ci),this.J.H(hre,null),this.J.H(ire,null),E,r,Z,Y,V,z,this.J.H(G9,null),this.J.H(Rme,null),this.J.H(I9,null),this.J.H($sd,null),this.J.H(Zsd,null),this.J.H($Nb,null),this.J.H(fS,null),this.J.H(pd,null),this.J.H(md,null)),new pre(g,this.J.H(rtd,null),this.J.H(tL,null),this.J.H(xtd,null),this.J.H(GN,null),y,v,V,this.J.H(BN,null),r,m,this.J.H(eK,null),l,this.J.H(iK,null),d.RCc)];m=k.length;for(n=0;n<m;++n)r=k[n],r.Wb(),
r.Of();h.JCc=!0;this.rg.lq(a);var ca=this;L.Nf(function(){a=ca.rg.jq("regfullactorschronos2");for(var b=[new qre(g,y,l,v,ca.J.H(tS,null).hg(),O,c.Xj.Xo.QVe,Q,ca.J.H(rre,null),ca.J.H(sre,null),ca.J.H(iu,null),U,f,ca.J.H(tre,null),Xoa,ca.J.H(DS,null),ca.J.H(iK,null),ca.J.H(T,null),ca.J.H(md,null),ca.J.H(WM,null),function(){return rj},c.eib(),function(a){return b6b(G().rb(),a)},function(){return F.Zyb},ca.J.H(ddd,null),ca.J.H(RZ,null)),new ure(e,d.ySd,H.yEc,g,E,c.eib(),ca.J.H(iK,null),ca.J.H(T,null))],
h=b.length,k=0;k<h;++k){var m=b[k];m.Wb();m.Of()}ca.rg.lq(a)});R(40145439,809,50,"Chronos2Package::Init");h=this.hI;k=h.length;for(m=0;m<k;++m)n=h[m],this.rg.jq(n.Xb()),n.ub(),this.rg.lq(n.Xb());a=this.rg.jq("al");vre(this);this.rg.lq(a);var la=this;L.Nf(function(){if(d.B8){a=la.rg.jq("idea");if(d.aH){var c=[Ni("ir-plugin-ski.min.js",5),Ni("infrared.hermes"+RU(b),1),Ni("microsoft.ideas.runtime.js",5)];KY(la.J.H(IY,null),Ni("ideas.hermes"+RU(b),1),c,null)}else c=wre(la),xre(la,c);la.rg.lq(a)}d.CRa&&
(a=la.rg.jq("smartLookup"),yre(la),la.rg.lq(a));F.R7b&&F.C3b&&!rj&&(a=la.rg.jq("versionhistory"),zre(la),la.rg.lq(a));!d||!d.LHc||Xf()||sma()||so()||0<=window.navigator.userAgent.indexOf("Windows Phone")||Je(window.Common.App.AppLifecycleManager.get_instance(),7,function(){la.J.H(lre,null).af()},3);var e=la.J.H(T,null);if(e&&(e.dMc||e.cMc||e.eMc)){var f=!!L.Va("TenantId")&&Array.contains(e.RMc,L.Va("TenantId"));C(D(la.J.ma(Are,null)),function(){return new Are(la.J.H(EN,null),iA(la.J.H(Ow,null),8),
la.J.H(GN,null),la.J.H(dK,null),la.J.H(Dd,null),e.FYd,e.EYd,e.dMc,e.cMc&&L.ia("IsO365ConsumerHost"),e.eMc,e.RRd&&f)});c=la.J.H(Are,null);la.LSe.push(c);c.af()}});apa||(a=this.rg.jq("appforoffice"),Bre(this),this.rg.lq(a));d.Drb&&Pxc(this.J.H(LZ,null))},ha:function(){for(var a=this.hI,b=a.length,c=0;c<b;++c)a[c].ha();a=this.LSe;b=a.length;for(c=0;c<b;++c){var d=a[c];try{d&&d.dispose()}catch(e){R(589635875,306,10,"Exception disposing a disposable. {0} {1}",e.message,e.stack)}}}};
function Bre(a){a=a.J.H(T,null);B().H(AS,null).iUc()?dre():a.Fk()?L.Nf(fre):Je(window.Common.App.AppLifecycleManager.get_instance(),8,function(){fre()},3)}function zre(a){a=mU(a.PG,Pi()+"pptVersionHistory.js");try{nk(a)}catch(b){R(40145478,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",b.toString())}}
function yre(a){R(41236128,809,50,"Start to download smartlookup.hermes.js file");var b=Ni("smartlookup.hermes"+RU(a.J.H(wS,null)),1);a=mU(a.PG,b);nk(a)}function xre(a,b){R(40145476,809,50,"Start to download ideas.hermes.js file");b=hYb(a.PG,Ni("microsoft.ideas.runtime.js",5),[b],!1);a=hYb(a.PG,Ni("ideas.hermes"+RU(a.J.H(wS,null)),1),[b],!1);nk(a)}
function wre(a){R(40145474,809,50,"Start to download infrared.hermes.js file");var b=[mU(a.PG,Ni("ir-plugin-ski.min.js",5))];a=hYb(a.PG,Ni("infrared.hermes"+RU(a.J.H(wS,null)),1),b,!1);nk(a);return a}
function vre(a){R(51468371,809,50,"Start to download augloop.hermes.js file and its dependency files");try{var b=Ni("augloop.hermes"+RU(a.J.H(wS,null)),1);if(a.J.H(T,null).iJc){var c=Ni("augloop-runtime-shim-ie",2);if(a.J.H(T,null).aH)c=[c],KY(a.J.H(IY,null),b,c,null);else{var d=a.J.H(Gga,null);o1b(d,c).CW(function(){o1b(d,b)})}}else if(a.J.H(T,null).aH)KY(a.J.H(IY,null),b,null,null);else{var e=mU(a.PG,b);nk(e)}}catch(f){R(51468373,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",
f.message,f.stack)}}function mre(a,b,c,d){this.Oof=Function.createDelegate(this,this.Ofg);this.Cra=Function.createDelegate(this,this.Krg);this.fa=b;this.ka=a;this.qR=this.ka.x3;this.wU=c;this.Hpd=d}
mre.prototype={fa:null,qR:!1,wU:null,Hpd:null,ka:null,Wb:function(){this.fa.ua(407117407,1,this.Cra,4);this.fa.ua(1402209562,1,this.Cra,4);this.fa.ua(543799107,1,this.Cra,4);this.fa.ua(1309495434,1,this.Oof,96);this.fa.ya(516359383,1,this.Cra);this.fa.ua(1782110672,1,this.Cra,64);this.fa.ya(2517401660,1,this.Cra);this.fa.ua(1592314317,1,this.Cra,64);this.fa.ya(2269104277,1,this.Cra);this.fa.ya(3280707168,1,this.Cra)},Of:function(){},Krg:function(a,b,c,d,e){if(!this.qR)return 16;if(1===c)return b=
1402209562===a&&(!W9(this)||!W9(this).IQf(e)),a=1402209562===a&&!!W9(this)&&W9(this).Rng(e),b||a?8:32;if(W9(this))switch(a){case 407117407:W9(this).TTa(e);break;case 1402209562:W9(this).STc(e);break;case 1309495434:W9(this).Fie(e);break;case 516359383:W9(this).Yng(e);break;case 1782110672:W9(this).Dje(e);break;case 543799107:W9(this).Vig();break;case 2517401660:W9(this).$og(e);break;case 1592314317:W9(this).WWf(e);break;case 2269104277:W9(this).Xng(e);break;case 3280707168:W9(this).oNf(e)}else this.wU.W8a(),
this.wU.AMa.ga(new Dre(a,e));return 32},Ofg:function(a,b,c,d,e){if(!this.qR)return 16;W9(this)&&W9(this).Fie(e);return 32}};function W9(a){return a.Hpd?a.Hpd.Da():null}
function nre(a,b,c,d,e,f,g,h,k,l,m,n){this.Kaf=Function.createDelegate(this,this.zWf);this.O$e=Function.createDelegate(this,this.oVf);this.I7e=Function.createDelegate(this,this.xRf);this.maf=Function.createDelegate(this,this.UVf);this.H7e=Function.createDelegate(this,this.wRf);this.naf=Function.createDelegate(this,this.rde);this.cpf=Function.createDelegate(this,this.fgg);this.I$e=Function.createDelegate(this,this.fVf);this.v8e=Function.createDelegate(this,this.pSf);this.I8e=Function.createDelegate(this,
this.JSf);this.H8e=Function.createDelegate(this,this.ISf);this.ka=a;this.qR=this.ka.kJc;this.AOe=this.ka.x3;this.Xq=b;this.fa=c;this.Hb=d;this.ra=e;this.iSb=g;this.Cb=f;this.wU=h;this.vd=k;this.Gd=l;this.ef=m;this.jk=n}
nre.prototype={Xq:null,fa:null,Hb:null,ra:null,Cb:null,iSb:null,wU:null,vd:null,Gd:null,ef:null,jk:null,ka:null,coc:0,THe:!1,qR:!1,AOe:!1,Wb:function(){this.fa.ua(2300394269,1,this.H8e,516);this.fa.ua(2741813164,1,this.I8e,4);this.fa.ya(1592244241,1,this.v8e);this.fa.ua(2620643039,1,this.I$e,4);this.fa.ua(860152194,1,this.cpf,96);this.fa.ya(2123786558,1,this.naf);this.fa.ya(2755471162,1,this.H7e);this.fa.ya(2451283737,1,this.maf);this.fa.ya(1530887760,1,this.I7e);this.fa.ya(1323818969,1,this.O$e);
this.fa.ya(1307613806,1,this.Kaf)},Of:function(){},Ig:function(){return this.vd.Da()},UVf:function(a,b,c,d,e){if(2!==c)return 32;var f=e.extId;e=e.OptionalProps;var g={};g.W9=e.Ksa.TaskPaneTitle;g.AP=x8d(f);g.Hab=e.Ksa.OnRenderedCallback;g.AW=e.IZb;g.PDb=!0;return this.rde(a,b,c,d,g)},xRf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;e=e.OptionalProps;b={};b.W9=e.Ksa.TaskPaneTitle;b.AP=x8d(a);b.Ybb=e.Ksa.SourceLocationOverrideResourceId;b.Hab=e.Ksa.OnRenderedCallback;b.AW=e.IZb;b.PDb=!0;e=this.Ig().uxb(b);
return(e=this.Ig().l_(e))&&this.Ig().CPc(e.gl)?32:8},oVf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;b=e.OptionalProps;e={};e.W9=b.Ksa.TaskPaneTitle;e.AP=x8d(a);e.Ybb=b.Ksa.SourceLocationOverrideResourceId;e.Hab=b.Ksa.OnRenderedCallback;e.AW=b.IZb;e.PDb=!0;a=this.Ig().uxb(e);return(a=this.Ig().l_(a))?(this.Ig().Yie(a.gl,e),32):8},ISf:function(a,b,c,d,e){b=this.ra.Ma();d=this.Hb.hg();if(!(this.qR&&b&&d)||this.ef.$d(b))return 8;if(!this.qR||oj&&!pj)return u(571860047,802,50,"Web add-in insert blocked by doc IRM"),
8;if(1===c)return 32;this.Ig()?this.Ig().p_f():(this.wU.W8a(),this.wU.AMa.ga(new Dre(a,e)));return 32},JSf:function(a,b,c,d,e){if(!this.qR||oj&&!pj)return u(571860048,802,50,"Web add-in insert blocked by doc IRM"),16;if(!e)return 8;if(e.targetType===window.OSF.OsfControlTarget.InContent)return Ere(this,e,a);if(e.targetType===window.OSF.OsfControlTarget.TaskPane){if(this.ef.$d(this.Hb.hg()))return 16;if(this.AOe)if(e.isAddinCommands)$H("AddinCommandsActionTypeUndefinedCheck")?A(e.addinCommandsActionType)||
!e.addinCommandsActionType?this.rDb(e):1===e.addinCommandsActionType?Fre(this,e):u(524118089,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+e.addinCommandsActionType.toString()):e.addinCommandsActionType?1===e.addinCommandsActionType&&Fre(this,e):this.rDb(e);else{a={};a.marketplaceId=e.solutionId;a.marketplaceVersion=e.version;a.storeType=e.storeType;a.storeId=e.storeId;a.targetData=e;var f=this;this.Ig().Bx().isAddinCommandsAsync(a,function(a,b,c){b?f.rDb(c.targetData):
Fre(f,c.targetData);a||(a=c.targetData,u(542994527,220,10,"Checking AddinCommands fails for {0} from {1}",window.Telemetry.PrivacyRules.GetPrivacyCompliantId(a.solutionId,a.storeType,a.assetId,null,null,a.storeId),a.storeType))})}else Fre(this,e);ofe[pfe(e.solutionId,e.targetType,e.storeId,e.storeType,e.version)]=!0;return 32}return 8},pSf:function(a,b,c,d,e){if(!this.qR)return 16;if(!e)return 8;if(1===c)return 32;a=window.$$as(String,e);if(!a||!a.length)return 8;if((b=this.Ig().jSc(a))&&b.Tk){if(this.Ig().rla(a))return this.Ig().Cbb(a,
!1),32;if(b.Ym&&window.OSF.OsfControl.isFirstPartyStoreString(b.Ym.YH()))return this.Ig().mRc(a),this.Ig().lig(a),32;b=b.Tk.RA();if(this.Ig().lZf(a)||b)this.Ig().mRc(a);else if(b=this.Ig().G6b(),c=aH(b),a=this.Ig().Abe(a)){c.Gl(window.$$as(my,a));a=this.Cb.qe(4,0,null,null,!0);try{a.Jc(b),dy(c)}finally{a&&a.dispose()}}}return 32},fVf:function(a,b,c,d,e){if(!this.qR)return 16;if(!e)return 8;if(1===c)return 32;b=window.$$as(String,e);if(!b||!b.length)return 8;this.Ig()?this.Ig().w2c(b):this.wU.AMa.ga(new Dre(a,
e));return 32},rde:function(a,b,c,d,e){if(!this.qR)return 16;if(!e)return 8;if(1===c)return 32;if(this.Ig()){if(!e||!e.AP||!kEc(e.AP))return 8;e.AW||(e.AW={});e.AW.ShowFeedback=F.JB;!this.THe&&this.coc&&(this.THe=!0,a=window.performance.now()-this.coc,u(41760289,220,50,"Apps for office load time {0}",a));a=this.Ig().uxb(e);if(a=this.Ig().l_(a))return this.Ig().Yie(a.gl,e),32;this.Ig().Zjg(e)}else this.coc||(this.coc=window.performance.now()),this.wU.W8a(),this.wU.AMa.ga(new Dre(a,e));return 32},zWf:function(a,
b,c,d,e){if(1===c)return this.qR?32:8;if(!this.qR)return 16;if(!(e&&e.iu&&-1!==e.iu.Ah()&&e.iu.Kca&&this.Ig()))return 8;a=this.Ig().dua(e.Ym.Ta());if(!a)return 8;b=this.Cb.qe(4,0,null,null,!0);try{b.Jc(a),J(a,A_a,e.iu.Ah()),J(a,B_a,e.iu.Kca),J(a,qQa,e.Ym.YH())}finally{b&&b.dispose()}return 32},wRf:function(a,b,c,d,e){return this.qR?e?1===c?32:this.Ig()&&e&&e.length?this.Ig().CPc(e)?32:8:8:8:16},fgg:function(a,b,c,d,e){if(2===c){a=e.callback;if(!a)return 16;b=new Cga;b.callbackFunc=a;b.storeType=window.OSF.StoreTypeEnum.MarketPlace;
b.fromInsertDialog=!1;b.refresh="true"===f7().o9("refreshRequired");this.Ig().Bx().queryEntitlementDetails(b)}return 32},rDb:function(a){var b=new (Ca.$$(Object));b.ga(a);a={};a.ack2=b;a.ack0=3;this.fa.jb(407117407,2,a,null)}};
function Fre(a,b){if(!a.Ig().l_(b.solutionId)){var c=a.Ig().dua(b.solutionId),d=a.Ig().G6b();if(c){d=new P2(c);if(!d.dY()){e=a.Cb.qe(4,0,null,null,!0);try{e.Jc(c),J(c,sQa,!0),J(c,qQa,b.storeType)}finally{e&&e.dispose()}}a.Ig().w2c(d.Ta())}else{c=a.iSb.Aa();e=a.Ig();c=window.$$as(my,c.Gn(1074135137));lfe(c,b,e);var e=a.Cb.qe(4,0,null,null,!0);try{e.Jc(d),a=c,Xy(d).Xf(a,19)}finally{e&&e.dispose()}}}}
function Ere(a,b,c){var d=a.ra.Ma();if(!d||a.ef.$d(d))return 16;if(!C3(a.jk,d,1))return B3(a.jk,d),16;try{d.gc();var e=b.width,f=b.height,g=gV(d)+1,h=d.gc().Be(),k=d.gc().Pc(),l=d.Qk.a9(h,k,0,g,!1);cU(l,!1,0,0,e,f);dU(l,e,f);lfe(l,b,a.Ig());m5(a.Xq,[window.$$as(YM,l)],d,c,null,null,!0);ofe[pfe(b.solutionId,b.targetType,b.storeId,b.storeType,b.version)]=!0;return 32}catch(m){return 8}}function Gre(a,b){Gre.initializeBase(this,[a.cOb()]);this.Gj=a;this.Fc=b;gfe="WAC_Powerpoint"}
Gre.prototype={Gj:null,Fc:null,MSc:function(){var a=new (wa.$$(w.r8a,w.pka));this.Fc.ia(S(51))&&(a.ea(0,2),a.ea(16,5));this.Fc.ia(S(187))&&a.ea(1,1);this.Gj.za.x3&&a.ea(8,1);this.Fc.ia(S(305))&&a.ea(10,5);return a}};function ere(){}
ere.prototype={J:null,Xb:function(){return"PowerPointWebEditor.AddinCommands"},wc:function(a){this.J=a;var b=this;D(C(lc(B().ma(Gre,null),age),function(){return new Gre(b.J.H(vS,null),b.J.H(md,null))}))},ub:function(){this.J.H(T,null).UFc&&this.J.H(md,null).Nf(function(){$fe()})},ha:function(){}};function gre(a,b,c,d,e){this.Knb=[];this.$od=!1;this.iqc=null;this.AMa=new (Ca.$$(Dre));this.fa=a;this.vwc=b;this.JCc=!1;this.Gd=c;this.Xj=d;this.PG=e;this.kqc=this.PSb=null}
gre.prototype={Knb:null,$od:!1,iqc:null,AMa:null,fa:null,vwc:null,Gd:null,Xj:null,PG:null,PSb:null,kqc:null,jFf:function(a){this.Knb.push(a)},W8a:function(){if(!this.$od){if(B().H(T,null).aH){var a=[AEc(this)];KY(B().H(IY,null),BEc(this),a,null)}else this.iqc||(a=[mU(this.PG,AEc(this))],this.iqc=hYb(this.PG,BEc(this),a,!1)),nk(this.iqc);this.$od=!0}},iUc:function(){var a=!!this.Knb&&0<this.Knb.length,b=!1;if(this.vwc.hg()&&!a){var c=aH(this.vwc.hg()).Jb(18);c&&0<tA(aH(c),19)&&(b=!0)}return a||b},
JCc:!1};function BEc(a){a.kqc||(a.kqc=Ni("appforoffice.hermes"+RU(a.Xj),1));return a.kqc}function AEc(a){a.PSb||(a.PSb=Ni("officeExtensionMerge.js",5));return a.PSb}function Dre(a,b){this.Sh=a;this.Zba=b}Dre.prototype={Sh:0,Zba:null};
function ore(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U,V,Z,Y,ca,la,ra){this.TYb=Function.createDelegate(this,this.Y4c);this.tOd=Function.createDelegate(this,this.Iog);this.uLa=Function.createDelegate(this,this.rCe);this.dqb=Function.createDelegate(this,this.S4c);this.e$d=Function.createDelegate(this,this.TCe);this.kCc=Function.createDelegate(this,this.R4c);this.cqb=Function.createDelegate(this,this.Eog);this.tCc=Function.createDelegate(this,this.P6c);this.Vxf=Function.createDelegate(this,this.mtg);
this.Wxf=Function.createDelegate(this,this.otg);this.Yzc=Function.createDelegate(this,this.KHf);this.uCc=Function.createDelegate(this,this.ntg);this.V0e=Function.createDelegate(this,this.JHf);this.Uxf=Function.createDelegate(this,this.ktg);this.ka=a;this.fa=b;this.jc=c;this.pa=d;this.Ia=e;this.ra=f;this.Cb=g;this.gRb=h;this.uOe=k;this.fRb=l;this.Lpa=m;this.ijb=n;this.Tha=r;this.rMa=t;this.Mb=v;this.Qk=x;this.$a=y;this.Lb=z;this.Ls=E;this.jk=H;this.hmb=O;this.tNa=Z;this.PRb=Y;this.xd=ca;this.ZE=a.vRa;
this.Fc=ra;this.hmb&&(this.hmb.rX.removeAttribute("style"),this.hmb.rX.style.display="none");this.Mvc=Q;this.vOe=U;this.QU=V;this.pPb=la;var sa=this;this.ijb.pb(function(a){a.Ge("MsoPremiumStockImages",!1).catch(function(a){return R(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",a)}).then(function(b){sa.Huc=b;sa.Huc||(sa.yDg=a.VGa("MsoPremiumStockImages",function(){sa.Huc=!0;R(593627150,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));
return null})})}function Hre(){return kU(CommonUIStrings.l_AttributionText.split(/[{}]+/),function(a){return!!a})}function Ire(a){var b=document.createElement("span");b.innerText=a;return b}function Jre(a,b){var c=document.createElement("A");c.setAttribute("href",b);c.setAttribute("target","_blank");c.setAttribute("rel","noreferrer");b=document.createElement("span");b.innerText=a;c.appendChild(b);return c}
function Kre(a){var b=Hre(),c=document.createElement("body"),d="",e="",f=CommonUIStrings.l_CCYYSA;A(a)||(A(a.PageUrl)||(d=a.PageUrl),!A(a.LicenseDisplayName)&&0<a.LicenseDisplayName.length&&(f=a.LicenseDisplayName),A(a.LicenseUrl)||(e=a.LicenseUrl));a=b.length;for(var g=0;g<a;++g){var h=b[g];switch(h){case "L_ThePhoto":h=Jre(CommonUIStrings.l_ThePhoto,d);break;case "L_CCYYSA":h=Jre(f,e);break;case "L_PhotoAuthor":h=Ire(CommonUIStrings.l_PhotoAuthor);break;default:h=Ire(h)}h&&c.appendChild(h)}b=document.createElement("html");
b.appendChild(c);return b}
ore.prototype={ka:null,jc:null,fa:null,pa:null,Ia:null,uOe:null,Lpa:null,ijb:null,Tha:null,rMa:null,ra:null,Cb:null,gRb:null,fRb:null,Mb:null,Qk:null,$a:null,Lb:null,Ls:null,jk:null,tNa:null,PRb:null,xd:null,hmb:null,Mvc:null,vOe:null,QU:null,Fc:null,pPb:null,Wib:!1,Huc:!1,yDg:null,ZE:!1,Wb:function(){Lre(this);this.fa.ua(3141441444,1,this.Uxf,4);this.fa.ua(4052404557,1,this.V0e,4);this.fa.ua(2168883939,1,this.uCc,4);this.fa.ua(2795955220,1,this.Yzc,4);this.fa.ua(330605680,1,this.uCc,4);this.fa.ua(4001411159,
1,this.Yzc,4);this.fa.ua(3979510275,1,this.uCc,4);this.fa.ua(1074547044,1,this.Yzc,4);CEc(this);this.fa.ua(723905578,1,this.uCc,4);this.fa.ua(303111889,1,this.Yzc,4);Mre(this);this.fa.ua(2168458114,1,this.Wxf,4);this.fa.ua(3276230454,1,this.Vxf,4);this.fa.ua(3612507612,1,this.tCc,96)},Y4c:function(a){if(a.rawEvent&&(a=a.rawEvent.data))try{R(33944475,352,50,"User select images.");var b=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),c=b.MessageId?b.MessageId.toString():null;b&&c&&("UI_InsertImage"===
c||"UI_InsertFileLink"===c)&&this.Mvc.af("UI_InsertImage"===c?this.Tha:this.vOe)}catch(d){R(33944477,352,10,"malformatted postmessage here.")}},Of:function(){},P6c:function(){return 32},R4c:function(a,b,c){b=this.ra.Ma();if(!X9(this,b,a,this.ka.y8))return 8;if(1===c)return 32;R(8955410,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{var d=Ae(),e=zh(this.ka.$sb).toString(),f=1685987254===a&&this.ka.YZd?1:0,g=String.format(this.ka.Irb,F.ag,ao(F.ag)._name,Jp,d.toString(),3,e,f);
0<this.ka.Irb.search(/insertmedia.bing.office.net/gi)&&(g=String.format(this.ka.XZd?this.ka.QTd:this.ka.Irb,qne(window.Box4.App.Rg)));var h=this;this.ijb.pb(function(b){b=h.gRb.ou(g,h.fRb,h.Lpa,b,fne);b.g_e(h.ka.psa);b.uPa(d);b.yWb(1);switch(a){case 3565639685:h.rMa.cja(2795955220);break;default:h.Tha.cja(2168883939)}b.AVa(CommonUIStrings.L_PictureInsertTitle,1685987254===a?h.Tha:h.rMa);R(8955412,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(k){return R(8955414,
352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",k.toString()),8}},TCe:function(a,b,c){if(1===c)return 32;a=new om(!1,!1,!1,!1);Ej(a,5);a.Hp=pm("<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>",ResourceStrings.l_InsertSocialMediaDialogMsg);a.zk(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{id:"SocialMediaExperimentDialog"});
R(520680148,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32},Eog:function(a,b,c){b=this.ra.Ma();if(!X9(this,b,a,this.ka.Ija))return 8;if(1===c)return 32;var d,e;switch(a){case 2691408781:case 2582565347:d=this.ka.STd;e=1;this.Tha.cja(330605680);break;case 3143141002:d=this.ka.t_b;e=1;this.Tha.cja(3141441444);break;case 1332899609:d=this.ka.rQd;e=0;this.rMa.cja(4052404557);break;case 148018230:d=this.ka.sQd;e=0;this.rMa.cja(4001411159);break;default:return R(593627140,
352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",a.toString()),16}if(!d||!d.length)return 16;R(50869124,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{var f=Ae(),g=zh(this.ka.$sb).toString(),h=this;this.ijb.pb(function(b){var c=h.ka.RTd&&b.KTa(),c=h.Huc?1:c?0:-1,m=L.ia("InsertOnlineM365ExperimentEnabled")?1:0,n=d,r=e,t=f.toString(),v=qne(window.Box4.App.Rg),x=ao(F.ag)._name,y=Jp;aB("ShIns226;ShIns226cf");m=String.format(n,F.ag,x,y,t,v,
g,c,r,m);b=h.gRb.ou(m,h.fRb,h.Lpa,b,"<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>");b.uPa(f);b.yWb(2);b.b_e(c);b.AVa(CommonUIStrings.L_PictureInsertTitle,1332899609===a||148018230===a?h.rMa:h.Tha);R(50869126,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(k){return R(50869128,
352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",k.toString()),8}},S4c:function(a,b,c){b=this.ra.Ma();if(!X9(this,b,a,rW()&&(Nre?!!this.Mvc.Fib()&&9<this.Mvc.Fib().length:!0)))return 8;if(1===c)return 32;R(17838496,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{c=!0;var d=0;if(L.ia("InsertMediaSharedFilePickerEnabled")){var e=B().H(No,null);if(Mie()){c=!1;var f=this.ka.Vib;b=!1;this.ka.nta&&(b=rEc());var g,h=(g=new gGa,g.Q8d=b,g.zNc=!0,g),
k=Oie(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,f,"InsertPicture",0,h),l=this;e.ZSc(k).then(function(a){if(a&&0<a.length){for(var b=[],c=0;c<a.length;c++){var e=a[c].url,f={};f.Extension=a[c].type;f.OriginalUrl="downloadUrl"in a[c]?a[c].downloadUrl:e;f.Type="extension"in a[c]?a[c].extension:"";f.Caption="name"in a[c]?a[c].name:"";f.Description="description"in a[c]?a[c].description:"";f.Width="imageWidth"in a[c]?a[c].imageWidth:0;f.Height="imageHeight"in
a[c]?a[c].imageHeight:0;Array.add(b,f)}l.Tha.cja(3979510275);l.Tha.Aua(b);R(17838498,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}d=32}).catch(function(a){R(17838528,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",a.toString());d=8})}}if(!c)return d;Nre=!0;!this.Wib&&rW()&&Efe()&&(G().lh().appendChild(this.hmb.rX),hh(this.hmb.rX.contentWindow,"message",this.TYb),this.Wib=!0);var m=this.uOe.ou();m.yWb(4);switch(a){case 2057552935:this.rMa.cja(1074547044);
break;default:this.Tha.cja(3979510275)}m.AVa(CommonUIStrings.L_PictureInsertTitle,720118144===a?this.Tha:this.rMa);R(559010630,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(n){return R(559010631,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",n.toString()),8}},rCe:function(a,b,c){b=this.ra.Ma();if(!X9(this,b,a,this.ka.nta&&L.fc("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===
c)return 32;tEc();try{var d=0,e=B().H(No,null);if(Mie()){var f=509870209===a,g=this.ka.Vib,h,k=(h=new gGa,h.Q8d=!0,h.zNc=!0,h),l=Oie(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,f,g,"InsertPictureFromMobile",3,k),m=this;e.ZSc(l).then(function(a){if(a&&0<a.length){for(var b=[],c=0;c<a.length;c++){var e=a[c].url,g=a[c],h={};h.Extension=a[c].type;h.OriginalUrl=K1(g,"downloadUrl",e);h.Type=K1(g,"extension","");h.Caption=K1(g,"name","");h.Description=K1(g,"description",
"");h.Width=K1(g,"imageWidth",0);h.Height=K1(g,"imageHeight",0);Array.add(b,h)}a=f?m.Tha:m.rMa;a.cja(f?723905578:303111889);a.Aua(b);R(537012059,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}d=32}).catch(function(a){R(537012060,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",a.toString());d=8})}return d}catch(n){return R(537012061,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",
n.toString()),8}},ntg:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090389,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.y8))return 8;if(1===c)return 32;if(!C3(this.jk,b,1))return B3(this.jk,b),16;try{var f=hV(b,this.pa.Tb());if(f&&this.jc.$d(f))return 16;var g=this.HFa(this.Lb,b,f),h=null,k=this,l=this,m=this.Cb.qe(15,0,function(){uR(k.pa);xR(k.pa);k.Ia.ne()},function(){l.pa.Hl(g,!0,!0);h&&l.pa.Hl(h,!1,!0)},!1);try{m.Jc(b);m.xe(1685987254);m.tL.ElementSource="Online";c=null;a={actionId:a};
if(this.ka.btb)if(e.LicenseUrl&&e.LicenseDisplayName){var n=Kre(e);c=en(n);if(this.ka.SKc)var r=b.gc(),h=tU(this.Qk,!0,r.Be(),r.Pc(),0,0,110,75,gV(b)+1,!1)}else a["result.LicenseDisplayName"]=e.LicenseDisplayName,a["result.LicenseUrl"]=zh(e.LicenseUrl);else a.IsEnabled=this.ka.btb;R(39409185,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",a);Yee(g,e.OriginalUrl,e.LicenseUrl?null:e.Caption,c,e.PageUrl);f&&b.vN([f]);b.wC(g,null);h&&(b.wC(h,null),Xee(g,h.Ta()),J(h,UYa,!0))}finally{m&&m.dispose()}z3(this.Ls,
g);return 32}catch(t){return R(8955416,352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",e.OriginalUrl,t.toString()),8}},KHf:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090390,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.D3))return 8;if(1===c)return 32;R(590128340,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!e)return 16;try{var f=this.iTa()||Ore(this);if(!f||this.jc.$d(f))return 16;var g=null,h=this,k=this.Cb.qe(15,0,null,
function(){h.pa.Hl(f,!0,!0);g&&h.pa.Hl(g,!1,!0);R(590128338,352,50,"InsertMediaActor::ChangeToOnlinePicture : Finish changing.")},!1);try{k.Jc(b);k.xe(2795955220);k.tL.ElementSource="Online";a=null;if(this.ka.btb&&e.LicenseUrl&&e.LicenseDisplayName){var l=Kre(e);a=en(l);if(this.ka.SKc){var m=b.gc(),g=tU(this.Qk,!0,m.Be(),m.Pc(),0,0,110,75,gV(b)+1,!1);R(590128336,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}Yee(f,e.OriginalUrl,e.LicenseUrl?null:
e.Caption,a,e.PageUrl);f.set_isSVGBlipFilled(!1);g&&(b.wC(g,null),Xee(f,g.Ta()),J(g,UYa,!0))}finally{k&&k.dispose()}z3(this.Ls,f);return 32}catch(n){return R(590128334,352,10,"InsertMediaActor::ChangeToOnlinePicture : Pic = [{0}], Exception = [{1}].",e.OriginalUrl,n.toString()),8}},ktg:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090391,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.Ija))return 8;if(1===c)return 32;R(38854735,352,50,"InsertMediaActor::UploadIcon : Start inserting.");
if(!e||!e.length)return 16;if(!C3(this.jk,b,e.length))return B3(this.jk,b),16;try{var f=null;c=null;var g,h,k;if(k=Pre(this,e,b,g={val:c},h={val:f}),c=g.val,f=h.val,!k)return 16;var l=this,m=this,n=this.Cb.qe(15,0,function(){uR(l.pa);xR(l.pa);l.Ia.ne()},function(){wR(m.pa,f,!0)},!1);try{for(n.Jc(b),n.xe(a),n.tL.ElementSource="Icon",c&&b.vN(c),a=0;a<f.length;a++)b.wC(f[a],null)}finally{n&&n.dispose()}z3(this.Ls,f[f.length-1]);return 32}catch(r){return R(37822680,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",
e.length,r.toString()),8}},JHf:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090392,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.V1b))return 8;if(1===c)return 32;R(38854738,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!e||!e.length)return 16;try{var f=Ore(this)||this.iTa();if(!f||this.jc.$d(f))return 16;var g=e[0].Caption,h=UP(f);g&&h&&Uee(this.xd,new VLb(b.gc(),f.get_shapeId(),f.get_smartArtModelId(),g));var k=this,l=this.Cb.qe(15,0,null,function(){h&&(Vee(k.xd),
k.pa.Hl(h,!0,!0),Wee(k.xd));R(590128329,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")},!1);try{l.Jc(f),l.xe(a),l.tL.ElementSource="Icon",f.set_isSVGBlipFilled(!0),Yee(f,e[0].OriginalUrl,g,null,null)}finally{l&&l.dispose()}(c=h||f)&&this.jc.vka(b,c,this.Lb.Eb(),a);return 32}catch(m){return R(38670732,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",e.length,m.toString()),8}},iTa:function(){if(this.ZE){var a=this.pa.Tb();return a&&a.length?this.KOc(a)?a[0]:
this.Y9a():null}return this.Y9a()},KOc:function(a){if(!a||!a.length)return!1;for(var b=YO(a[0]),c=1===wN(a[0]),d=a.length,e=0;e<d;++e)var f=a[e],b=b&&YO(f),c=c&&1===wN(f);return b||c},Y9a:function(){for(var a=this.pa.Tb(),b=a.length,c=0;c<b;++c){var d=a[c];if(d&&YO(d))return d}return null},Iog:function(a,b,c){b=this.ra.Ma();if(!X9(this,b,a,this.ka.QDa))return 8;if(1===c)return 32;try{if(this.ka.NFc){R(588001925,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");var d=
Ae(),e=zh(this.ka.$sb).toString(),f=this;this.ijb.pb(function(a){a=f.gRb.ou(pne(window.Box4.App.Rg,f.ka.UTd,d.toString(),e,f.ka.Urb),f.fRb,f.Lpa,a,"<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>");a.uPa(d);a.yWb(5);var b=new Qre(f.fa,f.Lpa,f.ka);b.cja(3276230454);a.AVa(CommonUIStrings.L_VideoInsertTitle,b)})}else if(this.ka.OFc)R(8955424,
352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new qxd(this.QU)).P9();else{R(38322659,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video");var g=this;this.ijb.pb(function(a){g.gRb.ou(rne(g.ka.VTd),g.fRb,g.Lpa,a,fne).AVa(CommonUIStrings.L_VideoInsertTitle,new Qre(g.fa,g.Lpa,g.ka))})}var h=this.Fc.Nda("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");$H("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==
h&&R(520976089,352,15,"InsertOnlineVideo::ToolTipMessage : "+h);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Fc.ona){var k=this.Fc.fc("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";R(520680147,352,15,"InsertOnlineVideo::SocialMediaIconIs"+k)}R(8955426,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(l){return R(8955456,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",l.toString()),
8}},otg:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090393,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.QDa))return 8;if(1===c)return 32;if(!C3(this.jk,b,1))return B3(this.jk,b),16;try{var f=hV(b,this.pa.Tb());if(f&&this.jc.$d(f))return 16;var g=this.HFa(this.Lb,b,f),h=nne(e.OriginalUrl);i2b(g,h,e.ThumbnailUrl,e.Caption,e.Description,0<e.Width?e.Width:0,0<e.Height?e.Height:0);var k=this,l=this,m=this.Cb.qe(15,0,function(){uR(k.pa);xR(k.pa);k.Ia.ne()},function(){l.pa.Hl(g,!0,!0)},
!1);try{m.Jc(b),m.xe(a),f&&b.vN([f]),b.wC(g,null)}finally{m&&m.dispose()}R(8955460,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",e.OriginalUrl);z3(this.Ls,g);return 32}catch(n){return R(8955462,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",n.toString()),8}},mtg:function(a,b,c,d,e){b=this.ra.Ma();if(!b)return R(557090394,352,50,"Active Slide is null"),8;if(!X9(this,b,a,this.ka.NFc))return 8;if(1===c)return 32;R(588001889,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");
if(!C3(this.jk,b,1))return B3(this.jk,b),16;try{var f=hV(b,this.pa.Tb());if(f&&this.jc.$d(f))return 16;var g=this.HFa(this.Lb,b,f);i2b(g,e.PageUrl,e.ThumbnailUrl,e.Caption,e.Description,0<e.Width?e.Width:0,0<e.Height?e.Height:0);var h=this,k=this,l=this.Cb.qe(15,0,function(){uR(h.pa);xR(h.pa);h.Ia.ne()},function(){k.pa.Hl(g,!0,!0)},!1);try{l.Jc(b),l.xe(a),f&&b.vN([f]),b.wC(g,null)}finally{l&&l.dispose()}R(588001887,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",
e.OriginalUrl);z3(this.Ls,g);return 32}catch(m){return R(588001885,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",m.toString()),8}},HFa:function(a,b,c){return Rre(this,b,c,null,!1,0)}};
function Rre(a,b,c,d,e,f){if(!b)return null;var g=b.gc();b=gV(b);var h=0,k=0;if(e){var l=h={val:h},m=k={val:k};c&&15===PO(c)?(l.val=ng(c.ta(Number,bu,0),0,!1),m.val=ng(c.ta(Number,cu,0),0,!1)):d&&0<d.Width&&0<d.Height?(l.val=d.Width,m.val=d.Height):(l.val=ng(2,0,!1),m.val=ng(2,0,!1));h=h.val;k=k.val}else h=110,k=75;d=c?k2b(c,h,k,!1):bV(a.Mb,h,k);f=c?0:15*f;a=tU(a.Qk,!0,g.Be(),g.Pc(),d.x+f,d.y+f,h,k,b+1,!0);a.set_isSVGBlipFilled(e);c&&qU(a,c.Ta());return a}
function X9(a,b,c,d){b=!!b&&d&&!a.jc.$d(b);switch(c){case 1332899609:return b&&(!!a.iTa()||!!Ore(a));case 3565639685:case 2057552935:case 1101801264:case 148018230:if(c=b)c=(a=a.iTa()||Ore(a))?UP(a)?!1:!0:!1;return c;default:return b}}function Ore(a){var b=null;a=a.pa.Tb();for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e&&e.get_isSVGBlipFilled())if(b)break;else b=e}return b}
function Pre(a,b,c,d,e){d.val=Array(b.length);e.val=Array(b.length);var f;f=a.pa.Tb();if((f=zZb(c,f))&&0<f.length)for(var g=0,h=f.length,k=0;k<h;++k){var l=f[k];if(l&&!a.jc.$d(l)&&g<b.length&&(d.val[g]=l,g++,g===b.length))break}f=!0;for(g=0;g<d.val.length;g++){if(a.ka.t7a&&b[g].SvgContent&&0<b[g].SvgContent.length&&(!d.val[g]||d.val[g]&&15!==PO(d.val[g]))){h=e.val;k=g;var m=a,n=c,l=d.val[g],r=b[g],t=g;if(n){var v=n.gc(),x=gV(n),y=void 0,z=void 0,n=window.$$as(uQ,Uy(n,m.Lb.Eb()));owd(m.tNa,l,r.Width,
r.Height,z={val:z},y={val:y});z=z.val;y=y.val;t=l?0:15*t;v=tU(m.Qk,!0,v.Be(),v.Pc(),y.x+t,y.y+t,z.ld,z.Ld,x+1,!1);x=pwd(m.Lb.Ve(),z,y,n.NU);MXb(v,x);J(v,Lt,!0);J(v,Nt,!0);f2b(v,!0);J(v,SVa,!0);v.set_isSVGBlipFilled(!0);b:if(r=r.SvgContent,x=m.PRb.qva(r),m=null,x&&x.innerHTML&&x.innerHTML.startsWith("<svg")){m=x.innerHTML;if(0<r.indexOf("viewBox")&&0>m.indexOf("viewBox"))if((x=r.match(/viewBox="[^"]*/))&&1===x.length&&x[0])m=m.replace("<svg",String.format('<svg {0}"',x[0]));else{m=null;break b}if(0<
r.replace(" ","").indexOf('xmlns="http://www.w3.org/'))m=0<m.indexOf("xmlns=")?m:m.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else{m=null;break b}}v.oob(m?String.format("data:image/svg+xml;charset=utf8,{0}",window.encodeURIComponent(m)):"");l&&qU(v,l.Ta());l=v}else l=null;h[k]=l}else e.val[g]=Rre(a,c,d.val[g],b[g],!0,g),f=!1;f&&XV(!0,!0);Yee(e.val[g],b[g].OriginalUrl,b[g].Caption,null,null)}return!0}
function K1(a,b,c){return b in a?a[b]:c}function Mre(a){a.fa.ua(2948423841,1,a.tOd,4);a.ka.UIc&&a.fa.WGa("ppt_insertOnlineVideos",!0,2948423841,1,a.tOd,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))})}
function CEc(a){a.ka.nta&&L.fc("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(a.fa.ua(509870209,1,a.uLa,4),a.fa.ua(1101801264,1,a.uLa,4),a.ka.UIc&&(a.fa.WGa("mso_insertMobileDevicePictures",!0,509870209,1,a.uLa,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))}),a.fa.WGa("mso_insertMobileDevicePictures",!0,1101801264,1,a.uLa,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))})))}
function Lre(a){a.fa.ua(3143141002,1,a.cqb,4);a.fa.ua(1332899609,1,a.cqb,4);a.fa.ua(1685987254,1,a.kCc,4);a.fa.ua(3565639685,1,a.kCc,4);$H("InsertSocialMediaVideoIcon")&&a.fa.ua(1182875165,1,a.e$d,4);a.fa.ua(2691408781,1,a.cqb,4);a.fa.ua(148018230,1,a.cqb,4);a.fa.ua(2582565347,1,a.cqb,4);a.fa.ua(720118144,1,a.dqb,4);a.fa.ua(2057552935,1,a.dqb,4);a.ka.UIc&&(a.fa.WGa("ppt_insertOnlinePictures",!0,1685987254,1,a.kCc,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,
c.T9a)))}),a.fa.WGa("ppt_insertOnlinePictures",!0,2691408781,1,a.cqb,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))}),a.fa.WGa("ppt_insertOnlinePictures",!0,2582565347,1,a.cqb,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))}),a.fa.WGa("ppt_insertOnlinePictures",!0,720118144,1,a.dqb,function(b){var c=a.pPb;G5b(window.Box4.App.Pb(),b,c.jja||(c.jja=Function.createDelegate(c,c.T9a)))}))}
function ire(a,b,c){ire.initializeBase(this,[a,b,null]);this.ka=c;this.uX=1488343741}
ire.prototype={ka:null,Aua:function(a){if(a&&a.length){var b=UH(this.uX),c=a[0];(c=!!c&&!!c.OriginalUrl&&0<c.OriginalUrl.length&&this.ka.V1b&&!!this.ka.BRa&&0<this.ka.BRa.length&&0<=c.OriginalUrl.toLowerCase().indexOf(this.ka.BRa.toLowerCase())&&c.OriginalUrl.toLowerCase().indexOf(".svg")===c.OriginalUrl.length-4)||R(38670750,352,50,"isChangeSvg = false");try{R(38670742,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",b,c?"ChangeOnlineIconUpload":
"ChangeOnlinePictureUpload");if(32!==(c?this.Fa.jb(4052404557,2,a,null):this.Fa.jb(this.uX,2,a[0],null)))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",c?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));R(38670744,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",b,c?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(d){R(38670748,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",
b,d.toString())}}}};function hre(a,b,c){hre.initializeBase(this,[a,b,null]);this.ka=c;this.uX=2168883939}
hre.prototype={ka:null,Aua:function(a){if(a&&a.length){var b,c=UH(this.uX),d=new window.Map;d.set("InsertMediaCommand",c);Ce().recordKpiUsageForAlertableKpi("InsertOnlineImage",null,d);try{for(var e=[],f=[],g=0;g<a.length;g++){var h=a[g];Sre(this,h)?Array.add(e,h):Array.add(f,h)}R(594043782,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",f.length,e.length,c);var k=this.uX;3141441444===k&&(k=330605680);for(g=0;g<f.length;g++)if(b=this.Fa.jb(k,2,f[g],null),32!==b)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",
f.toString(),c));if(Sre(this,e[0])&&(b=this.Fa.jb(3141441444,2,e,null),32!==b))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",e.toString()));R(594043780,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",f.length,e.length,c)}catch(m){R(21844552,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.uX.toString(),m.toString());d.set("Exception",m.toString());var l;Ce().recordKpiFailure("InsertOnlineImage","InsertMediaException",
!1,!0,(l=new nj,l.extendedProperties=d,l))}}}};function Sre(a,b){(a=!!b&&!!b.OriginalUrl&&0<b.OriginalUrl.length&&a.ka.Ija&&!!a.ka.BRa&&0<a.ka.BRa.length&&0<=b.OriginalUrl.toLowerCase().indexOf(a.ka.BRa.toLowerCase())&&b.OriginalUrl.toLowerCase().indexOf(".svg")===b.OriginalUrl.length-4)||R(37822723,352,50,"isInsertSvg = false");return a}function Qre(a,b,c){Qre.initializeBase(this,[a,b,null]);this.tVb=c.d6a;this.uX=2168458114}
Qre.prototype={tVb:null,Aua:function(a){if(a&&0<a.length){var b=cj(a[0].OriginalUrl),b=this.dWc(b)?b:"unsupported";R(554967957,352,50,"InsertMediaCallback: Insert online video called for {0}",b);this.Fa.jb(this.uX,2,a[0],null)}},dWc:function(a){if(!a)return!1;a=a.trim();for(var b=this.tVb,c=b.length,d=0;d<c;++d)if((new RegExp(b[d])).test(a))return!0;return!1}};
function lre(a,b,c,d,e,f,g,h){this.alf=Function.createDelegate(this,this.ibg);this.aYb=Function.createDelegate(this,this.OZc);this.LXb=Function.createDelegate(this,this.GYc);this.rCc=Function.createDelegate(this,this.u6c);this.ec=e;this.Cl=d;this.Tqa=h;this.iMa=new ($b.$$(zJ));this.Ku=new Tre(this.rCc,f);e=g?g.y6d:10;g=g?g.x6d:5;d=d&&d.Ma()?d.Ma().xj():0;this.ZDd=new Ure(d,e,g);this.f4c(a,b,c)}
lre.prototype={ec:null,Cl:null,Tqa:null,iMa:null,Ku:null,ZDd:null,QOa:!1,af:function(){this.QOa?R(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(R(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.QOa=!0,this.Ku.rva())},f4c:function(a,b,c){a&&uO(a,this.LXb);b&&b.Mga(this.aYb);c&&c.Xya(this.alf)},OZc:function(a,b){this.QOa&&(a=window.$$as($M,b.xc))&&ZN(a)&&(this.iMa.Mc(a.gc()),this.Ku.rva())},GYc:function(a,b){b&&
b.x8&&this.WI(b.x8.xj())},ibg:function(a,b){b&&this.WI(b.Sd)},WI:function(a){var b=this.ZDd;b.q0a!==a&&(b.q0a=a,b.Mqc=null);this.QOa&&this.Ku.rva()},u6c:function(){var a=this.DTc();0<a.length&&this.n3c(a[0]);return 1<a.length},DTc:function(){var a=[],b=this.Cl.Ed;if(!b)throw Error.argumentNull("Presentation is null");var b=b.Rj||[],c;c=this.ZDd;if(!c.Mqc){var d=[];Array.add(d,c.q0a);for(var e=1;e<=c.kvd||e<=c.pqd;e++)e<=c.kvd&&Array.add(d,c.q0a+e),e<=c.pqd&&0<=c.q0a-e&&Array.add(d,c.q0a-e);c.Mqc=
d}c=c.Mqc;d=c.length;for(e=0;e<d;++e){var f=b[c[e]];f&&ZN(f)&&!bO(f)&&!this.iMa.Kc(f.gc())&&Array.add(a,f)}return a},n3c:function(a){this.iMa.ga(a.gc());a=Vre(this,a);if(0<a.length)if(R(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",a.length),this.Tqa){var b=this.Tqa;if(a&&a.length){if(a&&a.length)for(var c=a.length,d=0;d<c;++d){var e=a[d].trim(),e=wYb(e);e.FPa?b.Kyc.add(e.FPa):R(590488194,825,10,"StreamPreFetchService::AddVideoIDsToQueue: failed extracting video ID from url")}else R(590488196,
825,10,"StreamPreFetchService::AddVideoIDsToQueue: invalid input urls");SZb(b,a[0]);b.Yaa&&b.rtc&&bEb(b)}else R(590488198,825,10,"StreamPreFetchService::PreFetch: invalid input urls")}else R(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null.")}};
function Vre(a,b){if(!a.ec)return R(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),a.Ku.nlb=!0,[];var c=[];if(!b)return c;b=window.$$as($M,b);if(!b)return c;b=b.jn(!1);for(var d=b.length,e=0;e<d;++e){var f=nBb(b[e]);f&&a.Tqa&&NXb(f)&&Array.add(c,f)}return c}function jre(){}jre.prototype={ou:function(a,b,c,d,e){return new ene(a,b,c,d,e)}};
function pre(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v){this.Udf=Function.createDelegate(this,this.K2f);this.ajf=Function.createDelegate(this,this.S8f);this.FGd=Function.createDelegate(this,this.Ybe);this.RMd=Function.createDelegate(this,this.wcg);this.Zxf=Function.createDelegate(this,this.wtg);this.FSd=Function.createDelegate(this,this.ape);this.Maf=Function.createDelegate(this,this.BWf);this.Naf=Function.createDelegate(this,this.CWf);this.fa=this.fa=a;this.dPa=b;this.uia=c?c.Zc():null;this.hZ=null;this.wBa=
d;this.ra=e;this.jc=f;this.wb=g;this.Ls=h;this.Cb=k;this.Qk=l;this.Hb=m;this.Kd=n;this.z0a=null;this.Ia=r;this.Xr=e.Ed;this.we=t;this.Y9c=v;this.ue=null}
pre.prototype={fa:null,dPa:null,wBa:null,uia:null,hZ:null,NMa:!1,jjb:null,tqc:null,z0a:null,ra:null,jc:null,wb:null,Ls:null,Cb:null,Qk:null,Hb:null,Kd:null,Ia:null,Xr:null,we:null,Y9c:!1,ue:null,Wb:function(){this.fa.ua(1970478872,1,this.Naf,4);this.fa.ua(40837381,2,this.Maf,4)},Of:function(){},CWf:function(a,b,c){b=this.ra.Ma();if(!b||this.jc.$d(b))return 16;if(1===c)return 32;if(this.uia){this.ue=dI("Audio::Insert",0);try{if(this.Y9c){var d=this;Wre("audio/*",Zxc,function(){return $xc(a,d.FSd,"audio",
d.we)},"audio",this.ra.Ed,this.jc,this.Kd,this.ue)}else{var e=this;Wre("audio/*",this.Zxf,function(){return Xre(e,a)},"audio",this.ra.Ed,this.jc,this.Kd,this.ue)}this.ue&&iI(this.ue,"AudioDialogInitialized","true");return 32}catch(f){R(579205014,818,10,"Error while rendering new audio selection dialog. Falling back to the old dialog")}di()||Aj(4)||F0b()&&72>NDa()?(FCd(this.dPa,this.uia,null,this.RMd,this.FGd,"audio/*",!1,!1),this.NMa=!1):(R(558445141,818,15,"Rendering audio file picker dialog using InsertAudioDialog"),
Yre(new Zre(this.ajf,this.wBa,this.ue)),this.NMa=!0);this.ue&&iI(this.ue,"AudioDialogInitialized","true");return 32}R(590210202,822,15,"Insert Audio initialization failed.");return 8},wtg:function(a){var b=this;return new Promise(function(c,d){R(576582924,822,50,"Audio File details: Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",a&&a.value?a.files.length:0,$re(a),ase(a));b.ue&&iI(b.ue,"AudioFileValidationStarts",String.format("Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",
a&&a.value?a.files.length:0,$re(a),ase(a)));if(a&&a.value&&a.value.length)if(bse(a.value)){var e=a.files[0];16777216<e.size?(R(577807694,822,10,"Audio::Insert:Invalid audio file size:{0}",e.size),cse(b,416,["16"]),d(416)):dse(e).then(function(a){a?(b.tqc=e.name,b.ue&&iI(b.ue,"AudioFileValidationPassedOnUI","true"),c(!0)):(cse(b,417,null),d(417))},function(){R(579205008,822,10,"Invalid audio File");cse(b,417,null);d(417)})}else R(577807696,822,10,"Audio::Insert:Invalid audio file type:{0}",$re(a)),
cse(b,427,null),d(427);else cse(b,418,null),d(418)})},S8f:function(a){a&&(this.jjb=a.files[0],FCd(this.dPa,this.uia,a,this.RMd,this.FGd,"audio/*",!1,!1))},Ybe:function(){var a="AudioUpload.ashx";if(window.Box4.App.g$)a=window.Box4.App.g$+a;else if(gi()||uCa())a=wj(a);a+=String.format("?{0}&{1}&{2}",Ona(),this.we.uk().ql,RA());this.we.Hc&&(a+=String.format("&{0}={1}","PodSID",this.we.Hc));this.we.el&&(a+=String.format("&waccluster={0}",this.we.el));return a},wcg:function(a){this.hZ=a;if(!this.NMa){if(hi()){ICd(a,
this.Udf);return}a=ICd(a,null);if(!a)return;this.jjb=a.files[0]}ese(this)},K2f:function(a){a&&(this.jjb=a.files[0],ese(this))},BWf:function(a,b,c){b=this.ra.Ma();if(!b||this.jc.$d(b))return 16;if(1===c)return 32;US(this.wb);this.Ia.ne();var d=String.format("{0}{1}","client",Ae().toString());c=fse(this,d);var e=this,f=this;ZRd(this.hZ,function(){gse(e,a,d)},function(a){cse(f,a.Ai.Code,null)},c);this.jjb=null;return 32},ape:function(a,b,c,d,e,f){d.UP(c)&&R(520737031,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
new Date-c.Tra);d.JN(c);e&&iI(e,"AudioUploadToRC","true");c=this.ra.Ma();d=gV(c);var g=this.Xr.nb(Number,Bt),h=this.Xr.nb(Number,Ct),k=mg(32,0),l=mg(32,1),g=g/2-mg(16,0),h=h/2-mg(16,1);if(c&&c.oc()){var m=this,n=this.Cb.qe(15,0,null,function(){z3(m.Ls,m.z0a);m.wb.Hl(m.z0a,!0,!0);m.Ia.ne()},!1);try{n.Jc(c);n.xe(a);e&&iI(e,"CreatingAudioShape","true");this.z0a=v2b(this.Qk,c.gc().Be(),c.gc().Pc(),10,g,h,k,l,d+1);var r=f.files[0].name;J(this.z0a,e_a,b);J(this.z0a,f_a,r);c.wC(this.z0a,null)}finally{n&&
n.dispose()}e&&(iI(e,"AudioShapeSuccessfullyCreated","true"),e.Sj(!1,null),e=null)}}};
function gse(a,b,c){a.jc.UP(a.ra.Ed)&&R(577807691,822,15,"Audio::InsertAudioSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",new Date-a.ra.Ed.Tra);a.jc.JN(a.ra.Ed);a.ue&&iI(a.ue,"AudioUploadToRC","true");var d=a.ra.Ma(),e=gV(d),f=a.Xr.nb(Number,Bt),g=a.Xr.nb(Number,Ct),h=mg(32,0),k=mg(32,1),f=f/2-mg(16,0),g=g/2-mg(16,1);if(d&&d.oc()){var l=a.Cb.qe(15,0,null,function(){z3(a.Ls,a.z0a);a.wb.Hl(a.z0a,!0,!0);a.Ia.ne()},!1);try{l.Jc(d),l.xe(b),a.ue&&iI(a.ue,"CreatingAudioShape",
"true"),a.z0a=v2b(a.Qk,d.gc().Be(),d.gc().Pc(),10,f,g,h,k,e+1),J(a.z0a,e_a,c),J(a.z0a,f_a,a.tqc),d.wC(a.z0a,null)}finally{l&&l.dispose()}a.ue&&(iI(a.ue,"AudioShapeSuccessfullyCreated","true"),a.ue.Sj(!1,null),a.ue=null)}}function fse(a,b){var c=new (Da.$$(String));c.ea("PresentationId",a.we.uk().ql);c.ea("si",a.we.we);c.ea("Canary",As);c.ea("access_token",Ii);c.ea("AudioToken",b);return c}function ese(a){a.jjb&&(a.tqc=a.wBa.g6b(a.jjb.name),TCd(a.hZ,!0),a.fa.jb(40837381,2,a.tqc,null))}
function cse(a,b,c){a.ue&&(a.ue.Sj(!1,null),a.ue=null);a.Kd.NK(b,function(a){a.pF=1;a.I5a=c;return!1},!1)}
function Xre(a,b){var c=String.format("{0}{1}","client",Ae().toString()),d;return d=new hse,d.rPd=fse(a,c),d.y1d=a.Ybe(),d.ZIc=function(){a.jc.$Z(a.ra.Ed,"Insert Audio",!1)},d.tRa=function(){gse(a,b,c)},d.aJc=function(b){a.jc.UP(a.ra.Ed)&&R(577807688,822,15,"Audio::InsertAudioFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",new Date-a.ra.Ed.Tra);a.jc.JN(a.ra.Ed);var c=null;try{var d=Sys.Serialization.JavaScriptSerializer.deserialize(b),c=d?d.Error:null}catch(k){R(579205012,
818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",b)}if(!c)var h,c=(h=new Nb,h.Code=421,h);a.ue&&(a.ue.Sj(!1,null),a.ue=null);R(579205010,822,10,"Upload audio failed");cse(a,c.Code,null)},d}function Zre(a,b,c){this.jB=Function.createDelegate(this,this.kv);this.Abf=Function.createDelegate(this,this.bee);this.nr=[];Zre.initializeBase(this,[!1,!1,!1,!1]);this.Mkd=!1;this.KTe=a;this.wBa=b;this.ue=c}
Zre.prototype={Bh:null,KTe:null,ue:null,wBa:null,dispose:function(){this.Bh&&oi(this.Bh,"keydown",this.jB);om.prototype.dispose.call(this)},bee:function(a){1===a&&this.KTe(this.Bh);this.Bh=null},Fo:function(){R(576582923,822,50,"Audio File details: Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",this.Bh&&this.Bh.value?this.Bh.files.length:0,$re(this.Bh),ase(this.Bh));this.ue&&iI(this.ue,"AudioFileValidationStarts",String.format("Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",
this.Bh&&this.Bh.value?this.Bh.files.length:0,$re(this.Bh),ase(this.Bh)));if(!this.Bh||!this.Bh.value||!this.Bh.value.length)return ise(this,ResourceStrings.L_NoAudioSpecifiedErrorMessage),!1;if(!bse(this.Bh.value))return ise(this,ResourceStrings.L_InvalidAudioFileExtensionError),!1;if(!(16777216>=this.Bh.files[0].size))return ise(this,String.format(ResourceStrings.L_InvalidAudioFileSizeError,"16")),!1;var a=this,b=this;dse(this.Bh.files[0]).then(function(b){b?(a.ue&&iI(a.ue,"AudioFileValidationPassedOnUI",
"true"),a.Cd(),a.bee(1,null)):ise(a,ResourceStrings.L_InvalidAudioFileError)},function(a){R(587871448,822,10,"Invalid audio File");ise(b,a)});return!1},Ydc:function(){if(0<this.nr.length){var a=new hHa(this.nr),b=$f().rk();b&&(this.nr[0].focus(),b.qg=a,b.QK=!0)}},kv:function(a){4!==pxa($f(),a)&&a.preventDefault()}};function ise(a,b){var c=document.getElementById("errorText");c.innerText=b;c.style.display="inline-block";a.ue&&(a.ue.Sj(!1,null),a.ue=null)}
function Yre(a){a.Hp=pm("<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>",ResourceStrings.L_AudioUploadMessage,ResourceStrings.L_NoAudioSpecifiedErrorMessage);Fj(a,1,ResourceStrings.L_Insert);a.$s(ResourceStrings.L_InsertAudioDialogTitle,a.Abf);a.Bh=document.getElementById("fileInput");
a.Bh&&a.Bh.setAttribute("accept","audio/*");var b=[];a.Bh&&(hh(a.Bh,"keydown",a.jB),b.push(a.Bh));var c=fp(a,1);c&&b.push(c);(c=fp(a,0))&&b.push(c);a.nr=b;a.Ydc()}
function dse(a){return new Promise(function(b,c){if(a&&a.size){var d=document.createElement("video"),e=window.URL.createObjectURL(a);d.setAttribute("src",e);hh(d,"loadedmetadata",function(){window.URL.revokeObjectURL(e);var a=d.videoHeight,c=d.videoWidth;0<d.duration&&!a&&!c?b(!0):(R(579205003,822,10,"Invalid audio File"),b(!1))});hh(d,"error",function(){window.URL.revokeObjectURL(e);R(579205001,822,10,"Invalid audio File");c(ResourceStrings.L_InvalidAudioFileError)})}else R(579205005,822,10,"Empty audio File"),
b(!1)})}function bse(a){a=ce(a);for(var b=0;b<lse.length;++b)if(lse[b]&&0<lse[b].length&&a.endsWith(lse[b]))return!0;return!1}function ase(a){return a&&a.value?a.files[0].size.toString():"Invalid number of files"}function $re(a){if(!a||!a.value)return"Input file name is null";var b=a.value.lastIndexOf(".");return-1===b?"":a.value.substring(b+1,b+5)}function ure(a,b,c,d,e,f,g,h){this.lpb=Function.createDelegate(this,this.gAb);ure.initializeBase(this,[a,b,c,f,g,h]);this.fa=d;this.Mb=e}
ure.prototype={fa:null,Mb:null,Wb:function(){this.fa.ya(981175184,1,this.uuf);this.TQb.pb(this.lpb)},Of:function(){},ume:function(){var a=this.Mb.pu(!0);if(!this.EQb||!a.Ld)return!1;var a=a.ld/a.Ld,b=new mse(this.EQb,!1,a);this.LMe=b;this.oha=a;this.itd=!!this.Fb&&!!this.EQb&&!A(this.bQb)&&!!b&&!!a;return!0},gAb:function(a){this.pNa=a;hj||F.s$a||!this.pNa||(this.pNa.kw("CanEmbed"),this.pNa.bE("CanEmbed",this.vuf))}};
function qre(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U,V,Z,Y){this.sja=Function.createDelegate(this,this.WBb);this.lpb=Function.createDelegate(this,this.gAb);this.Jpf=Function.createDelegate(this,this.Ugg);this.Tsf=Function.createDelegate(this,this.xlg);this.W9e=Function.createDelegate(this,this.kUf);this.X9e=Function.createDelegate(this,this.lUf);this.Snf=Function.createDelegate(this,this.Xeg);this.Rnf=Function.createDelegate(this,this.Weg);this.Qnf=Function.createDelegate(this,this.Veg);this.Vsf=
Function.createDelegate(this,this.Alg);this.a4e=Function.createDelegate(this,this.pMf);this.Z3e=Function.createDelegate(this,this.nMf);this.$3e=Function.createDelegate(this,this.oMf);this.fAc=Function.createDelegate(this,this.qRc);this.V9e=Function.createDelegate(this,this.jUf);this.L5c=$H("PartialDoc.SkipCutCopyCallout");if(!Y)throw Error.argumentNull("calloutNotificationAdapter");this.fa=a;this.ef=b;this.Ia=c;this.pa=d;this.Xr=e;this.$v=f;this.hBd=g;this.CNe=h;this.uUe=k;this.CPb=l;this.Fb=m;this.Jvd=
z.rTd;this.Fp=n;this.qc=H;this.mIe=z.G1d;this.RDg=r;this.Gha=t;this.Ya=y;this.Gqa=!z.Fk();this.vAd=O;this.MBd=U;this.Exd=V;this.P0a=Z;this.Rrd=!z.mLc||E.ia("DisablePrint");this.Srd=v;this.Hj=x;this.dLe=E.Va("DownloadPdfFromPodsUrl");this.tUe=E.Va("PrintPdfFromPodsUrl");this.cLe=E.Va("DownloadOdpFromPodsUrl");this.bsd=E.Va("DownloadImagesFromPodsUrl");this.qhd=E.ia("UseToastForDeferredBlobsEnabled");this.gna=E.ia("UseToastForDeferredBlobsEnabled");this.sWe=z.n2d;a=(F.qW||"").toLowerCase();z.Fk()&&
z.kGc?(this.TIe=!0,this.TPb=E.Va("DownloadACopyPodsUrl")):!z.Fk()&&z.zWd&&(a.endsWith(".pptx")||a.endsWith(".ppsx"))?(a=new xj(wj("DownloadACopyHandler.ashx")),yj(a,"Pid",this.Ya.uk().ql),yj(a,"si",this.Ya.we),yj(a,"fn",F.qW),dj(a.GPa),this.TPb=a.toString()):this.TPb=F.nFa;this.TQb=Q;this.PPe=z.WGc;this.z3a=kc(B(),Zc);this.X$c=E.fc("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.av=Y}
function nse(){var a=oj,b=!!F.nFa,c=L.ia("SupportsOfficeClientCoauthoring"),d=L.ia("PPTClpSwitchEnabled");R(590209869,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",a,b,c,d);return a&&b&&c&&d}
qre.prototype={fa:null,ef:null,Ia:null,pa:null,Xr:null,$v:null,CNe:null,hBd:!1,uUe:null,CPb:null,Fb:null,Jvd:null,TPb:null,Fp:null,mIe:!1,RDg:null,Gha:null,Ya:null,Gqa:!1,Rrd:!1,qhd:!1,gna:!1,Srd:null,Hj:null,dLe:null,tUe:null,cLe:null,bsd:null,sWe:!1,vAd:null,TIe:!1,qc:null,TQb:null,pNa:null,MBd:null,Exd:null,P0a:null,PPe:!1,z3a:null,X$c:!1,av:null,Wb:function(){var a=!!this.Srd&&!this.vAd();R(25297680,801,50,"Limited printing access: {0}, Message shown: {1}",this.Rrd,a);if(this.Rrd){if(a){var a=
this.Hj,b=a.LN.nc(null,this.Srd,null);LW(b,!0);b.Ns(20);a.Qm.xk(b,!1,null,null,null)}}else this.fa.ya(1588554917,1,this.V9e),this.fa.ya(3555692408,1,this.fAc),this.fa.ya(2439343378,1,this.$3e),this.fa.ya(1249692773,1,this.Z3e),this.fa.ya(1191538800,1,this.a4e),this.fa.ya(244793251,1,this.Vsf),this.fa.ya(1924572812,1,this.Qnf),this.fa.ya(3098027807,1,this.Rnf),this.fa.ya(3131236268,1,this.Snf),this.fa.ya(277798930,1,this.X9e),this.fa.ya(2255327903,1,this.W9e);this.fa.ya(3070187925,1,this.Tsf);this.hBd&&
this.fa.ua(1007486079,1,this.Jpf,96);this.TQb.pb(this.lpb)},Of:function(){var a=this.Ia.$c("app");a.kb(ag(80,Il()),1588554917);a.kb(ag(68,Il()),336231556);a.kb(ag(83,Il()),336231556);a.kb(ag(117,Il()),336231556);a.kb(ag(117,Il()|4),336231556)},Weg:function(a,b,c){return ose(this,c,2316717900,"SaveAsToHost")},Veg:function(a,b,c){return ose(this,c,4246497969,"SaveACopy")},Xeg:function(a,b,c){return ose(this,c,3050207199,"SaveToSharePoint")},qRc:function(a,b,c,d,e){if(this.ef.$d(this.Xr))return 16;if(1===
c)return!this.qc.il()||gW?8:nse()?32:oj?8:32;if(NZ(this.P0a)){R(556892301,843,15,"DownloadACopy is triggered while document has deferred content");this.L5c&&this.av.GJe.Ri();var f=this;jEc(this.P0a,"DownloadACopy",new MZ,function(){qse(f,e)});OZ(this.P0a,"DownloadACopyRequestedTime",kI(new Date));return 8}xR(this.pa);this.Ia.ne();R(19743434,801,50,"PPT save and download a copy");if(this.Ya.E1)qse(this,e);else{this.Fp.xf(!0,a);var g=this;M2(this.$v,!1,!0,this.Gqa,function(){qse(g,e)},this.sja,1)}return 32},
Ugg:function(a,b,c,d,e){a="";this.hBd&&(a=this.CNe.xS(this.Xr)?String.format(ResourceStrings.L_SavingStatus):this.Jvd?String.format(CommonUIStrings.l_SavedToStatus,this.Jvd):String.format(ResourceStrings.L_SavedStatus));e.Value=a;return 32},jUf:function(a,b,c){return rse(this,c,0,a)},lUf:function(a,b,c){return rse(this,c,8,a)},kUf:function(a,b,c){return rse(this,c,4,a)},oMf:function(a,b,c){if(this.ef.$d(this.Xr))return 16;if(1===c)return!this.qc.il()||gW?8:oj?8:32;this.Gha.tEc=new Date;xR(this.pa);
this.Ia.ne();if(this.Ya.E1)sse(this);else{this.Fp.xf(!0,a);var d=this;M2(this.$v,!1,!0,this.Gqa,function(){sse(d)},this.sja,1)}return 32},pMf:function(a,b,c){if(this.ef.$d(this.Xr))return 16;if(1===c)return!this.qc.il()||gW?8:oj?8:32;xR(this.pa);this.Ia.ne();if(this.Ya.E1)tse(this);else{this.Fp.xf(!0,a);var d=this;M2(this.$v,!1,!0,this.Gqa,function(){tse(d)},this.sja,1)}return 32},Alg:function(a,b,c){if(this.ef.$d(this.Xr))return 16;if(1===c)return!this.qc.il()||gW?8:oj?8:32;xR(this.pa);this.Ia.ne();
if(this.Ya.E1)use(this);else{this.Fp.xf(!0,a);var d=this;M2(this.$v,!1,!0,this.Gqa,function(){use(d)},this.sja,1)}return 32},nMf:function(a,b,c){if(this.ef.$d(this.Xr))return 16;if(1===c)return!this.qc.il()||gW?8:oj?8:32;if(NZ(this.P0a)){this.L5c&&this.av.GJe.Ri();R(556892302,843,15,"DownloadACopyAsOdp is triggered while document has deferred content");var d=this;jEc(this.P0a,"DownloadACopyAsOdp",new MZ,function(){vse(d)});return 8}xR(this.pa);this.Ia.ne();if(this.Ya.E1)vse(this);else{this.Fp.xf(!0,
a);var e=this;M2(this.$v,!1,!0,this.Gqa,function(){vse(e)},this.sja,1)}return 32},WBb:function(){this.Fp.Cd();return!1},xlg:function(a,b,c,d,e){if(this.ef.$d(this.Xr))return 16;if(1===c)return 32;xR(this.pa);this.Ia.ne();M2(this.$v,!1,!0,!0,function(a){if(e&&1<=e.length)e[0](a)},function(a){return e&&2<=e.length?(e[1](a,a.ServerError.Code),!0):!1},1);return 32},gAb:function(a){this.pNa=a}};
function wse(a,b){if(b){var c=new xj(b);a.Ya&&a.Ya.Hc&&0>b.indexOf(a.Ya.Hc)&&(c.s3b("PodSID="+a.Ya.Hc),R(35235403,801,50,"Append PodSessionId in url: {0}",a.Ya.Hc));a.sWe&&F.hz.Gt&&0<F.hz.Gt.length&&(yj(c,"fn",F.hz.Gt),R(37246871,801,50,"Appended FileName in url"));a.PPe&&(yj(c,"ipp","true"),R(595133152,801,50,"Appended IsPasswordProtectedFile param"));dj(c.GPa);return c.toString()}return null}function vse(a){a.Fp.Cd();xse(a.CPb,a.Ya.uk().ql,0,wse(a,a.cLe))}
function use(a){a.Fp.Cd();var b=wse(a,a.bsd),c=a.pa.Od();0<c.length&&(c=wT(String,c,function(a){return a.Pc().toString()}).join(","),b=new xj(b),yj(b,"sids",c),xse(a.CPb,a.Ya.uk().ql,2,b.toString()))}function tse(a){a.Fp.Cd();xse(a.CPb,a.Ya.uk().ql,2,wse(a,a.bsd))}function sse(a){a.Fp.Cd();a.Gha.SLc=new Date;xse(a.CPb,a.Ya.uk().ql,1,wse(a,a.dLe))}
function yse(a,b){a.Fp.Cd();var c=a.uUe,d=a.Ya.uk().ql;a=wse(a,a.tUe);c.ud.za.AGc&&c.bMe?(d=new xj(a),yj(d,"useNamedAction",sge(c.Vjb).toString()),yj(d,"publishOption",b.toString()),qge(c.Vjb,d.toString())):(b=new zse(d,sge(c.Vjb)),b.Lvc=c.mjf,b.af())}
function rse(a,b,c,d){if(a.ef.$d(a.Xr))return 16;if(1===b)return!a.qc.il()||gW?8:oj?8:32;if(a.vAd())return R(24934547,328,50,"Printing not allowed for IRM protected documents"),16;R(18983065,328,50,"PPT Editor print. PublishOption: {0}",c);xR(a.pa);a.Ia.ne();a.Ya.E1?yse(a,c):(a.Fp.xf(!0,d),M2(a.$v,!1,!0,a.Gqa,function(){yse(a,c)},a.sja,1));return 32}
function DEc(a){a.X$c&&a.z3a&&a.z3a.pb(function(a){a.Jn("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled",null)})}function qse(a,b){a.Fp.Cd();var c;c=nse()?F.nFa:a.TIe?wse(a,a.TPb):a.TPb;b&&b.FileDownloadUrl&&(c=b.FileDownloadUrl.toString());DEc(a);a.Exd&&!a.Exd()&&a.MBd&&a.MBd("3555692408")?a.pNa.Il("UI_Download",{},""):a.mIe?(new Ase(c),OZ(a.P0a,"DownloadModalTime",kI(new Date))):a.Fb.rH(!0,c,!0)}
function ose(a,b,c,d){return 1===b?oj||gW?8:a.fa.Ab(c,1,null):NZ(a.P0a)&&(R(556892300,843,15,"{0} is triggered while document has deferred content",d),!a.qhd)?(jEc(a.P0a,d,null,null),8):a.Ya.E1?(R(50370185,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",c),a.fa.jb(2916697279,2,c,null)):a.fa.Ab(c,2,null)}function Bse(a){Bse.initializeBase(this,[a,null])}
Bse.prototype={bha:function(){return F.Gka?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},kzb:function(){R(25544926,801,50,"Images download dialog displayed")},lzb:function(){R(25544928,801,50,"Images download dialog link clicked")},V$a:function(){R(25544930,801,50,"Images download dialog button clicked")}};function Cse(a){Cse.initializeBase(this,[a,!0,F.Gka,null,null,!1])}
Cse.prototype={bha:function(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady},xib:function(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion},JNb:function(){return"DownloadOdpLink"},XMb:function(){return ResourceStrings.L_Download},fNb:function(){return F.Gka?"UIFontDialogTextLarge":null},kzb:function(){R(8958087,801,50,"ODP download dialog displayed")},lzb:function(){R(8958089,801,50,"ODP download dialog link clicked")},V$a:function(){R(19505496,801,50,"ODP download dialog button clicked")},
qWc:function(){qk("PPTODF");return!0},HNb:function(){return L&&L.ia("EnableReactDialogs")&&$H("ReactDialogsODPDialogFix")?null:"#"},vib:function(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText},nHe:function(){return!F.Gka}};function tre(){this.tEc=this.SLc=this.NDc=this.lEc=window.Box4.App.hp}tre.prototype={tEc:null,SLc:null,NDc:null,lEc:null};function Dse(a){Dse.initializeBase(this,[a,null])}
Dse.prototype={bha:function(){return F.Gka?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},kzb:function(){R(21050910,801,50,"PDF download dialog displayed")},lzb:function(){R(21050912,801,50,"PDF download dialog link clicked")},V$a:function(){R(21050914,801,50,"PDF download dialog button clicked")}};function bre(){}
bre.prototype={Xb:function(){return"PowerPointWebEditor.PrintPackage"},wc:function(){C(D(lc(B().ma(Ese,null),rre)),function(){return new Ese(gc(B(),dge),gc(B(),vS),gc(B(),T).Fk())});C(D(lc(B().ma(Fse,null),sre)),function(){return new Fse(ic(B(),tre),gc(B(),vS),gc(B(),T).Fk())});C(D(B().ma(tre,null)),function(){return new tre})},ub:function(){},ha:function(){}};
function Gse(a){Gse.initializeBase(this,[ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,5308438]);this.Bt=a}Gse.prototype={af:function(){W5.prototype.af.call(this);var a=this.Bt,b=this.kja,c=this.ora,d=new QI("ConvertToOdp");RI(d,null);SI(d,new TI("presentationId",a));OI.hv(d,b,c,null,null,null,2)},Bt:null};
function Hse(a){Hse.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.l_ConvertingToPdfErrorString,5308439]);this.Bt=a}Hse.prototype={af:function(){W5.prototype.af.call(this);var a=this.Bt,b=this.kja,c=this.ora,d=new QI("ConvertToPdf");RI(d,null);SI(d,new TI("presentationId",a));OI.hv(d,b,c,null,null,null,2)},Bt:null};function Ase(a){Ase.initializeBase(this,[a,!0,F.Gka,null,null,!1])}
Ase.prototype={bha:function(){return CommonUIStrings.l_DownLoadACopyDialogMessage},xib:function(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion},JNb:function(){return"PowerPointDownloadCopyLink"},XMb:function(){return CommonUIStrings.l_Download},fNb:function(){return F.Gka?"UIFontDialogTextLarge":null},kzb:function(){R(19743688,801,50,"Download a copy dialog displayed")},lzb:function(){R(19743690,801,50,"Download a copy dialog clicked")},V$a:function(){R(19743692,801,50,"Download a copy dialog button clicked")}};
function kre(){}kre.prototype={};function zse(a,b){zse.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,5308421]);this.Bt=a;this.JYe=b}zse.prototype={JYe:!1,af:function(){W5.prototype.af.call(this);var a=this.Bt,b=this.JYe,c=this.kja,d=this.ora,e=new QI("Print");RI(e,null);SI(e,new TI("presentationId",a));SI(e,new TI("useNamedAction",b));OI.hv(e,c,d,null,null,null,2)},Bt:null};
function Ese(a,b,c){this.mjf=Function.createDelegate(this,this.o9f);if(!a)throw Error.argumentNull("directPrintManager");this.Vjb=a;this.ud=b;this.bMe=c}Ese.prototype={Vjb:null,ud:null,bMe:!1,o9f:function(a){var b=this.Vjb;b.VG.Ree&&u(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",b.ngb.Aa().fdc,b.ngb.Aa().wma);a=a.Ii;1!==G().Ah()&&(a=wj(a.PrintUrl),qge(this.Vjb,a))}};function V9(a,b,c,d){this.cAc=Function.createDelegate(this,this.n5b);this.E7=a;this.Ug=b;this.za=c;this.qc=d;this.Ria={}}
V9.prototype={pV:null,E7:null,Ug:null,za:null,qc:null,Ria:null};V9.prototype.Fcg=function(a,b){try{R(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");var c=document.getElementById("VersionHistoryViewerSpinner");c&&(c.style.display="none");if(this.pV)this.pV.onVersionSelected(a,b,this.Ria)}catch(d){R(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",d)}};V9.prototype.OnVersionHistorySelected=V9.prototype.Fcg;
V9.prototype.K2c=function(a){try{if(this.pV)Dfe(!1),this.pV.switchParentViewContainer(a);else{Dfe(!0);var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase="";b.IsRtl=!1;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.E7;c.animationDecoratorCallback=d.bAc||(d.bAc=Function.createDelegate(d,d.$Pc));c.notesIconDecoratorCallback=this.cAc;b.IsHighContrast=!1;this.Ug&&(b.IsHighContrast=this.Ug.UH());b.IsHighContrast&&(b.ClientColorSettings=this.Ug.To.q8+"_"+this.Ug.To.MM+
"_"+this.Ug.To.MDa);if(this.qc){var e=eDb(this.qc);b.DefaultSlideWidth=e.ld;b.DefaultSlideHeight=e.Ld}b.UserSessionId=vp;b.VersionViewerCssUrl=this.za.pNc;b.ProgressImageResourceUrl=dg("progress.gif");this.pV=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(f){R(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",f)}};V9.prototype.ResetAppVersionController=V9.prototype.K2c;
V9.prototype.n5b=function(){return Zj(14,14,"ToolbarNotesActiveDark_14x14x32",null,"Notes")};V9.prototype.CreateNotesIcon=V9.prototype.n5b;Type.registerNamespace("PPTe");TH=window.PPTe||{};function Ise(a,b,c,d,e,f){this.vuf=Function.createDelegate(this,this.fog);this.uuf=Function.createDelegate(this,this.ICb);this.Fb=a;this.EQb=b;this.bQb=c;this.TQb=d;this.Ya=e;this.za=f}
Ise.prototype={Fb:null,EQb:null,Ya:null,za:null,LMe:null,bQb:null,oha:null,itd:!1,TQb:null,pNa:null,ICb:function(a,b,c){(a=(a=rj)||this.Ya.E1)||this.itd||(a=!this.ume());1===c?c=a?2:32:this.itd?F.s$a&&this.bQb?(EEc(new FEc(this.bQb,this.oha)),c=32):(c=F.a7c?this.pNa.Il("UI_FileEmbed",null,"")?32:8:2,c=32!==c?this.Fb.rH(!0,F.$Rc,!1):c):c=8;return c},fog:function(a){a.Values.HostEmbeddedViewUrl&&(a=a.Values.HostEmbeddedViewUrl.toString(),this.bQb=F.s$a=a,EEc(new FEc(this.bQb,this.oha)))},ume:function(){return!1}};
function FEc(a,b){FEc.initializeBase(this,[a,!0]);b&&b&&!window.isNaN(b)||R(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");Ege(this,"wdAr",b.toString())}function GEc(a,b,c){return"wdEaaCheck"===b?Sj(a,b,c?"1":"0",!1):a}FEc.prototype={};
function EEc(a){var b=[];b.push({id:"wdEaaCheck",checkboxInitialValue:!1,checkboxLabel:ResourceStrings.l_AutoAdvanceLabel,urlTransformFunctionOnChange:GEc});wge.prototype.$Ce.call(a,{dimensionsOptions:{isMultipleChoice:!1,defaultWidth:a.Tre,defaultHeight:a.Sre,minWidth:375,minHeight:250,widthLabel:ResourceStrings.l_EmbedSlideWidth,heightLabel:ResourceStrings.l_EmbedSlideHeight},interactionOptions:b})}
function mse(a,b,c){this.xTb=a;this.MMe={};for(var d=0;d<a.length;d++)this.MMe[a[d].Format.toString()]=d;this.JLe=b;c&&!window.isNaN(c)&&window.isFinite(c)?this.oha=c:this.oha=0}mse.prototype={xTb:null,JLe:!1,oha:null,MMe:null};Type.registerNamespace("PowerPointWeb");KT=window.PowerPointWeb||{};function sre(){}sre.registerInterface("PowerPointWeb.IConverter");function rre(){}rre.registerInterface("PowerPointWeb.IPrinter");
function Pse(a,b,c){this.cCc=Function.createDelegate(this,this.f3c);this.Z1a=new Date(0);this.Y1a=new Date(0);this.jUb=a;this.ob=b;c&&(this.NXe=c)}
Pse.prototype={jUb:null,ob:null,NXe:"",nlb:!1,rva:function(){this.nlb?R(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Z1a>this.Y1a?R(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Z1a+". Last scan at "+this.Y1a+"."):(this.Z1a=new Date,this.ob.Vb(new Si(3,1,0,this.cCc,90,this.NXe,!1,0)))},f3c:function(){this.Y1a=
new Date;this.nlb?R(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.jUb()&&this.rva()}};function Fse(a,b,c){this.mff=Function.createDelegate(this,this.o4f);this.lff=Function.createDelegate(this,this.n4f);this.Gha=a;this.ud=b;this.usc=c}
Fse.prototype={Gha:null,ud:null,usc:!1,n4f:function(a){a=a.Ii;1!==G().Ah()&&(a=wj(a.PrintUrl),new Cse(a))},o4f:function(a){a=a.Ii;1!==G().Ah()&&(a=wj(a.PrintUrl),this.Gha.Aa().NDc=new Date,new Dse(a),this.Gha.Aa().lEc=new Date,R(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.Gha.Aa().tEc.toString(),this.Gha.Aa().SLc.toString(),this.Gha.Aa().NDc.toString(),this.Gha.Aa().lEc.toString()))}};
function xse(a,b,c,d){var e=null;c?1===c?a.ud.za.AGc&&a.usc?new Dse(d):rI(bI,function(){e=new Hse(b);e.Lvc=a.mff;e.af()}):2===c?a.ud.za.mHc&&a.usc&&new Bse(d):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",c)):a.usc?new Cse(d):(e=new Gse(b),e.Lvc=a.lff,e.af())}Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");M.Opg=M.Opg||{};
function Tre(a,b){this.cCc=Function.createDelegate(this,this.f3c);this.Z1a=new Date(0);this.Y1a=new Date(0);this.jUb=a;this.ob=b}
Tre.prototype={jUb:null,ob:null,nlb:!1,rva:function(){this.nlb?R(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Z1a>this.Y1a?R(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Z1a+". Last scan at "+this.Y1a+"."):(this.Z1a=new Date,this.ob.Vb(new Si(3,1,0,this.cCc,90,"112",!1,0)))},f3c:function(){this.Y1a=new Date;this.nlb?
R(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.jUb()&&this.rva()}};function Ure(a,b,c){this.kvd=b;this.pqd=c;this.q0a=a}Ure.prototype={q0a:0,Mqc:null,kvd:0,pqd:0};Type.registerNamespace("PowerPointWebEditor.Text");M.Text=M.Text||{};
function Are(a,b,c,d,e,f,g,h,k,l,m){this.Hcf=Function.createDelegate(this,this.Sfe);this.rCc=Function.createDelegate(this,this.u6c);this.Dpd=new Date;this.Xud={};this.gDd={};this.DDd={};this.FLe={};this.dispose=this.ha;if(!c)throw Error.argumentNull("graphTopologyManager");if(!d)throw Error.argumentNull("fontUtilsManager");this.Cl=c;this.aI=d;this.Wi=a;this.ozd=b;this.AUb=h;this.n3a=k;this.BUb=l;this.zUb=m;this.iMa=new ($b.$$(zJ));this.Ku=new Pse(this.rCc,e,"");0<f&&window.setInterval(this.Hcf,f);
this.HRe=g;a=c.Ma()?c.Ma().xj():0;if(b=this.Cl.Ed)b=b.Rj||[],a<b.length&&(this.vpa=b[a],this.Dpd=new Date)}function Qse(a,b){Array.forEach(b,function(b){$H("ShouldNormalizeFontNamesBeforeLogging")&&(b=Cg(b));A(a[b])&&(a[b]=!1)})}
function Rse(a,b,c,d,e){if(!a)throw Error.argumentNull("fonts");for(var f=[],g=Object.keys(a),h=g.length,k=0;k<h;++k){var l=g[k];a[l]||(Xvb(b,l)||Xvb(b,'"'+l+'"')||f.push(l),a[l]=!0)}a=f.length;if(0<a){f=f.join(",");d&&587337796===c?R(c,820,15,"{0}",f):R(c,820,15,"{0}",d?f:a.toString());c=new window.Map;d&&c.set("Fonts",f);c.set("FontsCount",a.toString());var m;Ce().recordQosError(e,["MissingFont"],!1,!1,!0,!1,(m=new nj,m.extendedProperties=c,m))}}
Are.prototype={Cl:null,iMa:null,Ku:null,Wi:null,ozd:null,Lxc:null,aI:null,HRe:0,vpa:null,AUb:!1,n3a:!1,BUb:!1,zUb:!1,ha:function(){this.Lf();this.Sfe()},af:function(){this.Lf();this.Lxc=new Sse(this);this.Ku.rva()},Lf:function(){if(this.Lxc){var a=this.Lxc,b=this.Wi,c=this.ozd;b&&tO(b,a.LXb);c&&Ppb(c,a.aYb)}this.Lxc=null},DTc:function(){var a=[];this.vpa&&a.push(this.vpa);return a},u6c:function(){var a=this.DTc();0<a.length&&(this.n3c(a[0]),this.iMa.ga(a[0].gc()));return 1<a.length},n3c:function(a){var b=
uSd(a);if(b&&(this.AUb||this.BUb||this.n3a||$H("ShouldLogMissingThirdPartyFontCount"))){var c={},d={},e={};Array.forEach(a.ta(String,b_a,null).split(","),function(a){a&&(a=Cg(a),c[a]=!1)});Array.forEach(a.ta(String,c_a,null).split(","),function(a){a&&(a=Cg(a),d[a]=!1)});Array.forEach(a.ta(String,l_a,null).split(","),function(a){a&&(a=Cg(a),e[a]=!1)});a=[];for(var f=[],g=[],h=0;h<b.length;h++)for(var k=window.$$as(Array,dP(b[h])),l=k.length,m=0;m<l;++m)for(var n=k[m],r=0;n.Ra&&r<n.Ra.Ba();){var t=
n.Ra.K(r);if(t=t.yb?Cg(sx(vE(t.yb).XQ().trim().toLowerCase(),0)):"")t in c&&!c[t]?(a.push(t),c[t]=!0):t in d&&!d[t]?(f.push(t),d[t]=!0):t in c||t in d||e[t]||(g.push(t),e[t]=!0);r++}this.AUb&&(Qse(this.Xud,a),Use(this,c,!0,555886295,555886296));if(this.n3a||$H("ShouldLogMissingThirdPartyFontCount"))Qse(this.gDd,f),Use(this,d,this.n3a||this.zUb,555886297,555886298);this.BUb&&(Qse(this.DDd,g),Use(this,e,this.zUb,555886299,555886300))}},Sfe:function(){new Date-this.Dpd<this.HRe||(this.AUb&&Rse(this.Xud,
this.aI,591003669,!0,"MissingFirstPartyFonts"),(this.n3a||$H("ShouldLogMissingThirdPartyFontCount"))&&Rse(this.gDd,this.aI,591003667,this.n3a||this.zUb,"MissingThirdPartyFonts"),this.BUb&&Rse(this.DDd,this.aI,587337796,this.zUb,"MissingNonLoggableFonts"))}};function Use(a,b,c,d,e){for(var f=[],g=Object.keys(b),h=g.length,k=0;k<h;++k){var l=g[k];b[l]||a.FLe[l]||(f.push(l),a.FLe[l]=!0)}a=f.length;0<a&&(R(d,820,15,"{0}",a),c&&R(e,820,15,"{0}",f.join(",")))}
function Sse(a){this.aYb=Function.createDelegate(this,this.OZc);this.LXb=Function.createDelegate(this,this.GYc);this.jNa=a;this.f4c(this.jNa.Wi,this.jNa.ozd)}Sse.prototype={jNa:null,f4c:function(a,b){a&&uO(a,this.LXb);b&&b.Mga(this.aYb)},OZc:function(a,b){(a=window.$$as($M,b.xc))&&ZN(a)&&(this.jNa.iMa.Mc(a.gc()),this.jNa.Ku.rva())},GYc:function(a,b){b&&b.x8&&(this.jNa.vpa=b.x8,this.jNa.Ku.rva(),this.jNa.Dpd=new Date)}};are.registerClass("PowerPointWebEditor.Chronos2Package",null,yo,ec);
mre.registerClass("PowerPointWebEditor.AddinCommandsActor",null,J2);nre.registerClass("PowerPointWebEditor.AppForOfficeActor",null,J2);Gre.registerClass("PowerPointWebEditor.AddinCommandsInitService",Yfe,age);ere.registerClass("PowerPointWebEditor.AddInCommandsInitPackage",null,yo,ec);gre.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory",null,AS);Dre.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory.CommandActionData");
ore.registerClass("PowerPointWebEditor.InsertMediaActor",null,J2);ire.registerClass("PowerPointWebEditor.ChangeOnlineImageHelper",J9);hre.registerClass("PowerPointWebEditor.InsertOnlineImageHelper",J9);Qre.registerClass("PowerPointWebEditor.InsertOnlineVideoHelper",J9);lre.registerClass("PowerPointWebEditor.StreamVideoPrefetchOrchestrator");jre.registerClass("PowerPointWebEditor.PptInsertMediaDialogFactory",null,Zqe);pre.registerClass("PowerPointWebEditor.InsertAudioActor",null,J2);
Zre.registerClass("PowerPointWebEditor.InsertAudioDialog",om);(function(){}).registerClass("PowerPointWebEditor.AudioValidationHelper");Ise.registerClass("PPTe.EmbedManager");ure.registerClass("PowerPointWebEditor.EmbedActor",Ise,J2);qre.registerClass("PowerPointWebEditor.DocumentOperationsActor",null,J2);Bse.registerClass("PowerPointWebEditor.DownloadACopyAsImagesDialog",ndc);Cse.registerClass("PowerPointWebEditor.DownloadACopyAsOdpDialog",hdc);tre.registerClass("PowerPointWebEditor.DownloadACopyAsPdfContext");
Dse.registerClass("PowerPointWebEditor.DownloadACopyAsPdfDialog",ndc);bre.registerClass("PowerPointWebEditor.PrintPackage",null,yo,ec);Gse.registerClass("PowerPointWebEditor.ConvertToOdpTask",W5);Hse.registerClass("PowerPointWebEditor.ConvertToPdfTask",W5);Ase.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialog",hdc);kre.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialogFactory",null,$qe);zse.registerClass("PowerPointWebEditor.PrintTask",W5);
Ese.registerClass("PowerPointWebEditor.Printer",null,rre);V9.registerClass("PowerPointWebEditor.PPTVersionHistorySelectionHandler",null,Iga);FEc.registerClass("PPTe.ReactEmbedDialog",wge);mse.registerClass("PPTe.FormatPicker");Pse.registerClass("PowerPointWeb.BackgroundJobScheduler");Fse.registerClass("PowerPointWeb.Converter",null,sre);Tre.registerClass("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility.PrefetchScheduler");Ure.registerClass("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility.SlideWindow");
Are.registerClass("PowerPointWebEditor.Text.FontLogger",null,Sys.IDisposable);Sse.registerClass("PowerPointWebEditor.Text.FontLogger.SlideEventListener");var Nre=!1,lse=[".mp3",".wav",".m4a",".aac",".oga"];F.mg&&gi()?R(40122142,809,15,"Firefox attempts to load chronos2 package when App is disposing"):zo(gj(),e7(new are,5),0,!1);Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function j_d(){}j_d.registerInterface("PowerPointWebEditor.IDesignerPane");function k_d(){}k_d.registerInterface("PowerPointWebEditor.IDesignerView");
M.z5b=function(){};M.z5b.prototype={init:0,loading:1,noSuggestion:2,showSuggestion:3,refreshing:4,sameSlideCoauthNoSuggestion:5,makeItVisualDrillIn:6,loadingMoreIdeas:7,moreIdeas:8,noSuggestionRibbon:9};M.z5b.registerEnum("PowerPointWebEditor.DesignerViewState",!1);Type.registerNamespace("PowerPointWebEditor.Designer");M.owb=M.owb||{};function Vse(){}
function Wse(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U,V,Z,Y,ca,la,ra,sa){this.fae=Function.createDelegate(this,this.LCb);this.Wgf=Function.createDelegate(this,this.p6f);this.WAc=Function.createDelegate(this,this.HYc);this.ap=Function.createDelegate(this,this.Lt);this.bQa=Function.createDelegate(this,this.HAb);this.UPa=Function.createDelegate(this,this.iAb);this.OXb=Function.createDelegate(this,this.TYc);this.V7=Function.createDelegate(this,this.lea);this.s3e=Function.createDelegate(this,this.oLf);
this.R4a=Function.createDelegate(this,this.EAb);this.jif=Function.createDelegate(this,this.O7f);this.Gjf=Function.createDelegate(this,this.S9f);this.t3e=Function.createDelegate(this,this.pLf);this.kZ=Function.createDelegate(this,this.F9);this.VGd=Function.createDelegate(this,this.zSf);this.Mwf=Function.createDelegate(this,this.Nrg);this.esf=Function.createDelegate(this,this.KBb);this.LCa=Function.createDelegate(this,this.l1f);this.QFd=Function.createDelegate(this,this.RFf);this.Guf=Function.createDelegate(this,
this.uog);this.Xpf=Function.createDelegate(this,this.ihg);this.pOd=Function.createDelegate(this,this.wog);this.KId=Function.createDelegate(this,this.sje);this.Gh=g;this.Ix=h;this.au=k;this.Jz=l;this.$b=m;this.fa=a;this.Kaa=b;this.wb=e;this.Ia=f;this.ra=n;this.ji=r;this.xd=t;this.My=v;this.ka=x;this.jc=c;this.Cb=d;this.Cf=y;this.eV=z;this.g7=Xse();this.bI=E;this.Lb=H;this.uc=O;this.ob=Q;this.kCa=U;this.c1a=Y;this.qc=ca;this.eI=la;this.Fs=ra;this.Ipd=sa;this.C7b=this.KId;if(Z){var ua=this;Z.Ge("PowerPointEnterpriseDesigner",
!1).then(function(a){ua.IQe=a;return null})}this.fa.G4(this)}function Yse(){var a=document.querySelector(".DesignerSuggestionList");return a&&a.getAttribute("correlationId")?a.getAttribute("correlationId").toString():null}
Wse.prototype={Gh:null,Ix:null,au:null,Jz:null,$b:null,fa:null,Kaa:null,Ia:null,wb:null,ra:null,ji:null,ka:null,jc:null,Cb:null,xd:null,My:null,Cf:null,eV:null,g7:null,gK:null,bI:null,Lb:null,uc:null,kCa:null,ob:null,eI:null,Fs:null,C7b:null,l7c:0,mCa:0,IQe:!1,K3a:null,c1a:null,bMa:null,qc:null,Ipd:null,SKe:!1,Wb:function(){if(this.ka.Rrb){this.fa.ua(1220232706,1,this.pOd,4);this.fa.ua(3666072395,1,this.pOd,4);$H("Designer.QueryNewPane")&&this.fa.ua(562763405,1,this.Xpf,96);this.fa.ua(1894291367,
1,this.Guf,4);this.fa.ua(397517337,1,this.QFd,4);this.fa.ua(1234776651,1,this.QFd,4);this.fa.ya(2687326703,1,this.LCa);this.fa.ya(1396913978,1,this.LCa);this.fa.ya(2958572984,1,this.LCa);this.fa.ya(3353734008,1,this.LCa);this.fa.ya(1860084563,1,this.LCa);this.fa.ya(3876507503,1,this.LCa);this.fa.ya(1297164033,1,this.LCa);this.fa.ya(2306720806,1,this.LCa);this.fa.ua(2658220272,1,this.esf,64);this.fa.ya(1170549389,1,this.Mwf);this.fa.ya(3180693624,1,this.VGd);this.fa.ya(39851908,1,this.VGd);W3(this.eV,
this.kZ);uO(this.ji,this.t3e);this.ka.jca&&this.xd.qa.Ka("RS",this.Gjf);this.ka.j8&&this.xd.qa.Ka("DCMI",this.jif);this.ka.cEc&&uZ(this.xd,this.R4a);this.ka.Yx&&PY(this.ji,this.s3e);this.ka.GZb&&GFb(this.bI,this.V7);this.ji.qa.Ka("FOGTD",this.OXb);kSd(this.kCa,this.UPa);this.ka.HZb&&qV(this.uc,this.bQa);nK(this.uc,this.ap);if(this.c1a){var a=this;this.c1a.pb(function(b){N0b(b,a.WAc)})}if(this.Ipd){var b=this;this.Ipd.pb(function(a){a.qa.Ka(a.kGe,b.Wgf)})}this.ka.gxc?(this.l7c=window.setTimeout(this.fae,
this.ka.cwc),window.addEventListener("FREDecisionEvent",this.C7b,!0)):this.LCb();var c;if(c=!!this.ka.H1b)a:switch(this.ka.H1b){case "wordtoppt":c=this.ka.PRd;break a;default:c=!1}if(c)switch(this.Gh.Qo(!0,null),Y9(this,"ConvertedToPPT",null,null),Z9(this.Ix,3),this.ka.H1b){case "wordtoppt":$se(this)}}},sje:function(a){window.removeEventListener("FREDecisionEvent",this.C7b,!0);window.clearTimeout(this.l7c);(a=a.detail)&&a.show&&a.show||this.LCb()},Of:function(){var a=this.Ia.$c("EditingDesignerPanelFocus");
a.kb(ag(38,0),2687326703);a.kb(ag(33,0),2687326703);a.kb(ag(36,0),1396913978);a.kb(ag(9,4),2958572984);a.kb(ag(40,0),3353734008);a.kb(ag(34,0),3353734008);a.kb(ag(35,0),1860084563);a.kb(ag(9,0),3876507503);a.kb(ag(37,0),1297164033);a.kb(ag(39,0),2306720806)},uog:function(a,b,c,d,e){return this.yN(this.Ix,"EditingDesignerPanelFocus",c,a,e)},wog:function(a,b,c,d,e){return e||!this.Gh.lf()?this.yN(this.Ix,"EditingIdeasPaneFocus",c,a,e):0},yN:function(a,b,c,d,e){var f=this.ra.Ed,f=!!this.ra.Ma()&&!!f&&
!this.jc.$d(f);if(this.ka.Yx)var g=this.wb.Od(),f=!!(f&(!!g&&1===g.length));if(!f)return 16;if(!this.Jz.lA())return 8;if(1===c)return 32;e||DT(this.Ia,b,a.Gh.lf());1894291367===d?this.$b.nd&&!Array.contains(this.$b.Qza,this.$b.nd)||Y9(this,"ToolbarButtonHome",null,null):a.Gh.lf()?a.Gh.Qo(!1,"SuggestionPaneClosed"):(Y9(this,3666072395===d?"ToolbarButtonHome":"ToolbarButton",null,null),a.Gh.Qo(!0,null));return 32},ihg:function(a,b,c,d,e){if(!SR.isInstanceOfType(e)||!this.Ix||!this.Ix.Gh)return 8;TU(e,
this.Ix.Gh.lf());return 32},RFf:function(a,b,c,d,e){b=this.ra.Ed;if(!this.ra.Ma()||!b||this.jc.$d(b))return 16;d=null;var f=!0;qda.isInstanceOfType(e)?d=e:ead.isInstanceOfType(e)&&(d=e.D3b,f=!1);if(!this.Jz.lA()||!d)return 8;if(4===this.Jz.Ix.Gh.J7)return R(24514636,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;if(1===c)return 32;if(!oQ(this.wb)){if(1===this.wb.Tb().length&&cP(this.wb.Tb()[0]))return xR(this.wb),
R(36845449,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;xR(this.wb)}if(!this.ka.j8&&this.$b.AV.Pc()===d.SuggestionSid)return R(38580375,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",d.CorrelationId,d.SuggestionSid),2;c=this.Cb.Ue(15,0);try{this.ka.GZb&&this.$b.gWb(new Date),c.Jc(b),c.xe(a),TT(b,kXa,d),this.$b.fWb(BJ(d.SuggestionSid,
d.SuggestionCid)),this.$b.wWb(!0),R(22590804,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{c&&c.dispose()}this.ka.DQa?this.jc.vka(b,this.ra.Ma(),this.Lb.Eb(),a):this.jc.mu(b,a);this.Gh.lf()&&this.Ia.Qf("EditingIdeasPaneFocus",!1);f&&this.$b.JWc();return 32},l1f:function(a,b,c){b=this.ra.Ed;if(!this.ra.Ma()||!b||this.jc.$d(b))return 16;if(!this.Jz.lA())return 8;if(1===c)return 32;c=this.Jz;a:switch(a){case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:case 1297164033:case 2306720806:c=
c.Ix;break;default:c=null;break a}if(c)switch(b=c.Gh,R(22590808,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",a,M.z5b.toString(b.J7)),b.J7){case 3:if(c&&c.Gh&&(b=document.activeElement)){var d=b.getAttribute("suggestionIndex"),e=b?!!b&&("DesignerStartFreeTrialButton"===b.className||"DesignerStartFreeTrialGoPremiumButton"===b.className||"DesignerInFreeTrialViewGoPremiumText"===b.className||"DesignerFreeTrialCardGoPremiumButton"===b.className):!1,f=Sys.UI.DomElement.containsCssClass(b,
"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(b,"IdeasText"),g=ate(b)||b.className.startsWith("Editor"),h=!c.lI.baa&&c.lI.Aa().Xga();if(d||f||g||e||h)if(e=d?window.parseInt(d.toString()):-1,f=bte(c)-1,!(1>f))switch(g=c.Gh,d=cte(c),a){case 3353734008:if(h||1===d||3===d)break;g.rA(!1);e<f&&(c.qv(e,!1),c.qv(e+1,!0));break;case 1860084563:if(h||1===d||3===d)break;g.rA(!1);e!==f&&(c.qv(e,!1),c.qv(f,!0));break;case 3876507503:if(h){dte(c);break}a:if(a=c.Gh,-1===e){switch(d){case 1:a.xNa?
(a.rA(!1),ete(c,!0)):fte(c)?(ete(c,!1),$9(c,!0,d)):($9(c,!1,d),a.rA(!0));break a;case 2:a.xNa?(a.rA(!1),c.qv(0,!0)):($9(c,!1,d),a.rA(!0));break a;case 3:b=a.xNa;a.rA(!b);$9(c,b,d);break a}a.rA(!1);c.qv(0,!0)}else e===f?(c.qv(e,!1),2===d?$9(c,!0,d):a.rA(!0)):(c.qv(e,!1),c.qv(e+1,!0));break;case 2687326703:if(h||1===d||3===d)break;g.rA(!1);0<e&&(c.qv(e,!1),c.qv(e-1,!0));break;case 1396913978:if(h||1===d||3===d)break;g.rA(!1);e&&(c.qv(e,!1),c.qv(0,!0));break;case 2958572984:if(h){dte(c);break}a:if(a=
c.Gh,0<e)c.qv(e,!1),c.qv(e-1,!0);else if(-1===e){switch(d){case 1:a.xNa?(a.rA(!1),$9(c,!0,d)):fte(c)?(ete(c,!1),a.rA(!0)):($9(c,!1,d),ete(c,!0));break a;case 2:a.xNa?(a.rA(!1),$9(c,!0,d)):($9(c,!1,d),c.qv(f,!0));break a;case 3:b=a.xNa;a.rA(!b);$9(c,b,d);break a}a.xNa&&(a.rA(!1),c.qv(f,!0))}else c.qv(0,!1),a.rA(!0);break;case 1297164033:case 2306720806:if(!h&&1!==d&&3!==d)if(a=2306720806===a,c=c.Gh,ate(b)){if(b=document.activeElement)Sys.UI.DomElement.containsCssClass(b,"mivOverlayContainer")?(b=window.parseInt(b.getAttribute("mivIdx").toString())+
1,a?6!==b?gte(c,b+1):gte(c,1):1!==b?gte(c,b-1):gte(c,6)):a?gte(c,1):gte(c,6)}else if(b.className.startsWith("Editor")&&(e=document.activeElement)){b=hte.yMf;for(h=0;!Sys.UI.DomElement.containsCssClass(e,b[h]);)if(h++,h===b.length){h=-1;break}d=document.querySelectorAll(".EditorSuggestionContainer").length;"EditorSuggestionContainer"!==b[h]?a?h!==b.length-1&&-1!==h?"EditorSuggestionContainer"!==b[h+1]?ite(b[h+1],c):jte(c,0):ite(b[0],c):h&&-1!==h?"EditorSuggestionContainer"!==b[h-1]?ite(b[h-1],c):jte(c,
d-1):ite(b[b.length-1],c):(e=window.parseInt(e.getAttribute("editorSuggestionIdx").toString()),a?e!==d-1?jte(c,e+1):ite(b[h+1],c):e?jte(c,e-1):ite(b[h-1],c))}}}break;case 2:case 9:if(b=b.J7,c&&(h=c.Gh,3876507503===a||2958572984===a||2687326703===a||3353734008===a))a=!(9===b?!c.tY.querySelector(".DesignerNoSuggestionNewButton:focus"):!c.tY.querySelector(".DesignerNoSuggestionView-Link:focus")),h.rA(a),(c=9===b?c.tY.querySelector(".DesignerNoSuggestionNewButton"):c.tY.querySelector(".DesignerNoSuggestionView-Link"))?
a?c.blur():c.focus():R(588851159,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}return 32},KBb:function(a,b,c,d,e){if(a$(this.Jz))return 0;this.Abb(e.vTe,e.hVe);return 32},Abb:function(a,b){var c=this.$b.nd;if(c)if(Array.contains(this.$b.Qza,c))R(593236993,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",c,b);else{var d={};d.CachedTrigger=this.$b.nDc;d.SuggestionSlideId=this.$b.AV.Pc().toString();d.SuggestionSlideCreationId=
this.$b.AV.Be().toString();d.AppliedSuggestion=this.$b.qP;d.DisplaySuggestionsTimeoutInMs=this.ka.FZb;d.SuggestionsTimeout=this.$b.HDa;d.ClientAbort=this.$b.k6a||1===this.Jz.Ix.Gh.J7;d.DesignerPaneClosed=a;d.ResetReason=b;d.HoverPreviewDesignerTriggered=this.$b.cVd;d.DesignerFixPaneOpenHint=this.ka.dEc;d.DesignerSendTraceRequestOnSessionEnded=this.ka.HZb;this.ka.cEc&&(d.DesignerDesignTabTriggerEnabled=!0);this.Ix.Uka()&&(this.ka.Wra?(d.UpsellFreeTrialDocumentCount=kte(this.au),d.UsageBasedUpsellEnabled=
!0,this.$b.EMc&&(d.StartUpsellFreeTrial=!0)):d.ContentBasedUpsellEnabled=!0);a=!!b&&0<=b.indexOf("MoreIdeas");if(this.ka.j8&&(d.TermCorrelationId=Yse(),!a)){var e=document.querySelector(".DesignerSuggestionList");d.TermAction=e&&(lte(this.au,e,!1)||lte(this.au,e,!0))?"Kept":"NotKept"}var e=ze(ye(L).SessionStartInfoJson.toString()),f={};f.ClientOS=e.Os;f.Browser=e.Browser||"";f.BrowserVersion=e.BrowserVersion||"";f.BrowserMajorVersion=e.BrowserMajorVersion||"";f.BrowserMinorVersion=e.BrowserMinorVersion||
"";this.$b.Ltb&&this.$b.K8&&this.$b.K8>this.$b.Ltb&&(f.SuggestionsE2ETimeMs=this.$b.K8-this.$b.Ltb);this.ka.jca&&(mte(this.au),nte(this),d.IncrementalRender=!0,f.VisibleSuggestionsCount=this.$b.s5a,0<this.$b.Frb.Qa()&&(f.IncrementalRenderTimeoutIndexes=this.$b.Frb.Jd().join(",")),0<this.$b.A3.Qa()&&(f.MissingDesignerCardIndexes=this.$b.A3.Jd().join(",")),0<this.$b.Pra.Qa()&&(f.CardIndexes=this.$b.Pra.Jd().join(",")),0<this.$b.ica.Qa()&&(f.DesignerCardIndexes=this.$b.ica.Jd().join(",")),this.$b.QM&&
(this.$b.Csb&&this.$b.Csb>this.$b.QM&&(f.MissingDesignerCardsReceivedTime=this.$b.Csb-this.$b.QM),this.$b.sqb&&this.$b.sqb>this.$b.QM&&(f.AllIncRenderReceivedTime=this.$b.sqb-this.$b.QM),this.$b.f8a&&this.$b.f8a>this.$b.QM&&(f.VisibleIncRenderReceivedTime=this.$b.f8a-this.$b.QM)));f.IdeasMivShown=this.$b.H0b;f.IdeasMivDrillIn=this.$b.rIc;f.IdeasEditorShown=this.$b.NZb;f.IdeasEditorKept=this.$b.MZb;f.IdeasEditorDrillIn=this.$b.MRd;f.AnyCardShown=this.$b.NZb||this.$b.H0b||0<this.$b.Pra.Qa();f.AnyCardKept=
this.$b.MZb||this.$b.qP;try{if(this.Fs.Da()){var g;var h=this.Fs.Da();if(h.Ad.Zo&&wn(h.Ad.Zo)){var k=JSON.stringify(h.Ad.Zo);if(h.Ad.$Ub===k)g="";else{h.Ad.$Ub=k;if("Kept"in h.Ad.Zo){var l=P9(Bpe(R9(new S9(h.Ad.eM,h.Ad.vG),h.Ad.QE),"Kept"),h.Ad.hR).yF(),m=Boolean.parse(h.Ad.Zo.Kept.toString());De(T9,m,0,l);if(m){var n=h.Ad.fQb;n.Q_b&&!n.cUd&&(n.cUd=!0,oia("WAC_Exp_AgendaToPPTHighConfidenceKept",null,0,!0,null,!1))}}h.Ad.oAa&&(aqe(h),h.Ad.oAa=!1);R(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",
h.Ad.$Ub,h.Ad.oAa.toString());g=k}}else g="";!g||(d.AgendaMetrics=g)}}catch(r){R(574665995,813,10,"exception while populating AgendaMetrics",r)}d.BrowserData=f;this.$b.QM&&this.$b.K8&&this.$b.K8>this.$b.QM&&(d.TimeToDisplaySuggestionsInMs=this.$b.K8-this.$b.QM);this.$b.$Mc&&this.$b.Ytb&&(d.TimeSuggestionsRendered=this.$b.$Mc.toUTCString());this.$b.Ytb&&(d.TimeDesignerPaneClosed=this.$b.Ytb.toUTCString());this.$b.j5a&&0<this.$b.j5a.Qa()&&(d.AppliedSuggestionHis=this.$b.j5a.Jd().join(" "));this.Cf.KBb(c,
JSON.stringify(d),"SessionEnded"===b);b$(this.Jz,c,"SuggestionPaneClosed"===b||"SuggestionsLoadingTimeout"===b||"NoSuggestion"===b||"DisallowedRequest"===b?"NoResult":"Pending",null,"");ote(this.$b,c,this.ka.j8&&a);R(22590806,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",b,c)}else R(593236959,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",b)},S9f:function(a,
b){b.KMc.en(this.$b.ica);pte(this,b.KMc,b.OEc,b.gh,b.dy,b.nd,-1);b.csa&&(this.bMa||this.$b.A3.Qa()||qte(this,b.dy,b.OEc))},O7f:function(a,b){Y9(this,"MoreIdeas",null,b.iRa)},EAb:function(a,b){!b.NDa||"PptRibbon.Design"!==b.NDa&&"Design"!==b.NDa||2!==b.qca&&3!==b.qca&&4!==b.qca||a$(this.Jz)||32===this.fa.Ab(4250022162,1,null)&&Y9(this,"DesignTab",null,null)},F9:function(a,b){(a=this.ra.Ma())&&b.nh.Sa(a.gc())&&(this.Jz.Tcc(b.lCd,b.oAd),a$(this.Jz)&&!this.Jz.lA()&&(R(22680479,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",
b.lCd,b.oAd,this.$b.nd),this.Gh.Qo(!1,"CoAuth")),this.Gh.lf()&&(this.Jz.lA()||b$(this.Jz,this.$b.nd,"NoResult",null,"")))},pLf:function(a,b){if(b.x8){var c;a=(c=new bbd,c.gh=b.x8.gc(),c);this.fa.jb(4236240734,2,a,null);this.Jz.Tcc(a.Etb,a.H3d);this.Gh.lf()&&(R(22853506,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.$b.nd),this.Jz.lA()&&!bO(b.x8)?Y9(this,"SlideNavigationDesignMode",null,null):bO(b.x8)&&this.ka.jRd||(this.Gh.Qo(!1,
"SlideNavigation"),b$(this.Jz,this.$b.nd,"NoResult",null,"")))}else R(24463122,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.$b.nd)},gyb:function(a){this.ka.Tqb&&(this.g7=Xse(),this.gK&&(this.Gh.lf()?(R(39413843,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.gK.wz,this.gK.TW),a()):this.gK=null))},zUa:function(a,b){this.gyb(b);R(36966411,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",
a.HttpStatusCode);return!0},oLf:function(){if(a$(this.Jz)){var a=this.wb.Od();a&&1<a.length&&(R(25968672,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.Gh.lf()&&this.Gh.Qo(!1,"MultiSlidesSelected"))}},lea:function(a,b){a=this.$b.k5a;var c=this.ka.DQa?"UnblockContentWhenDraw":"SessionRehydrated";a&&window.$$as(String,b.nZ)===c&&(this.$b.j5a.ga(String.format("{0}:{1}:{2}",this.$b.AV,a-this.$b.K8,new Date-a)),this.$b.gWb(null))},
HAb:function(a,b){a$(this.Jz)&&(R(592540182,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.$b.nd,M.lHa.toString(b.ZV)),1!==b.ZV&&3!==b.ZV||this.Abb(!0,"SessionEnded"))},Lt:function(){R(40379151,829,50,"DesignerActor::OnSessionRehydrated");Y9(this,"Refresh",{FailoverOccurred:!0},null)},TYc:function(a,b){b&&rte(this,b.Sh,b.Y2b.tL)},iAb:function(a,b){if(b.$Qa&&ste(b.Sh)){a={};if(b.XV){var c=vI("RevisionId",mI(b.XV.toString()).toString());c&&1===c.length&&(a.ActionStartTime=
c[0].Hk)}rte(this,b.Sh,a)}},zSf:function(a,b,c,d,e){switch(a){case 3180693624:return Array.add(this.$b.Qxc,e),32;case 39851908:return Array.remove(this.$b.Qxc,e),32;default:return 2}},Nrg:function(){Y9(this,"Refresh",{UndoRedo:!0},null);return 32},ybc:function(a){if(this.mCa<this.ka.fEc){var b=this;this.ob.Vb(new Si(2,1,1E3,function(){R(40379155,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",b.$b.nd);b.g7=Xse();b.mCa++;a()},0,"RetryRequestOnWait",!1,0))}else R(40379157,
829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.$b.nd)},LCb:function(){if(this.ka.Sqb&&this.ka.VM)if(this.qc){var a=this.ra.Ed;if(!a)throw Error.argumentNull("Presentation is null");var b=HO(this.qc);if(!b||0>=b.length)R(592494817,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var c="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===b[0].ThemeFamilyId.toLowerCase();c&&1!==b.length?R(588908107,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):
this.ka.P7d||c?!a.Rj||0>=a.Rj.length?R(592494819,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):c&&1!==a.Rj.length?R(588908103,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(a=null,this.ka.a5d&&this.ka.Rtb&&0<this.ka.Rtb.length&&(a={},a.TemplateId=this.ka.Rtb),R(41705686,829,50,"Triggering NewDocument designer request"),Y9(this,"NewDocument",a,null)):R(592494815,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else R(592494849,
829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else R(42766598,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.ka.Sqb,this.ka.VM)},HYc:function(a,b){a=this.$b;var c=b.Gwb;if(c){b=[];for(var d=new (Wb.$$(Number,Sne))(null),c=c.critiques,e=c.length,f=0;f<e;++f){var g=c[f],h=g.bucketId,k=d.K(h);k||(k=new Sne(h),d.ea(h,k),b.push(k));k.mFa.push(g)}a.dR=b}},L_:function(){},K_:function(a){if(this.ka.qEa&&1569530844===
a.Sh&&32===a.Jt()){var b=this.wb.Tb();if(b&&1===b.length&&b[0].Ta()&&(b=tte(window.$$as(zc,a.l6())))&&!(0>=b.length)){var c={};c.PastedText=b;rte(this,a.Sh,c)}}},p6f:function(){this.ka.$2b&&(this.Gh.lf()||this.SKe||(this.Gh.Qo(!0,null),Y9(this,"AgendaToPPT",null,null),Z9(this.Ix,3),R(559822157,829,50,"Auto opening designer pane for high confidence agenda")),this.SKe=!0)}};
function $se(a){if(a.ka.D1d)try{var b=kc(B(),Zc);b&&(R(579109450,829,50,"Floodgate survey for word to presentation triggered"),b.pb(function(a){a.Jn("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled",null)}))}catch(c){R(579109448,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",c)}}
function tte(a){if(!a)return null;var b=a.ta(String,vr,null);if(b)return b.replace("\r","\n").replace("\n\n","\n").split("\n");if(b=a.ta(String,dr,null))if(b=EV(b))return ute(b);if(b=a.ta(String,cOa,null))if(b=EV(b))return ute(b);return null}function ute(a){var b=new (Ca.$$(String));if(a&&a.children)for(var c=0;c<a.children.length;c++){var d=a.children[c].innerText;d&&0<d.length&&b.ga(a.children[c].innerText)}return b.Jd()}
function vte(a,b,c,d){if(a.ka.fRd&&a.eI){wte(a,c);d||(d={});var e=new Date;a.eI.WW(a.ka.wZd,a.ka.mRd,null).then(function(f){var g=new Date-e;f.IsSuccess?(d.FetchAuthTokenDuration=g,d.ServiceTicket=f.Token):(d.FetchAuthTokenFailureDuration=g,R(42324814,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+f.ErrorCode+": "+f.ErrorMessage));xte(a,b,c,d)}).catch(function(f){R(42295842,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",
f);d.FetchAuthTokenFailureDuration=new Date-e;xte(a,b,c,d)})}else xte(a,b,c,d)}
function xte(a,b,c,d){a.K3a&&(a.ob.ih(a.K3a),a.K3a=null);var e=yte(a,c,d);zte(a,e)?Ate(a.$b,a.ra.Ma().Pc())?(wte(a,e.wz),a.ybc(function(){vte(a,b,c,d)})):(R(40379161,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",e.wz,e.TW,e.Fta),a.$b.nd&&!Array.contains(a.$b.Qza,a.$b.nd)&&a.Abb(a$(a.Jz),e.wz),a.$b.Ltb=new Date,a.$b.uPa(e.Fta),a.$b.nDc=e.wz,Bte(a,e)?a.$b.uzc(e.wW.ActionStartTime):a.$b.uzc(new Date),b(e),wte(a,e.wz),b$(a.Jz,e.Fta,"Pending",null,"")):(R(40379163,829,50,"Designer call not currently allowed for trigger {0}",
c),a.Gh.Qo(!1,"DisallowedRequest"))}function wte(a,b){(a$(a.Jz)||Cte(a,b))&&Z9(a.Ix,"Typing"===b?4:"MoreIdeas"===b?7:1)}function Bte(a,b){if(!(a.ka.iEc&&"ActionStartTime"in b.wW&&b.wW.ActionStartTime))return!1;switch(b.wz){case "ToolbarButton":case "ToolbarButtonHome":case "SlideNavigationDesignMode":case "NewDocument":return!1;case "Refresh":return!("FailoverOccurred"in b.wW)||!("UndoRedo"in b.wW);default:return!0}}
function Cte(a,b){switch(b){case "ToolbarButton":case "ToolbarButtonHome":case "InsertPicture":case "InsertChart":case "SlideChangeLayout":case "ChangeSlideSize":case "ApplyTheme":case "PasteTable":case "NewDocument":case "ApplyReplaceObject":case "DesignTab":case "ConvertedToPPT":return!0;case "AgendaToPPT":return a.ka.$2b;case "PasteText":return a.ka.qEa;default:return!1}}
function zte(a,b){if(!b||!b.TW||!Cte(a,b.wz)&&!a.Gh.lf())return!1;switch(b.wz){case "NewSlide":case "ToolbarButton":case "ToolbarButtonHome":case "InsertPicture":case "ApplyTheme":case "DesignTab":case "ConvertedToPPT":case "PasteTable":case "SlideNavigationDesignMode":case "SlideChangeLayout":case "InsertTable":return!0;case "InsertChart":return a.ka.iNc;case "Typing":return a.ka.gEc&&a.Gh.lf();case "Retrigger":return a.ka.nRd&&a.$b.qP;case "ChangeSlideSize":case "DesignElementsDeleted":return a.ka.gRd;
case "PasteText":return a.ka.qEa;case "ApplyReplaceObject":case "ChangeIconInSmartArt":case "ChangeIcon":return a.ka.N7d;case "Refresh":return b=b.wW,"FailoverOccurred"in b&&b.FailoverOccurred||"UndoRedo"in b&&b.UndoRedo||a.ka.kRd&&a$(a.Jz)?!0:!1;case "MoreIdeas":return a.ka.j8;case "NewDocument":return a.ka.Sqb&&a.ka.VM;case "AgendaToPPT":return a.ka.$2b;default:return R(594399636,829,15,"invalid trigger: {0}",b.wz),!1}}
function yte(a,b,c){var d=a.ra.Ma();if(!d)return null;var e;e=new Dte;e.wz=b;e.TW=d.Pc();e.xka=d.Be();c=c||{};a.ka.Sqb&&"NewDocument"===b&&(c.EnableFullSizeSuggestedPictures="true");a.ka.oRd&&(c.SupportCustomTheme=a.IQe);a.Ix.Uka()&&(a.ka.Wra?(c.UpsellFreeTrialDocumentCount=kte(a.au),c.UsageBasedUpsellEnabled=!0):c.ContentBasedUpsellEnabled=!0);Ete(a.au,b)&&(c.IncrementalRender=!0);0<a.Jz.zjb&&(c.CoauthCountInSlide=a.Jz.zjb);c.NewPaneEnabled=!0;d=!Xn(a.$b.dR);if(c.RequestForEditorCardsForNewIdeasPane=
d){for(var d=0,f=a.$b.dR,g=f.length,h=0;h<g;++h)for(var k=f[h].mFa,l=k.length,m=0;m<l;++m)d+=k[m].suggestions.length;c.NumEditorCritiques=d}d={};d.SupportsImageToTableSuggestedAction=32===a.fa.Ab(3560393150,1,null);c.PPTOEnabledSuggestedActions=JSON.stringify(d);a.ka.qEa&&"PasteText"===b&&(c.PasteTextTriggerCharMin=a.ka.c0d,c.PasteTextTriggerWordMin=a.ka.e0d,c.PasteTextTriggerParaMin=a.ka.d0d);return e.wW=c,e}
function Fte(a,b){if(A(b))return!0;switch(b){case 397517337:case 1234776651:case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:case 1297164033:case 2306720806:case 3078715862:return!0;case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:return!a.$b.qP;default:return!1}}
function Y9(a,b,c,d){vte(a,function(c){function f(){Y9(a,a.gK.wz,a.gK.O7b,d)}if(a.ka.Tqb){if(a.g7.Ywc&&new Date-a.g7.$1a<a.ka.hEc){a.gK=new Gte;a.gK.TW=c.TW;a.gK.xka=c.xka;a.gK.wz=c.wz;a.gK.O7b=c.wW;R(40379153,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",b,c.TW);return}a.g7=Hte();a.gK=null}a.Cf.j9(c.xka,c.TW,c.Fta,Yse(),c.wz,d,JSON.stringify(c.wW),function(b){b&&2===b.Status?a.ybc(function(){Y9(a,c.wz,c.wW,d)}):a.mCa=0;a.mCa||a.gyb(f)},
function(b){return a.zUa(b,f)})},b,c)}
function rte(a,b,c){if(!Fte(a,b)){var d=function(b){var c={};c.Timestamp=b.lDb;c.CorrelationId=b.Fta;c.Trigger=b.wz;c.Sid=b.TW;c.Cid=b.xka;c.Hints=b.wW;b=a.Cb.qe(4,0,null,null,!1);try{b.Jc(a.ra.Ed);b.xe(3078715862);var d=JSON.stringify(c);J(a.ra.Ed,ZYa,d)}finally{b&&b.dispose()}},e=Ite(a,b,c),f=Jte(a,e,b,c);f&&(c||(c={}),c.ElementSource=f);ste(b)&&a.Gh.lf()?(a.K3a&&a.ob.ih(a.K3a),b$(a.Jz,a.$b.nd,"Pending",null,""),wte(a,"Typing"),a.K3a=new Si(2,1,a.ka.pRd,function(){a.Gh.lf()&&R(42320064,829,50,"Potential candidate for typing refresh request for designer pane");
a.ra.Ma()&&a.Gh.lf()&&vte(a,d,e,c)},0,"DesignerTypingRefreshTask",!1,0),a.ob.Vb(a.K3a)):vte(a,d,e,c)}}
function Ite(a,b,c){switch(b){case 1110240549:case 1685987254:case 2948423841:case 1124275563:case 934858027:return"InsertPicture";case 2995632670:case 1850078116:case 3796917740:case 1569530844:return c&&c.HasNewPicture||c&&c.HasNewMedia&&a.ka.Q7d?"InsertPicture":c&&c.HasNewTable?"PasteTable":c&&c.HasNewChart&&a.ka.iNc?"InsertChart":a.ka.qEa?"PasteText":"";case 2963456035:case 2759977169:case 841042441:return"ApplyTheme";case 4017322732:return"SlideChangeLayout";case 529839080:case 100917881:case 1045213174:case 991302939:case 410316994:return c&&
"HasDesignElements"in c&&c.HasDesignElements?"ChangeSlideSize":"Refresh";case 868006456:case 4198410725:return c&&"HasDesignElements"in c&&c.HasDesignElements?"DesignElementsDeleted":"Refresh";case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:return"Retrigger";case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return"Typing";
case 844437181:return"PasteTable";case 67272282:return"InsertTable";case 3455582195:case 4229337931:case 830497217:case 3006547192:return"NewSlide";case 4041021629:return"ApplyReplaceObject";case 1095764407:return"ChangeIconInSmartArt";case 1488343741:return"ChangeIcon";default:return"Refresh"}}
function Jte(a,b,c,d){if("InsertPicture"!==b&&"PasteTable"!==b&&"InsertChart"!==b)return null;var e=d?d.HasNewPicture:!1,f=d?d.HasNewMedia:!1,g=d?d.HasNewTable:!1,h=d?d.HasNewChart:!1,k=null;switch(c){case 1850078116:case 3796917740:k=e?"PastedExternalPicture":f?"PastedExternalMedia":g?"PastedExternalTable":h?"PastedExternalChart":null;break;case 2995632670:k=e?"PastedInternalPicture":f?"PastedInternalMedia":g?"PastedInternalTable":h?"PastedInternalChart":null;break;case 1110240549:k="FromFile";break;
case 1685987254:case 2948423841:k="Online";break;case 934858027:k="Icon"}k||R(41182167,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",b,c,a.$b.nd);delete d.HasNewPicture;delete d.HasNewMedia;delete d.HasNewTable;delete d.HasNewChart;return k}function nte(a){a.bMa&&(a.ob.ih(a.bMa),a.bMa=null)}
function Kte(a,b,c,d){var e={};e.MissingDesignerCardIndexes=a.$b.A3.Jd().join(",");a.bMa=new Si(0,1,0,function(){a.Cf.j9(b.Be(),b.Pc(),d,Yse(),c,null,JSON.stringify(e),function(){R(42259678,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",e.MissingDesignerCardIndexes,d)},function(a){R(42259680,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",
e.MissingDesignerCardIndexes,a.HttpStatusCode);return!0})},0,"FetchMissingDesignerCardsTask",!1,0);a.ob.Vb(a.bMa)}function pte(a,b,c,d,e,f,g){if(a.$b.ica.Qa()===c)nte(a);else if(b&&b.Qa()&&!(0<a.$b.A3.Qa())){if(-1===g)for(var h=b.$$lge();h.$$mn();){var k=h.$$cu();k>g&&(g=k)}for(h=0;h<c&&(b.Kc(h)||a.$b.A3.Kc(h)||a.$b.A3.ga(h),h!==g||a.$b.A3.Qa());h++);0<a.$b.A3.Qa()&&Kte(a,d,e,f)}}
function qte(a,b,c){nte(a);var d=a.ra.Ma().gc(),e=a.$b.nd;a.bMa=new Si(2,1,a.ka.D4d,function(){Array.contains(a.$b.Qza,e)||pte(a,a.$b.ica,c,d,b,e,c)},0,"CheckAndFetchMissingDesignerCardsTask",!1,0);a.ob.Vb(a.bMa)}function Lte(){}function Hte(){var a=new Lte;a.Ywc=!0;a.$1a=new Date;return a}function Xse(){var a=new Lte;a.Ywc=!1;a.$1a=null;return a}Lte.prototype={Ywc:!1,$1a:null};function Gte(){}Gte.prototype={TW:0,xka:0,wz:null,O7b:null};function Dte(){this.lDb=new Date;this.Fta=Ae().toString()}
Dte.prototype={lDb:null,Fta:null,wz:null,TW:0,xka:0,wW:null};function Mte(a){this.Qza=[];this.Qxc=[];this.V0a=a;this.AV=aK;this.j5a=new (Ca.$$(String));this.Pra=new (Ca.$$(Number));this.ica=new (Ca.$$(Number));this.Frb=new (Ca.$$(Number));this.A3=new (Ca.$$(Number));this.s5a=1}
Mte.prototype={Qza:null,Qxc:null,V0a:null,dR:null,xha:null,AV:null,fWb:function(a){return this.AV=a},nd:null,uPa:function(a){return this.nd=a},nDc:null,qP:!1,wWb:function(a){return this.qP=a},HDa:!1,VEd:function(a){return this.HDa=a},k6a:!1,$Mc:null,Ytb:null,JWc:function(){this.iHa(2,4)},iHa:function(a,b){this.V0a&&this.V0a.pb(function(c){var d,e=(d=new Mbd,d.cardId="EntityGroup.Designer.Slide.Suggestion",d.actionType=a,d.actionEngagement=b,d);c.A9b(e)})},cVd:!1,Ltb:null,K8:null,Csb:null,j5a:null,
k5a:null,gWb:function(a){return this.k5a=a},QM:null,uzc:function(a){return this.QM=a},sqb:null,f8a:null,s5a:0,Pra:null,ica:null,Frb:null,A3:null,aW:null,Kv:function(){return this.aW},m4a:function(a){return this.aW=a},gDa:null,RR:0,NZb:!1,MZb:!1,MRd:!1,H0b:!1,rIc:!1,EMc:!1,P2c:function(a){this.nd="";this.AV=aK;this.nDc="";this.k6a=this.HDa=this.qP=!1;this.Ytb=null;this.cVd=!1;this.k5a=this.Csb=this.K8=this.Ltb=null;this.j5a.Qe();this.f8a=this.sqb=this.QM=null;this.s5a=1;this.Pra.Qe();this.ica.Qe();
this.Frb.Qe();this.A3.Qe();this.RR=0;this.EMc=this.NZb=this.MZb=this.H0b=this.rIc=!1;a&&(this.aW=this.gDa=null)}};function Nte(a,b){a.RR=b}function Ate(a,b){return Array.contains(a.Qxc,b)}function ote(a,b,c){Array.contains(a.Qza,b)||(Array.add(a.Qza,b),R(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",b,a.Qza.length));a.P2c(!c)}
function Ote(a,b,c,d,e,f,g,h,k,l,m,n){this.pja=Function.createDelegate(this,this.CUa);this.SMd=Function.createDelegate(this,this.Dcg);this.Rkf=Function.createDelegate(this,this.Cag);this.NId=Function.createDelegate(this,this.X3f);this.uMd=Function.createDelegate(this,this.Abg);this.XNe=new ($b.$$(String));this.dispose=this.ha;this.Ix=a;this.au=b;this.$b=c;this.ka=d;this.fa=e;this.ra=f;this.Cb=g;this.xd=h;this.Ia=k;this.zjb=this.crc=0;this.Rha=l;this.VIe=m;this.kV=n;this.nv()}
Ote.prototype={Ix:null,au:null,$b:null,ka:null,fa:null,ra:null,Cb:null,xd:null,Ia:null,Rha:null,VIe:null,crc:0,zjb:0,kV:null,nv:function(){this.xd.qa.Ka("SU",this.uMd);this.xd.qa.Ka("DSCM",this.NId);var a=this;this.VIe.pb(function(b){b.kFf(a.Rkf,function(){Pte(a,a.Ix,3)})});this.ka.jca&&this.xd.qa.Ka("UBUP",this.SMd);this.xd.qa.Ka("UR",this.pja)},ha:function(){this.xd.qa.eb("SU",this.uMd);this.xd.qa.eb("DSCM",this.NId);this.ka.jca&&this.xd.qa.eb("UBUP",this.SMd);this.xd.qa.eb("UR",this.pja)},hyb:function(a,
b){if(this.ka.Rrb&&a$(this)){if(b&&(397517337===a||1234776651===a)){this.$b.fWb(aK);b=this.ra.Ed;var c=this.Cb.qe(7,0,null,null,!0);try{c.Jc(b),this.ka.qRd&&c.xe(a),wf(b,kXa)}finally{c&&c.dispose()}}b=this.au;if(c=c$(this.Ix))if(c=c.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3")){var d=-1!==c.className.indexOf("4x3");Qte(b,c,d,!1)}this.ka.lRd&&397517337!==a&&1234776651!==a&&this.fa.Ab(1170549389,
2,null)}},CUa:function(a,b){this.hyb(b.b3b,b.s0b)},lA:function(){return this.ka.Rrb},X3f:function(a,b){a=b.gh;R(23089489,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",a.Pc());if((b=this.ra.Ma())&&b.gc().Sa(a)){b="unopened";a$(this)&&(this.Ix.Gh.lf()&&Pte(this,this.Ix,5),b="set to SameSlideCoauthNoSuggestion UI");var c="unopened";a$(this)&&(b$(this,this.$b.nd,"NoResult",null,""),c="closed");"unopened"===b&&"unopened"===c||R(23089491,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",
b,c,a.Pc(),a.Be(),this.$b.nd,this.crc,this.zjb)}},Abg:function(a,b){R(22647391,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.ka.Rrb,this.crc,this.zjb,b.nd,b.dy);if(this.lA()){if(a=this.ra.Ma())if(b.gh.Sa(a.gc()))if(Array.contains(this.$b.Qza,b.nd))R(22618318,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",b.nd);else if(this.XNe.Kc(b.nd))R(41694935,
829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",b.nd);else{this.$b.nd!==b.nd&&(ote(this.$b,b.nd,this.ka.j8&&"MoreIdeas"===b.dy),R(42021664,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.$b.nd,b.nd));if(this.$b.nd===b.nd&&this.Ix.Gh.lf()&&3===this.Ix.Gh.J7){var c=this;
if(this.ka.jca&&Yn(b.Jtb.Jd(),function(a){return 0<=c.$b.A3.NUc(a)}))this.$b.Csb=new Date,R(42342610,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",b.nd,b.Jtb.toString(),this.$b.A3.toString());else if(a=b.q6d,!this.ka.jca||this.$b.ica.Kc(a)){R(22618320,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",
b.nd,a.toString());return}}a=Rte(b.u3);Ste(this,a,b);Tte(this,b);Ute(this,this.Ix,b,a,b.pEa,Xn(this.$b.gDa)?b.pEa:this.$b.gDa.length)}else R(22618322,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",b.nd)}else R(22618316,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",b.nd)},Tcc:function(a,b){this.zjb=a;this.crc=b;qS(this.xd,new kS(1))},Dcg:function(){this.Ix.Gh.lf()&&3===this.Ix.Gh.J7&&
(this.XNe.ga(this.$b.nd),Z9(this.Ix,1))},Cag:function(a){a=new Vte(this.$b.Kv(),a.suggestions.length,a.suggestions.length,a.correlationId,c$(this.Ix),!0,this.Ix.Uka(),Ete(this.au,a.trigger));Wte(this.au,a);DT(this.Ia,"EditingDesignerPanelFocus",!0)}};function a$(a){return a.Ix.Gh.lf()}
function b$(a,b,c,d,e){R(593236889,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",b,c,e);a.Rha.pb(function(a){var g=new V$c;g.correlationId=b;if(d){var h;b:{var k=[];try{if(!d||!d.SlideSuggestions){R(39338643,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse");h=k;break b}for(h=0;h<d.SlideSuggestions.length;h++)if(d.SlideSuggestions[h]){var l=d.SlideSuggestions[h].Base64Img,m=null;try{var n,m=(n=new T$c,
n.suggestionIndex=d.SlideSuggestions[h].Index.toString(),n.suggestionCid=d.SlideSuggestions[h].SlideId.Cid.toString(),n.suggestionSid=d.SlideSuggestions[h].SlideId.Sid.toString(),n.imageData=l.startsWith("data:image")?l:"data:image/png;base64,"+l,n.label=String.format(ResourceStrings.l_DesignerSuggestionItem,h+1),n)}catch(t){R(594071828,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),m=null}if(!m)var r,m=(r=new T$c,r.suggestionIndex=
d.SlideSuggestions[h].Index.toString(),r.suggestionSid=d.SlideSuggestions[h].SlideSid.toString(),r.imageData=l.startsWith("data:image")?l:"data:image/png;base64,"+l,r.label=String.format(ResourceStrings.l_DesignerSuggestionItem,h+1),r);Array.add(k,m)}}catch(t){R(39338645,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",t)}h=k}g.suggestions=h}else R(39977434,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",
b);!e||(g.trigger=e);a.L1f(c,g)})}function Xte(a,b){return b.lf()||"NewSlide"!==a&&"ChangeIconInSmartArt"!==a&&"ChangeIcon"!==a}function Tte(a,b){b.JFc?(Xn(a.$b.Kv().SlideSuggestions)||a.$b.Kv().SlideSuggestions.length===b.pEa)&&b$(a,b.nd,"Success",a.$b.Kv(),b.dy):b$(a,b.nd,"Success",a.$b.Kv(),b.dy)}
function Ute(a,b,c,d,e,f){R(592536898,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",c.nd,c.dy,c.pEa,e);if("MoreIdeas"===c.dy)a.$b.K8||(a.$b.K8=new Date),e=bte(b),Yte(a.au,d,c$(b),c.nd,b.Uka())||(Zte(c$(b)),e=bte(b)-1),b.qv(e,!0),Pte(a,b,8);else if(!e)!a.ka.iRd||"ToolbarButton"!==c.dy&&"ToolbarButtonHome"!==c.dy?Pte(a,b,2):Pte(a,b,9),a$(a)?b$(a,a.$b.nd,"NoResult",null,""):a.fa.jb(2658220272,2,new xCb(!1,"NoSuggestion"),null);else if(Xte(c.dy,
b.Gh)){var g=!0;if(a.ka.jca){var g=null,h=c$(b);h&&(g=h.querySelector("#"+b.Gh.Ta()+' .DesignerSuggestionList[correlationId="'+c.nd+'"]'));g=!g;R(592306817,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",c.nd,c.dy,g);h=new OLb(c,g);a.xd.qa.Ha("RS",h,null)}if(g){Pte(a,b,3);a.$b.K8||(a.$b.K8=new Date);try{a.ka.vZd&&a.kV.pb(function(a){a.Jn("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled",null)})}catch(k){R(42050709,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
k)}}Wte(a.au,new Vte(d,e,f,c.nd,c$(b),g,b.Uka(),Ete(a.au,c.dy)))}}function Ste(a,b,c){if(b&&"MoreIdeas"!==c.dy){if(!a.$b.Kv()){var d;a.$b.m4a((d=new rda,d.CardData=b.CardData,d.SlideSuggestions=Array(c.JFc?c.pEa:c.L6d),d))}if(!Xn(b.SlideSuggestions)){c=b.SlideSuggestions;d=c.length;for(var e=0;e<d;++e){var f=c[e];a.$b.Kv().SlideSuggestions[f.Index]=f}}a.$b.gDa||(b=$te(b),a.$b.gDa=b)}}
function ste(a){switch(a){case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return!0;default:return!1}}
function ite(a,b){switch(a){case "EditorPrev":b.HB("#EditorPrev");break;case "EditorNext":b.HB("#EditorNext");break;case "EditorIgnore":b.HB(".EditorIgnore");break;case "EditorSeeMoreLabel":b.HB(".EditorSeeMoreLabel")}}function ate(a){return Sys.UI.DomElement.containsCssClass(a,"mivContainer")||Sys.UI.DomElement.containsCssClass(a,"mivOverlayContainer")}function Pte(a,b,c){b?Z9(b,c):R(592536911,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",a.$b.nd,c)}
function aue(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.i3=Function.createDelegate(this,this.uUa);this.lB=Function.createDelegate(this,this.VK);this.lja=Function.createDelegate(this,this.ITa);this.GCa=Function.createDelegate(this,this.Z8a);this.LR=Function.createDelegate(this,this.xea);this.qa=new re;this.yy=!!G()&&!!G().rb()&&G().rb().JE();this.fwg=!!G()&&!!G().rb()&&G().rb().JE()&&L.ia("PptReactTabbedTaskPanesFocusV2IsEnabled");this.dispose=this.ha;this.Fb=a;this.Dc=b;this.Yc=c;this.Dp=d;this.fa=e;this.$b=
f;this.uq=g;this.uc=h;this.gu=k;this.Ub=l;this.Ia=m;this.ka=n;this.nm=r;this.Js="IdeasPane";this.yTe=ResourceStrings.L_Designer;this.vr=t;this.zb=document.createElement("div");this.zb.className="DesignerPane";this.zb.id="IdeasPane";this.zb.style.position="absolute";this.zb.setAttribute("role","region");this.zb.setAttribute("aria-labelledby","DesignerPaneLabel");this.mc=!1;this.dAa=iM();this.dAa.className="DesignerPaneLayoutRoot";this.zb.appendChild(this.dAa);a=L.Va("PPTFabricIconDiamondCssUrl");b=
document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);this.zb.appendChild(b);this.Fb.u_a(this.LR)}
function bue(a){var b=CommonUIStrings.l_DialogClose,c=VL();c.alt=b;c.className=ck("per","ClosePaneGlyph_16x16x32");c.src=a.Lk("per.png");c.setAttribute("Unselectable","on");a=jM();a.className="cui-img-16by16 cui-img-cont-float";a.appendChild(c);c=jM();c.className="cui-ctl-iconContainer";c.setAttribute("Unselectable","on");c.appendChild(a);a=kM();a.className="cui-ctl DesignerPaneButton";a.title=b;a.setAttribute("role","button");a.tabIndex=0;a.appendChild(c);return a}
aue.prototype={Fb:null,Dc:null,Yc:null,Dp:null,zb:null,dAa:null,fa:null,$b:null,uq:null,uc:null,gu:null,Ub:null,Ia:null,nm:null,Js:null,yTe:null,mc:!1,xNa:!1,J7:0,Ujb:null,Io:null,ka:null,vr:null,ha:function(){this.b_();this.zb.removeChild(this.dAa);this.Fb.Znb(this.LR);R(22590850,829,50,"DesignerPane::Dispose")},Qd:function(){this.Io=bue(this.Dc);Sys.UI.DomElement.addCssClass(this.Io,"DesignerPaneCloseButton");this.Io.setAttribute("role","button");this.dAa.appendChild(this.Io);this.Yc.Wa("click",
this.Io,this.GCa);this.Dp.Ka(this.Io,"keydown",this.lja);this.Ujb=iM();this.Ujb.id="DesignerPaneLabel";this.Ujb.className="DesignerPaneLabel";this.Ujb.innerText=this.yTe;this.dAa.appendChild(this.Ujb);var a=this,b=this;this.uq.wS("EditingDesignerPanelFocus","main",this.zb,function(b){a.fwg&&b===a.Ia.$c("TabbedTaskPaneFocus")&&a.Io?a.rA(!0):a.qN(!0)},function(){b.qN(!1)},!1,null);vM(this.uc,this.lB);nK(this.uc,this.i3);lwb(this.gu,this.i3);R(22590852,829,50,"DesignerPane::Initialize")},b_:function(){this.Yc&&
0<this.dAa.childNodes.length&&(this.Yc.Sb("click",this.Io,this.GCa),this.Dp.eb(this.Io,"keydown",this.lja),this.dAa.removeChild(this.Ujb),this.dAa.removeChild(this.Io));Syb(this.uc,this.lB);tM(this.uc,this.i3);xzb(this.gu,this.i3);this.Ia.kf()&&"EditingDesignerPanelFocus"===this.Ia.kf().Nd&&DT(this.Ia,"EditingDesignerPanelFocus",!1)},VK:function(a,b){b.ADa&&!zM(this.Ub)&&this.mc&&(R(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",
this.$b.nd),this.Qo(!1,"SuggestionPaneClosed"))},xea:function(a){a&&this.mc&&this.Qo(!1,"SuggestionPaneClosed")},uUa:function(){R(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.Qo(!1,"SessionRehydrated")},MF:function(a,b){var c=b?dM(a,this.$f()):cM(a,this.$f());this.mc&&(b?(Sys.UI.DomElement.addCssClass(this.zb,"DesignerPaneRTL"),dM(c,1)):(Sys.UI.DomElement.addCssClass(this.zb,"DesignerPaneLTR"),cM(c,1)));gM(this.zb,c);return a},Qo:function(a,b){if(this.mc!==a){this.mc=
a;var c=this.ka.dEc||"IdeasPane"!==this.Js?"PaneOpen":"IdeasPaneOpen";a?(a={},a[c]=!0,U2b(this.nm,JSON.stringify(a)),this.Qd(),this.zb.style.display="inline-flex",this.$b.iHa(0,0),R(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(a={},a[c]=!1,U2b(this.nm,JSON.stringify(a)),this.b_(),this.zb.style.display="none","CloseSecondPane"===b||this.mc&&"SuggestionPaneClosed"===b||(this.$b.Ytb=new Date,1===this.J7&&(this.$b.k6a=!0),this.fa.jb(2658220272,2,new xCb(!0,b),null)),this.$b.iHa(1,
0),R(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.yy?(this.q3b(this.zb),b=ResourceStrings.L_Designer,this.vr.yN(this,this.mc,"IdeasPane"===this.Js?b:ResourceStrings.L_ShowHideDesignerPane,"EditingDesignerPanelFocus")):this.Fb.np()}},q3b:function(a){Di?Sys.UI.DomElement.addCssClass(a,"DesignerPaneRTL"):Sys.UI.DomElement.addCssClass(a,"DesignerPaneLTR")},qN:function(a){a?this.qa.Ha("OnDesignerPaneFocusOn",null,null):this.qa.Ha("OnDesignerPaneFocusBlur",null,null)},ITa:function(a){!this.mc||
13!==a.keyCode&&32!==a.keyCode||this.Qo(!1,"Typing")},Z8a:function(){this.mc&&(R(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.$b.nd),this.Qo(!1,"SuggestionPaneClosed"));return!0},rA:function(a){(this.xNa=a)&&this.Io.focus()},HB:function(a){(a=document.querySelector(a))&&vl(a)},lf:function(){return this.mc},Zc:function(){return this.zb},aM:function(){return 7},Ta:function(){return this.Js},$f:function(){var a=0;this.mc&&(a=
304+(1+PS));return a}};function jte(a,b){a.HB('.EditorSuggestionContainer[editorSuggestionIdx="'+b+'"')}function gte(a,b){a.HB("#"+a.Js+" .mivButton:nth-child("+b+") > .mivOverlayContainer")}function cue(a,b){this.iEg=b;this.vk=a;this.Kf=!1}
cue.prototype={Wq:null,iEg:null,vk:null,Ewc:null,Kf:!1,Ro:function(){this.Kf||(this.Ewc=iM(),this.Ewc.setAttribute("Unselectable","on"),this.Ewc.style.position="absolute",eM(this.Ewc,"designerPreviewImageContainer"),this.Wq=new EL,this.Kf=!0)},ha:function(){this.Kf&&(this.Ri(),this.Wq&&this.Wq.Ja.parentNode&&(this.Wq.ns(),rV(this.Wq.Ja,"designerPreviewImageContainer")))},Ri:function(){this.Kf?(this.$Ua(),this.Wq.Gf(!1)):R(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")},
$Ua:function(){this.Wq.Ja.firstChild&&this.Wq.Ja.removeChild(this.Wq.Ja.firstChild)}};
function due(a,b,c){this.Kob=Function.createDelegate(this,this.J9a);if(a){this.hjb=a;var d=this;this.hjb.Ge("PowerPointDesigner",!1).then(function(a){(d.K_b=a)?R(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(d.xGc=d.hjb.KTa(),d.xGc?c?R(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):R(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):R(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));
return null});this.WDg=this.hjb.VGa("PowerPointDesigner",this.Kob);this.QSe=b}}due.prototype={hjb:null,WDg:null,QSe:null,Uka:function(){return!this.K_b&&this.xGc},K_b:!1,xGc:!1,Gua:function(a){this.hjb&&this.hjb.Gua(a,null)},J9a:function(a){a&&"PowerPointDesigner"===a.featureName&&(!this.K_b&&a.isEnabled&&this.QSe(),this.K_b=a.isEnabled)}};
function hte(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.Wz=Function.createDelegate(this,this.lz);this.nF=Function.createDelegate(this,this.EW);this.qK=Function.createDelegate(this,this.FW);this.uXb=Function.createDelegate(this,this.aVc);this.H1e=Function.createDelegate(this,this.FIf);this.lja=Function.createDelegate(this,this.ITa);this.bGd=Function.createDelegate(this,this.GIf);this.tJd=Function.createDelegate(this,this.C5f);this.jpb=Function.createDelegate(this,this.bAb);this.xdf=Function.createDelegate(this,
this.a2f);this.L6e=Function.createDelegate(this,this.bde);this.dispose=this.ha;hte.initializeBase(this,[new aF,a,f,null]);this.Gh=c;this.au=d;this.$b=e;this.Ia=g;this.Yc=h;this.Dc=b;this.Lo=k;this.Dp=l;this.fa=m;this.Me=n;this.ka=r;this.EFd=this.ka.c8a;var v=this;this.lI=new (ga.$$(eue))(function(){return new eue(v.fa,v.ka,b,h,l,v.L6e)});this.Jrd=new due(t,this.xdf,r.Wra);this.Lpa=new H9;var x;this.wOe=(x=new hre(m,this.Lpa,this.ka),x.uX=2168883939,x)}
hte.prototype={JU:null,OPb:null,tY:null,TJ:null,U0a:null,T0a:null,ZMe:0,XMe:0,Ipa:!1,Gh:null,au:null,$b:null,Ia:null,Yc:null,Lo:null,Dp:null,fa:null,Me:null,ka:null,EFd:!1,lI:null,Jrd:null,wOe:null,Lpa:null,vmb:null,cBa:null,SXe:null,Dc:null,ha:function(){this.Ipa&&fue(this);this.vmb&&(this.vmb.dispose(),this.vmb=null);!this.lI.baa&&this.lI.Aa().ha();bF.prototype.ha.call(this);R(22590858,829,50,"DesignerView::Dispose")},n8b:function(){this.JU=iM();this.JU.className="DesignerViewContainer";this.Ea.appendChild(this.JU);
this.Ipa=!0;R(22590860,829,50,"DesignerView::InitializeView")},Uka:function(){return this.ka.jEc&&this.Jrd.Uka()},bde:function(a){this.ka.jEc&&(R(592970129,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",a?a.toString():""),!this.lI.baa&&this.lI.Aa().Ri(),this.Jrd.Gua(this.ka.Wra?"designertrial":"designer"))},a2f:function(){R(592970127,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");!this.lI.baa&&this.lI.Aa().Ri();if(this.au.ka.Wra){var a=document.getElementsByClassName("DesignerFreeTrialCardContainer");
if(a)for(var b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);if(a=document.getElementsByClassName("DesignerInFreeTrialView"))for(b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);gue()}else if(a=document.getElementsByClassName("ShadowedTriangleContainer"))for(b=0;b<a.length;b++){a[b].style.display="none";var c=a[b].parentNode;c.removeAttribute("isShownAsPremiumContent");c.removeAttribute("aria-expanded");var d=c.getAttribute("aria-label");d&&(d=d.toString(),d=d.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,
""),c.setAttribute("aria-label",d))}},Txb:function(a){var b,c,d;return(d=hue(this,a,c={val:b},{val:void 0},{val:void 0}),b=c.val,d)?window.parseInt(b):-1},GIf:function(a){return this.Gh.lf()&&a&&a.fr?iue(this,a.fr.className):!1},FIf:function(a){if(!this.Gh.lf()||a.Jr||!this.au.Ma()||!a.Cc())return!1;var b=a.Cc();try{if(b.className){if("mivOverlayContainer"===b.className||"mivTerm"===b.className||"mivIcon"===b.className||"mivContainer"===b.className)return jue(this,b);if(b.className.startsWith("Editor"))return kue(this,
b)}else R(591151563,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(n){return R(591151561,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",b.className,n.message),!1}if(a=lue(b,"DesignerSuggestedActionResult"))return mue(this,a);if(this.Uka()){if("DesignerStartFreeTrialButton"===b.className)return!this.lI.baa&&this.lI.Aa().Ri(),nue(),this.$b.EMc=!0,this.qv(0,!0),R(592761816,829,50,"DesignerView::StartFreeTrial Free Trial started"),!0;if("DesignerInFreeTrialViewGoPremiumText"===
b.className){var c=$l(b);this.lI.Aa().xf(c,b,!0,b,"DesignerInFreeTrialViewGoPremiumTextSelected",null);return!0}(a=lue(b,"DesignerFreeTrialCardGoPremiumButton"))||(a=lue(b,"DesignerStartFreeTrialGoPremiumButton"));if(a)return this.bde(null),!0}if(this.ka.j8&&(a=lue(b,"DesignerMoreIdeasButton"))){Zte(c$(this));if(!a.getAttribute("correlationId"))return!1;oue(c$(this));a=new QLb(a.getAttribute("correlationId").toString());this.Me.qa.Ha("DCMI",a,null);return!0}if(Sys.UI.DomElement.containsCssClass(b,
"ms-Icon--Diamond")){if(b=b.parentNode,!b)return!1}else if(!(Sys.UI.DomElement.containsCssClass(b,"ShadowedTriangleContainer")||Sys.UI.DomElement.containsCssClass(b,"SuggestionImg")||Sys.UI.DomElement.containsCssClass(b,"DesignerSuggestionListDisabled")||(b=b.firstChild,b)))return!1;a=b.parentNode;var d=document.querySelector("#"+this.Gh.Ta()+" .DesignerSuggestionList"),e,f,g,h,k,l;if(l=hue(this,a,g={val:c},h={val:e},k={val:f}),c=g.val,e=h.val,f=k.val,!l)return!1;g=window.parseInt(c);h=window.parseInt(e);
k=window.parseInt(f)||0;l=this.$b.AV.Pc()===h;this.ka.j8&&(l=lte(this.au,d,!1)===a||lte(this.au,d,!0)===a);if(l)return R(25203038,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),Tee(this.Me,new PLb(g,bte(this))),!1;if(a&&a.getAttribute("isShownAsPremiumContent")){for(var b=null,m=a.childNodes,d=0;d<m.length;d++)if(g=m[d],Sys.UI.DomElement.containsCssClass(g,"ShadowedTriangleContainer")){b=g;break}e=new pue(c,e,f);c=$l(b||a);this.lI.Aa().xf(c,a,!1,null,null,e);return!1}if(Sys.UI.DomElement.containsCssClass(b,
"DesignerSuggestionListDisabled"))return!1;c=que(b,h,k);e=(m=new qda,m.SuggestionCid=k,m.SuggestionSid=h,m.CorrelationId=d.getAttribute("correlationId").toString(),m.ActiveSlideCid=this.au.Ma().Be(),m.ActiveSlideSid=this.au.Ma().Pc(),m);f=b;f=.01>=Math.abs(f.width/f.height-1.33);lte(this.au,d,f)?(rue(this.au,d,f),c&&c.parentNode&&c.parentNode.parentNode&&rue(this.au,c.parentNode.parentNode,f),this.fa.jb(1234776651,2,e,null),R(22590872,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):
(this.fa.jb(397517337,2,e,null),R(22590874,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.ka.eRd&&a&&a.getAttribute("containsAnimation")&&kc(B(),Zc).pb(function(a){try{a.Jn("DesignerAnimationSuggestion",null,null)}catch(b){R(573346252,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",b)}});Qte(this.au,b.parentNode,f,!0);c&&Qte(this.au,c.parentNode,f,!0);sue(this.JU,g);Tee(this.Me,new PLb(g,bte(this)));return!0},ITa:function(a){this.Gh.lf()&&
(13!==a.keyCode&&32!==a.keyCode||iue(this,a.target.className))},aVc:function(a){!this.Gh.lf()||13!==a.keyCode&&32!==a.keyCode||(a.preventDefault(),(a=document.activeElement)&&a.click())},qv:function(a,b){if(!(0>a)){var c=this.TJ.querySelector('[suggestionIndex="'+a+'"]');c?b&&(vl(c),sue(this.JU,a)):R(22590880,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",a)}},C5f:function(){this.Gh.lf()&&!this.lI.baa&&this.lI.Aa().Xga()&&this.lI.Aa().Ri()},bAb:function(){if(this.Gh.lf())if(2===
this.Gh.J7)vl(this.tY.lastChild);else if(3===this.Gh.J7){var a=cte(this);if(1===a)ete(this,!0);else if(3===a)$9(this,!0,a);else{var a=this.TJ.querySelector("#"+this.Gh.Ta()+" .DesignerSuggestionResultSelected"),a=this.Txb(a),b;b=this.TJ.querySelector("#"+this.Gh.Ta()+" [slideId]:hover");b=this.Txb(b);-1===a?this.qv(-1===b?0:b,!0):this.qv(a,!0)}}},FW:function(a){return this.Gh.lf()&&a.Cc()?tue(this,a.get_clientPoint()):!1},EW:function(a){return this.Gh.lf()&&a.Cc()?tue(this,a.get_clientPoint()):!1},
AC:function(){window.clearTimeout(this.ZMe);window.clearTimeout(this.XMe)},lz:function(a){9===a.keyCode&&("mivKeepFocusEnd"!==a.target.id||a.shiftKey?"mivKeepFocusStart"===a.target.id&&a.shiftKey&&uue(a,"mivKeepFocusEnd"):uue(a,"mivKeepFocusStart"))}};function vue(a,b){var c=a.$b.dR[b].mFa[0].explanationLabel;document.getElementById("EditorSubtitle").innerText=c;var c=document.getElementById("EditorSuggestionsContainer"),d=wue();c.parentNode.replaceChild(d,c);xue(a.au,d,b)}
function yue(a){var b=[];a=a.$b.dR[a.$b.RR].mFa;for(var c=a.length,d=0;d<c;++d)b.push(a[d].critiqueId);return b}function tue(a,b){var c=a.$b.xha;if(!c||Xn(a.$b.dR))return!1;for(b=tn(b);b&&"EditorContainer"!==b.className;)b=b.parentNode;b&&"EditorContainer"===b.className?c.M7b(yue(a),2):c.M7b([],2);return!0}
function kue(a,b){if(Sys.UI.DomElement.containsCssClass(b,"EditorPrevEnabled")||Sys.UI.DomElement.containsCssClass(b,"EditorNextEnabled")){if(Sys.UI.DomElement.containsCssClass(b,"EditorPrevEnabled")){var c;Nte(c=a.$b,c.RR-1);a.$b.RR||(Sys.UI.DomElement.removeCssClass(b,"EditorPrevEnabled"),Sys.UI.DomElement.addCssClass(b,"EditorPrevDisabled"));var d=document.getElementById("EditorNext");Sys.UI.DomElement.removeCssClass(d,"EditorNextDisabled");Sys.UI.DomElement.addCssClass(d,"EditorNextEnabled")}else{var e;
Nte(e=a.$b,e.RR+1);a.$b.RR===a.$b.dR.length-1&&(Sys.UI.DomElement.removeCssClass(b,"EditorNextEnabled"),Sys.UI.DomElement.addCssClass(b,"EditorNextDisabled"));d=document.getElementById("EditorPrev");Sys.UI.DomElement.removeCssClass(d,"EditorPrevDisabled");Sys.UI.DomElement.addCssClass(d,"EditorPrevEnabled")}document.getElementById("EditorBucketCurrent").innerText=(a.$b.RR+1).toString();vue(a,a.$b.RR);a=!0}else if(Sys.UI.DomElement.containsCssClass(b,"EditorSuggestionContainer")||Sys.UI.DomElement.containsCssClass(b,
"EditorSuggestionArrow")||Sys.UI.DomElement.containsCssClass(b,"EditorSuggestionText")||Sys.UI.DomElement.containsCssClass(b,"EditorSuggestionInstances"))if(d=a.$b.xha,Xn(a.$b.dR)||!d)a=!1;else{b=b.getAttribute("editorSuggestionIdx");if(c=document.querySelector('.EditorSuggestionArrow[editorSuggestionIdx="'+b+'"]'))c.innerText="\u2713",Sys.UI.DomElement.removeCssClass(c,"EditorSuggestionArrow"),Sys.UI.DomElement.addCssClass(c,"EditorSuggestionCheck");c=new (Wb.$$(String,Number))(0);e=a.$b.dR[a.$b.RR].mFa;
for(var f=e.length,g=0;g<f;++g)c.ga(e[g].critiqueId,b);d.$le(c,3);a=a.$b.MZb=!0}else Sys.UI.DomElement.containsCssClass(b,"EditorIgnore")?(b=a.$b.xha)?(b.W7b(yue(a),4),a.$b.dR.splice(a.$b.RR,1),a.$b.RR===a.$b.dR.length&&Nte(d=a.$b,d.RR-1),b=document.getElementById("EditorBucketTotal"),d=window.parseInt(b.innerText),d--,0>=d?(a=document.getElementById("EditorCardContent"),d=iM(),d.className="EditorNoMoreContainer",b=new RL,b.vi(40,40),SL(b,"0,0,2048,2048"),GL(b,"EditorSvgCheck"),c=new YL,ZL(c,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z"),
e=new YL,ZL(e,"M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z"),e.Ja.setAttribute("class","EditorWhiteCheck"),f=
new YL,ZL(f,"M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z"),
f.Ja.setAttribute("class","EditorGreenFill"),g=new YL,ZL(g,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z"),
g.Ja.setAttribute("class","EditorGreenBorder"),b.jf(c),b.jf(e),b.jf(f),b.jf(g),c=jM(),c.innerText=ResourceStrings.l_ConsistencyCardNoMore,c.className="EditorNoMoreLabel",d.appendChild(b.Ja),d.appendChild(c),a.parentNode.replaceChild(d,a)):(b.innerText=d.toString(),vue(a,a.$b.RR),b=a.$b.RR===a.$b.dR.length-1,c=document.getElementById("EditorNext"),1<d&&!b?(Sys.UI.DomElement.addCssClass(c,"EditorNextEnabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextDisabled")):(Sys.UI.DomElement.addCssClass(c,
"EditorNextDisabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextEnabled")),b&&(document.getElementById("EditorBucketCurrent").innerText=d.toString()),b=document.getElementById("EditorPrev"),1<d&&a.$b.RR?(Sys.UI.DomElement.addCssClass(b,"EditorPrevEnabled"),Sys.UI.DomElement.removeCssClass(b,"EditorPrevDisabled")):(Sys.UI.DomElement.addCssClass(b,"EditorPrevDisabled"),Sys.UI.DomElement.removeCssClass(b,"EditorPrevEnabled"))),a=!0):a=!1:Sys.UI.DomElement.containsCssClass(b,"EditorSeeMoreLabel")?
(a.fa.Ab(1625372200,2,null),a.Gh.Qo(!1,"OpenEditorPane"),a=a.$b.MRd=!0):a=!1;return a}
function zue(a,b){a.ka.j8&&(a.SXe=c$(a).querySelector(".DesignerSuggestionList").getAttribute("correlationId").toString());Z9(a,6);var c=zh(a.ka.$sb).toString(),c=String.format(a.ka.Irb,F.ag,ao(F.ag)._name,Jp,Ae().toString(),3,c,0),c=c.replace(/&amp;/g,"&").replace(/&p=3/,"&p=6")+"&q="+b;b=document.getElementById("mivFrame");b.setAttribute("src",c);b.style.visibility="visible";a.vmb=(new dne).ou(b.contentWindow,c);F9(a.vmb,"AddItem",function(b){if(b=hne(b)){var c=[];Array.add(c,b);a.fa.Ab(3070664289,
2,null);a.Gh.Qo(!1,"CloseSecondPane");a.wOe.Aua(c)}});F9(a.vmb,"ClosePane",function(){Z9(a,3);var b=a.$b.Kv()?a.$b.Kv().SlideSuggestions.length:0,c=a.ka.j8?a.SXe:a.$b.nd,b=new Vte(a.$b.Kv(),b,a.$b.gDa.length,c,c$(a),!0,a.Uka(),Ete(a.au,"MakeItVisual"));Wte(a.au,b)});return!0}
function jue(a,b){switch(b.className){case "mivContainer":return gte(a.Gh,1),!0;case "mivOverlayContainer":b=b.querySelector(".mivTerm").innerText;break;case "mivTerm":b=b.innerText;break;case "mivIcon":b=b.parentNode.querySelector(".mivTerm").innerText;break;default:return!1}return zue(a,b)}function uue(a,b){a.preventDefault();a.stopPropagation();(a=document.getElementById(b))&&a.focus()}
function Aue(a){var b=document.createElement("div");b.setAttribute("Id",a);b.setAttribute("tabindex",0);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");return b}
function Bue(a){a.TJ.style.display="none";a.$b.rIc=!0;a.cBa=iM();a.cBa.className="mivView";var b=Aue("mivKeepFocusStart"),c=document.createElement("iframe");c.className=c.id="mivFrame";var d=Aue("mivKeepFocusEnd");a.cBa.appendChild(b);a.cBa.appendChild(c);a.cBa.appendChild(d);a.JU.appendChild(a.cBa);var e=a.Ia.$c("IdeasMakeItVisualFocusId");e.ic="app";ll(a.Yc,"IdeasMakeItVisualFocusId",c,!1);Rl(e,function(){c.focus();var b,d=(b=new Yl(function(){return a.cBa}),b.kva=!0,b);Zl(d,3);Zl(d,2);Zl(d,4);
Zl(d,1);Zl(d,6);Zl(d,5);kxa($f(),a.cBa,e,d);b=NB($f(),"IdeasMakeItVisualFocusId");Wl(b);b.QK=!0;b.Dta=!0;Pl(e,$f().loa);Pl(e,$f().moa);d.xz(c)});a.Ia.Qf("IdeasMakeItVisualFocusId",!1);a.Dp.Ka(a.cBa,"keydown",a.Wz)}function Cue(a){var b=a.$b.nd;a.XMe=window.setTimeout(function(){a.AC();Zte(c$(a));R(593494240,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",b)},a.ka.FZb)}
function Due(a){var b=a.$b.nd;a.ZMe=window.setTimeout(function(){a.AC();Z9(a,2);R(22590912,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",b);a.Gh.lf()&&(a.$b.VEd(!0),a.fa.jb(2658220272,2,new xCb(!1,"SuggestionsLoadingTimeout"),null))},a.ka.FZb)}
function iue(a,b){try{var c=a.tY.querySelector("."+b);if(!c)return!1;var d=c.getAttribute("href").toString();if(!d)return!1;Uj(4,d,!0,null);return!0}catch(e){return R(41711770,829,10,"DesignerView:GoToSuggestionLink exception: {0}",e),!1}}
function $9(a,b,c){var d=null;1===c?d=a.TJ.querySelector(".DesignerStartFreeTrialGoPremiumButton"):2===c?d=a.TJ.querySelector(".DesignerInFreeTrialViewGoPremiumText"):3===c&&(d=a.TJ.querySelector(".DesignerFreeTrialCardGoPremiumButton"));d?b?vl(d):d.blur():R(592524127,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",c)}function dte(a){!a.lI.baa&&a.lI.Aa().Xga()&&(a=a.lI.Aa(),a.Xga()&&(a.rOb?a.xMa.focus():a.Uaa.focus(),a.rOb=!a.rOb))}
function ete(a,b){(a=a.TJ.querySelector(".DesignerStartFreeTrialButton"))?b?vl(a):a.blur():R(592524129,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}function fte(a){return!!a.TJ.querySelector(".DesignerStartFreeTrialButton:focus")}function cte(a){return a.Uka()?a.TJ.querySelector(".DesignerInFreeTrialViewGoPremiumText")?2:a.TJ.querySelector(".DesignerStartFreeTrialButton")?1:a.TJ.querySelector(".DesignerFreeTrialCardGoPremiumButton")?3:0:0}
function que(a,b,c){var d='[slideId="'+b+'"] > .SuggestionImg';c&&(d=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',"slideId",b,"slideCid",c,"SuggestionImg"));b=document.querySelectorAll(d);if(!b)return null;for(c=0;c<b.length;c++)if(d=b[c],d!==a)return d;return null}function lue(a,b){for(;a&&a.className!==b;)a=a.parentNode;return a}
function mue(a,b){b=b.getAttribute("suggestionIndex").toString();b=window.parseInt(b);b=a.$b.gDa[b];if(!b||3!==b.Type&&4!==b.Type)return!1;b=new RLb(b);a.Me.qa.Ha("SAC",b,null);return!0}function c$(a){var b=a.ka.c8a?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",c=a.ka.c8a?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return a.Ea.querySelector("."+(Di?c:b))}function bte(a){return a.TJ.querySelectorAll("#"+a.Gh.Ta()+" [suggestionIndex]").length}
function hue(a,b,c,d,e){c.val="";d.val="";e.val="";if(b){var f=b.getAttribute("suggestionIndex"),g=b.getAttribute("slideId");if(!f||!g)return R(41694980,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",a.$b.nd),!1;c.val=f.toString();d.val=g.toString();(b=b.getAttribute("slideCid"))?e.val=b.toString():R(594071841,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",
a.$b.nd);return!0}return!1}
function Eue(a,b){a.tY=iM();a.tY.className=Di?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";a.U0a=iM();a.T0a=iM();Fue(a.au,a.JU);if(b){a.U0a.className="DesignerNoSuggestionNew-Header";a.T0a.className="DesignerNoSuggestionNew-Content";var c=VL();c.src=a.Dc.Lk("DesignerNoIdeas.svg");c.className="DesignerNoIdeasIllustration";a.tY.appendChild(c)}else a.U0a.className="DesignerNoSuggestionView-Header",a.T0a.className="DesignerNoSuggestionView-Content";a.tY.appendChild(a.U0a);a.tY.appendChild(a.T0a);
b?(b=iM(),b.className="DesignerNoSuggestionNewButton",b.tabIndex=0,b.innerText=ResourceStrings.L_DesignerLearnMoreShort,b.setAttribute("Unselectable","on"),b.setAttribute("aria-label",b.innerText),b.setAttribute("role","button"),b.setAttribute("href","https://go.microsoft.com/fwlink/?linkid=849683"),a.Yc.Wa("click",b,a.bGd),a.tY.appendChild(b)):(b=kM(),b.className="DesignerNoSuggestionView-Link",b.setAttribute("href","https://go.microsoft.com/fwlink/?linkid=849683"),b.setAttribute("target","_blank"),
b.innerText=ResourceStrings.L_DesignerLearnMore,b.tabIndex=0,b.setAttribute("role","link"),a.tY.appendChild(b),a.Yc.Wa("click",b,a.bGd));a.JU.appendChild(a.tY);a.Dp.Ka(a.tY,"keydown",a.lja)}
function Z9(a,b){R(592536862,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",a.$b.nd,M.z5b.toString(b));a.AC();4!==b&&7!==b&&8!==b&&(fue(a),a.JU.id=a.$b.nd);a.Gh.J7=b;switch(a.Gh.J7){case 1:a.OPb=iM();a.OPb.className="DesignerLoadingView";b=VL();b.className=Di?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";b.src=dg("progress.gif");var c=iM();c.className=Di?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";c.innerText=ResourceStrings.L_DesignerLoading;a.OPb.appendChild(b);
R(38340425,829,50,"DesignerView::spinner shows up");a.OPb.appendChild(c);a.JU.appendChild(a.OPb);R(22590866,829,50,"DesignerView::InitLoadingState");Due(a);break;case 7:Cue(a);break;case 2:a.Gh.lf()&&(Eue(a,!1),a.U0a.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,a.T0a.innerText=ResourceStrings.L_DesignerNoSuggestionContent,R(22590868,829,50,"DesignerView::InitNoSuggestionState"));break;case 9:a.Gh.lf()&&(Eue(a,!0),a.U0a.innerText=ResourceStrings.L_DesignerNoIdeasHeader,a.T0a.innerText=ResourceStrings.L_DesignerNoIdeas,
R(588851201,829,50,"DesignerView::InitNoSuggestionState"));break;case 5:a.Gh.lf()&&(Eue(a,!1),a.U0a.innerText=ResourceStrings.L_DesignerCoauthorHeader,a.T0a.innerText=ResourceStrings.L_DesignerCoauthorContent,R(41725981,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"));break;case 3:a.Gh.lf()||a.Gh.Qo(!0,null);a.TJ=iM();b=a.EFd?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView";c=a.EFd?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";a.TJ.className=Di?c:b;a.JU.appendChild(a.TJ);
a.ka.gEc||(DT(a.Ia,"EditingDesignerPanelFocus",!0),a.Ia.ne());a.Yc.Wa("click",a.TJ,a.H1e);a.Dp.Ka(a.TJ,"keydown",a.uXb);a.Lo.Wa("msospPointerOver",a.TJ,a.qK);a.Lo.Wa("msospPointerOut",a.TJ,a.nF);R(22590870,829,50,"DesignerView::InitShowSuggestionState");break;case 6:Bue(a);break;case 4:if(b=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(c=0;c<b.length;c++)b[c].style.visibility="visible",b[c].setAttribute("SourceTrigger","Refreshing")}a.Gh.qa.Ka("OnDesignerPaneFocusOn",a.jpb);a.Gh.qa.Ka("OnDesignerPaneFocusBlur",
a.tJd)}function fue(a){if(a.ka.$qb){var b=a.au;try{b.r0a&&b.r0a.Da()&&Upe(b.r0a.Da())}catch(c){R(577807395,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",b.$b.nd,c)}}if(a.JU.children&&0<a.JU.children.length)for(;0<a.JU.children.length;)a.JU.removeChild(a.JU.children[0]);a.Gh.J7=0;a.Gh.qa.eb("OnDesignerPaneFocusOn",a.jpb);a.Gh.qa.eb("OnDesignerPaneFocusBlur",a.tJd);!a.lI.baa&&a.lI.Aa().Ri();R(22590862,829,50,"DesignerView::CleanUpView")}
function Vte(a,b,c,d,e,f,g,h){this.EQa=a;this.dSd=b;this.krb=c;this.Kqb=d;this.L3=e;this.csa=f;this.z2b=g;this.hub=h}Vte.prototype={EQa:null,dSd:0,krb:0,Kqb:null,Rhb:function(){return this.Kqb},L3:null,csa:!1,z2b:!1,hub:!1};function Gue(a,b,c,d,e,f,g){this.ra=a;this.qc=b;this.ka=c;this.$b=d;this.YTb=(a=this.ka.c8a)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.ZTb=a?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.ob=e;this.Dc=f;this.r0a=g}
function Rte(a){var b=null;try{b=kn(a)}catch(c){R(39338641,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return b}function $te(a){var b=a.CardData,c=null;try{if(c=kn(b),!a.SlideSuggestions&&c)for(c=kU(c,function(a){return!!a.Type}),a=0;a<c.length;a++)c[a].Index=a}catch(d){R(41969486,829,10,"parsing cards failed with exception: {0}",d)}return c}function wue(){var a=iM();a.className=a.id="EditorSuggestionsContainer";return a}
Gue.prototype={ra:null,ka:null,qc:null,$b:null,ob:null,Dc:null,r0a:null,YTb:null,ZTb:null,bRb:null,pu:function(){return this.qc.pu(!0)},Ma:function(){return window.$$as($M,this.ra.Ma())}};
function sue(a,b){if(a){if(a=a.querySelector('[suggestionIndex="'+b+'"]'))b=$l(a),a.contains(tn(new Sys.UI.Point(b.x,b.y)))&&a.contains(tn(new Sys.UI.Point(b.x+b.width-1,b.y)))?a.contains(tn(new Sys.UI.Point(b.x,b.y+b.height-1)))&&a.contains(tn(new Sys.UI.Point(b.x+b.width-1,b.y+b.height-1)))||a.scrollIntoView(!1):a.scrollIntoView(!$H("Designer.ScrollIntoViewFix"))}else R(36845459,829,15,"Designer view has been removed from DesignerViewContainer")}
function lte(a,b,c){return b.querySelector("."+(c?a.ZTb+"4x3":a.ZTb))}function Qte(a,b,c,d){b&&(d?(b.className=c?a.ZTb+"4x3":a.ZTb,Wf(b,"aria-selected","true")):(b.className=c?a.YTb+"4x3":a.YTb,Wf(b,"aria-selected","false")))}function rue(a,b,c){Qte(a,lte(a,b,c),c,!1)}function Hue(a){a=a.pu();return.01>=Math.abs(a.ld/a.Ld-1.33)}function mte(a){a.bRb&&(a.ob.ih(a.bRb),a.bRb=null)}
function Iue(a,b){mte(a);a.bRb=new Si(2,1,a.ka.hRd,function(){mte(a);for(var c=0;c<b;c++)a.$b.ica.Kc(c)||a.$b.Frb.ga(c)},0,"IncrementalRenderTimeoutTask",!1,0);a.ob.Vb(a.bRb)}
function xue(a,b,c){a=a.$b.dR[c].mFa[0].suggestions;c=Math.min(3,a.length);for(var d=0;d<c;d++){var e=b,f=a[d].description,g=a[d].numberOfInstances,h=d,k=iM();k.className="EditorSuggestionContainer";k.tabIndex=0;k.setAttribute("editorSuggestionIdx",h);var l=jM();l.className="EditorSuggestionArrow";l.innerText="\u2192";l.setAttribute("editorSuggestionIdx",h);var m=jM();m.className="EditorSuggestionText";m.innerText=f;m.setAttribute("editorSuggestionIdx",h);f=jM();f.className="EditorSuggestionInstances";
f.innerText=String.format("[{0}]",g);f.setAttribute("editorSuggestionIdx",h);k.appendChild(l);k.appendChild(m);k.appendChild(f);e.appendChild(k)}}function Fue(a,b){try{if(a.r0a&&a.r0a.Da()){var c=iM();c.id="AgendaCardContainer";c.className="AgendaCardContainer";b.appendChild(c);Vpe(a.r0a.Da(),c)}}catch(d){R(577807425,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",a.$b.nd,d)}}
function gue(){var a=document.getElementsByClassName("SuggestionImg");if(a)for(var b=0;b<a.length;b++){Sys.UI.DomElement.removeCssClass(a[b].parentNode,"pointer-events-none");a[b].parentNode.tabIndex=0;a[b].parentNode.removeAttribute("aria-hidden");var c=zW(a[b].parentNode,"DesignerSuggestionListDisabled");!c||c.getAttribute("SourceTrigger")&&"Refreshing"===c.getAttribute("SourceTrigger").toString()||(c.style.visibility="hidden")}}
function Jue(a,b,c,d,e){if(b){var f=VL();f.src=a.Dc.Lk(c);f.className="SuggestedMediaIcon";a=jM();a.className="SuggestedMediaContainer";a.appendChild(f);b.setAttribute("aria-label",String.format(d,e+1));a.setAttribute("aria-hidden","true");a.setAttribute("Unselectable","on");b.appendChild(a)}}
function Kue(a,b){if(a){var c=document.createElement("video");c.className="SuggestedVideoBackgroundContainer";c.setAttribute("Src",b);c.setAttributeNode(document.createAttribute("muted"));Afe()||(c.setAttributeNode(document.createAttribute("autoplay")),c.setAttributeNode(document.createAttribute("loop")),c.addEventListener("canplay",function(){c.muted="true";c.play()}));a.appendChild(c)}}
function Lue(a,b,c,d,e,f){var g=iM();g.className="mivButton";g.setAttribute("role","listitem");var h="mivTerm."+e,k=VL();k.className="mivButtonImage";a:{for(var l=Mue,m=l.length,n=0;n<m;++n){var r=l[n];if(r.toLowerCase()===b.toLowerCase()){d.ga(r);a=a.Dc.Lk(b+".png");break a}}a=a.Dc.Lk("stock"+f.val++ +".png")}k.src=a;k.setAttribute("aria-labelledby",h);a=iM();a.className="mivOverlayContainer";a.tabIndex=0;a.setAttribute("mivIdx",e);a.setAttribute("role","button");e=document.createElement("i");e.className=
"mivIcon";e.innerText="\ue721";e.setAttribute("role","presentation");d=jM();d.className="mivTerm";d.innerText=b;d.id=h;g.appendChild(k);g.appendChild(a);a.appendChild(e);a.appendChild(d);c.appendChild(g)}
function Nue(a,b,c,d,e,f,g,h,k,l){var m=null;if(a.ka.jca)a:if(c&&(m=c.querySelector("#"+e+' [IncSuggestionPlaceholder="'+h+'"]')),m&&Sys.UI.DomElement.addCssClass(m,"ShimmerPaused"),!a.$b.Pra.Kc(h)&&(a.$b.Pra.ga(h),c=a.$b.Pra.Qa(),c===f&&(a.$b.sqb=new Date,mte(a)),!a.$b.f8a&&c>=a.$b.s5a)){for(f=0;f<a.$b.s5a;f++)if(!a.$b.Pra.Kc(f))break a;a.$b.f8a=new Date}f=!1;switch(b){case 0:if(d&&g)try{f=!1;try{d.setAttribute("slideId",g.SlideId.Sid),d.setAttribute("slideCid",g.SlideId.Cid),f=!0}catch(v){R(594071824,
829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),f=!1}f||d.setAttribute("slideId",g.SlideSid);var n=VL();n.className="SuggestionImg";n.src=g.Base64Img;a.$b.ica.Kc(g.Index)||a.$b.ica.ga(g.Index);a.ka.dRd&&g.DesignerMediaURL&&g.Categories&&Wn(g.Categories,1)&&Kue(d,g.DesignerMediaURL);d.appendChild(n);R(42342620,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",h,a.$b.nd)}catch(v){d.parentNode.removeChild(d),R(41695003,
829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",h,a.$b.nd,v)}var r=k&&a.ka.Wra;f=r&&1!==l;var t=l=n=!1;if(g&&g.Categories)for(g=g.Categories,b=g.length,c=0;c<b;++c)e=g[c],2===e?n=k&&!r:1===e?l=!0:3===e?t=!0:4===e&&Jue(a,d,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,h);(n||f)&&d&&(a.ka.Wra?Sys.UI.DomElement.addCssClass(d,"pointer-events-none"):(d.setAttribute("isShownAsPremiumContent",
"isShownAsPremiumContent"),(g=d.getAttribute("aria-label"))&&d.setAttribute("aria-label",String.format("{0}. {1}",g.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem)),Wf(d,"aria-expanded","false"),g=iM(),g.className="ShadowedTriangleContainer",k=document.createElement("i"),k.className="ms-Icon ms-Icon--Diamond",g.appendChild(k),d.appendChild(g)));l?Jue(a,d,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,h):t&&(Jue(a,d,"commoncontrolanimationsuggestioniconnoborder.svg",
ResourceStrings.l_DesignerAnimationSuggestionItem,h),d.setAttribute("containsAnimation","containsAnimation"),d.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));break;case 1:if(g){d.className="mivContainer";d.setAttribute("aria-label",ResourceStrings.L_MakeItVisualCardTitle);h=jM();h.className="mivTitle";h.innerText=ResourceStrings.L_MakeItVisualCardTitle;k=jM();k.className="mivSubtitle";k.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;l=iM();l.className="mivButtonsContainer";
l.setAttribute("role","list");n=0;t=new ($b.$$(String));b=Math.min(6,g.SearchTerms.length);for(r=0;r<b;r++)Lue(a,g.SearchTerms[r].Term,l,t,r,n={val:n}),n=n.val;for(r=b;6>r;r++)for(g=Mue,b=g.length,c=0;c<b;++c)if(e=g[c],!t.Kc(e)){Lue(a,e,l,t,r,g={val:n});n=g.val;break}d.appendChild(h);d.appendChild(k);d.appendChild(l);a.$b.H0b=!0}break;case 2:if(!(g=Xn(a.$b.dR))){a:if(g=a.$b,g.xha)t=!0;else{try{if(r=gc(B(),vbd)){g.xha=r;t=!0;break a}}catch(v){R(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",
v)}t=!1}g=!t}g?d.style.display="none":(d.className="EditorContainer",g=jM(),g.className="EditorTitle",g.innerText=ResourceStrings.L_ConsistencyCardTitle,h=iM(),h.className="EditorSubtitleContainer",k=jM(),k.className=k.id="EditorSubtitle",k.innerText=k.title=a.$b.dR[0].mFa[0].explanationLabel,l=iM(),l.className="EditorBucketContainer",t=jM(),t.innerText="<",t.tabIndex=0,Sys.UI.DomElement.addCssClass(t,"EditorPrev"),Sys.UI.DomElement.addCssClass(t,"EditorPrevDisabled"),t.id="EditorPrev",r=jM(),r.innerText=
"1",r.id="EditorBucketCurrent",Nte(a.$b,0),n=jM(),n.innerText="/",b=jM(),b.className="EditorBucketTotalCount",b.id="EditorBucketTotal",b.innerText=a.$b.dR.length.toString(),c=jM(),c.innerText=">",c.tabIndex=0,c.className=c.id="EditorNext",0<a.$b.dR.length-1?Sys.UI.DomElement.addCssClass(c,"EditorNextEnabled"):Sys.UI.DomElement.addCssClass(c,"EditorNextDisabled"),l.appendChild(t),l.appendChild(r),l.appendChild(n),l.appendChild(b),l.appendChild(c),h.appendChild(k),h.appendChild(l),k=jM(),k.className=
"EditorDescription",k.innerText=ResourceStrings.L_ConsistencyCardDescription,l=wue(),xue(a,l,0),t=iM(),t.className="EditorIgnoreContainer",r=iM(),r.className="EditorIgnore",r.innerText=ResourceStrings.L_ConsistencyCardIgnore,r.title=ResourceStrings.L_ConsistencyCardIgnoreTitle,r.tabIndex=0,t.appendChild(r),r=iM(),r.className="EditorSeeMoreContainer",n=jM(),n.className="EditorSeeMoreLabel",n.innerText=ResourceStrings.L_ConsistencyCardSeeMore,n.tabIndex=0,r.appendChild(n),n=iM(),n.id="EditorCardContent",
n.appendChild(h),n.appendChild(k),n.appendChild(l),n.appendChild(t),d.appendChild(g),d.appendChild(n),d.appendChild(r),a.$b.NZb=!0);break;case 3:case 4:if(g){d.className="DesignerSuggestedActionResult";d.setAttribute("aria-label",g.TitleText);d.setAttribute("suggestionIndex",g.Index);a:switch(g.ExecutionActionName){case "PowerPointConvertImageToTable":h="pegal_ImageToTable_24x24x32";break a;default:h=null}h&&(k=VL(),k.src=a.Dc.Lk("pegal.png"),k.className=h,a=jM(),a.className="cui-img-container cui-img-24by24",
a.appendChild(k),d.appendChild(a));a=jM();a.className="DesignerSuggestedActionTitle";a.innerText=g.TitleText;k=jM();k.className="DesignerSuggestedActionSubtitle";k.innerText=g.DescriptionText;g=iM();g.className=h?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";g.appendChild(a);g.appendChild(k);d.appendChild(g)}}m&&m.parentNode.removeChild(m);m=iM();m.className="DesignerSuggestionListDisabled";f&&(m.style.visibility="visible",d.removeAttribute("tabindex"),d.setAttribute("aria-hidden",
"true"));d.appendChild(m)}function Oue(a,b,c,d){var e=iM();e.className=d?a.YTb+"4x3":a.YTb;e.setAttribute("suggestionIndex",b);e.tabIndex=0;e.setAttribute("aria-label",String.format(ResourceStrings.l_DesignerSuggestionItem,b+1));e.setAttribute("role","listitem");e.setAttribute("aria-posinset",b+1);e.setAttribute("aria-setsize",c);return e}
function Zte(a){if(a){var b=a.querySelector(".DesignerMoreIdeasButton");b&&a.removeChild(b);(b=a.querySelector(".DesignerMoreIdeasLoading"))&&a.removeChild(b)}}function oue(a){if(a){var b=VL();b.className="DesignerMoreIdeasLoading";b.src=dg("progress.gif");a.appendChild(b)}}
function Pue(a,b){var c=iM();c.className="DesignerMoreIdeasButton";c.setAttribute("correlationId",b);c.tabIndex=0;b=new RL;b.vi(16,16);SL(b,"0,0,2048,2048");var d=new YL;ZL(d,"M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");b.jf(d);
b=b.Ja;b.setAttribute("class","DesignerMoreIdeasButtonIcon");c.appendChild(b);b=iM();b.className="DesignerMoreIdeasButtonLabel";b.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;c.appendChild(b);c.setAttribute("aria-label",b.innerText);c.setAttribute("role","button");a.appendChild(c)}function nue(){var a=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(a)for(var b=0;b<a.length;b++){var c=a[b];if(c.parentNode){var d=Que();c.parentNode.replaceChild(d,c)}}gue()}
function Que(){var a=iM();a.className="DesignerInFreeTrialView";var b=document.createElement("i");b.className=Di?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";var c=iM();c.className="DesignerInFreeTrialViewGoPremiumText";c.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;c.tabIndex=0;var d=iM();d.className=Di?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";d.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;
c.setAttribute("role","link");c.setAttribute("aria-expanded","false");c.setAttribute("aria-label",c.innerText);a.appendChild(b);a.appendChild(c);a.appendChild(d);a.setAttribute("aria-label",c.innerText+" "+d.innerText);a.setAttribute("role","region");return a}
function Yte(a,b,c,d,e){try{if(!(b&&b.SlideSuggestions&&b.SlideSuggestions.length&&c))return!1;Zte(c);var f=c.querySelector(".DesignerSuggestionList");if(!f)return!1;for(var g=f.childNodes.length,h=f.childNodes.length+b.SlideSuggestions.length,k=Hue(a),l=c.parentNode.parentNode.id,m=0;m<b.SlideSuggestions.length;++m){var n=Oue(a,g+m,h,k);Nue(a,0,c,n,l,h,b.SlideSuggestions[m],g+m,e,b.DocumentUpsellStatus);f.appendChild(n)}b.HasPaginationInfo&&Pue(c,d);return!0}catch(r){return R(593794385,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",
r),!1}}
function Wte(a,b){R(592536837,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",a.$b.nd,b.csa);if(b.EQa&&b.krb&&b.L3){var c=Hue(a),d=b.L3.parentNode.parentNode.id;if(b.z2b&&a.ka.Wra&&b.csa)switch(b.EQa.DocumentUpsellStatus){case 0:var e=b.L3,f=iM();f.className="DesignerFreeTrialCardContainer";var g=iM();g.className="DesignerFreeTrialCardTitle";g.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;var h=iM();h.className="DesignerFreeTrialCardContent";h.innerText=
String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,kte(a));var k=iM();k.className="DesignerStartFreeTrialButtonsContainer";var l=iM();l.className="DesignerStartFreeTrialButton";l.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;l.tabIndex=0;l.setAttribute("aria-label",l.innerText);l.setAttribute("role","button");var m=iM();m.className="DesignerStartFreeTrialGoPremiumButton";var n=document.createElement("i");n.className="ms-Icon ms-Icon--Diamond";n.style.lineHeight=
"20px";n.setAttribute("Unselectable","on");var r=iM();r.className="DesignerStartTrialGoPremiumButtonText";r.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;r.setAttribute("Unselectable","on");m.setAttribute("aria-label",r.innerText);m.setAttribute("role","button");m.tabIndex=0;m.appendChild(n);m.appendChild(r);k.appendChild(l);k.appendChild(m);f.appendChild(g);f.appendChild(h);f.appendChild(k);f.setAttribute("aria-label",String.format("{0}. {1}",g.innerText,h.innerText));f.setAttribute("role",
"region");e.appendChild(f);break;case 1:e=b.L3;f=Que();e.appendChild(f);break;case 2:e=b.L3,f=iM(),f.className="DesignerFreeTrialCardContainer",g=iM(),g.className="DesignerFreeTrialCardTitle",g.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle,h=iM(),h.className="DesignerFreeTrialCardContent",h.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent,k=iM(),k.className="DesignerFreeTrialCardGoPremiumButton",l=document.createElement("i"),l.className="ms-Icon ms-Icon--Diamond",
l.style.lineHeight="20px",m=iM(),m.className="DesignerTrialExhaustedGoPremiumButtonText",m.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText,k.setAttribute("aria-label",m.innerText),k.setAttribute("role","button"),k.tabIndex=0,k.appendChild(l),k.appendChild(m),f.appendChild(g),f.appendChild(h),f.appendChild(k),f.setAttribute("aria-label",String.format("{0}. {1}",g.innerText,h.innerText)),f.setAttribute("role","region"),e.appendChild(f)}b.csa&&a.ka.$qb&&Fue(a,b.L3);if(b.csa){e=b.krb;h=b.Rhb();
f=b.L3;k=b.hub;g=iM();g.className="DesignerSuggestionList";g.setAttribute("correlationId",h);g.setAttribute("aria-label",ResourceStrings.l_DesignerSuggestions);g.setAttribute("role","list");k&&(h=a.$b,(k=document.getElementById("WACDocumentPanel"))?(l=a.ka.c8a,m=Hue(a),k=Math.floor((k.offsetHeight-87)/(l||m?135:101))):k=1,h.s5a=k);for(h=0;h<e;++h)g.appendChild(Oue(a,h,e,c));f.appendChild(g);e=g}else{e=b.L3;f=b.Rhb();if(!e)throw Error.argumentNull("suggestionsContainer");e=e.querySelector("#"+d+' .DesignerSuggestionList[correlationId="'+
f+'"]')}if(f=e)try{var t=a.$b.gDa,v=!Xn(t)&&"IdeasPane"===d,x=b.EQa,e={};if(v)for(var y=t.length,z=0;z<y;++z){var E=t[z];switch(E.Type){case 0:for(var H=E,g=null,O=x.SlideSuggestions,Q=O.length,h=0;h<Q;++h)if(U=O[h],U.Index===H.IndexInDesigner){g=U;break}e[E.Index.toString()]=g;break;default:e[E.Index.toString()]=E}}else for(z=x.SlideSuggestions,H=z.length,x=0;x<H;++x){var U=z[x];e[U.Index.toString()]=U}if(b.csa){a.$b.$Mc=new Date;b.hub&&Iue(a,b.dSd);for(var V=0;V<f.childNodes.length;V++){var Z=f.childNodes[V],
Y;if(Y=b.hub){var ca=e,la=V.toString();Y=!(la in ca)||!ca[la]}if(Y){var ca=c,ra=V,sa=Z;sa.style.backgroundColor="white";var ua=iM();ua.className=ca?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";ua.setAttribute("IncSuggestionPlaceholder",ra);(ji()||gi())&&Sys.UI.DomElement.addCssClass(ua,"Shimmer");sa.appendChild(ua)}else Nue(a,v?t[V].Type:0,b.L3,Z,d,b.krb,e[V.toString()],V,b.z2b,b.EQa.DocumentUpsellStatus)}a.ka.j8&&b.EQa.HasPaginationInfo&&Pue(b.L3,
b.Rhb())}else if(b.hub)for(R(592306778,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",a.$b.nd,wn(e)),V=Object.keys(e),ca=V.length,c=0;c<ca;++c)ra=V[c],sa=window.parseInt(ra),Z=b.L3.querySelector("#"+d+' [suggestionIndex="'+sa+'"]'),e[ra]&&Z&&Sys.UI.DomElement.containsCssClass(Z.firstChild,"IncSuggestionPlaceholder")&&Nue(a,v?t[sa].Type:0,b.L3,Z,d,b.krb,e[ra],sa,b.z2b,b.EQa.DocumentUpsellStatus)}catch(xa){R(41695001,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",
a.$b.nd,xa)}}}function Ete(a,b){if(!a.ka.jca)return!1;a=!0;switch(b){case "MoreIdeas":a=!1;break;case "NewDocument":a=!1}return a}function kte(a){return a.ka.tRd?a.ka.sRd:a.ka.rRd}
function Rue(a,b,c,d,e,f,g,h,k,l,m,n){this.V7=Function.createDelegate(this,this.lea);this.csf=Function.createDelegate(this,this.okg);this.b0e=Function.createDelegate(this,this.SFf);this.$9e=Function.createDelegate(this,this.oUf);this.q8e=Function.createDelegate(this,this.fSf);this.fa=a;this.Cb=b;this.wb=c;this.ra=d;this.Lb=e;this.ka=f;this.Cf=g;this.sj=h;this.jc=k;this.bI=l;this.ob=m;this.Kd=n;this.g7=Xse()}
Rue.prototype={fa:null,Cb:null,wb:null,ra:null,Lb:null,ka:null,Cf:null,jc:null,bI:null,ob:null,Kd:null,sj:null,g7:null,gK:null,mCa:0,Wb:function(){this.fa.ua(3100655080,1,this.q8e,4);this.fa.ua(1559931984,1,this.$9e,96);this.fa.ua(3293131920,1,this.b0e,4);this.fa.ua(1573366810,1,this.csf,64);GFb(this.bI,this.V7)},fSf:function(a,b,c){b=this.wb.Tb();if(2>b.length)return 8;if(1===c)return 32;c=this.ra.Ed;this.ka.DQa?this.jc.vka(c,this.ra.Ma(),this.Lb.Eb(),a):this.jc.mu(c,a);this.sj.F_b=!0;var d=[];Array.forEach(b,
function(a){Array.add(d,a.get_shapeId())});a={};a.SelectedShapeIds=d.join(",");this.sj.p5d=d;Sue(this,a,null);var e=this;Tue(this.sj,window.setTimeout(function(){var a=e.sj.nd;e.sj.VEd(!0);R(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",a);e.fa.jb(1573366810,2,"SuggestionsLoadingTimeout",null);e.Kd.uda(5341354,0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain,!1)},this.ka.eFc));return 32},ybc:function(a){if(this.mCa<this.ka.fEc){var b=
this;this.ob.Vb(new Si(2,1,1E3,function(){R(578937822,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",b.sj.nd);b.g7=Xse();b.mCa++;a()},0,"RetryRequestOnWait",!1,0))}else R(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.sj.nd)},SFf:function(a,b,c,d,e){b=this.ra.Ed;if(!this.ra.Ma()||!b)return 16;d=null;qda.isInstanceOfType(e)&&(d=e);if(!d)return 8;if(1===c)return 32;c=this.Cb.Ue(15,0);try{this.ka.GZb&&this.sj.gWb(new Date),
c.Jc(b),c.xe(a),TT(b,kXa,d),this.sj.fWb(BJ(d.SuggestionSid,d.SuggestionCid)),this.sj.wWb(!0),R(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{c&&c.dispose()}return 32},gyb:function(a){this.ka.Tqb&&(this.g7=Xse(),this.gK&&a())},zUa:function(a,b){this.gyb(b);R(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",a.HttpStatusCode);return!0},
oUf:function(a,b,c,d,e){Uue();if(!SR.isInstanceOfType(e))return 8;if(1<oZb(this.wb)){var f;(f=this.sj).o5a=f.o5a+1;return 32}return 8},okg:function(a,b,c,d,e){if("NoSuggestion"===e||"SuggestionsLoadingTimeout"===e)this.ka.DQa?this.jc.vDb(QQ(this.ra.Ma(),this.Lb.Eb())):this.jc.JN(this.ra.Ed);this.Abb(e);return 32},lea:function(a,b){if(this.sj.F_b){a=this.jc.$d(this.ra.Ed);var c=this.ka.DQa?"UnblockContentWhenDraw":"SessionRehydrated";a||window.$$as(String,b.nZ)!==c||(window.clearTimeout(this.sj.bNc),
this.sj.HDa||(this.sj.lEa=new Date),this.sj.gWb(null),this.sj.F_b=!1)}},Abb:function(a){var b=this.sj.nd;if(b){var c={};this.sj.AV&&(c.SuggestionSlideId=this.sj.AV.Pc().toString(),c.SuggestionSlideCreationId=this.sj.AV.Be().toString());c.AppliedSuggestion=this.sj.qP;c.DisplaySuggestionsTimeoutInMs=this.ka.eFc;c.SuggestionsTimeout=this.sj.HDa;c.ClientAbort=this.sj.k6a;c.ResetReason=a;c.DesignerSendTraceRequestOnSessionEnded=this.ka.HZb;var d=ze(ye(L).SessionStartInfoJson.toString()),e={};e.ClientOS=
d.Os;e.Browser=d.Browser||"";e.BrowserVersion=d.BrowserVersion||"";e.BrowserMajorVersion=d.BrowserMajorVersion||"";e.BrowserMinorVersion=d.BrowserMinorVersion||"";this.sj.mEa&&this.sj.L7a&&this.sj.L7a>this.sj.mEa&&(e.SuggestionsE2ETimeMs=this.sj.L7a-this.sj.mEa);this.sj.mEa&&this.sj.lEa&&this.sj.lEa>this.sj.mEa&&(e.SuggestionAppliedE2ETimeMs=this.sj.lEa-this.sj.mEa);c.BrowserData=e;this.sj.QM&&this.sj.lEa&&this.sj.lEa>this.sj.QM&&(c.TimeToDisplaySuggestionsInMs=this.sj.lEa-this.sj.QM);this.sj.ZMc&&
(c.TimeSuggestionsRendered=this.sj.ZMc.toUTCString());this.Cf.KBb(b,JSON.stringify(c),"SessionEnded"===a);this.sj.P2c();R(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",a,b)}else R(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",a)},L_:function(){},K_:function(){}};
function Uue(){try{var a=kc(B(),Zc);a&&a.pb(function(a){a.Jn("AutoFixInViewportActivity",null,null)})}catch(b){R(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",b)}}function Vue(a,b,c){var d=a.ra.Ma();if(d&&d.Pc()){var e;c=(e=new Dte,e.TW=d.Pc(),e.xka=d.Be(),e.wW=c||{},e);R(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",c.TW,c.Fta);a.sj.nd&&a.Abb("Retrigger");a.sj.mEa=new Date;a.sj.uPa(c.Fta);a.sj.uzc(new Date);b(c)}}
function Sue(a,b,c){Vue(a,function(b){function e(){Sue(a,a.gK.O7b,c)}if(a.ka.Tqb){if(a.g7.Ywc&&new Date-a.g7.$1a<a.ka.hEc){a.gK=new Gte;a.gK.TW=b.TW;a.gK.xka=b.xka;a.gK.O7b=b.wW;return}a.g7=Hte();a.gK=null}a.Cf.j9(b.xka,b.TW,b.Fta,null,"FixIt",c,JSON.stringify(b.wW),function(f){f&&2===f.Status?a.ybc(function(){Sue(a,b.wW,c)}):a.mCa=0;a.mCa||a.gyb(e)},function(b){return a.zUa(b,e)})},b)}function Wue(){this.AV=aK}
Wue.prototype={o5a:0,p5d:null,AV:null,fWb:function(a){return this.AV=a},nd:null,uPa:function(a){return this.nd=a},bNc:0,HDa:!1,VEd:function(a){return this.HDa=a},qP:!1,wWb:function(a){return this.qP=a},F_b:!1,k6a:!1,ZMc:null,mEa:null,L7a:null,k5a:null,gWb:function(a){return this.k5a=a},lEa:null,QM:null,uzc:function(a){return this.QM=a},P2c:function(){this.o5a=0;this.nd=this.p5d=null;this.AV=aK;this.bNc=0;this.k6a=this.F_b=this.qP=this.HDa=!1;this.QM=this.lEa=this.k5a=this.L7a=this.mEa=this.ZMc=null}};
function Tue(a,b){a.bNc=b}function Xue(a,b,c,d,e,f,g,h,k,l){this.pja=Function.createDelegate(this,this.CUa);this.tMd=Function.createDelegate(this,this.zbg);this.H4a=Function.createDelegate(this,this.v4);this.dispose=this.ha;this.fa=a;this.ra=b;this.Cb=c;this.xd=d;this.sj=e;this.ji=f;this.kCa=g;this.Hx=h;this.uc=k;this.Kd=l;this.nv()}
Xue.prototype={fa:null,ra:null,Cb:null,xd:null,sj:null,ji:null,kCa:null,Hx:null,uc:null,Kd:null,nv:function(){kSd(this.kCa,this.H4a);uO(this.ji,this.H4a);qV(this.uc,this.H4a);nK(this.uc,this.H4a);this.xd.qa.Ka("FISU",this.tMd);this.xd.qa.Ka("UR",this.pja)},ha:function(){this.xd.qa.eb("FISU",this.tMd);this.xd.qa.eb("UR",this.pja)},zbg:function(a,b){if(a=this.ra.Ma())if(b.gh.Sa(a.gc()))if(this.sj.nd!==b.nd)R(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",
this.sj.nd,b.nd);else{a=null;try{a=kn(b.u3)}catch(d){R(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}if(a.SlideSuggestion){this.sj.L7a||(this.sj.L7a=new Date);var c;b=(c=new qda,c.SuggestionCid=a.SlideSuggestion.SlideId.Cid,c.SuggestionSid=a.SlideSuggestion.SlideId.Sid,c.CorrelationId=b.nd,c.ActiveSlideCid=window.$$as($M,this.ra.Ma()).Be(),c.ActiveSlideSid=window.$$as($M,this.ra.Ma()).Pc(),c);this.fa.jb(3293131920,2,b,null)}else switch(this.fa.jb(1573366810,
2,"NoSuggestion",null),a.ResponseDescription){case "Invalid request":this.Kd.uda(5341306,0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest,!1);break;case "No suggestion":this.Kd.uda(5341316,0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItNoSuggestion,!1);break;default:this.Kd.uda(5341318,0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain,!1)}}else R(578937808,
829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",b.nd)},kN:function(a){this.sj.nd&&3293131920!==a&&this.fa.jb(1573366810,2,"WebActionId:"+this.Hx.Lea(a),null)},hyb:function(a,b,c){if(this.sj.nd&&c&&3293131920===b){this.sj.fWb(aK);c=this.ra.Ed;var d=this.Cb.qe(7,0,null,null,!0);try{d.Jc(c),d.xe(b),wf(c,kXa)}finally{d&&d.dispose()}this.fa.jb(1573366810,2,"WebActionId:"+this.Hx.Lea(a),null)}},CUa:function(a,b){this.hyb(b.Sh,b.b3b,
b.s0b)},v4:function(a,b){a=!1;var c="";if(kK.isInstanceOfType(b)){R(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.sj.nd,M.lHa.toString(window.$$as(kK,b).ZV));if(1===window.$$as(kK,b).ZV||3===window.$$as(kK,b).ZV)a=!0;c="SessionEnded"}else kwb.isInstanceOfType(b)?(R(578937800,829,50,"FixItManager::OnSessionRehydrated"),a=!0,c="Rehydrated"):DBb.isInstanceOfType(b)?(a=!0,c="SlideNavigation"):m2.isInstanceOfType(b)&&window.$$as(m2,b).$Qa&&this.kN(window.$$as(m2,b).Sh);
a&&this.sj.nd&&this.fa.jb(1573366810,2,c,null);0<this.sj.o5a&&(R(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.sj.o5a),this.sj.o5a=0)}};function Yue(){}Yue.prototype={Z5d:0,Wu:0,YXd:null,S6d:null};
function Zue(a,b,c,d,e,f,g,h,k,l,m){this.KPa=Function.createDelegate(this,this.yTa);this.B8e=Function.createDelegate(this,this.ySf);this.wI=Function.createDelegate(this,this.WI);this.lHd=Function.createDelegate(this,this.hVf);this.OGd=Function.createDelegate(this,this.CRf);this.fa=a;this.wb=b;this.jc=c;this.Wi=d;this.Hs=e;this.Cf=f;this.Mb=g;this.Qk=h;this.uqc=k;this.$aa=l;this.ka=m}function $ue(a){var b;return b=new Une,b.aZd=XEb(a),b.bZd=YEb(a),b.JXd=rU(a),b.IXd=sU(a),b}
Zue.prototype={fa:null,wb:null,jc:null,Wi:null,Hs:null,Cf:null,Mb:null,Qk:null,uqc:null,$aa:null,ka:null,Qd:function(){this.fa.ya(3560393150,1,this.OGd);this.fa.ya(319102301,1,this.lHd);uO(this.Wi,this.wI);var a=this;this.uqc.pb(function(b){var c=new ave;b.vBb(c.OE(),c.Nhb(),c.Jib(),null);b.nka("ImageToTable.Response",a.B8e);b.wub("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");b.bbc("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",a.KPa)})},ha:function(){this.fa.I4(3560393150,1,this.OGd);this.fa.I4(319102301,
1,this.lHd);tO(this.Wi,this.wI)},WI:function(){this.$aa.rB()},CRf:function(a,b,c){if(!this.ka.Q_d)return 16;if(1===c)return 32;a=this.wb.Tb();if(1!==a.length)return 8;var d=bve(this.$aa);if(!d)return R(593867352,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;var e=a[0];this.ka.AJc&&(cve(this.$aa,d,MO(e),e.get_shapeId(),$ue(e)),dve(this.$aa,d));var f=this;this.uqc.pb(function(a){a.ltg(NO(e),MO(e),e.get_shapeId(),function(a){eve(f,d,e,a)},function(){eve(f,d,e,
null);return!0})});return 32},yTa:function(a){if(a&&"errorDescription"in a&&"parentPath"in a&&"errorCode"in a){var b=new Tne,c=a.errorDescription.split(";");b.ZRd=c[0].split(":")[1];b.M3d=c[1].split(":")[1];b.WG=a.errorCode;R(593867350,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",b.M3d,b.WG,b.ZRd);c=a.parentPath[1].split("|");b.gh=Number.parseInvariant(c[0]);b.Wu=Number.parseInvariant(c[2]);b.tTd=a.html;a=this.$aa;(c=a.l2)&&c.gh===b.gh&&c.Wu===b.Wu&&
(a.l2.q_b=b);fve(this.$aa)}},ySf:function(a,b,c,d){R(576047055,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",d.processId,d.errorCode,d.errorDescription);a=this.$aa;if(b&&d&&(c=gve(a,b.PW))&&!c.zFc)if(c.gh=b.RCb,c.Wu=b.BCb,c.FFc=b.Jfe,window.clearTimeout(c.wNc),d.errorCode)hve(a,b.PW,"Failed to convert image to table");else{var e={};e.tableHtml=d.html;e.imageData=b.Image;a.Il(c.Zx,e)}},hVf:function(a,b,c,d,e){a=GO(this.Mb,e.Z5d);if(!a)return 8;c=(b=
a.RP(e.Wu))?$ue(b):e.YXd;if(!c)return 8;R(592303583,829,50,"Replacing image with html table. Shape id: {0}",b.get_shapeId());e=OZb(this.Qk,!1,a.Be(),a.Pc(),!1,c.aZd,c.bZd,c.JXd,c.IXd,gV(a)+1,e.S6d,"");m5(this.Hs,[e],a,0,null,b,!0);this.jc.mu(a,"ImageToTable");return 32}};
function eve(a,b,c,d){if(d&&d.ImgData)if(a.ka.AJc)ive(a.$aa,b,d.ImgData),fve(a.$aa);else{var e=$ue(c),f,g=(f=new Vne,f.PW=b,f.RCb=MO(c),f.BCb=c.get_shapeId(),f.Jfe=e,f.Image=d.ImgData,f);a.uqc.pb(function(a){a.HVa("ImageToTableTile",g)});dve(a.$aa,b)}else hve(a.$aa,b,"Failed to render the image shape")}function ave(){this.MPa=Function.createDelegate(this,this.QTa)}
ave.prototype={jY:null,TY:null,OE:function(){return"ImageToTableALWorkflow"},Nhb:function(){if(!this.jY){var a;this.jY=(a=new g3,a.aA="LambdaBefore_ImageToTableAL",a.Hja="ImageToTableTile",a.Sja="ImageToTable.Request",a.Eja=this.MPa,a)}return this.jY},Jib:function(){if(!this.TY){var a;this.TY=(a=new g3,a.aA="LambdaRemote_ImageToTableAL",a.Hja="ImageToTable.Request",a.Sja="ImageToTable.Response",a.Eja=null,a)}return this.TY},QTa:function(a,b,c){var d;a=(d=new Vse,d.image=a.Image,d);c(a)}};
function jve(a){this.Zx=a}jve.prototype={Zx:null,gh:0,Wu:0,FFc:null,wNc:0,zFc:!1,Isb:null,PVd:!1,kZd:null,hZd:null,GFc:null,q_b:null};function kve(a,b,c,d){this.$Gd=Function.createDelegate(this,this.YSf);this.rJd=Function.createDelegate(this,this.v5f);this.fa=a;this.vd=b;this.za=c;this.rvc=d;this.l2=null}
kve.prototype={fa:null,vd:null,za:null,rvc:null,l2:null,Qd:function(){var a=this;this.vd.pb(function(b){b.Dmd(a.rJd)});this.rvc.Cmd(this.$Gd)},ha:function(){var a=this;this.vd.pb(function(b){b.CFg(a.rJd)});this.rvc.qa.eb("ImageToDocPaneMessageReceived",this.$Gd)},rB:function(){lve(this,this.l2)},PZc:function(a){R(593867348,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",a.Zx);var b=this.vd.Da().l_("FA000000050");if(b&&b.LE()&&"SessionID"in b.LE()){var c,d,e;if(e=vk(b.LE().SessionID,
d={val:c}),c=d.val,e)a.Zx===c?(a.Isb=b.gl,R(593867346,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",b.gl)):R(593867344,375,50,"[ImageToTablePane] Failed to find the taskpane")}},YSf:function(a,b){b=b.Mo;if((a=gve(this,b.session_id))&&!a.PVd)if("ACK"===b.cmd_type)R(593867342,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",b.cmd_type),a.hZd();else if("cancel"===b.cmd_type)R(593867340,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",
b.cmd_type),lve(this,a);else if("insert_html"===b.cmd_type){R(593867338,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",b.cmd_type);var c;b=(c=new Yue,c.Z5d=a.gh,c.Wu=a.Wu,c.YXd=a.FFc,c.S6d=b.parameters,c);lve(this,a);this.fa.jb(319102301,2,b,null)}else R(593867336,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",b.cmd_type)},Il:function(a,b){var c=gve(this,a);if(c&&c.Zx===a){var d=this;c.kZd.then(function(){d.rvc.Il(c.Isb,
b)})}},v5f:function(a,b){b&&this.l2&&b.Hpc===this.l2.Isb&&(this.l2=null)}};function gve(a,b){return b&&a.l2&&a.l2.Zx===b?a.l2:null}function hve(a,b,c){a.Il(b,{errorMessage:c})}function fve(a){var b=a.l2;if(b&&!b.zFc&&b.q_b&&b.GFc)if(window.clearTimeout(b.wNc),b.q_b.WG)hve(a,b.Zx,"Failed to convert image to table");else{var c={};c.tableHtml=b.q_b.tTd;c.imageData=b.GFc;a.Il(b.Zx,c)}}
function dve(a,b){var c=gve(a,b);c&&(c.wNc=window.setTimeout(function(){c.zFc=!0;hve(a,c.Zx,"Failed to convert image to table using AL")},a.za.UZd))}function ive(a,b,c){if(a=gve(a,b))a.GFc=c}function cve(a,b,c,d,e){if(a=gve(a,b))a.gh=c,a.Wu=d,a.FFc=e}function lve(a,b){b&&b.Isb&&(b.PVd=!0,a.fa.jb(2755471162,2,b.Isb,null))}
function bve(a){a.rB();var b=new jve(Ae().toString());b.kZd=new Promise(function(a){b.hZd=function(){a(b.Zx)}});var c={};c.W9=ResourceStrings.L_DataFromPicturePaneTitle;c.AP="FA000000050";c.Hab=function(){a.PZc(b)};c.AW={SessionID:b.Zx};c.PDb=!0;c.Ybb=a.za.WZd;return 32===a.fa.jb(2123786558,2,c,null)?(a.l2=b,a.l2.Zx):a.l2=null}function mve(a){this.Rob=Function.createDelegate(this,this.WWc);this.qa=new re;this.za=a}
mve.prototype={qa:null,za:null,Cmd:function(a){this.qa.Ka("ImageToDocPaneMessageReceived",a)},Qd:function(){try{window.addEventListener?window.addEventListener("message",this.Rob,!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",this.Rob):R(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(a){R(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
a.message,a.stack)}},Il:function(a,b){for(var c={imageToTablePaneWildcard:"."},d=Object.keys(b),e=d.length,f=0;f<e;++f){var g=d[f];c[g]=b[g]}window.OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(a,"onCustomMessage",c,function(a){a&&R(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",a)})},WWc:function(a){if(a&&this.Myb(a.origin)){var b,c,d;(d=vk(a.data,c={val:b}),b=c.val,d)&&b&&(a=window.$$as(Object,b),"."===a.imageToTablePaneWildcard&&this.qa.Ha("ImageToDocPaneMessageReceived",
new Wne(a),null))}},Myb:function(a){return a&&a.length&&"null"!==a?a===this.za.VZd:!1}};function nve(){this.yy=!!G()&&!!G().rb()&&G().rb().JE()}
nve.prototype={J:null,IO:!1,Xb:function(){return"PowerPointWebEditor.Designer"},wc:function(a){this.J=a;var b=this;C(D(this.J.ma(k_d,null)),function(){return new hte(b.J.H(Xv,null),b.J.H(sK,null),b.J.H(j_d,null),b.J.H(Nne,null),b.J.H(K9,null),b.J.H($v,null),b.J.H(cL,null),b.J.H(xd,null),b.J.H(zd,null),b.J.H(fK,null),b.J.H(dd,null),b.J.H(dS,null),b.J.H(T,null),b.J.H(Ci,null))});var c=this;C(D(this.J.ma(j_d,null)),function(){return new aue(c.J.H(iu,null),c.J.H(sK,null),c.J.H(xd,null),c.J.H(fK,null),
c.J.H(dd,null),c.J.H(K9,null),c.J.H(ZR,null),c.J.H(EK,null),c.J.H(KK,null),c.J.H(LK,null),c.J.H(cL,null),c.J.H(T,null),c.J.H(gO,null),c.J.H(sL,null))});var d=this;C(D(this.J.ma(Nne,null)),function(){return new Gue(d.J.H(GN,null),d.J.H(WM,null),d.J.H(T,null),d.J.H(K9,null),d.J.H(Dd,null),d.J.H(sK,null),kc(d.J,o9))});var e=this;C(D(this.J.ma(J$c,null)),function(){return new Ote(e.J.H(k_d,null),e.J.H(Nne,null),e.J.H(K9,null),e.J.H(T,null),e.J.H(dd,null),e.J.H(GN,null),e.J.H(BN,null),e.J.H(fS,null),e.J.H(cL,
null),kc(e.J,T2),kc(e.J,X$c),kc(e.J,Zc))});var f=this;C(D(this.J.ma(Pne,null)),function(){return new cue(f.J.H(aM,null),f.J.H(wQ,null))});var g=this;C(D(this.J.ma(K9,null)),function(){return new Mte(kc(g.J,T2))});var h=this;C(D(this.J.ma(DRd,null)),function(){return new ove(h.J.H(dd,null),h.J.H(T,null))});var k=this;C(D(this.J.ma(K$c,null)),function(){return new Xue(k.J.H(dd,null),k.J.H(GN,null),k.J.H(BN,null),k.J.H(fS,null),k.J.H(One,null),k.J.H(EN,null),k.J.H(l2,null),k.J.H(jK,null),k.J.H(EK,null),
k.J.H(eK,null))});C(D(this.J.ma(One,null)),function(){return new Wue});if(this.IO=this.J.H(vS,null).za.az){var l=this;C(D(this.J.ma(mK,null)),function(){return new mK(F.gf,l.J.H(iK,null),l.J.H(EK,null),l.J.H(KK,null),l.J.H(eK,null),l.J.H(Dd,null),l.J.H(md,null))})}var m=this;C(D(this.J.ma(Zue,null)),function(){return new Zue(m.J.H(dd,null),m.J.H(UM,null),m.J.H(mQ,null),m.J.H(EN,null),m.J.H(uS,null),m.J.H(i2,null),m.J.H(WM,null),m.J.H(XM,null),kc(m.J,e3),m.J.H(Qne,null),m.J.H(T,null))});var n=this;
C(D(this.J.ma(Rne,null)),function(){return new mve(n.J.H(T,null))});var r=this;C(D(this.J.ma(Qne,null)),function(){return new kve(r.J.H(dd,null),kc(r.J,zS),r.J.H(T,null),r.J.H(Rne,null))});var t=this;C(D(this.J.ma(pve,null)),function(){return new pve(t.J.H(dd,null),t.J.H(UM,null),t.J.H(GN,null),t.J.H(fS,null))})},ub:function(){var a=this.J.H(md,null),b=this;a.Nf(function(){if(a.ia(S(248))){b.IO&&b.J.H(mK,null);var c=b.J.H(k_d,null),d=B().H(j_d,null).Zc();c.tka(d);c.n8b();b.yy||b.J.H(JR,null).xC(b.J.H(j_d,
null));c=null;if(a.ia(S(1034))&&(c=b.J.H(v6,null))){var d=a.Va(S(1043)),e=a.Va(S(1035)),f=new Date;c.WW(d,e,null).then(function(a){var b=new Date-f;a.IsSuccess?R(51475615,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+b):(R(42324822,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+a.ErrorCode+": "+a.ErrorMessage),R(51475618,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+b))}).catch(function(a){R(51475648,
829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+(new Date-f));R(42324824,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",a)})}c=new Wse(b.J.H(dd,null),b.J.H(Ru,null),b.J.H(mQ,null),b.J.H(CN,null),b.J.H(UM,null),b.J.H(cL,null),b.J.H(j_d,null),b.J.H(k_d,null),b.J.H(Nne,null),b.J.H(J$c,null),b.J.H(K9,null),b.J.H(GN,null),b.J.H(EN,null),b.J.H(fS,null),b.J.H(b3,null),b.J.H(T,null),b.J.H(i2,null),b.J.H(W2,null),b.J.H(hQ,null),b.J.H($R,null),b.J.H(EK,
null),b.J.H(Dd,null),b.J.H(l2,null),b.J.H(DRd,null),b.J.H(Ci,null),kc(b.J,oWb),b.J.H(WM,null),c,kc(b.J,Q2),kc(b.J,o9));c.Wb();c.Of();(new Rue(b.J.H(dd,null),b.J.H(BN,null),b.J.H(UM,null),b.J.H(GN,null),b.J.H($R,null),b.J.H(T,null),b.J.H(i2,null),b.J.H(One,null),b.J.H(mQ,null),b.J.H(hQ,null),b.J.H(Dd,null),b.J.H(eK,null))).Wb();b.J.H(T,null).eEc&&b.J.H(Pne,null).Ro();b.J.H(Rne,null).Qd();b.J.H(Qne,null).Qd();b.J.H(Zue,null).Qd();b.J.H(pve,null).Qd();b.J.H(K$c,null)}else R(37041294,829,50,"Designer setting is disabled")})},
ha:function(){this.J.H(T,null).eEc&&this.J.H(Pne,null).ha();this.J.H(Qne,null).ha();this.J.H(Zue,null).ha();this.J.H(pve,null).ha();this.J.H(K$c,null).dispose()}};function pue(a,b,c){this.oXe=a;this.nh=b;this.RWe=c}pue.prototype={oXe:null,nh:null,RWe:null};pue.prototype.toString=function(){return"SuggestionIndex:"+this.oXe+" SlideId:"+this.nh+" CreationId:"+this.RWe};pue.prototype.toString=pue.prototype.toString;
function eue(a,b,c,d,e,f){this.CJd=Function.createDelegate(this,this.h6f);this.nGd=Function.createDelegate(this,this.CLf);this.lja=Function.createDelegate(this,this.ITa);this.vV=Function.createDelegate(this,this.Ri);this.K1e=Function.createDelegate(this,this.NIf);this.ka=b;this.fa=a;this.RSe=f;this.Yc=d;this.Dp=e;this.ysd=ag(27,0);this.fa.ya(1561081765,2147483648,this.K1e);this.sO=iM();this.sO.className="GoPremiumCalloutContainer";this.xMa=bue(c);Sys.UI.DomElement.addCssClass(this.xMa,"GoPremiumCalloutClose");
this.xMa.setAttribute("role","button");this.sO.appendChild(this.xMa);a=document.createElement("i");a.className="ms-Icon ms-Icon--Diamond";a.setAttribute("role","presentation");a.setAttribute("Unselectable","on");a.setAttribute("aria-hidden","true");this.sO.appendChild(a);this.W2=iM();this.W2.className="GoPremiumTitle";this.sO.appendChild(this.W2);this.Fu=iM();this.Fu.className="GoPremiumSubtitle";this.sO.appendChild(this.Fu);this.Uaa=iM();this.Uaa.className="GoPremiumButton";a=jM();a.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;
a.setAttribute("Unselectable","on");a.setAttribute("aria-hidden","true");this.Uaa.appendChild(a);this.Uaa.tabIndex=0;this.Uaa.setAttribute("aria-label",a.innerText);this.Uaa.setAttribute("role","button");this.sO.appendChild(this.Uaa);this.nv()}
eue.prototype={so:null,Uaa:null,sO:null,W2:null,Fu:null,amb:null,dPb:null,xMa:null,uyc:null,rOb:!1,ywd:!1,Yc:null,Dp:null,RSe:null,xCd:null,ka:null,fa:null,ysd:null,xf:function(a,b,c,d,e,f){this.Xga()&&this.Ri();this.amb=d;this.dPb=b;this.uyc=e;this.xCd=f;this.amb&&Sys.UI.DomElement.addCssClass(this.amb,this.uyc);c?(this.W2.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.Fu.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.W2.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,
this.Fu.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);b.setAttribute("aria-expanded","true");this.ka.CEc?this.so=new NW(a,document.body,G().aN,null):(this.so=edc(a,document.body,document.body,2,this.vV),this.so.V2b=120);this.so.P3=310;this.sO.setAttribute("aria-label",String.format("{0}. {1}",this.W2.innerText,this.Fu.innerText));this.sO.setAttribute("role","region");this.Dp&&this.Dp.Ka(this.sO,"keydown",this.lja);ddc(this.so,this.sO);this.m8a();b=new Sys.UI.Bounds(0,0,xW(),he());cdc(this.so,
qve(b,a,c));this.so.kra(!1);var g=this;adc(this.so,function(){g.sO.parentNode&&Sys.UI.DomElement.addCssClass(g.sO.parentNode,"GoPremiumCalloutContentContainer");OW(g.so)&&(Sys.UI.DomElement.addCssClass(OW(g.so),"GoPremiumCalloutOuter"),OW(g.so).removeAttribute("role"),g.ka.CEc||(OW(g.so).style.zIndex=G().CJ()));$cc(g.so);g.$I(g.Uaa);g.rOb=!0});this.so.xf()},m8a:function(){if(Tj()){var a=$f(),b=a.$c("callout/modal");b.ic="main";txa(a,"callout/modal","main",this.sO);xi(a,"callout/modal",!1);b.kb(this.ysd,
1561081765);var c=this,b=new Yl(function(){return c.sO});b.kva=!0;Zl(b,2);var d=this,a=Ol(a,function(){return d.sO},a.$c("callout/modal"),b);Wl(a);a.QK=!0;a.Dta=!0}},ZUa:function(){if(Tj()&&!F.mg){var a=$f(),b=a.$c("callout/modal");b&&Pl(b,this.ysd);qi(a,"callout/modal",!0);(b=NB(a,"callout/modal"))&&b.qg.xz(null);Ql(a,"callout/modal")}},$I:function(a){Tj()?NB($f(),"callout/modal").qg.ZSa(a):a.focus()},Xga:function(){return!!this.so&&this.so.Xga()},CLf:function(){this.Ri();return!0},NIf:function(){this.Ri();
return 32},Ri:function(){if(!this.ywd){this.ywd=!0;try{this.ZUa(),this.dPb&&(this.dPb.setAttribute("aria-expanded","false"),vl(this.dPb),this.dPb=null),this.amb&&(Sys.UI.DomElement.removeCssClass(this.amb,this.uyc),this.amb=null),this.xCd=this.uyc=null,this.rOb=!1,this.so&&(this.so.Ri(),this.so.ha(),this.so=null),this.Dp&&this.Dp.eb(this.sO,"keydown",this.lja)}finally{this.ywd=!1}}},ha:function(){this.Ri();this.YW();this.sO=this.xMa=this.Uaa=null},ITa:function(a){if(13===a.keyCode||32===a.keyCode){a.preventDefault();
a=document.activeElement;try{a?a.click():R(590967751,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(b){R(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",b)}}},h6f:function(){this.RSe(this.xCd);return!0},nv:function(){this.Yc?(this.Yc.Wa("click",this.xMa,this.nGd),this.Yc.Wa("click",this.Uaa,this.CJd)):R(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")},
YW:function(){this.Yc&&(this.Yc.Sb("click",this.xMa,this.nGd),this.Yc.Sb("click",this.Uaa,this.CJd))}};function qve(a,b,c){if(c)return 0;c=6;240>b.y-a.y&&(c=3);return c}function pve(a,b,c,d){this.sMd=Function.createDelegate(this,this.ybg);this.fa=a;this.wb=b;this.ra=c;this.xd=d}
pve.prototype={fa:null,wb:null,ra:null,xd:null,Qd:function(){this.xd.qa.Ka("SAC",this.sMd)},ha:function(){this.xd.qa.eb("SAC",this.sMd)},ybg:function(a,b){if((a=b.jQd)&&this.ra.Ma()){var c=[];b=[];for(var d=this.ra.Ma().jn(!1),e=d.length,f=0;f<e;++f)for(var g=d[f],h=a.Selects,k=h.length,l=0;l<k;++l)if(h[l].Id===g.get_shapeId()){Array.add(c,g);Array.add(b,g.get_shapeId());break}uR(this.wb);xR(this.wb);wR(this.wb,c,!0);if(4===a.Type){if(c=this.ra.Ed){var m;a=(m=new Nda,m.Scenario=a.Scenario,m.SlideSid=
this.ra.Ma().Pc(),m.SlideCid=this.ra.Ma().Be(),m.ShapeIds=b,m);TT(c,a_a,a)}}else this.fa.Ab(VBa(a.ExecutionActionName),2,null)}}};Type.registerNamespace("PowerPointWebEditor.Infrared");M.jz=M.jz||{};
function ove(a,b){this.oAc=Function.createDelegate(this,this.tSf);this.pAc=Function.createDelegate(this,this.xSf);this.UGd=Function.createDelegate(this,this.uSf);this.z8e=Function.createDelegate(this,this.vSf);this.A8e=Function.createDelegate(this,this.wSf);this.fa=a;this.ka=b;this.fa.ya(1068159161,1,this.A8e);this.fa.ya(206151992,1,this.z8e);this.fa.ya(1724554274,1,this.UGd);this.fa.ya(2857549322,1,this.pAc);this.fa.ya(4031196440,1,this.pAc);this.fa.ya(2760733910,1,this.oAc);this.fa.ya(369327638,
1,this.UGd);this.fa.ya(1658089342,1,this.pAc);this.fa.ya(2924806476,1,this.oAc);this.fa.ya(2740350877,1,this.oAc)}
ove.prototype={fa:null,ka:null,MDg:null,xEg:null,jpa:null,hTb:!1,wSf:function(){if(!this.ka.ZDa)return 2;this.hTb=!0;if(!(this.jpa&&0<this.jpa.Ba())){var a=Ae();this.ka.ZDa&&(this.MDg=a,this.xEg="ToolbarButtonHome",this.jpa=new (Zb.$$(ka))(null))}return 32},vSf:function(){if(!this.ka.ZDa)return 2;this.hTb=!1;return 32},uSf:function(a){if(!this.ka.ZDa)return 2;a=rve(a);this.hTb&&3!==a&&this.jpa&&this.jpa.ga(new ka(a,1));return 32},xSf:function(a){if(!this.ka.ZDa)return 2;this.Cdc(rve(a));return 32},
tSf:function(a){if(!this.ka.ZDa)return 2;a=rve(a);this.hTb&&3!==a&&this.jpa&&this.jpa.ga(new ka(a,2));return 32},Cdc:function(a){this.ka.ZDa&&this.hTb&&3!==a&&this.jpa&&!dfe(this.jpa,function(b){return b.Dg()===a})&&this.jpa.ga(new ka(a,0))}};function rve(a){switch(a){case 1724554274:case 2857549322:case 2924806476:a=0;break;case 4031196440:case 2760733910:a=1;break;case 369327638:case 1658089342:case 2740350877:a=2;break;default:a=3}return a}Vse.registerClass("PowerPointWebEditor.Designer.ImageToTableRequest");
Wse.registerClass("PowerPointWebEditor.Designer.DesignerActor",null,ed);Lte.registerClass("PowerPointWebEditor.Designer.RequestState");Gte.registerClass("PowerPointWebEditor.Designer.PendingRequest");Dte.registerClass("PowerPointWebEditor.Designer.DesignerRequestData");Mte.registerClass("PowerPointWebEditor.Designer.DesignerContext",null,K9);Ote.registerClass("PowerPointWebEditor.Designer.DesignerManager",null,J$c,Sys.IDisposable);
aue.registerClass("PowerPointWebEditor.Designer.DesignerPane",null,j_d,rL,Sys.IDisposable);cue.registerClass("PowerPointWebEditor.Designer.DesignerPreviewImageView",null,Pne);due.registerClass("PowerPointWebEditor.Designer.DesignerStateManager");hte.registerClass("PowerPointWebEditor.Designer.DesignerView",bF,k_d,Dv,Fv,Sys.IDisposable);Vte.registerClass("PowerPointWebEditor.Designer.RenderSuggestionsArgs",null,Mne);Gue.registerClass("PowerPointWebEditor.Designer.DesignerViewHelper",null,Nne);
Rue.registerClass("PowerPointWebEditor.Designer.FixItActor",null,ed);Wue.registerClass("PowerPointWebEditor.Designer.FixItContext",null,One);Xue.registerClass("PowerPointWebEditor.Designer.FixItManager",null,K$c,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.Designer.IdeasPaneConstants");Yue.registerClass("PowerPointWebEditor.Designer.ReplaceImageWithHtmlTableData");Zue.registerClass("PowerPointWebEditor.Designer.ImageToTableActor");
ave.registerClass("PowerPointWebEditor.Designer.ImageToTableALWorkflow",null,f3);jve.registerClass("PowerPointWebEditor.Designer.ImageToTableConversionContext");kve.registerClass("PowerPointWebEditor.Designer.ImageToTablePane",null,Qne);mve.registerClass("PowerPointWebEditor.Designer.ImageToTablePaneMessenger",null,Rne);nve.registerClass("PowerPointWebEditor.Designer.PPTWebEditorDesignerPackage",null,yo,ec);pue.registerClass("PowerPointWebEditor.Designer.LoggableSourceContext");eue.registerClass("PowerPointWebEditor.Designer.PremiumContentCallout");
pve.registerClass("PowerPointWebEditor.Designer.SuggestedActionsHandler");ove.registerClass("PowerPointWebEditor.Infrared.IdeasContext",null,DRd);hte.yMf=["EditorPrev","EditorNext","EditorSuggestionContainer","EditorIgnore","EditorSeeMoreLabel"];var Mue="Architecture Backgrounds Cities Nature People Technology".split(" ");zo(gj(),e7(new nve,0),0,!1);Type.registerNamespace("PowerPointWebEditor.Rehearsal");M=window.PowerPointWebEditor||{};M.qp=M.qp||{};function sve(){}sve.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor");
function tve(){}tve.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalManager");window.PowerPointWebEditor.Rehearsal.ICoachManager=M.qp.$Ig=function(){};window.PowerPointWebEditor.Rehearsal.ICoachManager.registerInterface("PowerPointWebEditor.Rehearsal.ICoachManager");window.PowerPointWebEditor.Rehearsal.ICoachActorManager=M.qp.ZIg=function(){};window.PowerPointWebEditor.Rehearsal.ICoachActorManager.registerInterface("PowerPointWebEditor.Rehearsal.ICoachActorManager");
window.PowerPointWebEditor.Rehearsal.ICoachFREActorManager=M.qp.Mjf=function(){};window.PowerPointWebEditor.Rehearsal.ICoachFREActorManager.registerInterface("PowerPointWebEditor.Rehearsal.ICoachFREActorManager");function uve(){}uve.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalTrigger");function vve(){}vve.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");function wve(){this.Hm=Function.createDelegate(this,this.vm)}
wve.prototype={Yv:null,Xb:function(){return"PowerPointWebEditor.Rehearsal"},wc:function(a){this.J=a;var b=this;kc(this.J,l7).pb(function(){HEc(b)});if(this.J.H(T,null).E3){var c=this;C(D(this.J.ma(vve,null)),function(){return new yve(F.gf,c.J.H(T,null),c.J.H(ZH,null),c.J.H(dd,null))});this.Yv=this.J.H(vve,null);var d=this.J.H(GK,null),e=this;C(D(this.J.ma(tve,null)),function(){return new zve(Zf(),d,e.J.H(Cc,null),e.J.H(M3,null),e.J.H(WM,null),e.J.H(GN,null),e.J.H(iK,null),e.J.H(T,null),kc(B(),P3),
kc(B(),L3),kc(B(),sve),e.Yv,e.J.H(BK,null),e.J.H(b2,null))});this.J.H(tve,null).Wb();var f=this;C(D(this.J.ma(uve,null)),function(){return new Ave(Zf(),f.J.H(T,null),kc(B(),tve),kc(B(),sve),mc(Zc,kc(B(),Zc)))});this.J.H(uve,null)}},ub:function(){L.Nf(this.Hm)},vm:function(){if(this.J.H(T,null).v6a){var a=this;Je(window.Common.App.AppLifecycleManager.get_instance(),7,function(){kc(a.J,sve).pb(function(){a.Qd()})},3)}},Qd:function(){this.J.H(sve,null).hzb();this.J.H(T,null).E3&&this.J.H(tve,null).hzb();
if(this.J.H(T,null).wRa){this.J.H(F,null);var a=new Bve(this.J.H(Cc,null).Rp,this.J.H(dd,null),this.J.H(ZR,null),this.Yv,this.J.H(T,null));a.Wb();a.Of();Cve(this.Yv)}},ha:function(){},J:null};function HEc(a){C(D(a.J.ma(sve,null)),function(){return new xve(Zf(),a.J.H(l7,null),wZ(a.J),a.J.H(T,null),kc(a.J,Zc))});a.J.H(sve,null).Wb()}
function xve(a,b,c,d,e){this.Auf=Function.createDelegate(this,this.mog);this.fvf=Function.createDelegate(this,this.Yog);this.qa=new re;this.fa=a;this.Ekb=new Dve(b,this.fa,d);this.YFa=c;this.inb=e}
xve.prototype={Wb:function(){this.fa.ya(3890296866,1,this.fvf);this.fa.ya(1607456269,1,this.Auf)},Mcc:function(a,b,c,d,e){this.Ekb.Mcc(a,b,c,d,e)},Yog:function(a,b,c,d,e){switch(c){case 2:return this.Ekb.Mcc(e,!1,null,null,null),32;case 1:if(this.$Ma)return 32;break;default:R(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8},mog:function(a,b,c){switch(c){case 2:return this.inb.pb(function(a){rqc(a,"PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),
32;case 1:if(this.$Ma)return 32;break;default:R(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8},hzb:function(){var a=Date.now(),b=this;this.YFa("rehearsalSummaryPage").then(function(){var c=L.Va("RehearsalSummaryPageCssUrl"),d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",c);window.$addHandler(d,"load",function(){b.$Ma=!0;b.qa.Ha("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs,null);R(555798673,
817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-a)});document.body.appendChild(d);return null})},YFa:null,$Ma:!1,fa:null,Ekb:null,inb:null};function Dve(a,b,c){this.FKd=Function.createDelegate(this,this.L8f);this.Xm=a;this.fa=b;this.ka=c}
Dve.prototype={Xm:null,fa:null,ka:null,Mcc:function(a,b,c,d,e){try{var f=document.createElement("div");f.id="SummaryPageOverlay";f.style.width="100%";f.style.height="100%";f.style.zIndex=999;f.style.display="flex";f.style.flexDirection="column";f.style.justifyContent="center";f.style.position="absolute";var g=document.getElementById("SummaryPageOverlay");g&&document.body.removeChild(g);document.body.insertBefore(f,document.body.firstChild);var h=f.parentNode;hh(h,"keydown",this.FKd);var k=a.thumbIndices;
if(k){for(var g={},l=0,m=Eve(this,k),n=0;n<k.length;n++)g[k[n].toString()]=m[n],m[n]||l++;R(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",k.length,l);a.slideImageSrcs=g}else a.slideImageSrcs={},R(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");var r=F.JB;r||R(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");
c||(c=Fve(this.ka,this.ka.Gca));var k={},t=ze(ye(L).SessionStartInfoJson.toString()).WACSessionID;k.fFeedbackCardEnabled=this.ka.A0d&&r;k.fShowFeedbackButton=r;k.fMonotoneEnabled=this.ka.u1b&&d$(c,e$.dXc);k.fGrammarEnabled=this.ka.i1b&&d$(c,e$.OTc);k.fFillersCardEnabled=d$(c,e$.dSc);k.locale=this.ka.Gca;k.fPronunciationCardEnabled=this.ka.IJc&&d$(c,e$.M1c);k.fCrutchWordCardEnabled=this.ka.HJc&&d$(c,e$.BQc);k.fVisionEnabled=b&&this.ka.M_d&&this.ka.xRa;var v=Gve(this.ka,this.ka.Gca);!v||(k.fPacingGaugeRange=
v);!t||(k.clientSessionId=t);this.ka.wRa&&(k.rehearsalOptOutFeatures=d);var x=this,y=this,z=this,E=this;(new window.rehearsalSummaryPage.RehearsalSummaryPageController(f,a,function(){R(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");e&&e();x.fa&&(f.parentNode.removeChild(f),x.fa.jb(1256345977,2,{entryPoint:3},null))},function(){e&&e();oi(h,"keydown",y.FKd)},this.ka.zr,window.decodeURIComponent(this.ka.XDa),function(){R(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");
z.fa&&(z.ka.k2d?z.fa.jb(1607456269,2,null,null):z.fa.jb(802602464,2,!1,null))},k,Hve(this.ka.uRa),"Web",function(){R(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");E.fa&&E.ka.wRa&&E.fa.jb(413593002,2,null,null)})).renderSummaryPage()}catch(H){R(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",H.toString())}},L8f:function(a){"MainApp"===a.target.id&&(a.preventDefault(),a.stopPropagation())}};
function Eve(a,b){var c=Array(b.length);if(!a.Xm)return c;var d=a.Xm.sW();a=a.Xm.c9();for(var e=0;e<b.length;e++){var f=a[d[b[e]].Pc().toString()];f&&f.V7a.length&&(c[e]=f.V7a)}return c}function e$(){}window.PowerPointWebEditor.Rehearsal.ISlideState=M.qp.JXf=function(){};M.qp.JXf.prototype={currentSlideIndex:0,totalSlideCount:0};window.PowerPointWebEditor.Rehearsal.IWebcamConfig=M.qp.MXf=function(){};
M.qp.MXf.prototype={videoView:null,workingCanvas:null,numFramesPerSecond:0,webcamFrameWidth:0,requestedVideoWidth:0,requestedVideoHeight:0};window.PowerPointWebEditor.Rehearsal.ICoachActorConfig=M.qp.gXf=function(){};M.qp.gXf.prototype={rootContainer:null,slideState:null,imagesBaseFilePath:null,zIndex:0,fEnableVision:!1,fShowRealtimeFeedbackEnabledCheckbox:!1,fUseCountdownWelcomeScreen:!1,speechFDBase:null,fDontShowTooltips:!1,fUseNewRealtimePanel:!1,fUseNewRealtimeCheckbox:!1};
window.PowerPointWebEditor.Rehearsal.ICoachFREActorConfig=M.qp.aoe=function(){};M.qp.aoe.prototype={imagesBaseFilePath:null,rootContainer:null,zIndex:0};window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig=M.qp.AUc=function(){};M.qp.AUc.prototype={userDataCenterClusterId:null,webServiceBase:null,podsSessionId:null,docId:null};window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig=M.qp.iXf=function(){};
M.qp.iXf.prototype={logger:null,disabledCoachRealtimeFeatures:null,userSessionId:null,documentDownloadConfig:null,requestedCoachFeatures:null,requestedRehearsalOptOutFeatures:null,customSettings:null,fEnableVision:!1,webcamConfig:null,speechFDBase:null,userId:null,tenantId:null,identityProvider:null,audienceChannel:null,audienceGroup:null,buildVersion:null,locale:null,wacHost:null,wacDatacenter:null,entryPoint:null,sourceLanguage:null,supportedRehearsalTemplates:null,fEnableServiceSideAggregationForCoach:!1,
httpTimeoutForCoachSummaryData:0,fSendClientMetaDataOnSessionStart:!1,enableTimeStampedCritiqueTelemetry:!1,audioInputDeviceCount:0};window.PowerPointWebEditor.Rehearsal.IDistanceInfo=M.qp.lXf=function(){};M.qp.lXf.prototype={critiqueTime:0,distanceCritiqueName:null};window.PowerPointWebEditor.Rehearsal.IFillerData=M.qp.pXf=function(){};M.qp.pXf.prototype={filler:null,count:0};window.PowerPointWebEditor.Rehearsal.IGrammarInfo=M.qp.qXf=function(){};
M.qp.qXf.prototype={slideIndex:0,helpText:null,category:null,originalText:null,triggerStart:0,triggerLength:0,suggestionText:null};window.PowerPointWebEditor.Rehearsal.ISensitivePhrasesData=M.qp.HXf=function(){};M.qp.HXf.prototype={phrase:null,count:0};window.PowerPointWebEditor.Rehearsal.IPaceData=M.qp.zXf=function(){};M.qp.zXf.prototype={pace:0,timePoint:0};window.PowerPointWebEditor.Rehearsal.IMonotoneData=M.qp.yXf=function(){};M.qp.yXf.prototype={pvq:0,timePoint:0,slide:0};
window.PowerPointWebEditor.Rehearsal.IPronunciationInfo=M.qp.EXf=function(){};M.qp.EXf.prototype={word:null,count:0,slideNumber:null,lowestPhonemeIndex:0,phonemeSequence:null};window.PowerPointWebEditor.Rehearsal.ICrutchWordsData=M.qp.kXf=function(){};M.qp.kXf.prototype={word:null,count:0,synonyms:null};window.PowerPointWebEditor.Rehearsal.ICoachSummaryData=M.qp.jXf=function(){};
M.qp.jXf.prototype={fillers:null,sensitivePhrases:null,sensitivePhrasesCorrected:null,originalityProblemSlides:null,timeSpentInSeconds:0,averageWPMPace:0,paceOverTime:null,monotoneOverTime:null,grammarInfos:null,slidesRehearsed:0,pronunciationInfo:null,crutchWords:null,visionGazeInfos:null,visionOcclusionInfos:null,visionDistanceInfos:null,visionCritiqueFrames:null};window.PowerPointWebEditor.Rehearsal.IQualityStatusInfo=M.qp.FXf=function(){};
M.qp.FXf.prototype={severity:0,priority:0,shortCode:0,longCode:0,shortString:null,longString:null};window.PowerPointWebEditor.Rehearsal.IFeatureInfo=M.qp.nXf=function(){};M.qp.nXf.prototype={featureValue:null,featureTemplate:null,templateInfo:null};window.PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo=M.qp.hXf=function(){};M.qp.hXf.prototype={features:null,currentSlideIndex:0};window.PowerPointWebEditor.Rehearsal.IMediaEventInfo=M.qp.xXf=function(){};M.qp.xXf.prototype={mediaStatus:null};
window.PowerPointWebEditor.Rehearsal.IRealTimeCritique=M.qp.GXf=function(){};M.qp.GXf.prototype={currentSlideIndex:0,featureName:null,featureInfo:null};
function zve(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.vyf=Function.createDelegate(this,this.ZBg);this.wyf=Function.createDelegate(this,this.NHg);this.YCa=Function.createDelegate(this,this.QAb);this.RCa=Function.createDelegate(this,this.Yzb);this.hpb=Function.createDelegate(this,this.LYc);this.Wz=Function.createDelegate(this,this.lz);this.XCa=Function.createDelegate(this,this.xUa);this.Y7=Function.createDelegate(this,this.wUa);this.Mpb=Function.createDelegate(this,this.J_c);this.iMd=Function.createDelegate(this,
this.gbg);this.Hpf=Function.createDelegate(this,this.Sgg);this.wrf=Function.createDelegate(this,this.sjg);this.qwf=Function.createDelegate(this,this.lrg);this.Evf=Function.createDelegate(this,this.Gpg);this.fLd=Function.createDelegate(this,this.K9f);this.rUe=-1;this.qa=new re;this.z5c=L.ia("FirstRehearsalExperienceEnabled");this.XPb=c;b&&(this.mha=b.wB());this.Xa=d;this.fa=a;this.qc=e;this.ra=f;this.Ya=g;this.ka=h;this.Yj=k;this.c2=l;this.QTb=m;this.Yv=n;this.xG=r;this.wo=t;Ive(this)&&this.Yv.qa.Ka("OnRehearsalOptOutSettingsRequestFinished",
this.fLd)}
zve.prototype={XPb:null,Xa:null,$Ma:!1,fa:null,mha:null,jD:null,$Yb:null,qc:null,ra:null,Ya:null,ka:null,Yj:null,Ov:null,RTb:0,fVb:0,c2:null,QTb:null,Myc:null,Syc:null,Xtd:!1,gud:!1,Fia:0,FAd:0,WJ:!1,UOa:null,jqd:!1,PDd:!1,Yv:null,Gsc:!1,GAd:null,bKe:0,xG:null,UOb:0,HLe:!1,wo:null,lmd:!1,Wb:function(){this.fa.ya(3076808240,1,this.Evf);this.fa.ya(2400267914,1,this.qwf);this.fa.ya(2954393506,1,this.wrf);this.fa.ua(2360689666,1,this.Hpf,96)},Sgg:function(a,b,c,d,e){if(!e||!SR.isInstanceOfType(e))return R(590381532,822,
10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;TU(e,this.WJ);return 32},sjg:function(a,b,c){switch(c){case 1:if(this.$Ma&&(Ive(this)?this.Gsc:1))return this.fa.Ab(1256345977,1,null);break;default:R(575021444,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8},lrg:function(a,b,c,d,e){switch(c){case 2:return this.WJ=!this.WJ,G()&&G().rb().ro()&&window.Box4.App.Pb().lT({ToggleRehearsalVisionEnabled:"CheckboxModel"}),Ive(this)&&e&&e.triggerPoint!==
e$.fje&&(a=this.Yv,a.WJ=this.WJ,Jve(a,"vision",!a.WJ),Kve(a)&&a.qa.Ha("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty,null)),32;case 1:if(this.$Ma&&(Ive(this)?this.Gsc:1))return 32;break;default:R(590381530,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8},Gpg:function(a,b,c,d,e){switch(c){case 2:if(!this.ra.Ma())throw Error.argumentNull("ActiveSlide is null");e$.SUa[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;e$.SUa[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
e$.SUa[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;e$.SUa[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;e$.xae=ResourceStrings.L_SubtitleDetection_MicReady;e$.yae=ResourceStrings.L_SubtitleDetection_SoundReminder;e$.Zae=ResourceStrings.L_SubtitleDetection_NoMicrophone;e$.$ae=ResourceStrings.l_NoCamera;e$.Ube=ResourceStrings.L_SpeechGenericRetryErrorMessage;this.Xa.Jhb(this.iMd);this.Xa.Xya(this.Mpb);this.Xa.NX(this.Y7);this.Xa.Khb(this.XCa);Ive(this)&&(Lve(this.Yv),this.Yv.qa.eb("OnRehearsalOptOutSettingsRequestFinished",
this.fLd));b=new window.PowerPointWebEditor.Rehearsal.ISlideState;this.UOa=Fve(this.ka,this.ka.Gca);this.WJ&&!this.ka.xRa&&R(590381524,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.WJ=this.WJ&&this.ka.xRa;a=new window.UlsExternalLogger;c=this.ra.Ma().gc();c=window.$$as(TN,GO(this.qc,c.Pc()));b.currentSlideIndex=c?c.Sd:0;b.totalSlideCount=this.qc.il();c=new window.PowerPointWebEditor.Rehearsal.ICoachActorConfig;c.rootContainer=this.mha;c.slideState=b;c.imagesBaseFilePath=
L.Va("CoachImagesBaseFilePath");c.zIndex=e$.NQc;c.fEnableVision=this.WJ;c.fShowRealtimeFeedbackEnabledCheckbox=this.ka.y0d;c.fUseNewRealtimePanel=this.ka.e4d;c.fUseCountdownWelcomeScreen=L.ia("PptCoachEnableCountdownWelcomeUI");c.speechFDBase=Hve(this.ka.uRa);c.fDontShowTooltips=gi();c.fUseNewRealtimeCheckbox=$H("UseNewRealtimeCheckbox");this.Ov=(new window.CoachActorPackage.CoachActorFactory).createCoachActorManager(c,a);this.WJ&&(this.Myc=this.Ov.getRehearsalVideoElement(),this.Syc=this.Ov.getRehearsalVideoCanvas());
this.FAd=e;e=Mve(this,b,this.Myc,this.Syc);this.jD=(new window.CoachPackage.CoachSessionFactory).createCoachManager(e);e=new window.PowerPointWebEditor.Rehearsal.ICoachFREActorConfig;e.rootContainer=this.mha;e.zIndex=e$.NQc;e.imagesBaseFilePath=L.Va("CoachImagesBaseFilePath");this.$Yb=(new window.CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(e,a);$H("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&x3b(this.hpb,this.RCa,this.YCa);Nve(this);Ove(this);this.RTb=0;this.gud=!1;e=
this.Ov.getCoachElement(e$.xJf);a=$H("PresenterCoachTabFix")?document.getElementById("HiddenFocusTrapAnchor"):document.getElementById("slideshowEndFocusTrap");this.mha.insertBefore(e,a);e&&hh(e,"keydown",this.Wz);2===this.FAd&&(e=localStorage.getItem(e$.cCb),this.z5c&&!e?IEc(this):Pve(this));return 32;case 1:if(this.$Ma&&(Ive(this)?this.Gsc:1))return 32;break;default:R(51454232,822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8},hzb:function(){try{this.bKe=Date.now();var a=this.XPb.Rp,
b=this;a.Ni("powerpoint-presenter-coach-strings").then(function(){var c=new (Ca.$$(Promise));c.ga(a.Ni("CoachActorPackage"));c.ga(a.Ni("CoachPackage"));Promise.all(c.Jd()).then(function(){Qve(b);return null}).catch(function(a){R(590947672,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",a);return null})})}catch(c){R(590947670,822,10,"RehearsalManager: Exception in LoadResources : {0}.",c)}},xUa:function(a,b){82===b.mB&&Rve(this)},yva:function(a){this.mha&&this.Ov&&window.setTimeout(function(){vl(a)},
50)},lz:function(a){try{var b=this.Ov.getCoachElement(e$.Tce),c=this.Ov.getCoachElement(e$.U_f),d=this.Ov.getCoachElement(e$.Utg),e=this.Ov.getCoachElement(e$.I1f);if(9===a.keyCode){if(!$H("PresenterCoachTabFix")){var f=!d&&!!b&&a.target===b||!!d&&a.target===d,g=!!b&&!!c&&c.contains(a.target),h=!!e&&a.target===e;(f||g||h)&&this.Xa.uz()}}else 37===a.keyCode||38===a.keyCode?(this.Xa.Vla(),Rve(this)):39===a.keyCode||40===a.keyCode?(this.Xa.Rb(),Rve(this)):13===a.keyCode||32===a.keyCode||a.shiftKey||
this.Xa.uz()}catch(k){R(594403598,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",k)}},LYc:function(a){this.UOb=0;if(a.length)for(var b=a.length,c=0;c<b;++c)"audioinput"===a[c].kind&&(this.UOb+=1);else this.UOb=0;this.HLe=!0;a=new window.PowerPointWebEditor.Rehearsal.ISlideState;b=this.ra.Ma().gc();b=window.$$as(TN,GO(this.qc,b.Pc()));a.currentSlideIndex=b?b.Sd:0;a.totalSlideCount=this.qc.il();a=Mve(this,a,this.Myc,this.Syc);this.jD.updateSessionConfiguration(a)},Yzb:function(a){R(555779546,
822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",a.toString())},QAb:function(){R(555779547,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",uo())},gbg:function(){var a=localStorage.getItem(e$.cCb);this.z5c&&!a?IEc(this):Pve(this)},J_c:function(a,b){a=new window.PowerPointWebEditor.Rehearsal.ISlideState;a.currentSlideIndex=b.Sd;a.totalSlideCount=this.qc.il();b=Mve(this,a,this.Myc,this.Syc);this.jD.updateSessionConfiguration(b);
this.Ov.updateCoachSlideComponent(a)},l$a:function(){var a=L.Va("PptEditingUserId");a||(a=L.Va("LoggableUserId"),u(587563427,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",!a));return a},wUa:function(){this.Xa.XVb(this.iMd);this.Xa.b4a(this.Mpb);this.Xa.jZ(this.Y7);this.Xa.YVb(this.XCa);this.Fia=3;this.jD.stopSession();this.$Yb.hideCoachFREAndWelcomeUI();this.Ov.hideCoachUI();this.PDd=this.jqd=!1;try{var a=this;this.jD.getSessionSummary(function(b){b.timeSpentInSeconds=
a.RTb;a.fa.Ab(3117366731,2,null);a.fa.Ab(2765468550,2,null);window.clearInterval(a.rUe);a.gud&&a.QTb.Da().Mcc(b,a.WJ,a.UOa,a.GAd,function(){if(a.ka.z0d){var b=a.jD.getTraceRequestMetadata(),d=a.Ov.getTraceRequestMetadata(),e=a.ka.uRa.replace("wss","https");if(e&&e.length){var f=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",e),e=new XMLHttpRequest;e.open("POST",f,!0);f=Ae().toString();e.setRequestHeader("X-Correlation",f);try{u(587563425,822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",
f);var g={};if(b)for(var h in b){var k={key:h,value:b[h]};g[k.key]=k.value}if(d)for(var l in d)k={key:l,value:d[l]},g[k.key]=k.value;var m=ze(ye(L).SessionStartInfoJson.toString());g.AudienceGroup=m.Ring||"Unknown";g.BuildVersion=Jp||"Unknown";g.ClientType="web";g.IdentityProvider=a.ka.yZ||L.Va("HostAuthType")||"Unknown";g.Locale=a.ka.Wja||"Unknown";g.SpeechMode="rehearsal";g.TenantId=L.Va("TenantId");g.UserId=a.l$a();g.WacDatacenter=m.WACDatacenter||"Unknown";g.WacHost=m.Host||"Unknown";g.SourceLanguage=
a.ka.EDc||Sve(a.ka.Gca);e.send(Id(g))}catch(n){u(587563424,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",f)}}else u(587563426,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}})})}catch(b){u(576247201,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",b)}},NHg:function(){2!==this.Fia&&(this.RTb+=1,this.Ov&&this.Ov.updateTimer(this.RTb))},handleError:function(a){a=window.$$as(String,a);this.Fia=4;a?a.startsWith("ErrorAudio")?(this.Ov&&
this.Ov.showCoachDisabledUI(0),f$(this)&&this.Yj.Da().xf(e$.Zae,Q3.vGa)):a.startsWith("ErrorVideo")?(this.Ov&&this.Ov.showCoachDisabledUI(1),f$(this)&&this.Yj.Da().xf(e$.$ae,Q3.vGa)):R(589169224,822,10,"RehearsalManager::handleError unhandled errorInfo"):R(589169226,822,10,"RehearsalManager::handleError errorInfo null")},ZBg:function(){f$(this)&&(window.clearTimeout(this.fVb),this.Yj.Da().Cd())},K9f:function(){this.Gsc=!0;this.WJ=this.Yv.WJ;$H("PollToRefreshCoachEntryPointOnRibbon")&&this.wo&&this.wo.CB()}};
function Ive(a){return a.ka.wRa&&!!a.Yv}function f$(a){return a.ka.F3&&a.Yj&&a.Yj.Da()&&2!==a.Fia?!0:!1}function Tve(a){a.Ov&&(a.WJ&&a.Ov.enableCoachVideoUI(),a.Ov.showCoachRealtimeUI(a.lmd));f$(a)&&a.Yj.Da().xf(e$.xae,Q3.y9b)}
function Ove(a){a.jD.on("SpeechRecognitionStarted",function(){a.Xtd&&f$(a)&&(a.Yj.Da().Cd(),a.Xtd=!1)});a.jD.on("PPTCoachRealtimeNotification",function(b){a.Ov.updateCoachRealtimeNotification(b)});a.jD.on("QualityStatusChanged",function(b){if(a.ka.F3){var c=b.severity,d=b.shortCode;if(0<d&&d<e$.mGe&&e$.SUa[d])switch(c){case 0:f$(a)&&a.Yj.Da().Cd();break;case 1:(b=0<d?e$.SUa[d]:b.shortString)&&f$(a)&&a.Yj.Da().xf(b,Q3.hab);break;case 2:(b=0<d?e$.SUa[d]:b.shortString)&&f$(a)&&a.Yj.Da().xf(b,Q3.vGa)}else R(595198425,
822,10,"onQualityStatusChanged: Invalid short code")}});a.jD.on("MediaStatusChanged",function(b){"AudioDeviceConnected"===b.mediaStatus?(a.jqd=!0,a.WJ&&!a.PDd||Tve(a)):"VideoSetupCompleted"===b.mediaStatus&&(a.PDd=!0,a.jqd&&(a.Ov&&a.Ov.enableCoachVideoUI(),Tve(a)))});a.jD.on("Error",function(b){a.handleError(b)});a.jD.on("ConnectionRetry",function(){a.Xtd=!0;f$(a)&&a.Yj.Da().xf(e$.Ube,Q3.vGa)})}
function Nve(a){a.Ov.on("CoachSessionStarted",function(){a.Fia=1;a.rUe=window.setInterval(a.wyf,1E3);a.jD.enableVoiceStreaming();f$(a)&&(a.Yj.Da().xf(e$.yae,Q3.y9b),a.fVb=window.setTimeout(a.vyf,3E3));a.gud=!0});a.Ov.on("CoachSessionPaused",function(){a.Fia=2;a.jD.pauseSession();f$(a)&&a.Yj.Da().Cd()});a.Ov.on("CoachSessionResumed",function(){a.Fia=1;a.jD.resumeSession()})}
function Mve(a,b,c,d){var e=new window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig;e.disabledCoachRealtimeFeatures="";e.userSessionId=vp;var f=new window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig;f.docId=F.sh;f.podsSessionId=a.Ya.Hc;f.userDataCenterClusterId=a.Ya.el;f.webServiceBase=a.ka.zr;e.documentDownloadConfig=f;f=new window.UlsExternalLogger;e.logger=f;f={};f.currentSlideIndex=b.currentSlideIndex.toString();e.customSettings=f;e.fEnableServiceSideAggregationForCoach=a.ka.o_d;
e.httpTimeoutForCoachSummaryData=a.ka.p_d;e.fSendClientMetaDataOnSessionStart=a.ka.SRd;e.speechFDBase=a.ka.uRa;b=",visionFace";a.ka.K_d&&(b+=","+e$.Ptg+","+e$.Otg);a.ka.L_d&&(b+=","+e$.Rtg+","+e$.Qtg);a.ka.I_d&&(b+=","+e$.Ltg+","+e$.Mtg+","+e$.Ntg);b=e$.dug+(d$(a.UOa,e$.dSc)?","+e$.dSc:"")+","+e$.jmg+","+e$.fKf+","+e$.ldg+","+e$.Oeg+(a.ka.i1b&&d$(a.UOa,e$.OTc)?","+e$.OTc:"")+(a.ka.u1b&&d$(a.UOa,e$.dXc)?","+e$.dXc:"")+(a.ka.xRa&&d$(a.UOa,e$.une)?b:"")+(a.ka.IJc&&d$(a.UOa,e$.M1c)?","+e$.M1c:"")+(a.ka.HJc&&
d$(a.UOa,e$.BQc)?","+e$.BQc:"");e.requestedCoachFeatures=b;Ive(a)&&(a.GAd=Uve(a.Yv,!0),e.requestedRehearsalOptOutFeatures=a.GAd);$H("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(e.enableTimeStampedCritiqueTelemetry=!0);e.entryPoint=M.p2c.toString(a.FAd);e.fEnableVision=a.WJ;if(e.fEnableVision&&c&&d){var g;e.webcamConfig=(g=new window.PowerPointWebEditor.Rehearsal.IWebcamConfig,g.videoView=c,g.workingCanvas=d,g.numFramesPerSecond=a.ka.J_d,g.webcamFrameWidth=a.ka.N_d,g)}e.supportedRehearsalTemplates=
a.Ov.getSupportedRehearsalTemplates();$H("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&a.HLe&&(e.audioInputDeviceCount=a.UOb);c=ze(ye(L).SessionStartInfoJson.toString());e.userId=a.l$a();e.tenantId=L.Va("TenantId");e.identityProvider=a.ka.yZ||L.Va("HostAuthType")||"Unknown";e.audienceChannel="";e.audienceGroup=c.Ring||"Unknown";e.buildVersion=Jp||"Unknown";e.locale=a.ka.Wja||"Unknown";e.wacHost=c.Host||"Unknown";e.wacDatacenter=c.WACDatacenter||"Unknown";e.sourceLanguage=a.ka.EDc||Sve(a.ka.Gca);
R(591537798,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",a.ka.Wja,a.ka.Gca);return e}function IEc(a){a.$Yb.showCoachFREUI(function(b){localStorage.setItem(e$.cCb,"true");a.lmd=b;Pve(a)})}
function Pve(a){a.Fia=0;a.c2.pb(function(a){a.dob(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.SubtitlesButton,!1);a.dob(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.LiveButton,!1);a.dob(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.CoachButton,!1);a.dob(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.MicButton,!1)});a.jD.startSession(!0)}
function Rve(a){if(a.Fia)2===a.Fia?(b=a.Ov.getCoachElement(e$.Zdg))&&a.yva(b):1===a.Fia&&(b=a.Ov.getCoachElement(e$.V_f))&&a.yva(b);else{var b=a.Ov.getCoachElement(e$.Tce);b&&a.yva(b)}}
function Qve(a){var b=L.Va("CoachPackageCssUrl"),c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b);window.$addHandler(c,"load",function(){a.$Ma=!0;$H("PollToRefreshCoachEntryPointOnRibbon")&&a.wo&&a.wo.CB();a.qa.Ha("OnCoachResourcesLoaded",new Sys.EventArgs,null);R(555798674,822,50,"RehearsalManager: Coach package loading time: {0}ms",Date.now()-a.bKe)});document.body.appendChild(c)}
function Ave(a,b,c,d,e){this.zjf=Function.createDelegate(this,this.M9f);this.Uef=Function.createDelegate(this,this.V3f);this.fa=a;this.za=b;this.QUe=c;this.QTb=d;this.kV=e;var f=this;this.QUe.pb(function(a){a.qa.Ka("OnCoachResourcesLoaded",f.Uef)});var g=this;this.QTb.pb(function(a){a.qa.Ka("OnRehearsalSummaryResourcesLoaded",g.zjf)})}Ave.prototype={fa:null,za:null,QUe:null,QTb:null,kV:null,aIe:!1,eIe:!1,V3f:function(){this.aIe=!0;Vve(this)},M9f:function(){this.eIe=!0;Vve(this)}};
function Vve(a){a.aIe&&a.eIe&&Je(window.Common.App.AppLifecycleManager.get_instance(),10,null,3).CW(function(){if(a.za.jMc&&a.za.H_d){var b=document.getElementById("rehearsal-loading-dialog-modal");b?(b.style.display="none",R(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):R(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===a.fa.Ab(1256345977,1,null))if(a.za.jMc)a.fa.jb(1256345977,2,{entryPoint:5},null);else if(!a.za.VM&&
a.za.JJc&&a.za.uZd)try{a.kV.CW(function(){ab(a.kV).Jn("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled",null)}),R(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(c){R(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",c)}})}function Wve(){}Wve.prototype={critiquesDisabled:null,critiquesDisabledByDefault:null};function Xve(){}Xve.prototype={userCritiques:null};
function Yve(){}Yve.prototype={critique:null,displayName:null,optOut:!1,category:null};function Zve(){}Zve.prototype={critiquesData:null,categoriesData:null};function yve(a,b,c,d){this.jkf=Function.createDelegate(this,this.y$f);this.Qqf=Function.createDelegate(this,this.W1c);this.qa=new re;this.tq=a;this.ka=b;this.RAa=c;this.fa=d}
yve.prototype={ka:null,tq:null,RAa:null,fa:null,gV:null,FPb:null,gI:null,WJ:!1,JJe:null,xqa:0,wqa:0,y$f:function(a){var b=JI(a);R(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",b,a.Pa.So)},W1c:function(){this.xqa&&1!==this.xqa&&this.wqa&&1!==this.wqa&&(Kve(this)?this.qa.Ha("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs,null):this.qa.Ha("OnRehearsalGetCritiquesFailed",new Sys.EventArgs,null))}};
function $ve(a){var b=ze(ye(L).SessionStartInfoJson.toString()).Ring||"Unknown",c=a.ka.uRa.replace("wss","https");return c&&c.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",c,b,Sve(a.ka.Gca)):null}
function awe(a){try{var b=$ve(a);if(b){var c=new XMLHttpRequest;c.open("GET",b,!0);c.onreadystatechange=function(){if(4===c.readyState){if(200===c.status){R(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");var b=ze(c.responseText);if(b){a.FPb=new (Ca.$$(Yve));for(var e=b.critiquesData,f=e.length,g=0;g<f;++g){var h=e[g],k;a.FPb.ga((k=new Yve,k.category=h.category,k.displayName=h.displayName,k.optOut=!1,k.critique=h.critique.toLowerCase(),k))}a.JJe=
b.categoriesData;a.wqa=2}else a.wqa=3}else a.wqa=3;a.W1c()}};c.send("");a.wqa=1}else R(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request")}catch(d){a.wqa=3,a.W1c(),R(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",d.toString())}}
function bwe(a,b){var c=a.ka.Xsa+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",F.sh),d={};d["X-StatelessPopsAffinityRoutingEnabled"]=a.ka.Osb.toString();a.tq.lk(c,1,null,d,!1,2,function(c){var d=0;try{c.Pa.Ce&&0<c.Pa.Ce.trim().length&&(d=c.Pa.Ce.length,a.gV=JSON.parse(c.Pa.Ce));a.gV&&a.gV.userCritiques||(a.gV=new Xve,a.gV.userCritiques=new Wve);a.gV.userCritiques.critiquesDisabledByDefault||(a.gV.userCritiques.critiquesDisabledByDefault="vision",a.gV.userCritiques.critiquesDisabled=
a.gV.userCritiques.critiquesDisabled?a.gV.userCritiques.critiquesDisabled+",vision":"vision");a.gI=new (Ca.$$(String));if(a.gV.userCritiques.critiquesDisabled)for(var g=a.gV.userCritiques.critiquesDisabled.split(","),h=g.length,k=0;k<h;++k)a.gI.ga(g[k].toLowerCase());a.WJ=!a.gI.Kc("vision");a.xqa=2}catch(l){a.xqa=3,R(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",l.toString())}b&&b();c=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",
d,JSON.stringify(c.Pa.TD),JSON.stringify(c.Pa.Ws),JSON.stringify(c.Pa.Yw));R(559548295,822,50,c)},function(c){a.xqa=3;b&&b();c=JI(c);R(559548296,822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",c)},null,null,!1,null,null,"17_16",null,!1,null,!1,null);a.xqa=1}
function cwe(a){var b=!1;try{var c=!a.gV.userCritiques.critiquesDisabled;if(!a.gI||!a.gI.Qa()&&c)return!1;if(c&&0<a.gI.Qa()||!c&&!a.gI.Qa())return!0;var d=new window.Set(a.gV.userCritiques.critiquesDisabled.split(","));if(a.gI.Qa()!==d.size)return!0;for(c=0;c<a.gI.Qa();c++)if(!d.has(a.gI.K(c).toLowerCase())){b=!0;break}}catch(e){R(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",e.toString())}return b}
function Jve(a,b,c){a.gI&&(b=b.toLowerCase(),c&&!a.gI.Kc(b)?a.gI.ga(b):!c&&a.gI.Kc(b)&&a.gI.Mc(b),$H("RehearsalRoamingSettingAutoSaveEnabled")&&Lve(a))}
function Lve(a){if(2!==a.xqa)R(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(cwe(a)){R(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var b=new Xve,c;b.userCritiques=(c=new Wve,c.critiquesDisabled=Uve(a,!1),c.critiquesDisabledByDefault=a.gV.userCritiques.critiquesDisabledByDefault,c);c=Id(b);var d=a.ka.Xsa+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",
F.sh),e={};e["X-StatelessPopsAffinityRoutingEnabled"]=a.ka.Osb.toString();a.tq.lk(d,2,c,e,!1,2,function(c){a.gV=b;R(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",c.Pa.Yw-c.Pa.TD,c.Pa.Ws-c.Pa.TD)},a.jkf,null,null,!1,null,null,"17_17",null,!1,null,!1,null)}else R(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}
function Uve(a,b){var c="";if(a.gI&&0<a.gI.Qa())if($H("RehearsalFilterOptOutCritiqueEnabled")&&b){var d;a:{b=a.ka;var e=a.ka.Gca,f=null;try{if(!b||!e){u(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");d=null;break a}var g=b.jtb?Sys.Serialization.JavaScriptSerializer.deserialize(b.jtb,!0):{},f={},h;for(h in g){var k={key:h,value:g[h]};if(k.value){var l=bla(k.value.split(","));f[k.key.toLowerCase()]=l&&e.toLowerCase()in
l?!0:!1}}}catch(m){R(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",m.toString()),f=null}d=f}if(d)for(g=a.gI.$$lge();g.$$mn();)if(a=g.$$cu(),h="vision"===a?e$.une.toLowerCase():a.toLowerCase(),h in d?d[h]:1)c=c?c+","+a.toLowerCase():a.toLowerCase()}else for(d=a.gI.$$lge();d.$$mn();)a=d.$$cu(),c=c?c+","+a.toLowerCase():a.toLowerCase();return c}
function dwe(a){if(!a.FPb)return R(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(a.gI)for(var b=a.FPb.$$lge();b.$$mn();){var c=b.$$cu();a.gI.Kc(c.critique.toLowerCase())?c.optOut=!0:c.optOut=!1}}catch(d){R(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",d.toString())}return a.FPb.Jd()}
function ewe(a){try{a.xqa&&3!==a.xqa||bwe(a,a.Qqf),a.wqa&&3!==a.wqa||awe(a)}catch(b){R(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",b.toString())}}function Kve(a){return 2===a.xqa&&2===a.wqa}function Cve(a){try{bwe(a,function(){a.qa.Ha("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs,null)})}catch(b){R(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",b.toString())}}
function Bve(a,b,c,d,e){this.gLd=Function.createDelegate(this,this.L9f);this.dLd=Function.createDelegate(this,this.I9f);this.eLd=Function.createDelegate(this,this.J9f);this.Zpf=Function.createDelegate(this,this.jhg);this.Muf=Function.createDelegate(this,this.Aog);this.Yuf=Function.createDelegate(this,this.Rog);var f=this;a.Ni("powerpoint-presenter-coach-strings").then(function(){f.JAa=!0;R(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(function(a){R(559548253,822,
10,"Failed to load powerpoint-presenter-coach-strings "+a.toString())});this.fa=b;this.ka=e;this.uq=c;this.Yv=d;this.fa.G4(this)}
Bve.prototype={fa:null,uq:null,ka:null,Yv:null,mc:!1,JAa:!1,Wb:function(){this.fa.ya(413593002,1,this.Yuf);this.fa.ya(4006743010,1,this.Muf);this.fa.ua(4191121318,1,this.Zpf,96)},Of:function(){},L_:function(){},K_:function(){},Rog:function(a,b,c){if(1!==b.Ke()||!this.JAa)return 2;if(1===c)return 32;if(this.mc){var d=this;window.Common.UISurfaces.rw().then(function(a){a.setSelectedTaskPane("RehearsalFeedbackSettingsPaneFocus",2);d.rA(!0);return null}).catch(function(a){R(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",
a.toString())})}else this.mc=!0,fwe(this),(a=!Kve(this.Yv))&&ewe(this.Yv),a=this.PP(a,!1),gwe(this,a,!1),R(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane");return 32},Aog:function(a,b,c){if(1!==b.Ke()||!this.JAa)return 2;if(1===c)return 32;(this.mc=!this.mc)?(fwe(this),(a=!Kve(this.Yv))&&ewe(this.Yv),a=this.PP(a,!1),gwe(this,a,!1),R(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(hwe(),R(559548255,822,50,
"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32},jhg:function(a,b,c,d,e){if(!SR.isInstanceOfType(e))return 8;TU(e,this.mc);return 32},PP:function(a,b){var c,d=this,e=this;return c=new CLb,c.groupItems=a||b?null:dwe(this.Yv),c.categoriesData=this.Yv.JJe,c.locale=this.ka.Gca,c.updateCritiqueState=function(a,b){var c=d.Yv;Jve(c,a,b);"vision"===a.toLowerCase()&&(c.WJ=!b,a={},a.triggerPoint=e$.fje,c.fa.jb(2400267914,2,a,null))},c.retryToFetchCritiqueSettings=
function(){ewe(e.Yv)},c.showLoadingMessage=a,c.showErrorMessage=b,c},rA:function(a){var b=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");a&&b&&b.focus()},J9f:function(){var a=this.PP(!1,!1);gwe(this,a,!0)},I9f:function(){var a=this.PP(!1,!0);gwe(this,a,!0)},L9f:function(){var a=this.PP(!1,!1);a.isExternalUpdated=!0;gwe(this,a,!0)}};
function fwe(a){a.Yv.qa.Ka("OnRehearsalGetCritiquesSucceeded",a.eLd);a.Yv.qa.Ka("OnRehearsalGetCritiquesFailed",a.dLd);a.Yv.qa.Ka("OnRehearsalSettingsUpdatedExternally",a.gLd)}function hwe(){window.Common.UISurfaces.rw().then(function(a){a.hideTaskPane("RehearsalFeedbackSettingsPaneFocus",2);return null}).catch(function(a){R(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",a.toString())})}
function gwe(a,b,c){var d,e=(d=new Im,d.title=ResourceStrings.L_RehearseFeedbackSettings,d.hideHeader=!1,d.width=window.parseInt(320),d.location=2,d.contentProps=b,d.onOpen=function(){},d.onClose=function(){a.mc=!1;a.Yv.qa.eb("OnRehearsalGetCritiquesSucceeded",a.eLd);a.Yv.qa.eb("OnRehearsalGetCritiquesFailed",a.dLd);a.Yv.qa.eb("OnRehearsalSettingsUpdatedExternally",a.gLd);Lve(a.Yv)},d.onHide=function(){Lve(a.Yv)},d.isModernPane=!0,d);b=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");
a.uq.wS("RehearsalFeedbackSettingsPaneFocus","main",b,function(){a.rA(!0)},function(){a.rA(!1)},!1,null);window.Common.UISurfaces.rw().then(function(b){c?a.mc&&b.updateTaskPane("RehearsalFeedbackSettingsPaneFocus",e):b.showTaskPane("RehearsalFeedbackSettingsPaneFocus",e);return null}).catch(function(a){R(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",a.toString())})}
function d$(a,b){return b?a?b.toLowerCase()in a:!0:(u(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1)}
function Fve(a,b){var c=null;try{if(!a||!b)return u(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),null;var d=a.jtb?Sys.Serialization.JavaScriptSerializer.deserialize(a.jtb,!0):{},c={},e;for(e in d){var f={key:e,value:d[e]};if(f.value){var g=bla(f.value.split(","));g&&b.toLowerCase()in g&&(c[f.key.toLowerCase()]=!0)}}}catch(h){R(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",
h.toString()),c=null}return c}function Gve(a,b){if(!b||!a.YJc)return null;try{var c=Sys.Serialization.JavaScriptSerializer.deserialize(a.YJc,!0),d;b?d=b.split("-")[0].toLowerCase():(u(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty."),d=null);return c[d]}catch(e){return R(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",e.toString()),null}}
function Hve(a){if(a&&3<a.length){var b="";"ws"===a.substring(0,2)?b="http"+a.substring(2,a.length):"wss"===a.substring(0,3)&&(b="https"+a.substring(3,a.length));return b}return a}function Sve(a){if(!a)return u(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",a),"en-US";switch(a.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return a}}
wve.registerClass("PowerPointWebEditor.Rehearsal.PPTWebEditorRehearsalPackage",null,yo,ec);xve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageActor",null,sve);Dve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageHelper");e$.registerClass("PowerPointWebEditor.Rehearsal.RehearsalResourceString");window.PowerPointWebEditor.Rehearsal.ISlideState.registerClass("PowerPointWebEditor.Rehearsal.ISlideState");window.PowerPointWebEditor.Rehearsal.IWebcamConfig.registerClass("PowerPointWebEditor.Rehearsal.IWebcamConfig");
window.PowerPointWebEditor.Rehearsal.ICoachActorConfig.registerClass("PowerPointWebEditor.Rehearsal.ICoachActorConfig");window.PowerPointWebEditor.Rehearsal.ICoachFREActorConfig.registerClass("PowerPointWebEditor.Rehearsal.ICoachFREActorConfig");window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig.registerClass("PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig");window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig.registerClass("PowerPointWebEditor.Rehearsal.ICoachSessionConfig");
window.PowerPointWebEditor.Rehearsal.IDistanceInfo.registerClass("PowerPointWebEditor.Rehearsal.IDistanceInfo");window.PowerPointWebEditor.Rehearsal.IFillerData.registerClass("PowerPointWebEditor.Rehearsal.IFillerData");window.PowerPointWebEditor.Rehearsal.IGrammarInfo.registerClass("PowerPointWebEditor.Rehearsal.IGrammarInfo");window.PowerPointWebEditor.Rehearsal.ISensitivePhrasesData.registerClass("PowerPointWebEditor.Rehearsal.ISensitivePhrasesData");window.PowerPointWebEditor.Rehearsal.IPaceData.registerClass("PowerPointWebEditor.Rehearsal.IPaceData");
window.PowerPointWebEditor.Rehearsal.IMonotoneData.registerClass("PowerPointWebEditor.Rehearsal.IMonotoneData");window.PowerPointWebEditor.Rehearsal.IPronunciationInfo.registerClass("PowerPointWebEditor.Rehearsal.IPronunciationInfo");window.PowerPointWebEditor.Rehearsal.ICrutchWordsData.registerClass("PowerPointWebEditor.Rehearsal.ICrutchWordsData");window.PowerPointWebEditor.Rehearsal.ICoachSummaryData.registerClass("PowerPointWebEditor.Rehearsal.ICoachSummaryData");window.PowerPointWebEditor.Rehearsal.IQualityStatusInfo.registerClass("PowerPointWebEditor.Rehearsal.IQualityStatusInfo");
window.PowerPointWebEditor.Rehearsal.IFeatureInfo.registerClass("PowerPointWebEditor.Rehearsal.IFeatureInfo");window.PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo.registerClass("PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo");window.PowerPointWebEditor.Rehearsal.IMediaEventInfo.registerClass("PowerPointWebEditor.Rehearsal.IMediaEventInfo");window.PowerPointWebEditor.Rehearsal.IRealTimeCritique.registerClass("PowerPointWebEditor.Rehearsal.IRealTimeCritique");
zve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalManager",null,tve);Ave.registerClass("PowerPointWebEditor.Rehearsal.RehearsalTrigger",null,uve);Wve.registerClass("PowerPointWebEditor.Rehearsal.UserCritiqueSettings");Xve.registerClass("PowerPointWebEditor.Rehearsal.RehearseRoamingSettings");Yve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalCritique");Zve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalCritiquesData");
yve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalFeedbackSettings",null,vve);Bve.registerClass("PowerPointWebEditor.Rehearsal.RehearsalFeedbackSettingsPane",null,ed);(function(){}).registerClass("PowerPointWebEditor.Rehearsal.RehearsalUtils");e$.mGe=20;e$.NQc=50002;e$.SUa=Array(e$.mGe);e$.xae=null;e$.yae=null;e$.Zae=null;e$.$ae=null;e$.Ube=null;e$.dSc="fillerWords";e$.ldg="originality";e$.dug="wordsPerMinute";e$.jmg="sensitivePhrases";e$.fKf="correctedSensitivePhrases";e$.Oeg="positivity";
e$.OTc="grammar";e$.dXc="monotone";e$.M1c="pronunciation";e$.BQc="crutchWords";e$.une="visionFace";e$.Ptg="visionGaze";e$.Otg="visionGazeGood";e$.Rtg="visionOcclusion";e$.Qtg="visionOcclusionGood";e$.Ltg="visionDistanceGood";e$.Mtg="visionDistanceTooClose";e$.Ntg="visionDistanceTooFar";e$.Tce="GetStartedButton";e$.U_f="ListeningButtonPlayPauseButton";e$.V_f="ListeningElement";e$.xJf="ContainerElement";e$.Zdg="PausedElement";e$.I1f="NotificationButtonElement";e$.Utg="WelcomeCheckboxElement";
e$.fje="RehearsalFeedbackSettingPane";e$.cCb="PPTCoachRehearsalFREShown";zo(gj(),new wve,0,!1);Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function p7(){}p7.registerInterface("PowerPointWebEditor.IReplaceObjectGalleryView");
function iwe(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E){this.pja=Function.createDelegate(this,this.CUa);this.fId=Function.createDelegate(this,this.C2f);this.gId=Function.createDelegate(this,this.D2f);this.gP=Function.createDelegate(this,this.u4);this.kqb=Function.createDelegate(this,this.N6c);this.eId=Function.createDelegate(this,this.Hge);this.kLd=Function.createDelegate(this,this.she);this.hLd=Function.createDelegate(this,this.rhe);this.kZ=Function.createDelegate(this,this.F9);this.wI=Function.createDelegate(this,
this.WI);this.MHd=Function.createDelegate(this,this.Wfe);this.iP=Function.createDelegate(this,this.RK);this.pa=a;this.Ia=b;this.ra=c;this.jc=d;this.bI=e;this.ji=f;this.fa=g;this.Dt=h;this.Gia=k;this.Zv=l;this.kCa=n;this.eV=r;this.Nmb=t;this.xd=v;this.Hx=x;this.ob=y;this.Fb=z;this.ur=m;this.Rha=E;this.Kf=!1}
iwe.prototype={pa:null,Ia:null,ra:null,jc:null,bI:null,ji:null,fa:null,Dt:null,Gia:null,Zv:null,ur:null,kCa:null,eV:null,Nmb:null,xd:null,Hx:null,ob:null,Fb:null,tAa:!1,$Qb:!1,Rha:null,NNa:!1,Kf:!1,Ro:function(){this.Kf||(this.nv(),this.$Qb=2===this.Fb.Ic(),this.Kf=!0)},nv:function(){uz(this.pa,this.iP);kSd(this.kCa,this.MHd);uO(this.ji,this.wI);W3(this.eV,this.kZ);this.xd.qa.Ka("ROIU",this.hLd);this.Gia.qa.Ka("ReplaceObjectViewDE",this.kLd);GFb(this.bI,this.eId);this.ji.qa.Ka("CH",this.kqb);this.Fb.o1(this.gP);
this.xd.qa.Ka("AROSBSR",this.gId);this.xd.qa.Ka("AROSASR",this.fId);this.xd.qa.Ka("UR",this.pja)},ha:function(){this.Kf&&(SC(this.pa,this.iP),this.kCa.Tjb.eb("MU",this.MHd),tO(this.ji,this.wI),this.eV.GUb.eb("SPC",this.kZ),this.xd.qa.eb("ROIU",this.hLd),this.Gia.qa.eb("ReplaceObjectViewDE",this.kLd),this.bI.qa.eb("OBCSC",this.eId),this.Fb.pCa(this.gP),this.ji.qa.eb("CH",this.kqb),this.xd.qa.eb("AROSBSR",this.gId),this.xd.qa.eb("AROSASR",this.fId),this.xd.qa.eb("UR",this.pja),this.Kf=!1)},BHa:function(a){return this.tAa&&
this.$Qb?this.Nmb.UDb(a):!1},I8b:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},D2f:function(){this.NNa=!0},C2f:function(){this.NNa=!1},CUa:function(a,b){this.kN(b.Sh)},S6b:function(a){return a?"data:image/png;base64,"+a:null},u4:function(a){R(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",a.Ic());this.$Qb=2===a.Ic()},N6c:function(){this.tAa||
R(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.tAa=!0}};
function jwe(a,b,c,d){if(c.$z)if(c.gRa&&b.KRa)R(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",b.KRa);else{if(b.KRa)if(1===b.KRa){if(!b.u3){R(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",b.nd);return}c.m4a(lwe(a,b.u3,b.x6a));c.$7a=new Date;d.B8&&nwe(a,b.nd,c.Hy(),c.Kv(),"Success")}else 2===b.KRa&&(c.PHc=!1,c.Wu=b.Wu,nwe(a,c.nd,b.Wu,c.Kv(),"Success"));else{if(0>=b.x6a){R(38115482,829,
50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",b.nd);a.zF(c,"NoSuggestions");return}if(b.x6a<d.n4d){R(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",b.nd);a.zF(c,"LowSuggestions");return}kwe(c,!1);c.m4a(lwe(a,b.u3,b.x6a));mwe(c,b.x6a);R(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",c.K7a,b.nd)}d=c.Cu();c.Cq&&c.Cq.oc()&&d&&d.oc()&&a.ur.PTa(d)&&a.tAa&&a.$Qb&&(1===b.KRa?owe(a.Zv,c.nd):
pwe(a.Zv,d))}else R(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",b.nd)}function nwe(a,b,c,d,e){a.Rha.pb(function(a){var g,h=(g=new W$c,g.correlationId=b,g.shapeId=c,g.suggestions=d,g);a.M1f(e,h)})}
function lwe(a,b,c){var d=[];if(!b)return d;b=b.split(";");if(b.length<c)return R(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",c,b.length),d;for(var e=0;e<c;++e){var f=b[e].split(":");if(3!==f.length)throw a=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",e,b[e]),R(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",a),Error.create(a);var g=hld(Number.parseInvariant(f[1]),1,177,"L_SAType"),h;
Array.add(d,(h=new U$c,h.index=f[0],h.labelText=g?g:ResourceStrings.L_SmartArt,h.imageData=a.S6b(f[2]),h))}return d}Type.registerNamespace("PowerPointWebEditor.ReplaceObject");M.IBb=M.IBb||{};function qwe(){}qwe.registerInterface("PowerPointWebEditor.ReplaceObject.IFlyoutAnchor");function N4d(){}N4d.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectContext");function g$(){}g$.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager");function rwe(){}rwe.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager");
function swe(){}swe.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls");function twe(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U){this.dMd=Function.createDelegate(this,this.K_c);this.sNd=Function.createDelegate(this,this.xie);this.tNd=Function.createDelegate(this,this.Efg);twe.initializeBase(this,[h,c,d,e,f,g,k,l,m,n,r,v,x,y,z,H,O,Q,U]);this.UE=a;this.kqd=b;this.YUe=t;this.ka=E;this.LAd=this.ka.m4d}
twe.prototype={UE:null,kqd:null,YUe:null,ka:null,LAd:!1,nv:function(){if(this.ka.f2b){var a=this;this.kqd.pb(function(b){b.nka("ShapeTextConvertable",a.tNd)})}else{var b=this;this.UE.pb(function(a){a.nka("ShapeTextConvertable",b.sNd)})}this.xd.qa.Ka("SSS",this.dMd);iwe.prototype.nv.call(this)},ha:function(){if(this.Kf){if(this.ka.f2b){var a=this;this.kqd.pb(function(b){b.YUa("ShapeTextConvertable",a.tNd)})}else{var b=this;this.UE.pb(function(a){a.YUa("ShapeTextConvertable",b.sNd)})}this.xd.qa.eb("SSS",
this.dMd)}iwe.prototype.ha.call(this)},xie:function(a,b){if(a&&b){var c,d;try{c=kn(a),d=kn(b)}catch(f){R(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(c&&!window.isNaN(c.sid)&&!window.isNaN(c.cid)&&!window.isNaN(c.shapeId)&&this.ra.Ma()&&(a=new Date(c.c),b=c.c?(new Date).getTime()-c.c:-1,R(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",c.sid,c.cid,c.shapeId,c.t,b),(b=this.ra.Ma().RP(c.shapeId))&&
(Wn(uwe(this),b.get_shapeId())||c.t===M.EP.bfa.toString(1))))if(d&&!d.isTextConvertible)h$(this.Zv,b,!0,!0,!1);else{var e=this.Dt.Mxb(b.get_shapeId());if(e&&e.qDa&&(e=new tHb(b,e.O8),this.fa.jb(3825036569,2,e,null),!e.zDa))return;this.BHa(b)&&(d=d&&d.smartArtInfo?d.smartArtInfo.length:0,this.j9(this.ra.Ma(),b,d,c.t||"AugLoopDefault","",a))}}},Efg:function(a,b,c,d){b&&d&&d.ContextId&&d.Payload&&this.xie(d.ContextId,d.Payload)},K_c:function(){vwe(this,"SlideShowStarted")},RK:function(a,b){if(!this.Kf)R(26042393,
829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.NNa&&(b.sz.length||!this.Ia.kf()||"document"!==this.Ia.kf().Nd)){a=uwe(this);for(b=this.Dt.$$ge();b.$$mn();){var c=b.$$cu();c.$z&&!Array.contains(a,c.Hy())&&this.zF(c,"SelectionChanged")}this.LAd&&!Array.contains(a,this.Zv.Fja)&&(a=this.Zv,-1!==a.Fja&&a.ra.Ma()&&(b=a.ra.Ma().RP(a.Fja))&&h$(a,b,!0,!0,!1))}},she:function(a,b){this.Kf?(a=this.Dt.Mxb(b.DI.get_shapeId()))&&a.$z&&(b=a.Cu(),this.zF(a,"ShapePositionChanged"),
this.BHa(b)&&this.j9(this.ra.Ma(),b,0,"AugLoopRetrigger","ShapePositionChanged",null)):R(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Wfe:function(a,b){b.$Qa&&this.kN(b.Sh)},WI:function(){vwe(this,"SlideNavigation")},F9:function(a,b){if(b.TQa&&b.Lu){a=b.Lu;b=a.length;for(var c=0;c<b;++c){var d=this.Dt.Mxb(a[c]);d&&d.$z&&this.zF(d,"ShapePresence")}}},rhe:function(a,b){(a=this.Dt.rTa(b.nd))?jwe(this,b,a,this.ka):R(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",
b.nd)},Hge:function(){if(this.Kf)for(var a=this.Dt.$$ge();a.$$mn();){var b=a.$$cu();!b.G_b||b.$V||this.jc.$d(this.ra.Ed)||(wwe(b,!1),h$(this.Zv,b.Cu(),!0,!0,!1))}},BHa:function(a){var b=this.Dt.OGe();return 1<=b?(R(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",b),!1):iwe.prototype.BHa.call(this,a)},j9:function(a,b,c,d,e,f){try{var g=this.Dt.Mxb(b.get_shapeId());g&&this.zF(g,"NewSession");g=this.Dt.m5b(a,b.get_shapeId(),
d,e,this.ka);g.Xtb=f;xwe(g,"richEditTextUnicodeChanged"===d);this.Zv.zDb(g.nd);var h=ywe(this.YUe,g);R(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",g.nd,g.Cq.Pc(),g.Cq.Be(),g.Hy(),h);R(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",g.nd,c,Math.min(c,
this.ka.xLc),d);c&&this.ka.o4d&&(c=Math.min(c,this.ka.xLc),g.m4a(zwe(c)),mwe(g,c),kwe(g,!1),pwe(this.Zv,b));!h&&this.ka.B8&&nwe(this,g.nd,g.Hy(),[],"Pending")}catch(k){R(34152522,829,10,"GenerateSuggestion failed!! {0} ",k.message)}},kN:function(a){this.Kf?this.I8b(a)||vwe(this,"WebActionId:"+this.Hx.Lea(a)):R(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")},zF:function(a,b){if(!a.$V){if("NoSuggestions"===b)h$(this.Zv,a.Cu(),!0,!0,!1);else if(a.qDa){var c=
this.Zv,d=a.Cu(),e;this.LAd?(e=this.pa.Tb(),e=a.qDa&&Array.contains(e,a.Cu())):e=!1;h$(c,d,!0,"NewSession"!==b,e)}this.Dt.v8b(a,b);this.ka.B8&&nwe(this,a.nd,a.Hy(),a.Kv(),"NoResult")}}};function uwe(a){a=a.pa.Tb();var b=[];a&&Array.forEach(a,function(a){Array.add(b,a.get_shapeId())});return b}function vwe(a,b){for(var c=a.Dt.$$ge();c.$$mn();){var d=c.$$cu();a.zF(d,b)}}
function zwe(a){for(var b=Array(a),c=0;c<a;c++){var d;Array.add(b,(d=new U$c,d.index=c.toString(),d.labelText=ResourceStrings.l_Loading,d.imageData=null,d))}return b}function Awe(a,b){this.Pxd=window.Box4.App.hp;this.ka=a;this.ob=b}Awe.prototype={ka:null,ob:null,Pxd:null,Yra:!1};function Bwe(a,b){var c=new Si(2,1,550,function(){b()},0,null,!1,0);a.ob.Vb(c)}function Cwe(a,b){a.Yra=!0;a.Pxd=new Date;var c=new Si(2,1,a.ka.wLc,function(){a.Yra&&new Date-a.Pxd>=a.ka.wLc&&b()},0,null,!1,0);a.ob.Vb(c)}
function Dwe(a,b,c,d,e,f,g,h,k){this.qra=Function.createDelegate(this,this.Rua);this.FJd=Function.createDelegate(this,this.t6f);this.vV=Function.createDelegate(this,this.Ri);this.LY=a;this.Yc=b;this.Lo=c;this.wR=d;this.A2=e;this.Dc=g;this.ka=f;this.Eza=k}
Dwe.prototype={zY:null,eu:null,LY:null,Yc:null,Lo:null,wR:null,A2:null,Dc:null,Eza:null,ka:null,Kf:!1,B5b:function(){this.ka.JRa?this.eu.setAttribute("Src",this.Dc.Lk("BLUEBOLT_Deactivated.gif")):this.eu.style.opacity=".3";Cwe(this.Eza,this.vV)},N5b:function(){this.ka.JRa?this.eu.setAttribute("Src",this.Dc.Lk("BLUEBOLT_Reactivated.gif")):this.eu.style.opacity="initial";this.Eza.Yra=!1},xf:function(){this.ka.JRa?this.eu.setAttribute("Src",this.Dc.Lk("BLUEBOLT_Entrance.gif")):this.eu.setAttribute("Src",
this.Dc.Lk("LightningIdeasOOUI_blue_32x.png"))},Ri:function(){if(this.ka.JRa){this.eu.setAttribute("Src",this.Dc.Lk("BLUEBOLT_Exit.gif"));var a=this;Bwe(this.Eza,function(){a.LY.Ja.style.visibility="hidden"})}else this.eu.setAttribute("Src",""),this.LY.Ja.style.visibility="hidden"},Ro:function(){this.Kf||(this.LY?(this.zY=new EL,this.zY.Ja.style.visibility="inherit",this.zY.Ja.style.position="absolute",this.eu=VL(),this.eu.setAttribute("Unselectable","on"),this.eu.setAttribute("role","presentation"),
this.eu.className="gifFloatie",this.zY.Ja.appendChild(this.eu),this.LY.jf(this.zY),this.jva()):R(38072903,829,15,"parentElement is null"),this.Kf=!0)},t6f:function(a){var b;switch(this.ka.m7a){case 7:b="BLUEBOLT_Hover_on.gif";break;case 8:b="BLUEBOLT_HoverWhite_On.gif";break;default:b="BLUEBOLT_Hover_on.gif"}this.eu.setAttribute("Src",this.Dc.Lk(b));return this.A2(a)},Rua:function(){var a;switch(this.ka.m7a){case 7:a="BLUEBOLT_Hover_off.gif";break;case 8:a="BLUEBOLT_HoverWhite_Off.gif";break;default:a=
"BLUEBOLT_Hover_off.gif"}this.eu.setAttribute("Src",this.Dc.Lk(a));return!0},jva:function(){this.wR&&this.Yc.Wa("click",this.eu,this.wR);this.A2&&(this.Lo.Wa("msospPointerOver",this.eu,this.FJd),this.Lo.Wa("msospPointerOut",this.eu,this.qra))},C6c:function(){this.wR&&this.Yc.Sb("click",this.eu,this.wR);this.A2&&(this.Lo.Sb("msospPointerOver",this.eu,this.FJd),this.Lo.Sb("msospPointerOut",this.eu,this.qra))},ha:function(){this.Ri();this.C6c();this.Kf=!1}};function Ewe(){}
Ewe.prototype={J:null,mxd:!1,Mwd:!1,IO:!1,Xb:function(){return"PowerPointWebEditor.ReplaceObject"},wc:function(a){this.J=a;if(this.IO=this.J.H(vS,null).za.az){var b=this;C(D(this.J.ma(mK,null)),function(){return new mK(F.gf,b.J.H(iK,null),b.J.H(EK,null),b.J.H(KK,null),b.J.H(eK,null),b.J.H(Dd,null),b.J.H(md,null))})}C(D(lc(lc(lc(a.ma(Fwe,null),pbd),c3),obd)),function(){return new Fwe});C(D(a.ma(i$,null)),function(){return new i$(a.H(aM,null),a.H(wQ,null),a.H(GN,null))});C(D(a.ma(p7,null)),function(){return new Gwe(a.H(aM,
null),a.H(zd,null),a.H(xd,null),a.H(GN,null),a.H(dd,null),a.H(c3,null),a.H(g$,null),a.H(fK,null),a.H(ZR,null),a.H(cL,null),a.H(T,null),a.H(Fd,null))});C(D(a.ma(swe,null)),function(){return new Hwe(a.H(T,null),a.H(ZM,null),a.H(i$,null))});C(D(a.ma(Iwe,null)),function(){return new Iwe(a.H(swe,null),a.H(i$,null),a.H(GN,null),a.H(T,null))});C(D(a.ma(rwe,null)),function(){return new Jwe(a.H(i2,null),a.H(i$,null),a.H(T,null).zXd)});C(D(a.ma(g$,null)),function(){return a.H(md,null).ia(S(473))?new j$(function(b,
c,d,h,k,l){var m=new Kwe(a.H(i2,null),kc(a,T2));m.jFa(b,c,d,h,k,l);return m}):new k$(new Kwe(a.H(i2,null),kc(a,T2)))});C(D(a.ma(O$c,null)),function(){return a.H(md,null).ia(S(473))?new twe(kc(a,d3),kc(a,e3),a.H(cL,null),a.H(GN,null),a.H(mQ,null),a.H(hQ,null),a.H(EN,null),a.H(UM,null),a.H(dd,null),a.H(g$,null),a.H(obd,null),a.H(l$,null),a.H(i$,null),a.H(rwe,null),a.H(l2,null),a.H(W2,null),a.H(Iwe,null),a.H(fS,null),a.H(T,null),a.H(jK,null),a.H(Dd,null),a.H(GK,null),kc(a,T2)):new Lwe(a.H(cL,null),a.H(GN,
null),a.H(mQ,null),a.H(hQ,null),a.H(EN,null),a.H(UM,null),a.H(dd,null),a.H(g$,null),a.H(obd,null),a.H(l$,null),a.H(i$,null),a.H(i2,null),a.H(l2,null),a.H(W2,null),a.H(Iwe,null),a.H(fS,null),a.H(T,null),a.H(jK,null),a.H(Dd,null),a.H(GK,null),kc(a,T2))});C(D(a.ma(l$,null)),function(){return new l$(a.H(GN,null),a.H(fR.$$(uGb),null),a.H(fR.$$(vGb),null),a.H(g$,null),a.H(obd,null),a.H(i$,null),a.H(p7,null),a.H(cL,null),a.H(Yv,null).Eb(),a.H(ZM,null))});C(D(a.ma(Awe,null)),function(){return new Awe(a.H(T,
null),a.H(Dd,null))});C(D(a.ma(Mwe,null)),function(){return new Mwe(a.H(xd,null),a.H(zd,null),a.H(aM,null),a.H(mFd,null),a.H(T,null),a.H(sK,null),a.H(Awe,null))});C(D(a.ma(fR.$$(uGb),null)),function(){return new (lR.$$(uGb))(function(b,c){var d=null,h=window.$$as(tQ,Uy(b,a.H(Yv,null).Eb()));h&&!h.Hv()&&h.$r&&(d=new Nwe(b,h,c,a.H(Mwe,null),a.H(dd,null),a.H(aM,null),a.H(iR,null),a.H(g$,null),a.H(c3,null),a.H(T,null),a.H(p7,null)),d.Ro());return d})});C(D(a.ma(fR.$$(vGb),null)),function(){return new (lR.$$(vGb))(function(b,
c){var d=null,h=window.$$as(tQ,Uy(b,a.H(Yv,null).Eb()));h&&!h.Hv()&&h.$r&&(d=new Owe(b,h,c,a.H(Mwe,null),a.H(i$,null)),d.Ro());return d})});var c=this;C(D(lc(a.ma(Pwe,null),f3)),function(){return new Pwe(kc(c.J,d3),c.J.H(O$c,null),c.J.H(Iwe,null))});var d=this;C(D(a.ma(Qwe,null)),function(){return new Qwe(kc(d.J,e3),d.J.H(f3,null))});C(D(a.ma(m$,null)),function(){return new m$(a.H(UM,null),a.H(dd,null),a.H(cL,null),a.H(EN,null),a.H(GN,null),a.H(mQ,null),a.H(c3,null),a.H(fS,null),a.H(g$,null),a.H(BN,
null),a.H(l$,null),a.H($R,null),a.H(ZM,null))});C(D(a.ma(Rwe,null)),function(){return new Rwe(a.H(UM,null),a.H(fS,null),a.H(g$,null),a.H(GN,null),a.H(ZM,null),a.H(T,null),a.H(l$,null),a.H(i2,null),a.H(i$,null),a.H(W2,null),a.H(hQ,null),a.H(lQ,null),a.H(l2,null),a.H(jK,null),a.H(LK,null))})},ub:function(){this.IO&&this.J.H(mK,null);var a=this.J.H(md,null),b=this;a.Nf(function(){var c=new Date;a.fc("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?R(592232657,324,50,"PPTO TestEcsFeature Client Flight Enabled."):
R(592232655,324,50,"PPTO TestEcsFeature Client Flight Disabled.");b.mxd=a.ia(S(463));b.mxd&&(a.ia(S(499))&&b.J.H(Qwe,null).Qd(),b.J.H(p7,null).Ro(),b.J.H(l$,null).Ro(),b.J.H(m$,null).Ro(),b.J.H(O$c,null).Ro());b.Mwd=a.ia(S(676));b.Mwd&&(b.J.H(p7,null).Ro(),b.J.H(l$,null).Ro(),b.J.H(m$,null).Ro(),b.J.H(Rwe,null).Ro());R(40158946,829,50,"ReplaceObject::Callback duration:{0}",new Date-c)})},ha:function(){this.mxd&&(this.J.H(p7,null).ha(),this.J.H(O$c,null).ha(),this.J.H(l$,null).ha(),this.J.H(m$,null).ha());
this.Mwd&&(this.J.H(p7,null).ha(),this.J.H(l$,null).ha(),this.J.H(m$,null).ha(),this.J.H(Rwe,null).ha())}};
function Rwe(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v){this.wBc=Function.createDelegate(this,this.zUa);this.bhf=Function.createDelegate(this,this.x6f);this.UPa=Function.createDelegate(this,this.iAb);this.V7=Function.createDelegate(this,this.lea);this.kZ=Function.createDelegate(this,this.F9);this.GJd=Function.createDelegate(this,this.v6f);this.bId=Function.createDelegate(this,this.A2f);this.dId=Function.createDelegate(this,this.B2f);this.iP=Function.createDelegate(this,this.RK);this.HJd=Function.createDelegate(this,
this.w6f);this.xd=b;this.pa=a;this.Dt=c;this.ra=d;this.$a=e;this.ka=f;this.Zv=g;this.Cf=h;this.ur=k;this.eV=l;this.bI=m;this.Vaa=n;this.L3a=r;this.Hx=t;this.Ub=v}
Rwe.prototype={xd:null,ra:null,pa:null,Dt:null,$a:null,ka:null,Zv:null,Cf:null,ur:null,eV:null,bI:null,Vaa:null,L3a:null,Hx:null,Ub:null,Zr:null,NNa:!1,nv:function(){this.xd.qa.Ka("ISIU",this.HJd);uz(this.pa,this.iP);this.xd.qa.Ka("AROSBSR",this.dId);this.xd.qa.Ka("AROSASR",this.bId);this.xd.qa.Ka("IC",this.GJd);W3(this.eV,this.kZ);GFb(this.bI,this.V7);kSd(this.L3a,this.UPa)},A6c:function(){this.xd.qa.eb("ISIU",this.HJd);SC(this.pa,this.iP);this.xd.qa.eb("AROSBSR",this.dId);this.xd.qa.eb("AROSASR",
this.bId);this.xd.qa.eb("IC",this.GJd);this.eV.GUb.eb("SPC",this.kZ);this.bI.qa.eb("OBCSC",this.V7);this.L3a.Tjb.eb("MU",this.UPa)},ha:function(){this.A6c()},Ro:function(){this.nv()},B2f:function(){this.NNa=!0},A2f:function(){this.NNa=!1},v6f:function(a,b){b&&this.Zr&&this.Zr.ztb&&this.Zr.Cq.Pc()===b.gh.Pc()&&this.Zr.Cq.Be()===b.gh.Be()&&this.Zr.Hy()===b.Wu&&this.Zr.J8===b.dka&&(this.Zr.VLc=b.Y5a)},F9:function(a,b){if(b.TQa&&b.Lu&&this.Zr){a=b.Lu;b=a.length;for(var c=0;c<b;++c){var d=a[c];this.Zr.Hy()===
d&&this.oS("ShapePresence")}}},iAb:function(a,b){b.$Qa&&!this.I8b(b.Sh)&&this.oS("WebActionId:"+this.Hx.Lea(b.Sh))},I8b:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},lea:function(){if(this.Zr){var a=this.Zr.Cu(),b=UP(a);a&&b&&!this.Vaa.$d(b)&&(wwe(this.Zr,!1),h$(this.Zv,a,!0,!0,!1),this.Zr.Vtb=new Date,this.Zr.oS("SelectionChanged"))}},RK:function(){if(!this.NNa){var a=pU(this.pa.Tb());
if(a){if(this.Zr&&this.Zr.$z){if(sfe(a.bY(),this.Zr.bY()))return;this.oS("SelectionChanged")}this.BHa(a)&&this.j9(this.ra.Ma(),a,"SelectShape")}else this.Zr&&this.Zr.$z&&this.oS("SelectionChanged")}},j9:function(a,b,c){this.Zr=this.Dt.jFa(a,b.get_shapeId(),c,"",this.ka,b.get_smartArtModelId());kwe(this.Zr,!0);this.Zv.zDb(this.Zr.nd);R(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Zr.nd,this.Zr.Cq.Pc(),this.Zr.Cq.Be(),
this.Zr.Hy(),this.Zr.J8);var d=b.get_smartArtModelId()?UP(b):b;d?Pee(this.Cf,a.Be(),a.Pc(),d.get_shapeId(),Swe(d),Twe(d),b.get_smartArtModelId(),this.Zr.nd,c,this.bhf,this.wBc):R(38279305,829,15,"Parent ShapeNode of a {0} is null",b.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")},x6f:function(a){if(a&&a.SuggestionResult){var b=a.CorrelationId,c=this.Dt.rTa(b);if(c)if(c.$z){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a.SuggestionResult)}catch(d){R(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",
d)}if(b){c.m4a(Uwe(this,b));c.$7a=new Date;if(c.gRa){if(Vwe(this,c)){R(39184097,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",c.Dqb,this.ka.O1b);this.oS("ClientSuggestionTimeOut");return}R(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");mwe(c,c.Kv()?c.Kv().length:0);kwe(c,!1);pwe(this.Zv,c.Cu())}owe(this.Zv,c.nd)}else this.oS("ServerError"),R(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else R(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Zr?this.Zr.nd:"",b);else R(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",b)}else this.oS("ServerError"),R(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")},
zUa:function(a){this.oS("ServerError");R(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},BHa:function(a){return zM(this.Ub)?a.get_smartArtModelId()&&a.get_isSVGBlipFilled()?(a=UP(a),!!a&&!a.QL()):!1:!1},oS:function(a){this.Zr&&(h$(this.Zv,this.Zr.Cu(),!0,!0,!1),this.Dt.v8b(this.Zr,a),this.Zr=null)},S6b:function(a){return a?a.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+window.encodeURIComponent(a):
"data:image/png;base64,"+a:null},w6f:function(a,b){var c,d,e,f,g,h;b=b.u3;var k=c={val:c},l=d={val:d},m=e={val:e};a=f={val:f};k.val="";l.val=0;m.val=0;a.val=null;if(b){var n=b.split("|");if(4!==n.length)R(38279325,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+b.length),h=!1;else{k.val=n[0];l.val=window.parseInt(n[1]);m.val=Number.parseInvariant(n[2]);m=n[3];b=l.val;k=[];if(m&&b){for(l=0;l<b;++l)n=(h=new U$c,h.index=l.toString(),h.labelText=
"",h.imageData=null,h.renderData=null,h),Array.add(k,n);h=m.split(";");if(h.length-1!==b)R(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",k.length,b);else for(l=0;l<b;++l)m=h[l].indexOf(":"),0>m?R(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):k[l].labelText=h[l].substr(m+1)}a.val=k;h=!0}}else R(38279323,829,
50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),h=!1;(g=h,c=c.val,d=d.val,e=e.val,f=f.val,g)?(g=this.Dt.rTa(c))?g.$z&&g.gRa?(h=g.Cu(),e||(0>=d?(R(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",c),this.oS("NoSuggestions")):Vwe(this,g)?(R(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",g.Dqb,this.ka.O1b),this.oS("ClientSuggestionTimeOut")):(kwe(g,
!1),mwe(g,d),g.m4a(f),R(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",g.nd,g.K7a),pwe(this.Zv,h)))):R(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Zr?this.Zr.nd:"",c,g.$z,g.gRa):R(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",
c):R(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}};function Vwe(a,b){var c=new Date,d=b.O8;a=a.ka.O1b;return c&&d&&0<a&&c-d>a?(b.Dqb=c-d,!0):!1}function Uwe(a,b){var c=[];if(!b||!b.length)return c;for(var d=0;d<b.length;++d){var e,f=(e=new U$c,e.index=b[d].Index.toString(),e.labelText=b[d].Label,e.imageData=a.S6b(b[d].Render),e.renderData=a.S6b(b[d].Replace),e);Array.add(c,f)}return c}
function m$(a,b,c,d,e,f,g,h,k,l,m,n,r){this.RHd=Function.createDelegate(this,this.m1f);this.qOd=Function.createDelegate(this,this.Bog);this.d0e=Function.createDelegate(this,this.$Ff);this.kqb=Function.createDelegate(this,this.N6c);this.fa=b;this.Ia=c;this.ra=e;this.ji=d;this.jc=f;this.e7=g;this.Zv=m;this.Lb=n;this.$a=r;this.pa=a;this.xd=h;this.Dt=k;this.Cb=l}
m$.prototype={Ia:null,fa:null,ji:null,ra:null,jc:null,e7:null,pa:null,xd:null,Dt:null,Cb:null,Zv:null,Lb:null,$a:null,tAa:!1,Kf:!1,Ro:function(){this.Kf||(this.nv(),this.Wb(),this.Of(),this.Kf=!0)},ha:function(){this.Kf&&(this.A6c(),this.Kf=!1)},nv:function(){this.ji.qa.Ka("CH",this.kqb)},A6c:function(){this.ji.qa.eb("CH",this.kqb)},Wb:function(){this.fa.ua(4041021629,1,this.d0e,4);this.fa.ua(283636573,1,this.qOd,4);this.fa.ua(206307490,1,this.qOd,4);this.fa.ua(1534968859,1,this.RHd,4);this.fa.ua(2657104201,
1,this.RHd,4)},Of:function(){var a=this.Ia.$c("editing"),b=this.Ia.$c("document"),c=this.Ia.$c("EditingReplaceObjectSuggestionsGalleryFocus");a.kb(ag(13,2),206307490);b.kb(ag(13,2),206307490);c.kb(ag(13,2),206307490);c.kb(ag(27,0),206307490);c.kb(ag(37,0),1534968859);c.kb(ag(39,0),2657104201)},N6c:function(){this.tAa||R(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.tAa=!0},$Ff:function(a,b,c,d,e){if(!this.Kf)return R(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),
16;b=this.ra.Ed;if(!this.ra.Ma()||!b||this.jc.$d(b))return 16;if(1===c)return 32;c=!0;d=null;hea.isInstanceOfType(e)?d=e:fad.isInstanceOfType(e)&&(d=e.D3b,c=!1);e=new iN(BJ(d.ActiveSlideSid,d.ActiveSlideCid),d.ShapeId,d.SmartArtSubNodeId);var f=new qbd(e);this.e7.qa.Ha("ReplaceObjectBSA",f,null);var g=this.Dt.sTa(e);if(g&&g.Hy()===d.ShapeId){var h=null;1===g.$V&&(h=UP(g.Cu()));var k=this,l=this;e=this.Cb.qe(15,0,function(){1===g.$V||oQ(k.pa)||(Vee(k.xd),xR(k.pa),Wee(k.xd))},function(){h&&(Vee(l.xd),
l.pa.Hl(h,!0,!0),Wee(l.xd))},!1);try{e.Jc(b),e.xe(d.SmartArtSubNodeId?1095764407:a),TT(b,OXa,d),g.eZb=d.SuggestionSid,g.XCc=d.Label,g.wWb(!0),g.Wtb=new Date,R(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{e&&e.dispose()}g.PHc=!0;wwe(g,!0);c&&g.JWc();g.$V?h?this.jc.vka(b,h,this.Lb.Eb(),a):R(38854750,808,15,"Invalid smartArtShape"):this.jc.mu(b,a)}else R(33863682,808,15,"Couldn't find active replaceObjectContext");
return 32},Bog:function(a,b,c,d,e){if(!this.Kf)return R(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;b=this.ra.Ed;if(!this.ra.Ma()||!b||this.jc.$d(b))return 16;if(1===c)return 32;c=null;b=0;if(283636573===a){a=window.$$as(ubd,e);if(!a)return 16;c=a.shape;b=a.action}else if(206307490===a){a=this.pa.Tb();if(1!==a.length)return 32;c=a[0]}if(!c)return R(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),
16;a=this.Dt.sTa(c.bY());if(!a||!this.tAa&&a&&!a.$V)return 2;if(a&&a.$z&&a.Hy()===c.get_shapeId())switch(US(this.pa),this.Ia.ne(),b){case 0:e=this.Zv;a=a.nd;e.Kf?e.Uz.lf()?((c=e.Dt.rTa(a))&&c.$z&&c.nd===a&&e.lyb(c.Cu()),Wwe(e,c.Cu())):Xwe(e,a):R(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup");break;case 1:this.Zv.Uz.lf()||Xwe(this.Zv,a.nd);break;case 2:Wwe(this.Zv,c)}return 32},m1f:function(a,b,c){if(!this.Kf)return R(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),
16;b=this.ra.Ed;if(!this.ra.Ma()||!b||this.jc.$d(b))return 16;if(1===c)return 32;if(!this.Zv.Uz.lf())return 16;if(1534968859===a){a=this.Zv;if(a.Kf){if(c=Ywe(a.Uz))-1===c?a.Uz.qv(0,!0):(a.Uz.qv(c,!1),a.Uz.qv(c-1,!0))}else R(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup");return 32}return 2657104201===a?(a=this.Zv,a.Kf?(c=Ywe(a.Uz),b=a.Uz,b.Kf?b=b.byc:(R(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),
b=0),c+1!==b&&(-1===c?a.Uz.qv(0,!0):(a.Uz.qv(c,!1),a.Uz.qv(c+1,!0)))):R(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup"),32):16}};function Qwe(a,b){this.xM=a;this.vqc=b}Qwe.prototype={xM:null,vqc:null,Qd:function(){var a=this;this.xM.pb(function(b){b.vBb(a.vqc.OE(),a.vqc.Nhb(),a.vqc.Jib(),null)})}};function Kwe(a,b){this.ZAc=Function.createDelegate(this,this.aAb);this.T2a=[];this.Cf=a;this.V0a=b;this.Fd()}
Kwe.prototype={Cf:null,V0a:null,T2a:null,ka:null,jFa:function(a,b,c,d,e,f){this.$z&&this.oS("NewSession");if(!a)throw Error.argumentNull("slide");var g=Zee(a,new iN(a?a.gc():null,b,f));if(!g)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",b));this.Cq=a;this.DI=g;this.Wu=b;this.J8=f;this.nd=Ae().toString();this.$z=!0;this.dy=c;this.ELc=d;this.ka=e;this.O8=new Date;a=this.DI;this.$V=this.ka.wTd&&a&&this.J8&&a.get_isSVGBlipFilled()?1:0;return this.nd},
m5b:function(a,b,c,d,e){return this.jFa(a,b,c,d,e,null)},oS:function(a){if(this.$z&&(!this.T2a||!Array.contains(this.T2a,this.nd))){var b={};b.SuggestionCount=this.K7a;b.ClientSuggestionTimeoutInMs=this.Dqb;b.IsApplied=this.qP;b.AppliedSuggestionId=this.qP?this.eZb.toString():"";b.AppliedSuggestionLabel=this.qP?this.XCc:"";b.IsFloatieShown=this.vGc;b.IsGalleryShown=this.zGc;b.Trigger=this.dy;b.RetriggerReason=this.ELc;b.ResetReason=a;b.IconId=this.ka.m7a;b.SlideCID=this.Cq.Be();b.SlideSID=this.Cq.Pc();
b.ShapeID=this.Wu;b.AnimId=this.ka.uLc;b.AnimEnabled=this.ka.JRa;b.GalleryHoverEnabled=this.ka.vLc;b.ReplaceSuggestionType=Nba.toString(this.$V);b.SeeMoreButtonClicked=this.ztb;b.SeeMoreIconName=this.ztb?this.VLc:"";this.O8&&(b.SessionLiveTimeInMs=new Date-this.O8);this.J8&&(b.SmartArtSubNodeId=this.J8);this.fta&&this.$7a&&this.$7a>this.fta&&(b.SuggestionsReadyInMs=this.$7a-this.fta);0<this.Ktb&&(b.SuggestionsDisplayedForMs=this.Ktb);0<this.L5a&&(b.FloatieDisplayedForMs=this.L5a);this.fta&&this.O8&&
this.fta>this.O8&&(b.FloatieReadyInMs=this.fta-this.O8);this.O8&&this.Xtb&&this.O8>this.Xtb&&(b.TriggeredByAugLoopInMs=this.O8-this.Xtb);this.Wtb&&this.Vtb&&this.Vtb>this.Wtb&&(b.SuggestionAppliedInMs=this.Vtb-this.Wtb);if(0<this.aW.length){a=[];for(var c=0;c<this.aW.length;c++)Array.add(a,this.aW[c].labelText);b.SuggestionLabels=JSON.stringify(a)}1===this.$V&&this.ORa&&(a=Oh(this.ORa))&&a.hasChildNodes()&&(dma(),a=this.ORa,jn.removeChild(yBa[a]),yBa[a]=null);Oee(this.Cf,this.nd,JSON.stringify(b),
this.ZAc);b=this.nd;this.T2a&&!Array.contains(this.T2a,b)&&(Array.add(this.T2a,b),R(25012102,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",b,this.T2a.length))}this.Fd()},Fd:function(){this.$z=!1;this.Cq=null;this.PHc=this.zGc=this.vGc=this.G_b=this.qP=this.qDa=!1;this.ELc=this.dy=this.nd="";this.aW=[];this.eZb=0;this.XCc="";this.gRa=!1;this.Dqb=this.K7a=0;this.Vtb=this.Wtb=this.XMc=this.$7a=this.Ztb=this.fta=this.Xtb=this.O8=null;this.$V=
this.L5a=this.Ktb=0;this.ORa="";this.DI=null;this.ztb=!1;this.VLc=""},aAb:function(a){R(37586196,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",a.HttpStatusCode);return!0},JWc:function(){Zwe(this,2,4)},Cq:null,DI:null,Cu:function(){return this.DI},Wu:0,Hy:function(){return this.Wu},J8:null,$V:0,qDa:!1,eZb:0,XCc:null,qP:!1,wWb:function(a){return this.qP=a},G_b:!1,vGc:!1,zGc:!1,O8:null,Xtb:null,fta:null,Ztb:null,$7a:null,XMc:null,Wtb:null,
Vtb:null,Ktb:0,L5a:0,nd:null,dy:null,ELc:null,gRa:!1,aW:null,Kv:function(){return this.aW},m4a:function(a){return this.aW=a},K7a:0,Dqb:0,PHc:!1,ORa:null,ztb:!1,VLc:null,$z:!1,bY:function(){return new iN(this.Cq?this.Cq.gc():null,this.Wu,this.J8)}};function mwe(a,b){a.K7a=b}function kwe(a,b){a.gRa=b}function wwe(a,b){a.G_b=b}function xwe(a,b){a.qDa=b}
function Zwe(a,b,c){a.V0a&&a.V0a.pb(function(a){var e,f=(e=new Mbd,e.cardId="EntityGroup.Designer.TextToSmartArt.Suggestion",e.actionType=b,e.actionEngagement=c,e);a.A9b(f)})}function Fwe(){this.qa=new re}Fwe.prototype={Jie:function(a){this.qa.Ha("ReplaceObjectSPOver",a,null)},Iie:function(a){this.qa.Ha("ReplaceObjectSPOut",a,null)}};
function $we(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.KXb=Function.createDelegate(this,this.rab);this.vV=Function.createDelegate(this,this.Ri);this.LY=a;this.mR=b;this.YNe=c;this.cOe=d;this.Qvd=n.m7a;this.Npd=n.uLc;this.Opd=n.JRa;this.xba=f;this.vOa=e;this.Yc=g;this.Lo=h;this.wR=k;this.A2=l;this.vk=m;this.pXe=r;this.Eza=t;this.Kf=!1}
$we.prototype={Gu:null,mR:0,YNe:null,cOe:null,Qvd:0,Npd:0,xba:null,vOa:null,Yc:null,Lo:null,wR:null,A2:null,vk:null,LY:null,Opd:!1,pXe:0,Eza:null,eu:null,tnd:function(){return 1===this.pXe?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.Eza.Yra?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip},Kf:!1,Ro:function(){this.Kf||(this.Gu=new EL,this.eu=new uFd(this.vOa.vk),this.Gu.Ja.style.visibility="inherit",this.KEa(),this.Kf=!0)},B5b:function(){Cwe(this.Eza,
this.vV);this.QEa();this.sCb(!1);Sys.UI.DomElement.containsCssClass(this.Gu.Ja,"replaceObjectGrayedFlyoutAnchor")||GL(this.Gu,"replaceObjectGrayedFlyoutAnchor")},xf:function(){this.Kf?this.sCb(this.Opd):R(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")},N5b:function(){this.Eza.Yra=!1;this.QEa();this.sCb(!1);dSd(this.Gu,"replaceObjectGrayedFlyoutAnchor")},sCb:function(a){this.Kf?this.eu.Gbb(axe(this,a),""):R(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")},
QEa:function(){this.Kf?(this.eu.Qe(),rV(this.Gu.Ja,"replaceObjectFlyoutAnchorBase"),rV(this.Gu.Ja,"replaceObjectFlyoutAnchor"+this.Qvd),this.Opd&&(rV(this.Gu.Ja,"replaceObjectFlyoutAnchorAnimBase"),rV(this.Gu.Ja,"replaceObjectFlyoutAnchorAnim"+this.Npd))):R(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")},ha:function(){this.Kf&&(this.C6c(),this.Gu&&this.Gu.Ja.parentNode&&this.Gu.ns(),this.Ri(),this.eu.ha(),this.Gu=null,this.Kf=!1)},Ri:function(){this.Kf?(this.QEa(),
this.LY.Ja.style.visibility="hidden"):R(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")},KEa:function(){this.LY?(this.Gu.Ja.style.width=this.vk.h0(this.mR),this.Gu.Ja.style.height=this.vk.h0(this.mR),this.Gu.Ja.setAttribute("role","button"),this.LY.jf(this.Gu),this.eu.KEa(this.Gu.Ja),this.jva()):R(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")},rab:function(){return!0},jva:function(){this.wR&&this.Yc.Wa("click",this.Gu.Ja,this.wR);this.Yc.Wa("dblclick",
this.Gu.Ja,this.KXb);this.A2&&(this.Lo.Wa("msospPointerOver",this.Gu.Ja,this.A2),this.Lo.Wa("msospPointerOver",this.Gu.Ja.firstChild,this.A2),this.Lo.Wa("msospPointerOver",this.Gu.Ja.firstChild.firstChild,this.A2))},C6c:function(){this.wR&&this.Yc.Sb("click",this.Gu.Ja,this.wR);this.Yc.Sb("dblclick",this.Gu.Ja,this.KXb);this.A2&&(this.Lo.Sb("msospPointerOver",this.Gu.Ja,this.A2),this.Lo.Sb("msospPointerOver",this.Gu.Ja.firstChild,this.A2),this.Lo.Sb("msospPointerOver",this.Gu.Ja.firstChild.firstChild,
this.A2))}};function axe(a,b){var c=a.xba.Y$d(a.mR,a.mR,a.YNe,a.cOe,a.tnd(),null);eM(a.Gu.Ja,"replaceObjectFlyoutAnchorBase");eM(a.Gu.Ja,"replaceObjectFlyoutAnchor"+a.Qvd);b&&(eM(a.Gu.Ja,"replaceObjectFlyoutAnchorAnimBase"),eM(a.Gu.Ja,"replaceObjectFlyoutAnchorAnim"+a.Npd));return c}function Lwe(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O){this.wBc=Function.createDelegate(this,this.zUa);Lwe.initializeBase(this,[f,a,b,c,d,e,g,h,k,l,m,r,t,v,x,z,E,H,O]);this.mh=h.pce();this.Cf=n;this.ka=y}
Lwe.prototype={mh:null,Cf:null,ka:null,RK:function(a,b){if(!this.Kf)R(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.NNa&&b.sz.length)if(a=this.pa.Tb(),1!==a.length)this.mh.$z&&this.zF(this.mh,"SelectionChanged");else{a=a[0];if(this.mh.$z){if(this.mh.Hy()===a.get_shapeId())return;this.zF(this.mh,"SelectionChanged")}this.BHa(a)&&this.j9(this.ra.Ma(),a,"SelectShape","")}},she:function(a,b){this.Kf?this.mh.$z&&this.mh.Cu()===b.DI&&(a=this.mh.Cu(),this.zF(this.mh,
"ShapePositionChanged"),this.BHa(a)&&this.j9(this.ra.Ma(),a,"Retrigger","ShapePositionChanged")):R(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Wfe:function(a,b){b.$Qa&&this.kN(b.Sh)},WI:function(){this.mh.$z&&this.zF(this.mh,"SlideNavigation")},F9:function(a,b){this.mh.$z&&b.TQa&&b.Lu&&Array.contains(b.Lu,this.mh.Hy())&&this.zF(this.mh,"ShapePresence")},rhe:function(a,b){b.nd!==this.mh.nd?R(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.mh.nd,b.nd):jwe(this,b,this.mh,this.ka)},Hge:function(){this.Kf&&this.mh.G_b&&!this.mh.$V&&!this.jc.$d(this.ra.Ed)&&(wwe(this.mh,!1),h$(this.Zv,this.mh.Cu(),!0,!0,!1))},j9:function(a,b,c,d){try{var e=this.mh.m5b(a,b.get_shapeId(),c,d,this.ka);kwe(this.mh,!0);this.Zv.zDb(this.mh.nd);Nee(this.Cf,a.Be(),a.Pc(),b.get_shapeId(),e,c,Swe(b),Twe(b),null,this.wBc);this.ka.B8&&nwe(this,e,this.mh.Hy(),this.mh.Kv(),"Pending")}catch(f){R(34152532,829,15,"GenerateSuggestion failed!! {0} ",f.message)}},zUa:function(a){R(36966422,
829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},kN:function(a){this.Kf?this.mh.$z&&!this.I8b(a)&&this.zF(this.mh,"WebActionId:"+this.Hx.Lea(a)):R(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")},zF:function(a,b){a.qDa&&h$(this.Zv,a.Cu(),!0,!0,!1);a.oS(b);this.ka.B8&&nwe(this,a.nd,a.Hy(),a.Kv(),"NoResult")}};function j$(a){this.zBa=[];this.$$ge=this.GetEnumerator;this.WUe=a}
j$.prototype={WUe:null,v8b:function(a,b){a&&(a.oS(b),Array.remove(this.zBa,a))},rTa:function(a){for(var b=this.zBa,c=b.length,d=0;d<c;++d){var e=b[d];if(e.nd===a)return e}return null},sTa:function(a){for(var b=this.zBa,c=b.length,d=0;d<c;++d){var e=b[d];if(sfe(a,e.bY()))return e}return null},Mxb:function(a){a:{for(var b=this.zBa,c=b.length,d=0;d<c;++d){var e=b[d];if(e.Hy()===a&&!e.J8){a=e;break a}}a=null}return a},pce:function(){return 0<this.zBa.length?this.zBa[0]:null},jFa:function(a,b,c,d,e,f){var g=
this.sTa(new iN(a.gc(),b,f));g&&this.v8b(g,"NewSession");g=this.WUe(a,b,c,d,e,f);Array.add(this.zBa,g);return g},m5b:function(a,b,c,d,e){return this.jFa(a,b,c,d,e,null)},OGe:function(){var a=0;Array.forEach(this.zBa,function(b){b.$z&&a++});return a}};j$.prototype.GetEnumerator=function(){return new (n$.$$(N4d))(this.zBa)};j$.prototype.GetEnumerator=j$.prototype.GetEnumerator;
function n$(a){this.yt=-1;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.nqc=Array.clone(a)}
n$.$$=function(a){var b=j$.__tc=j$.__tc||{},c="ArrayEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];n$.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.__tc."+c,null,Sys.IC);d.prototype.Qb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.ArrayEnumerator$1":{T:a},ctor:n$};a=n$.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==
f.key&&(d.prototype[f.key]=f.value)}}return b[c]};n$.prototype={nqc:null};n$.prototype.$k=function(){if(-1===this.yt||this.yt>=this.nqc.length)throw Error.invalidOperation();return this.nqc[this.yt]};n$.prototype.get_Current=n$.prototype.$k;n$.prototype.jd=function(){this.yt++;return this.yt<this.nqc.length};n$.prototype.MoveNext=n$.prototype.jd;n$.prototype.Fd=function(){this.yt=-1};n$.prototype.Reset=n$.prototype.Fd;
function l$(a,b,c,d,e,f,g,h,k,l){this.iLd=Function.createDelegate(this,this.T9f);this.jLd=Function.createDelegate(this,this.U9f);this.tId=Function.createDelegate(this,this.Z2f);this.ra=a;this.MAd=b;this.ZUe=c;this.ur=f;this.Gia=e;this.Dt=d;this.Uz=g;this.Ia=h;this.ge=k;this.$a=l;this.Kf=!1;this.Fja=-1}
l$.prototype={ra:null,MAd:null,ZUe:null,Gia:null,Dt:null,Uz:null,ur:null,$a:null,Ia:null,ge:0,Kf:!1,Fja:0,Ro:function(){this.Kf||(this.Gia.qa.Ka("ReplaceObjectBSA",this.tId),this.Gia.qa.Ka("ReplaceObjectSPOver",this.jLd),this.Gia.qa.Ka("ReplaceObjectSPOut",this.iLd),this.Kf=!0)},ha:function(){this.Kf&&(this.Gia.qa.eb("ReplaceObjectBSA",this.tId),this.Gia.qa.eb("ReplaceObjectSPOver",this.jLd),this.Gia.qa.eb("ReplaceObjectSPOut",this.iLd),this.Kf=!1)},Z2f:function(a,b){if(!this.ra.Ma())throw Error.argumentNull("ActiveSlide is null");
(a=Zee(this.ra.Ma(),b.s5d))&&h$(this,a,!1,!0,!1)},U9f:function(a,b){this.ra.Ma()&&(a=new iN(this.ra.Ma().gc(),b.Wu,b.dka),(a=Zee(this.ra.Ma(),a))&&this.e5c(a,b.CTd))},T9f:function(a,b){this.ra.Ma()&&(a=new iN(this.ra.Ma().gc(),b.Wu,b.dka),(a=Zee(this.ra.Ma(),a))&&this.lyb(a))},e5c:function(a,b){var c=a;a.get_smartArtModelId()&&(c=UP(a));if(a=bxe(this,c))cxe(this,c,!1),a.e5c(b)},lyb:function(a){var b=a;a.get_smartArtModelId()&&(b=UP(a));if(a=bxe(this,b))cxe(this,b,!0),a.lyb()},zDb:function(a){this.Uz.zDb(a)}};
function cxe(a,b,c){b&&(a=window.$$as(tQ,Uy(b,a.ge)))&&((a=a.Zc())?a.pe(c):R(25306516,829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}function owe(a,b){a.Kf?a.Uz.lf()&&Xwe(a,b):R(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}
function Xwe(a,b){var c=a.Dt.rTa(b);if(c&&c.nd===b&&c.$z){var d=dxe(a,c.Cu());if(d){var e=d.Ee();e?a.Uz.lf()&&a.Uz.mh&&!sfe(a.Uz.mh.bY(),c.bY())||(e=a.ur.nu(e),a.Uz.xf(b,e.x,e.y),d.Ee().style.zIndex=G().CJ(),DT(a.Ia,"EditingReplaceObjectSuggestionsGalleryFocus",!0),c.zGc=!0):R(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else R(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}
function Wwe(a,b){a.Uz.lf()&&a.Uz.mh&&sfe(a.Uz.mh.bY(),b.bY())&&(a.Uz.Ri(),(b=dxe(a,a.Uz.mh.Cu()))&&b.Ee()&&(b.Ee().style.zIndex=0),DT(a.Ia,"EditingReplaceObjectSuggestionsGalleryFocus",!1))}
function h$(a,b,c,d,e){a.Kf?b&&(c&&a.lyb(b),d&&Wwe(a,b),c=dxe(a,b))&&(e?(c.B5b(),a.Fja=b.get_shapeId()):(a.Fja===b.get_shapeId()&&(a.Fja=-1),c.rj()&&c.Ri(),(a=a.Dt.sTa(b.bY()))&&b.get_shapeId()===a.Hy()&&xwe(a,!1))):R(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}
function pwe(a,b){if(!a.Kf)R(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(b){var c;if(c=b&&window.$$as(tQ,Uy(b,a.ge))?WU(a.MAd,b):null){var d=a.Dt.sTa(b.bY());if(d&&(!d.qDa||a.Fja===d.Hy())){if(d.qDa)a.Fja===d.Hy()&&(c.N5b(),a.Fja=-1);else{var e=!(a.Uz.mh&&a.Uz.lf()&&sfe(b.bY(),a.Uz.mh.bY()));h$(a,b,!0,e,!1);c.Jka()}xwe(d,!0)}}}}function dxe(a,b){return b&&window.$$as(tQ,Uy(b,a.ge))?a.MAd.lH(b):null}
function bxe(a,b){return b&&!b.get_smartArtModelId()&&window.$$as(tQ,Uy(b,a.ge))?WU(a.ZUe,b):null}function exe(a,b){this.Gk=a;this.vk=b;this.Kf=!1}
exe.prototype={vk:null,Gk:null,Kf:!1,XG:null,Ro:function(){this.Kf||(this.XG=new EL,this.KEa(),this.Kf=!0)},KEa:function(){this.Gk?(this.Gk.appendChild(this.XG.Ja),eM(this.XG.Ja,"replaceObjectPreviewContainer"),this.XG.Gf(!1)):R(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")},Gbb:function(a){if(this.Kf){if(a=this.hFa(a))this.$Ua(),this.XG.Ja.appendChild(a),this.XG.Gf(!0)}else R(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")},vi:function(a,
b){this.Kf?this.XG.vi(a,b):R(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")},ha:function(){this.Kf&&(this.Ri(),this.XG&&this.XG.Ja.parentNode&&(this.XG.ns(),rV(this.XG.Ja,"replaceObjectPreviewContainer")),this.XG=null)},Ri:function(){this.Kf?(this.$Ua(),this.XG.Gf(!1)):R(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")},hFa:function(a){if(a){var b=VL();b.setAttribute("Unselectable","on");b.src=a;b.style.height="100%";b.style.width="100%";
return b}return null},$Ua:function(){this.XG.Ja.firstChild&&this.XG.Ja.removeChild(this.XG.Ja.firstChild)}};function fxe(){}fxe.prototype={RCb:0,sle:0,BCb:0,Sab:null,F0c:0};function Jwe(a,b,c){this.h3a=[];this.Cf=a;this.ur=b;this.Iqd=c}Jwe.prototype={Cf:null,ur:null,Iqd:!1};function gxe(a,b){Array.remove(a.h3a,b);b.Sab&&b.Sab.$z&&(R(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",b.Sab.nd,b.F0c-1),ywe(a,b.Sab))}
function ywe(a,b){var c=hxe(a,b.Cq.Pc(),b.Cq.Be(),b.Hy());if(c)return c.Sab=b,c.F0c++,1;var d,e=(d=new fxe,d.RCb=b.Cq.Pc(),d.sle=b.Cq.Be(),d.BCb=b.Hy(),d.F0c=0,d.Sab=null,d);Array.add(a.h3a,e);kwe(b,!0);c=b.nd;d=b.Cq;var f=b.Cu();Nee(a.Cf,d.Be(),d.Pc(),f.get_shapeId(),c,b.dy,a.Iqd?Swe(f):ixe(a.ur,f),a.Iqd?Twe(f):jxe(a.ur,f),function(){gxe(a,e)},function(b){gxe(a,e);R(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",b.HttpStatusCode);
return!0});return 0}function hxe(a,b,c,d){for(var e=0;e<a.h3a.length;e++)if(a.h3a[e].RCb===b&&a.h3a[e].sle===c&&a.h3a[e].BCb===d)return a.h3a[e];return null}function k$(a){this.$$ge=this.GetEnumerator;this.mh=a}
k$.prototype={mh:null,v8b:function(a,b){a&&a===this.mh&&a.oS(b)},rTa:function(){return this.mh},sTa:function(){return this.mh},Mxb:function(){return this.mh},pce:function(){return this.mh},jFa:function(a,b,c,d,e,f){this.mh.jFa(a,b,c,d,e,f);return this.mh},m5b:function(a,b,c,d,e){return this.jFa(a,b,c,d,e,null)},OGe:function(){return this.mh.$z?1:0}};k$.prototype.GetEnumerator=function(){return new (o$.$$(N4d))(this.mh)};k$.prototype.GetEnumerator=k$.prototype.GetEnumerator;
function o$(a){this.yAa=this.Qb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Number||Type.isEnum(this.Qb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T)?0:this.Qb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Boolean?!1:null;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.yAa=a}
o$.$$=function(a){var b=k$.__tc=k$.__tc||{},c="SingleEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];o$.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.__tc."+c,null,Sys.IC);d.prototype.Qb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1":{T:a},ctor:o$};a=o$.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==
f.key&&(d.prototype[f.key]=f.value)}}return b[c]};o$.prototype={Fwd:!0};o$.prototype.$k=function(){return this.yAa};o$.prototype.get_Current=o$.prototype.$k;o$.prototype.jd=function(){return this.Fwd?(this.Fwd=!1,!0):!1};o$.prototype.MoveNext=o$.prototype.jd;o$.prototype.Fd=function(){this.Fwd=!0};o$.prototype.Reset=o$.prototype.Fd;function Owe(a,b,c,d,e){this.dispose=this.ha;this.Sz=a;this.fM=b;this.gR=c;this.ur=e;this.vOa=d;this.Kf=!1}
Owe.prototype={Sz:null,fM:null,gR:null,ur:null,vOa:null,nba:null,Urd:!1,hnb:!1,Aia:null,dW:!1,rj:function(){return this.dW},hf:function(a){return this.dW=a},Kf:!1,Ro:function(){if(!this.Kf){this.Aia=new EL;var a=new exe(this.Aia.Ja,this.vOa.vk);a.Ro();this.nba=a;this.fM&&!this.fM.Hv()&&this.fM.$r&&(this.fM.$r.jf(this.Aia),this.pe(!1),this.hnb=!0,TQ(this.fM,this,3),this.dW=KQ(this.fM)||this.fM.Hw());this.Kf=!0}},Mm:function(){R(25306526,829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")},
QC:function(){},$w:function(){if(!this.Kf)return R(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.Urd||!this.nba.Kf||!this.nba.XG)return null;var a=JL(this.nba.XG.Ja.style.left),b=JL(this.nba.XG.Ja.style.top),c=JL(this.nba.XG.Ja.style.width),d=JL(this.nba.XG.Ja.style.height);return new mJ(new pJ(a,b),new pJ(a+c,b),new pJ(a+c,b+d),new pJ(a,b+d))},xB:function(){return!1},hx:function(){},ez:function(){},te:function(){},$j:function(){this.hnb=
!0;this.Nt()},pq:function(){this.hnb=!0;this.Nt()},uu:function(){this.hnb=!0;this.Nt()},vs:function(a){this.Aia&&this.Aia.eE(a)},ry:function(){},dx:function(){return null},MC:function(){return[]},uB:function(){},ha:function(){this.gR();this.Kf&&(this.nba.ha(),this.Aia.Ja.parentNode&&this.Aia.ns(),this.Aia=null,this.Kf=!1)},e5c:function(a){this.Kf?(this.sCb(a),this.Nt()):R(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")},lyb:function(){this.Kf?this.QEa():
R(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")},sCb:function(a){this.Kf?(this.nba.Gbb(a),this.pe(!0)):R(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")},QEa:function(){this.Kf?(this.nba.Ri(),this.pe(!1)):R(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")},Hd:function(){},Nt:function(){if(this.Urd&&this.hnb){var a=ixe(this.ur,this.Sz),b=jxe(this.ur,this.Sz);this.vi(a,b);
if(this.Aia){a=this.Sz;if(!a)throw Error.argumentNull("shape");a=X4d(a);a=QJ(kxe(a.TopLeft),kxe(a.TopRight));dza(this.Aia.Ja,Ah(a))}this.hnb=!1}},pe:function(a){this.Urd=a;this.Aia.pe(a)},vi:function(a,b){this.nba&&this.nba.vi(a,b)}};
function Gwe(a,b,c,d,e,f,g,h,k,l,m){this.tpb=Function.createDelegate(this,this.jAb);this.gBc=Function.createDelegate(this,this.yZc);this.iBc=Function.createDelegate(this,this.AZc);this.hBc=Function.createDelegate(this,this.zZc);this.N4a=Function.createDelegate(this,this.lAb);this.M4a=Function.createDelegate(this,this.kAb);this.nF=Function.createDelegate(this,this.EW);this.qK=Function.createDelegate(this,this.FW);this.uXb=Function.createDelegate(this,this.aVc);this.Aq=Function.createDelegate(this,
this.oz);this.UJd=Function.createDelegate(this,this.i7f);this.cvd=-1;this.vk=a;this.Yc=c;this.Lo=b;this.ra=d;this.fa=e;this.uq=k;this.e7=f;this.Dt=g;this.EO=h;this.Ia=l;this.ka=m;this.tWe=!ji();this.Kf=this.AI=!1}
Gwe.prototype={Ia:null,vk:null,Yc:null,Lo:null,ra:null,fa:null,e7:null,Dt:null,EO:null,uq:null,ka:null,tWe:!1,yo:null,P2:null,uOa:null,j2:null,rOa:null,byc:0,mh:null,Kf:!1,AI:!1,lf:function(){return this.AI},Ro:function(){this.Kf||(this.yo=iM(),this.yo.setAttribute("Unselectable","on"),this.yo.style.position="absolute",eM(this.yo,"replaceObjectContainer"),lxe(this,null),document.body.appendChild(this.yo),this.jva(),this.uq.wS("EditingReplaceObjectSuggestionsGalleryFocus","main",this.yo,function(){},
function(){},!0,null),this.Kf=!0)},ha:function(){this.Kf&&(this.Ri(),this.z6c(),this.yo&&this.yo.parentNode&&this.yo.parentNode.removeChild(this.yo),this.Kf=!1)},Ri:function(){this.Kf?(G().JP(!0),this.Gf(!1),S4(this).style.display="none",S4(this).style.zIndex=-1,this.rOa=this.j2=null,lxe(this,null)):R(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")},xf:function(a,b,c){if(!this.Kf)R(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");
else if(a){var d=this.Dt.rTa(a);if(d&&d.nd===a&&d.$z&&!d.gRa){this.mh=d;var e=this.mh.Kv();lxe(this,a);if(a)if(e&&e.length){d=document.createElement("ul");d.id=a;d.setAttribute("Unselectable","on");d.setAttribute("role","menu");eM(d,"replaceObjectSuggestionsList");this.j2||(this.j2=new (Da.$$(String)));this.rOa||(this.rOa=new (Da.$$(String)));a=e.length;for(var f=0;f<a;++f){var g=e[f];!g.imageData||this.j2.ea(g.index,g.imageData);p$(this)&&g.renderData&&this.rOa.ea(g.index,g.renderData);var h=g.index,
g=g.labelText,k=this.j2.hc(h),l=k?this.j2.K(h):dg("progress.gif");k||R(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");var m=VL();m.setAttribute("Unselectable","on");m.src=l;m.title=g;m.setAttribute("role","presentation");eM(m,"replaceObjectSuggestionThumbnail");l=kM();l.id="ROS_"+h;l.setAttribute("Unselectable","on");l.title=g;l.setAttribute("role","none");var n=p$(this)?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.mh.qP&&this.mh.eZb.toString()===
h&&(n+="Selected");eM(l,n);k||eM(l,"ReplaceObjectSuggestionLoading");l.appendChild(m);h=document.createElement("li");h.setAttribute("Unselectable","on");h.setAttribute("tabindex","-1");h.setAttribute("role","presentation");h.setAttribute("aria-label",g);h.appendChild(l);d.appendChild(h)}if(this.tWe&&0<this.rOa.Qa()&&p$(this)&&(this.mh.ORa||(e=this.mh,a=wl().toString(),e.ORa=a),(e=Oh(this.mh.ORa))&&!e.hasChildNodes())){e.style.position="absolute";e.style.left="0px";e.style.top="0px";for(a=this.rOa.Iy().$$ge();a.$$mn();)f=
a.$$cu(),h=VL(),h.src=f,h.style.display="block",h.style.position="absolute",e.appendChild(h);cma()}}else R(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),d=null;else R(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),d=null;d&&(e=jM(),e.setAttribute("Unselectable","on"),p$(this)?(e.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,eM(e,"replaceIconObjectContainerTitle")):
(e.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,rV(e,"replaceIconObjectContainerTitle")),eM(e,"UIFont replaceObjectContainerTitle"),this.yo.appendChild(e),this.yo.appendChild(d),p$(this)&&(this.P2=jM(),this.P2.setAttribute("Unselectable","on"),this.P2.setAttribute("tabindex","-1"),this.P2.setAttribute("role","link"),eM(this.P2,"UIFont replaceObjectContainerLink"),p$(this)&&this.ka.V1b&&this.ka.Ija&&(this.P2.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,this.Yc.Wa("click",
this.P2,this.UJd)),d=iM(),d.appendChild(this.P2),this.yo.appendChild(d)));this.byc=this.mh.K7a;this.cvd=-1;G().nS(!0);S4(this).style.zIndex=G().sLa();this.yo.style.zIndex=G().CJ();S4(this).style.visibility="hidden";S4(this).style.display="block";S4(this).style.visibility="visible";p$(this)?eM(this.yo,"replaceIconObjectContainer"):rV(this.yo,"replaceIconObjectContainer");this.WVa(b,c);this.Gf(!0)}}},WVa:function(a,b){var c,d;this.te(0,0);if(p$(this)){c=a+32+7;d=b;var e=oLb();c+this.yo.offsetWidth>
e.ld&&(c=a+32-this.yo.offsetWidth,d=b-7-this.yo.offsetHeight)}else c=a,d=b-7-this.yo.offsetHeight;this.te(c,d)},qv:function(a,b){if(!this.Kf)R(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>a)&&this.AI)if(this.yo)if(a>=this.byc)R(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.byc,a);else{var c=this.yo.querySelector(".replaceObjectSuggestionsList");
if(c)if(c=c.children)if(c=c[a])if(b)this.cvd=a,vl(c)&&mxe(this,c.firstChild);else{this.cvd=-1;var d;try{c.blur(),d=!0}catch(e){d=!1}d&&nxe(this,c.firstChild)}else R(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null");else R(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null");else R(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else R(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")},zDb:function(a){this.uOa&&(this.uOa.className="ReplaceObjectCorrelation "+a)},jva:function(){this.yo&&(this.Yc.Wa("click",this.yo,this.Aq),this.EO.Ka(this.yo,"keydown",this.uXb),this.Lo.Wa("msospPointerOver",this.yo,this.qK),this.Lo.Wa("msospPointerOut",this.yo,this.nF))},z6c:function(){this.yo&&(this.Yc.Sb("click",this.yo,this.Aq),this.EO.eb(this.yo,"keydown",this.uXb),this.Lo.Sb("msospPointerOver",
this.yo,this.qK),this.Lo.Sb("msospPointerOut",this.yo,this.nF))},FW:function(a){a=oxe(a.Cc());mxe(this,a);return!0},EW:function(a){a=oxe(a.Cc());nxe(this,a);return!0},aVc:function(a){if(this.AI&&!a.ctrlKey&&!a.altKey&&(!a.shiftKey||9===a.keyCode&&p$(this)))if(13===a.keyCode||32===a.keyCode)a.preventDefault(),(a=this.yo.querySelector(":focus"))&&a.firstChild.click();else if(9===a.keyCode&&p$(this)){var b=this.yo.querySelector(":focus");b&&this.P2&&(b===this.P2?(a.preventDefault(),a.stopPropagation(),
this.qv(0,!0)):b.parentNode&&b.parentNode.className&&0<=b.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(a.preventDefault(),a.stopPropagation(),this.qv(Ywe(this),!1),vl(this.P2)))}},oz:function(a){if(a.Jr)return!1;var b=oxe(a.Cc());if(!pxe(b)||!b||!b.className||-1!==b.className.indexOf("ReplaceObjectSuggestionLoading"))return!0;a=b?b.parentNode.parentNode.id:null;var c=this.Txb(b),b=b?b.title:null;if(a&&c){var d;a=(d=new hea,d.SuggestionSid=window.parseInt(c),d.ShapeId=this.mh.Hy(),
d.CorrelationId=a,d.ActiveSlideCid=this.ra.Ma().Be(),d.ActiveSlideSid=this.ra.Ma().Pc(),d.Label=b,d.SmartArtSubNodeId=this.mh.J8?this.mh.J8:null,d.ReplaceObjectType=this.mh.$V,d);this.fa.jb(4041021629,2,a,null)}return!0},i7f:function(){this.mh&&(this.mh.ztb=!0);qxe(this);this.fa.Ab(1332899609,2,null);return!0},Txb:function(a){if(!a)return null;a=a.id.split("_");return 2!==a.length?null:a[1]},te:function(a,b){this.Kf?(0>a&&(a=0),0>b&&(b=0),this.yo.style.left=this.vk.h0(a),this.yo.style.top=this.vk.h0(b)):
R(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")},Gf:function(a){if(this.yo){if(this.mh)if(a)this.mh.XMc=new Date,Zwe(this.mh,3,3);else{var b;(b=this.mh).Ktb=b.Ktb+(new Date-this.mh.XMc)}this.yo.style.visibility=a?"visible":"hidden";this.AI=a;DT(this.Ia,"EditingReplaceObjectSuggestionsGalleryFocus",a)}},Vk:null,kAb:function(){return!0},lAb:function(){return qxe(this)},zZc:function(){return!0},AZc:function(){return!0},yZc:function(){return qxe(this)},jAb:function(){return!0}};
function qxe(a){if(!a.mh||!a.mh.Cq)return!0;var b=a.mh.Cu();if(!b)return!0;var c;a.fa.jb(283636573,2,(c=new ubd,c.action=2,c.shape=b,c),null);return!0}
function S4(a){a.Vk&&"undefined"!==typeof a.Vk||(a.Vk=iM(),a.Vk.setAttribute("id","ModalDiv"),eM(a.Vk,"cui-modalDiv"),a.Vk.setAttribute("Unselectable","on"),document.body.appendChild(a.Vk),bi().Wa("msospPointerDown",a.Vk,a.M4a),bi().Wa("msospPointerUp",a.Vk,a.N4a),bi().Wa("msospPointerMove",a.Vk,a.hBc),bi().Wa("msospPointerOut",a.Vk,a.iBc),Zh().Wa("click",a.Vk,a.gBc),Wh().Wa(Cl(),a.Vk,a.tpb));return a.Vk}function p$(a){return!!a.mh&&1===a.mh.$V}
function pxe(a){return!!a&&!!a.className&&-1!==a.className.indexOf("ObjectSuggestionContainer")}function oxe(a){if(!a)throw Error.argumentNull("sourceElement");return"a"===a.nodeName.toLowerCase()?a:a.parentNode}function nxe(a,b){b&&pxe(b)&&(b=new sbd(a.mh.Hy(),a.mh.J8),a.e7.Iie(b))}function mxe(a,b){b&&pxe(b)&&(b=a.Txb(b))&&(b=p$(a)?a.rOa.hc(b)?a.rOa.K(b):"":a.j2.hc(b)?a.j2.K(b):"")&&(b=new rbd(a.mh.Hy(),b,a.mh.J8),a.e7.Jie(b))}
function lxe(a,b){a.yo&&(a.P2&&(a.Yc.Sb("click",a.P2,a.UJd),a.P2=null),Qd(a.yo),a.uOa=iM(),a.uOa.setAttribute("Unselectable","on"),a.uOa.className=b?"ReplaceObjectCorrelation "+b:"ReplaceObjectCorrelation",a.uOa.style.position="absolute",a.uOa.style.display="none",a.yo.appendChild(a.uOa),a.yo.style.zIndex=-1)}
function Ywe(a){return a.Kf?a.AI?a.yo?a.yo.querySelector(".replaceObjectSuggestionsList")?a.cvd:(R(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(R(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),-1):-1:(R(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}
function Iwe(a,b,c,d){this.$Ue=a;this.ur=b;this.ra=c;this.ka=d}Iwe.prototype={$Ue:null,ur:null,ra:null,ka:null,UDb:function(a){return!(a&&a.get_shapeId()&&HP(a)&&this.ur.PTa(a))||a.get_shapeRotation()||a.QL()||OO(a)||$O(a)||!this.$Ue.Fo(a)?!1:!0}};function Mwe(a,b,c,d,e,f,g){this.Yc=a;this.Lo=b;this.vk=c;this.xba=d;this.ka=e;this.Dc=f;this.avd=g}Mwe.prototype={Yc:null,Lo:null,vk:null,xba:null,ka:null,Dc:null,avd:null};function i$(a,b,c){this.vk=a;this.ra=c;this.mCd=b}
i$.prototype={mCd:null,vk:null,ra:null,nu:function(a){return this.vk.bla(a)},PTa:function(a){return a?!!this.ra.Ma()&&this.ra.Ma().gc().Sa(a.Sg()):!1}};function kxe(a){return new pJ(a.X,a.Y)}function rxe(a){return(a=a.mCd.ie())?a.NU:1}function sxe(a){return a.nu(XU(a.mCd.ie()))}function jxe(a,b){return Twe(b)*rxe(a)}function ixe(a,b){return Swe(b)*rxe(a)}function Twe(a){if(!a)throw Error.argumentNull("shape");a=X4d(a);return PJ(kxe(a.TopRight),kxe(a.BottomRight))}
function Swe(a){if(!a)throw Error.argumentNull("shape");a=X4d(a);return PJ(kxe(a.TopLeft),kxe(a.TopRight))}function Pwe(a,b,c){this.zAc=Function.createDelegate(this,this.lWc);this.MPa=Function.createDelegate(this,this.QTa);this.UE=a;this.XUe=b;this.Nmb=c}
Pwe.prototype={UE:null,XUe:null,Nmb:null,jY:null,TY:null,OE:function(){return"ReplaceObjectWacALWorkflow"},Nhb:function(){if(!this.jY){var a;this.jY=(a=new g3,a.aA="LambdaBefore_ReplaceObjectWacAL",a.Hja="ShapeTextTile",a.Sja="ShapeTextTile",a.Eja=this.MPa,a)}return this.jY},Jib:function(){if(!this.TY){var a;this.TY=(a=new g3,a.aA="LambdaRemote_ReplaceObjectWacAL",a.Hja="ShapeTextTile",a.Sja="ShapeTextConvertable",a.Eja=this.zAc,a)}return this.TY},QTa:function(a,b,c){if(b=a)b=this.XUe,b=b.tAa&&b.$Qb;
if(b)if(a){var d;try{d=kn(a.ContextId)}catch(e){R(37041409,375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.OE());c(null);return}Array.contains(this.Nmb.ka.l4d,d.t)?(R(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.OE()),c(null)):(b=this.Nmb,d=d.shapeId,b.ra.Ma()?(d=b.ra.Ma().RP(d),d=b.UDb(d)):d=!1,d?c(a):(R(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.OE()),c(null)))}else c(null),R(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.OE());
else R(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.OE()),c(null)},lWc:function(a,b,c){if(a)if(a){var d=this;this.UE.pb(function(b){b.LBb(a.Topic,a.Data,a.ContextId,function(a){d.Jea(a)},function(a){d.Hea(a)},c)})}else c(null);else c(null)},Jea:function(a){if(!F.mg&&a&&a.Pa){var b=a.Pa.So;if(b){var c;try{c=kn(a.Pa.Ce)}catch(d){b(null);R(36804442,375,10,"Try parse aug response failed:{0}",d.message);return}b(c)}}},Hea:function(a){!F.mg&&a&&a.Pa&&(a=a.Pa.So)&&a(null)}};
function Hwe(a,b,c){this.ka=a;this.$a=b;this.T3a=c;this.ub(this.ka.k4d)}
Hwe.prototype={b3:null,ka:null,$a:null,T3a:null,Fo:function(a){return this.b3?this.b3.UDb(a):!0},ub:function(a){var b={};if(a){a=a.split(";");for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e){var f=e.split(":");2===f.length?b[f[0]]=f[1]:R(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",e)}}}a=[];"MinParagraphCount"in b&&Array.add(a,new txe(xK(b,"MinParagraphCount",0),this.$a));"MinShapeHeight"in b&&Array.add(a,new uxe(zK(b,"MinShapeHeight",0),this.T3a));"MaxShapeHeight"in b&&Array.add(a,
new vxe(zK(b,"MaxShapeHeight",Number.MAX_VALUE),this.T3a));"MinShapeWidth"in b&&Array.add(a,new wxe(zK(b,"MinShapeWidth",0),this.T3a));"MaxShapeWidth"in b&&Array.add(a,new xxe(zK(b,"MaxShapeWidth",Number.MAX_VALUE),this.T3a));"MinShapeAreaRatio"in b&&Array.add(a,new yxe(zK(b,"MinShapeAreaRatio",0),this.T3a));"MaxShapeAreaRatio"in b&&Array.add(a,new zxe(zK(b,"MaxShapeAreaRatio",Number.MAX_VALUE),this.T3a));for(b=0;b<a.length-1;b++)a[b].fEd=a[b+1];0<a.length&&(this.b3=a[0])}};function q$(){}
q$.prototype={fEd:null,UDb:function(a){return this.Fo(a)?this.fEd?this.fEd.UDb(a):!0:!1}};function txe(a,b){txe.initializeBase(this);this.iSe=a;this.$a=b}txe.prototype={iSe:0,$a:null,Fo:function(a){return Axe(a,this.$a)>=this.iSe}};function Axe(a,b){if(!a)return 0;var c=0;b.uH(a,function(a){a.fb(zq)&&(a=a.nb(String,zq))&&0<a.length&&c++});return c}function uxe(a,b){uxe.initializeBase(this);this.fSe=a;this.ur=b}uxe.prototype={fSe:0,ur:null,Fo:function(a){return jxe(this.ur,a)>=this.fSe}};
function vxe(a,b){vxe.initializeBase(this);this.TRe=a;this.ur=b}vxe.prototype={TRe:0,ur:null,Fo:function(a){return jxe(this.ur,a)<=this.TRe}};function wxe(a,b){wxe.initializeBase(this);this.lSe=a;this.ur=b}wxe.prototype={lSe:0,ur:null,Fo:function(a){return ixe(this.ur,a)>=this.lSe}};function xxe(a,b){xxe.initializeBase(this);this.ZRe=a;this.ur=b}xxe.prototype={ZRe:0,ur:null,Fo:function(a){return ixe(this.ur,a)<=this.ZRe}};function Bxe(){Bxe.initializeBase(this)}Bxe.prototype={ur:null};
function Cxe(a,b){var c=ixe(a.ur,b);b=jxe(a.ur,b);var d=c*b,e=sxe(a.ur).width;a=sxe(a.ur).height;d=d/(e*a)*100;R(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",c,b,e,a,d);return d}function yxe(a,b){yxe.initializeBase(this);this.jSe=a;this.ur=b}yxe.prototype={jSe:0,Fo:function(a){return Cxe(this,a)>=this.jSe}};function zxe(a,b){zxe.initializeBase(this);this.XRe=a;this.ur=b}
zxe.prototype={XRe:0,Fo:function(a){return Cxe(this,a)<=this.XRe}};function Nwe(a,b,c,d,e,f,g,h,k,l,m){this.kB=Function.createDelegate(this,this.mv);this.lgf=Function.createDelegate(this,this.z5f);this.kgf=Function.createDelegate(this,this.y5f);this.dispose=this.ha;this.fa=e;this.vk=f;this.ke=g;this.Dt=h;this.e7=k;this.vOa=d;this.gR=c;this.Sz=a;this.fM=b;this.tD=!1;this.ka=l;this.Twc=m;this.Kf=this.dW=!1}
Nwe.prototype={fa:null,vk:null,ke:null,Dt:null,e7:null,fM:null,vOa:null,Twc:null,EWe:!1,hNa:null,d7:null,tD:!1,Sz:null,ka:null,gR:null,dW:!1,rj:function(){return this.dW},hf:function(a){return this.dW=a},Kf:!1,Ro:function(){if(!this.Kf){var a=Dxe(this),a=a?a.$V:0;this.EWe=1===a;this.d7=new EL;var b=this.vOa,c=this.d7,d=this.kgf,e=this.lgf,f=b.ka.m7a,a=7<=f&&8>=f&&1!==a?new Dwe(c,b.Yc,b.Lo,d,e,b.ka,b.Dc,0,b.avd):new $we(c,32,"per","PowerPointDesigner_32x32x32",b,b.xba,b.Yc,b.Lo,d,e,b.vk,b.ka,a,b.avd);
a.Ro();this.hNa=a;this.fM&&!this.fM.Hv()&&this.fM.$r&&(this.Mm(this.fM.$r),TQ(this.fM,this,3));this.Kf=!0}},N5b:function(){this.Kf?this.hNa&&this.hNa.N5b():R(38397254,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")},B5b:function(){this.Kf?this.hNa&&this.hNa.B5b():R(34358810,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")},Jka:function(){if(!this.Kf)R(25306629,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.dW){this.Nt();this.hNa.xf();
this.dW=!0;this.d$();var a=Dxe(this);if(a){a.vGc=!0;var b=new Date;a.fta||(a.fta=b);a.Ztb=b;R(36500810,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",a.dy,a.nd)}}},Ee:function(){return this.Kf?this.d7.Ja:(R(25306631,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)},Ri:function(){if(this.Kf){this.hNa.Ri();this.dW=!1;var a=Dxe(this);a&&(xwe(a,!1),a.Ztb&&(a.L5a+=new Date-a.Ztb,R(26026273,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
a.L5a,a.Ztb,a.dy,a.nd)))}else R(25306633,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")},Mm:function(){this.dW=!1;eM(this.d7.Ja,"replaceObjectBody");document.body.appendChild(this.d7.Ja);nIb(this.ke,this.kB);this.Nt()},QC:function(){},$w:function(){return null},xB:function(){return!1},hx:function(){},ez:function(){},te:function(){},$j:function(){},pq:function(){},uu:function(){},vs:function(){},ry:function(a){if(this.Kf){if(a)this.dW=!1,this.d$();else if(this.tD){var b=new tbd(this.Sz);
this.e7.qa.Ha("ReplaceObjectViewDE",b,null)}this.tD=a}else R(25306637,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")},dx:function(){return null},MC:function(){return[]},uB:function(){this.Kf?this.Nt():R(25306639,829,15,"ShapeReplaceObjectView::Draw - called before setup")},Hd:function(){},ha:function(){this.gR();this.Kf&&(this.ke.qa.eb("SUHS",this.kB),this.d7&&(this.d7.Ja.parentNode&&this.d7.ns(),rV(this.d7.Ja,"replaceObjectBody")),this.Ri(),this.hNa.ha(),this.d7=null,this.Kf=!1)},
d$:function(){this.d7.Ja.style.visibility=this.dW?"visible":"hidden";var a=Dxe(this);a&&xwe(a,this.dW)},Nt:function(){var a=null,b=this.fM.$r;b&&(a=this.vk.bla(b.Ja));if(a){if(b=a.x-42,this.EWe&&this.fM&&this.fM.tc&&(b=kA(this.fM.tc.Ve(),rU(this.Sz),0),b=a.x+b+10),hBa(this.d7.Ja,1),this.d7.te(1*b,a.y),b*=1,a=a.y,this.Twc.lf()){var c=Dxe(this),d=this.Twc.mh;d&&c&&d.nd===c.nd&&this.Twc.WVa(b,a)}}else R(38557190,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")},y5f:function(a){if(a.Jr)return!1;
var b;this.fa.jb(283636573,2,(b=new ubd,b.shape=this.Sz,b.action=0,b),null);return!0},z5f:function(){if(!this.ka.vLc)return!1;var a=Dxe(this);if(a&&1===a.$V)return!1;var b;this.fa.jb(283636573,2,(b=new ubd,b.shape=this.Sz,b.action=1,b),null);return!0},mv:function(a,b){this.dW&&(a=null,b&&b.EI&&(a=b.EI.ii()),a&&a.gc().Sa(this.Sz.Sg())&&this.Nt())}};function Dxe(a){return a.Dt.sTa(a.Sz.bY())}function Exe(){}Exe.prototype={isTextConvertible:!1,smartArtInfo:null};
iwe.registerClass("PowerPointWebEditor.BaseReplaceObjectManager",null,O$c,R2);twe.registerClass("PowerPointWebEditor.ReplaceObject.AugmentationLoopReplaceObjectManager",iwe);Awe.registerClass("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer");Dwe.registerClass("PowerPointWebEditor.ReplaceObject.GifFlyoutAnchor",null,qwe,R2);Ewe.registerClass("PowerPointWebEditor.ReplaceObject.PPTWebEditorReplaceObjectPackage",null,yo,ec);Rwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceIconManager");
m$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor");Qwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager");Kwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectContext",null,N4d);Fwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource",null,pbd,c3,obd);$we.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectFlyoutAnchor",null,qwe,R2);
Lwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectManager",iwe);j$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager",null,g$,Sys.ax);l$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter",null,R2);exe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPreviewImageView",null,R2);fxe.registerClass("PowerPointWebEditor.ReplaceObject.TaskItem");
Jwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectRequestManager",null,rwe);k$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager",null,g$,Sys.ax);Owe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionPreviewView",null,vGb,sQ,YK,Sys.IDisposable,R2);Gwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionsGalleryView",null,p7,R2);Iwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper");
Mwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory");i$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper");Pwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow",null,f3);Hwe.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWalls",null,swe);q$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWall");txe.registerClass("PowerPointWebEditor.ReplaceObject.MinParagraphCount",q$);
uxe.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeHeight",q$);vxe.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeHeight",q$);wxe.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeWidth",q$);xxe.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeWidth",q$);Bxe.registerClass("PowerPointWebEditor.ReplaceObject.AreaRatioWall",q$);yxe.registerClass("PowerPointWebEditor.ReplaceObject.MinAreaRatio",Bxe);
zxe.registerClass("PowerPointWebEditor.ReplaceObject.MaxAreaRatio",Bxe);Nwe.registerClass("PowerPointWebEditor.ReplaceObject.ShapeReplaceObjectView",null,uGb,sQ,YK,Sys.IDisposable,R2);Exe.registerClass("PowerPointWebEditor.ReplaceObject.TextAnalysisHint");zo(gj(),e7(new Ewe,0),0,!1);
