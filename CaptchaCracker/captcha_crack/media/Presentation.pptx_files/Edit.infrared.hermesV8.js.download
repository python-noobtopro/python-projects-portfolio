Type.registerNamespace("PowerPointWebEditor.Infrared");M=window.PowerPointWebEditor||{};M.jz=M.jz||{};function oRd(){}oRd.registerInterface("PowerPointWebEditor.Infrared.IInfraredRuntimeManager");function T6(){this.lFf=this.addSlideSuggestionsListener;this.nFf=this.addTextToSmartArtSuggestionListener;this.L1f=this.notifySlideSuggestion;this.M1f=this.notifyTextToSmartArtSuggestion;this.yGg=this.set_isIdeasPaneVisible}
T6.prototype={jCd:null,fDd:null,A1a:null,ZNc:function(a){this.A1a=a},A9b:function(a){this.A1a&&this.A1a(a)},eVd:!1};T6.prototype.oyg=function(a){this.jCd=a};T6.prototype.addSlideSuggestionsListener=T6.prototype.oyg;T6.prototype.qyg=function(a){this.fDd=a};T6.prototype.addTextToSmartArtSuggestionListener=T6.prototype.qyg;T6.prototype.IEg=function(a,b){this.jCd&&(this.jCd(a,b),R(37065174,829,50,"data: count: {0}, correlation: {1}",b?b.suggestions.length:0,b?b.correlationId:"0"))};
T6.prototype.notifySlideSuggestion=T6.prototype.IEg;T6.prototype.JEg=function(a,b){this.fDd&&(this.fDd(a,b),R(37065176,829,50,"data: count: {0}, correlation: {1}",b?b.suggestions.length:0,b?b.correlationId:"0"))};T6.prototype.notifyTextToSmartArtSuggestion=T6.prototype.JEg;T6.prototype.lBg=function(){return this.eVd};T6.prototype.get_isIdeasPaneVisible=T6.prototype.lBg;T6.prototype.UGg=function(a){return this.eVd=a};T6.prototype.set_isIdeasPaneVisible=T6.prototype.UGg;
function qRd(a,b,c,d,e,f,g,h,k){this.s6e=Function.createDelegate(this,this.Sce);this.cbf=Function.createDelegate(this,this.PXf);this.WAc=Function.createDelegate(this,this.HYc);this.IJd=Function.createDelegate(this,this.y6f);this.Glf=Function.createDelegate(this,this.Tbg);this.Zkf=Function.createDelegate(this,this.abg);R(37065178,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.DOa=a;this.TNe=g;this.utc=k;this.MRe=a.ia(S(659));this.EUb=a.Va(S(750));g=window.location.hostname;k=a.Va(S(816));
g&&0<g.length&&k&&0<k.length&&0<=k.toLowerCase().indexOf(g.toLowerCase())&&(this.EUb="");this.Rha=b;this.c1a=f;if(this.vZe=a.ia(S(688)))this.lOe=a.Va(S(689)),this.nqd=new rRd(h);this.Rha.lFf(this.Zkf);this.Rha.nFf(this.Glf);this.Rha.ZNc(this.IJd);c.ZNc(this.IJd);if(this.c1a){var l=this;this.c1a.pb(function(a){N0b(a,l.WAc)})}this.fa=d;if(this.UE=e){var m=this;this.UE.pb(function(a){var b;a.m2c("InfraredSlideTextTileWorkflow",(b=new g3,b.aA="InfraredSlideTextTileLambda",b.Hja="SlideTextTile",b.Sja=
"SlideTextTile",b.Eja=function(a,b,c){a:if(m.MRe)if(a)if(a){try{var d=kn(a.Content);sRd(m.Xxd,d)&&(m.Xxd=d,m.SBd=!0)}catch(e){R(37598660,811,10,"Deserializing tile response failed");break a}m.VNe&&tRd(m)}else R(37598658,811,50,"ProcessSlideTextTileChange,TileNull");else R(37598656,811,50,"ProcessSlideTextTileChange,InputNull");c(null)},b))})}uRd(this)}
qRd.prototype={OQa:null,Rha:null,c1a:null,fa:null,UE:null,MRe:!1,nqd:null,vZe:!1,lOe:null,DOa:null,EUb:null,TNe:null,VNe:!1,Xxd:null,SBd:!1,utc:null,PXf:function(a){this.VNe=a;this.Rha.yGg(a);a?(this.fa.Ab(1894291367,2,null),tRd(this)):this.fa.jb(2658220272,2,new xCb(!0,"IdeasPaneClosed"),null)},abg:function(a,b){var c=[],d;c.push((d=new uWb,d.providerId="Provider.Designer.Slide",d.groupTypeId="EntityGroup.Designer.Slide.Suggestion",d.notificationConfidence=0,d.shouldRaiseNotification=!1,d.confidence=
1,d.data=b,d));try{var e;this.OQa.pushProviderResult((e=new vWb,e.providerId="Provider.Designer.Slide",e.resultStatus=a,e.entityGroups=c,e))}catch(f){R(38413662,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",f)}"Success"===a&&(Xn(b.suggestions)||this.utc.Cdc(0))},Tbg:function(a,b){var c=[],d;c.push((d=new uWb,d.providerId="Provider.Designer.TextToSmartArt",d.groupTypeId="EntityGroup.Designer.TextToSmartArt.Suggestion",d.notificationConfidence=
0,d.shouldRaiseNotification=!1,d.confidence=1,d.data=b,d));try{var e;this.OQa.pushProviderResult((e=new vWb,e.providerId="Provider.Designer.TextToSmartArt",e.resultStatus=a,e.entityGroups=c,e))}catch(f){R(38560531,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",f)}},y6f:function(a){try{this.OQa.trackIdeasProviderAction(a.cardId,a.actionType,a.actionEngagement)}catch(b){R(38413664,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",
b)}},HYc:function(a,b){try{a=[];var c;a.push((c=new uWb,c.groupTypeId="EntityGroup.UCI.Editor",c.providerId="Provider.UCI.Editor",c.notificationConfidence=b.Wda?b.Wda.xge:0,c.shouldRaiseNotification=b.Wda?b.Wda.Rke:!1,c.confidence=b.Wda?b.Wda.Fvb:0,c.data=b.Gwb,c));var d;this.OQa.pushProviderResult((d=new vWb,d.providerId="Provider.UCI.Editor",d.resultStatus=b.Wda?b.Wda.U2c:"Invalid",d.entityGroups=a,d))}catch(e){R(38413699,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",
e)}b.Wda&&"Success"===b.Wda.U2c&&b.Gwb&&!Xn(b.Gwb.critiques)&&this.utc.Cdc(2)},Sce:function(){if(!this.nqd)return R(38413701,811,50,"authenticationProvider is null"),null;try{if(this.EUb&&0<this.EUb.length)return vRd(this.nqd,new U6(this.EUb,"user_impersonation",!0,{},""),this.lOe);R(39323299,811,50,"ShredderServiceResourceId is null or empty");return null}catch(a){return R(38413703,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",a),null}},hPf:function(){var a=
this;return new Promise(function(b){var c=a.DOa.Va(S(749)),d=a.Sce();c&&c.length&&d?d.then(function(a){a&&a.length?(a=new wRd,a.CountryCode="US",a.IsEnabled=!1,a.IsEnterpriseEnabled=!0,a.IsGoLocal=!1,a.ServiceEndpoint=c,a.TenantRoot="",b(a)):b(null)},function(){b(null)}):b(null)})}};
function tRd(a){if(a.SBd){try{var b;a.OQa.postMessage((b=new xRd,b.messageType="PowerPoint.TextTileChanged",b.data=a.Xxd,b))}catch(c){R(38413697,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",c)}a.utc.Cdc(1);a.SBd=!1}}
function sRd(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b)return!1;if(!a.drawingElems&&b.drawingElems||a.drawingElems&&!b.drawingElems)return!0;for(var c=new (Wb.$$(String,String))(null),d=a.drawingElems,e=d.length,f=0;f<e;++f)if(a=d[f],a=a.text)for(var g=a.paragraphs,h=g.length,k=0;k<h;++k)a=g[k],!a||a.id&&a.chars&&c.ea(a.id,a.chars);b=b.drawingElems;d=b.length;for(e=0;e<d;++e)if(a=b[e],a=a.text)for(f=a.paragraphs,g=f.length,h=0;h<g;++h)if((a=f[h])&&a.id&&a.chars&&(!c.hc(a.id)||c.K(a.id)!==a.chars))return!0;
return!1}function uRd(a){var b=JSON.parse(a.DOa.Va(S(612))),c,b=(c=new yRd,c.rankingOrder=b,c);a.OQa=window.IdeasInfraredConnector.setup(b,R,a.cbf,zRd(a.DOa),a.TNe,a.s6e)}function ARd(){}
ARd.prototype={J:null,Xb:function(){return"PowerPointWebEditor.Infrared"},wc:function(a){this.J=a;C(D(lc(this.J.ma(T6,null),T2)),function(){return new T6});C(D(lc(this.J.ma(BRd,null),aad)),function(){return new BRd});var b=this;C(D(lc(this.J.ma(CRd,null),ebd)),function(){return new CRd(b.J.H(dd,null),b.J.H(md,null))});R(559751877,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");var c=this;C(D(lc(this.J.ma(qRd,null),oRd)),function(){return new qRd(c.J.H(md,null),c.J.H(T2,
null),c.J.H(aad,null),c.J.H(cd,null),kc(c.J,e3),kc(c.J,oWb),c.J.H(ebd,null),c.J.H(V6,null),c.J.H(DRd,null))})},ub:function(){var a=this.J.H(md,null),b=this;a.Nf(function(){a.ia(S(610))&&(R(559751878,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),b.J.H(oRd,null))})},ha:function(){}};
function CRd(a,b){this.fa=a;this.fa.ua(122331915,1,Bi.Vs,4);this.fa.ua(3193936695,1,Bi.Vs,4);this.fa.ua(3193936696,1,Bi.Vs,4);this.fa.ua(3193936697,1,Bi.Vs,4);this.fa.ua(3193936698,1,Bi.Vs,4);this.fa.ua(3193936699,1,Bi.Vs,4);this.fa.ua(2223642720,1,Bi.Vs,4);this.fa.ua(1919703035,1,Bi.Vs,4);this.fa.ua(1926303135,1,Bi.Vs,4);this.fa.ua(3492387076,1,Bi.Vs,4);this.fa.ua(763503721,1,Bi.Vs,4);this.fa.ua(2329587662,1,Bi.Vs,4);this.fa.ua(4251901963,1,Bi.Vs,4);this.fa.ua(2625809748,1,Bi.Vs,4);this.fa.ua(1878013559,
1,Bi.Vs,4);this.fa.ua(1996485857,1,Bi.Vs,4);this.fa.ua(466025397,1,Bi.Vs,4);this.fa.ua(3747160629,1,Bi.Vs,4);this.fa.ua(2128456064,1,Bi.Vs,4);this.fa.ua(1044579542,1,Bi.Vs,4);this.fa.ua(1297860507,1,Bi.Vs,4);this.fa.ua(4062972035,1,Bi.Vs,4);a=this.qrd=JSON.parse(b.Va(S(674)));b=a.length;for(var c=0;c<b;++c){var d=a[c];d.regex=new RegExp(d.pattern)}}CRd.prototype={fa:null,qrd:null};
CRd.prototype.JHg=function(a){for(var b=this.qrd,c=b.length,d=0;d<c;++d){var e=b[d];e.regex.test(a)&&this.fa.Ab(e.actionId,2,null)}};CRd.prototype.trackAction=CRd.prototype.JHg;function BRd(){}BRd.prototype={A1a:null,ZNc:function(a){this.A1a=a},A9b:function(a){this.A1a&&this.A1a(a)}};Type.registerNamespace("Microsoft.Office.Infrared");Lp=window.Microsoft||{};Lp.jv=Lp.jv||{};Lp.jv.jz=Lp.jv.jz||{};function yRd(){}function ERd(){}function xRd(){}function wRd(){}function FRd(){}FRd.registerInterface("Microsoft.Office.Infrared.IAuthenticationProvider");
function zRd(a){var b={};2===G().rb().Tm()?b.appName="PowerPoint":b.appName="unknown";b.appVersion=Jp;b.appPlatform="WAC";b.lcid=F.ag;var c=ao(F.ag),c=c?c._name:null,d=c.split("-");b.market=d[d.length-1];b.uiLanguage=c;b.sessionId=vp;b.tenantRoot=a.Va(S(748));b.shredderServiceEndpoint=a.Va(S(749));return b}function rRd(a){this.aEd=a}rRd.prototype={aEd:null};
function vRd(a,b,c){return new Promise(function(d,e){a.aEd&&b&&c||e("wopiIdentityManager or tokenParameter or clientWoipId is null");a.aEd.getAccessToken(b,c,null).then(function(a){a?d(a.get_accessToken()):e("auth token is null")},function(a){e(a)})})}function U6(a,b,c,d,e){this.Et=a;this.kBd=b;this.YBd=c;this.t2a=d;this.FMa=e}U6.prototype={Et:null,kBd:null,YBd:!1,t2a:null,FMa:null};U6.prototype.Lod=function(){return this.Et};U6.prototype.get_resource=U6.prototype.Lod;
U6.prototype.jFd=function(a){return this.Et=a};U6.prototype.set_resource=U6.prototype.jFd;U6.prototype.Mod=function(){return this.kBd};U6.prototype.get_scope=U6.prototype.Mod;U6.prototype.kFd=function(a){return this.kBd=a};U6.prototype.set_scope=U6.prototype.kFd;U6.prototype.Nod=function(){return this.YBd};U6.prototype.get_silentLogin=U6.prototype.Nod;U6.prototype.lFd=function(a){return this.YBd=a};U6.prototype.set_silentLogin=U6.prototype.lFd;U6.prototype.Kod=function(){return this.t2a};
U6.prototype.get_options=U6.prototype.Kod;U6.prototype.iFd=function(a){return this.t2a=a};U6.prototype.set_options=U6.prototype.iFd;U6.prototype.Fod=function(){return this.FMa};U6.prototype.get_correlationId=U6.prototype.Fod;U6.prototype.eFd=function(a){return this.FMa=a};U6.prototype.set_correlationId=U6.prototype.eFd;(function(){}).registerClass("PowerPointWebEditor.Infrared.PPTIdeasDatapointConfiguration");T6.registerClass("PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider",null,T2);
qRd.registerClass("PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager",null,oRd);ARd.registerClass("PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimePackage",null,yo,ec);CRd.registerClass("PowerPointWebEditor.Infrared.IdeasActionTracker",null,ebd);BRd.registerClass("PowerPointWebEditor.Infrared.InfraredTelemetryListener",null,aad);(function(){}).registerClass("Microsoft.Office.Infrared.ApplicationProperties");yRd.registerClass("Microsoft.Office.Infrared.RankerConfiguration");ERd.registerClass("Microsoft.Office.Infrared.Message");
xRd.registerClass("Microsoft.Office.Infrared.PowerPointTextTileChangedMessage",ERd);wRd.registerClass("Microsoft.Office.Infrared.EnterpriseUserInfo");(function(){}).registerClass("Microsoft.Office.Infrared.ApplicationPropertiesManager");rRd.registerClass("Microsoft.Office.Infrared.AuthenticationProvider",null,FRd);U6.registerClass("Microsoft.Office.Infrared.InfraredTokenParameters",null,hGa);xRd.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";zo(gj(),new ARd,0,!1);
