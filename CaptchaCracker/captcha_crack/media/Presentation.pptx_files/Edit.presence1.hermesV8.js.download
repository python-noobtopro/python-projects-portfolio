TFd.prototype.d$a=q(-1999828422,function(a){var b=new (bb.$$(Number)),c=this;this.ub().CW(function(){a in c.sfc?mb(b,c.sfc[a]):c.Kkc[a]=b});return b.Wf()});dGd.prototype.d$a=q(-300453624,function(a){return this.tAe.d$a(a)});nbd.prototype.rU=q(-1785268380,function(){return this.R6d.rU()});j4.prototype.rU=q(1563294260,function(){return this.lj});
$ad.prototype.Qxb=q(-897243856,function(){return new window.PowerpointPresence.SerializablePresenceInfo(this.ik,this.OJe,this.NJe,this.hOe,this.jAa,this.IJe.hw,this.Qx?this.Qx.Qxb():null,this.Y2,this.dBd,this.htd,F.XVa||F.oN)});$2.prototype.Qxb=q(-2088129136,function(){return new window.PowerpointPresence.SerializablePresenceData(this.nh.Cba,this.Lu,this.tBd)});
WQ.prototype.ZGa=q(-31001387,function(a){a?this.Wm?(R(17056458,814,50,"PresenceManager : RemovePresence for ClientId {0}",a.eh),this.Wm.V_(a),this.mSa()):R(17056456,814,50,"PresenceManager : RemovePresence - Presence pawn is not initialized  for ClientId {0}",a.eh):R(17056454,814,15,"PresenceManager : RemovePresence - presenceUser null")});
WQ.prototype.oka=q(1118426978,function(a){a&&this.Awc.Da()?(R(17056452,814,50,"PresenceManager : AddPresence for ClientId {0}",a.eh),this.z8a(),this.Wm||bIb(this),this.Wm&&this.Wm.zP(a)):R(17056450,814,15,"PresenceManager : AddPresence - presenceUser is null {0}, presencePawnFactory is null {1}",!a,!this.Awc.Da())});
CQ.prototype.tcb=q(-379285248,function(a){if(this.GO){var b,c=!1;b=this.Naa;this.pa.u7a===this.va&&(c=!0,this.Naa||R(19140737,828,10,"Lock owner is null when unlock the shape. ShapeId: {0}.",this.va?this.va.rt():""));this.Naa=null;this.uCa(!1);this.xRe=new Date;this.VC();a&&hHb(this);a=new YIb(this,b,!1,c);this.Me.qa.Ha("SU",a,null)}});j4.prototype.tcb=q(453190961,function(){if(this.GO){this.Naa=null;this.uCa(!1);qS(this.xd,new kS(7));var a=new mbd(null);this.uha.qa.Ha("TLSC",a,null)}});
CQ.prototype.WTa=q(-571150215,function(a){this.GO&&this.Naa===a||(this.Naa=a,this.uCa(!0),lHb(this,!1),this.zRe=new Date,a=new YIb(this,a,!0,!1),this.Me.qa.Ha("SL",a,null))});j4.prototype.WTa=q(1776082154,function(a){this.GO&&this.Naa===a||(lHb(this.Zk(),!1),this.Naa=a,this.uCa(!0),qS(this.xd,new kS(7)),a=new mbd(a),this.uha.qa.Ha("TLSC",a,null),a=new nbd(this),this.uha.qa.Ha("TCVEL",a,null))});xO.prototype.gob=q(573058357,function(a){this.kk.gob(a);return a});
zO.prototype.gob=q(1762183610,function(a){return this.RQd=a});xO.prototype.KNb=q(1653466249,function(){return this.mIc});CQ.prototype.KNb=q(-768999213,function(){return this.zRe});ny.prototype.$yc=q(1661694460,function(){});RS.prototype.$yc=q(-1349673073,function(a){this.qa.eb("InitSelectionSet",a)});ny.prototype.Rnc=q(-1216058513,function(){});RS.prototype.Rnc=q(-902013252,function(a){this.qa.Ka("InitSelectionSet",a)});
function RGd(a,b,c){var d=new Date,e=new (bb.$$(Boolean));a.ub().CW(function(){var f=fGd(a,b);if(!f.k9c){var g=Date.now();f.j9c=g;gGd(f)}f=d?d.getTime():(new Date).getTime();b in a.LAe?e.W4():(f=new iGd(b,1===a.$De?a.aEe:Czc(a),f,a.d$a(a.Lfd||"{"+vp+"}"),a.d$a(b),a.yoa,a.cna,c,a.Mma),a.LAe[b]=f,f.hec(e))})}function SGd(a){j6(a,35);a.ri.tvc&&a.xk(36,a.ri.tvc.getTime())}function TGd(a,b,c){b&&c&&b!==c&&(b in a.lxc||(a.lxc[b]=c))}function UGd(a,b){a.GUb.Ha("SPC",b,null)}
function VGd(a){Ukd(a);return a.cBd}function WGd(a,b,c){var d=0,e=a.D0a.length;if(0<e&&b<a.D0a[e-1].pZb){b=b.getTime();c=c.getTime();for(var f=0;f<e;++f){var g=Math.max(a.D0a[f].HQd.getTime(),b),h=Math.min(a.D0a[f].pZb.getTime(),c);g<h&&(d+=h-g)}}return d}
function XGd(a,b){a.Sx&&(b?!a.Sx.v5a||!a.Sx.v5a||b.v5a&&b.v5a||R(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",a.ik):R(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",a.ik));a.Sx=b}function ZGd(a){a.Xj.xxc?(a=a.Xj.xxc,a=a.yba===a.TZe?new Date(0):new Date((new Date).getTime()+a.yba)):a=new Date;return a}function $Gd(a){a.ED=L.Va("UserPrincipalName")}window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");
w=window.Common||{};w.Ca=w.Ca||{};w.Ca.uac=w.Ca.uac||{};function aHd(a,b,c,d,e,f,g,h,k){this.gxf=Function.createDelegate(this,this.usg);this.eYb=Function.createDelegate(this,this.I$b);this.pbf=Function.createDelegate(this,this.jYf);this.Ua=new re;this.rye=a;this.djd=b;this.Bhd=c;this.zhd=d;this.v8c=f;bHd=e;this.JAe=g;this.St=h;this.vBe=k;Oa.WAA(b,c).CW(this.pbf)}
aHd.prototype={tIa:null,Tad:!0,u8c:null,rye:null,v8c:0,djd:null,vJ:null,Bhd:null,Ahd:null,zhd:null,JAe:null,St:null,vBe:!1,jYf:function(){ab(this.djd)&&ab(this.Bhd)&&(this.vJ=ab(this.djd),this.Ahd=ab(this.Bhd),this.vJ.$nc(this.eYb),this.u8c=new Si(2,2,this.v8c,this.gxf,88,null,!1,0),bHd.Vb(this.u8c))},I$b:function(a,b){if(!(a=this.Tad))a:{b=b.sEa;for(var c in b)if((a=cHd(this.zhd,{key:c,value:b[c]}))&&a.Ax()&&(a=a.Ax().toLowerCase(),(a=this.tIa[a]||this.tIa[a.toUpperCase()])&&2===a.Se)){a=!0;break a}a=
!1}a&&bHd.MW(this.u8c,0)},usg:function(a){for(var b=this.vJ,c={},d=b.IQ.GetEnumerator();d.$$mn();){var e=d.$$cu(),f,g,h;if(h=e.Aa().ng(0,g={val:f},null),f=g.val,h)c[e.Dg()]=b.KFa(e.Dg())}if(c)if(d=new Date,e=!1,this.Tad){this.tIa=c;this.Tad=!1;var k=this.tIa,l;for(l in k)g={key:l,value:k[l]},c=g.value,c.STa<d&&(d=c.STa),2===c.Se&&(e=!0,this.Ahd.kbc(g.key));e&&this.Ua.Ha("u",null,this);bHd.MW(a,dHd(this,d))}else{b=new (Ca.$$(String));l=!1;f=this.tIa;for(var m in f)if(g={key:m,value:f[m]},g=g.key,g in
this.tIa&&this.rye.Ax()!==g){var n=this.tIa[g];h=c[g];if(n&&h){var n=n.Se,r=h.Se;2===n&&1===r?(b.ga(g),u(38052609,392,50,g+" returned from away")):1===n&&2===r&&(l=e=!0,this.Ahd.kbc(g),u(38052610,392,50,g+" went away"));1===r&&h.STa<d&&(d=h.STa)}}this.tIa=c;bHd.MW(a,dHd(this,d));(0<b.Qa()||e)&&this.Ua.Ha("u",null,this);if(0<b.Qa()&&!this.vBe){a=this.vJ.D6b();c=new (Ca.$$(String));for(k in a)if(m={key:k,value:a[k]},b.Kc(m.key)&&(d=cHd(this.zhd,m)))c.ga(d.sU()),b.Mc(m.key);c.Qa()||u(38052611,392,10,
"There were no coauthor names found");k=c;if(k.Qa())for(a=k.$$lge();a.$$mn();)c=a.$$cu(),c=this.St.Hta(String.format(CommonUIStrings.l_EditorsToastArriving,c),!1),c.pK(5),c.zzc("CoAuth_AuthorStatus_16x16x32"),this.St.xk(c)}else k=new (Ca.$$(String));(l||0<k.Qa())&&this.JAe(2052777571,2,null)}}};function dHd(a,b){var c=new Date;return Math.max(b.getTime()+a.v8c-c.getTime(),0)}aHd.registerClass("Common.App.Presence.AwayManager");var bHd=null;Type.registerNamespace("AppRealtimeChannel");
Do=window.AppRealtimeChannel||{};function eHd(){}eHd.registerInterface("AppRealtimeChannel.IConnectedUsageKpiLogger");window.AppRealtimeChannel.ApiType=Do.Nub=function(){};Do.Nub.prototype={SendNotification:0,SendPersistentState:1,FindSession:2,Last:3};window.AppRealtimeChannel.ApiType.registerEnum("AppRealtimeChannel.ApiType",!1);window.AppRealtimeChannel.EventCountType=Do.iNf=function(){};
Do.iNf.prototype={AttemptCount:0,SuccessCount:1,DropCount:2,FailedCount:3,LatencyOverThresholdCount:4,LatencyUnderThresholdCount:5,ThrottledCount:6,Last:7};window.AppRealtimeChannel.EventCountType.registerEnum("AppRealtimeChannel.EventCountType",!1);function fHd(){}fHd.registerInterface("AppRealtimeChannel.IAssignRtcMachineStrategy");function n6(){}n6.registerInterface("AppRealtimeChannel.IRealtimeChannel");function gHd(){}gHd.registerInterface("AppRealtimeChannel.IRealtimeChannelMetrics");
function hHd(){}hHd.registerInterface("AppRealtimeChannel.IRealtimeChannelClientProxy");function iHd(){}iHd.registerInterface("AppRealtimeChannel.IRealtimeChannelServerProxy");function jHd(){}jHd.registerInterface("AppRealtimeChannel.IRealtimeChannelEventHub");function kHd(){}kHd.registerInterface("AppRealtimeChannel.IRealtimeChannelSettings");function lHd(){}lHd.registerInterface("AppRealtimeChannel.IMessageStatus");function mHd(){}mHd.registerInterface("AppRealtimeChannel.IMessageHandler");
function nHd(){}nHd.registerInterface("AppRealtimeChannel.IThrottle");function oHd(){}oHd.registerInterface("AppRealtimeChannel.IThrottleMaxRate");function pHd(){}pHd.registerInterface("AppRealtimeChannel.IMaxOutstandingThrottler");function qHd(){}qHd.registerInterface("AppRealtimeChannel.IThrottlerFactory");function rHd(){}rHd.registerInterface("AppRealtimeChannel.IThrottlerManager");
function sHd(a){this.yjf=Function.createDelegate(this,this.G9f);this.Ulf=Function.createDelegate(this,this.icg);this.rbf=Function.createDelegate(this,this.mYf);this.QAc=Function.createDelegate(this,this.nea);this.Rr=a;this.Rr.s_a(this.QAc)}sHd.prototype={Rr:null,rhb:null,$ja:0,H5a:!1,nea:function(a,b){this.$ja=b.yK},icg:function(){u(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");tHd(this.Rr,null)},mYf:function(a){this.rhb.ub(a)}};
function uHd(a){this.Lcf=Function.createDelegate(this,this.p0f);this.QRa=vHd;this.tQa=wHd;this.aYd=this.Lcf;this.Qp=a}function vHd(a,b){return window.setTimeout(a,b)}function wHd(a){window.clearTimeout(a)}uHd.prototype={Iga:!1,thb:0,V9c:!1,Qp:null,QRa:null,tQa:null,aYd:null,p0f:function(){u(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Qp)},AC:function(){this.Iga&&this.tQa(this.thb);this.thb=0;this.Iga=!1}};function xHd(a){a.AC();a.V9c||(a.V9c=!0,a.aYd())}
function yHd(a){a.Iga||(a.thb=a.QRa(function(){a.Iga=!1;xHd(a)},8E3),a.Iga=!0,a.V9c=!1)}function zHd(){}zHd.prototype={Q0b:0,P0b:0,O0b:0,c_b:0,ksb:!1,hrb:null,y5a:null,Fca:null,tK:null,nd:null};
function AHd(a,b,c,d,e,f,g,h,k,l,m,n,r){this.krf=Function.createDelegate(this,this.$ig);this.QAc=Function.createDelegate(this,this.nea);this.psf=Function.createDelegate(this,this.Dkg);this.Mwe=(new Date(0)).getTime();this.$wg="enabled errorMessage url connectionString queryString throttling_globalMaxNumberOfOutstandingMessages throttling_maxNumberOfOutstandingMessages throttling_timeToWaitForResponse throttling_messageDelay".split(" ");this.Zwg=["enabled","errorMessage"];this.Nad=new BHd(m?m:function(){return F.sh},
e,f,g,a,b);this.g8a=n;this.zh=d;this.eg=b;this.wse=c;this.Qp=h;this.Rr=k;this.peb=r;this.Oad=!1;this.bsa=9E4;if(l){var t=this;l.pb(function(a){a.Xnc(function(){u(40768456,500,50,"Connection parameters refresh requested for client [{0}]",t.Qp);var a=t.Nad;a.yKa=a.Vhd()})})}2>=100*Math.random()&&(this.d2c=3E5);o6&&(o6.iSd=this.d2c)}function CHd(a,b,c,d,e,f,g,h,k,l,m){return DHd(a,b,c,d,e,f,g,h,k,l,m)}
function DHd(a,b,c,d,e,f,g,h,k,l,m){a=a||Ae().toString();a=new AHd(a,b,c,d,e,3,f,g,h,k,l,m,null);a.ub();return a}
AHd.prototype={Nad:null,wse:null,eg:null,Lxe:0,hjc:!1,zh:null,Rr:null,Qp:null,UCe:null,d2c:36E5,Bdb:1E3,kGb:0,peb:null,Oad:!1,MRa:null,$ja:0,QQd:null,q7a:null,g8a:null,dYd:null,LNb:function(){return this.dYd},tK:null,mnd:function(){return this.tK},bsa:0,d_e:function(a){return this.bsa=a},V3c:function(a){this.q7a=a},ub:function(){this.Rr.Ua.Ka("RMID",this.psf);this.Rr.s_a(this.QAc)},nea:function(a,b){this.$ja=b.yK;2===b.yK&&(this.kGb=0)},R6b:function(a){a.val=this.MRa.nd;return String.format("{0}&{1}={2}",
this.MRa.Fca,"corrid",nh(a.val))},zTc:function(a,b,c,d,e){var f=this,g=this;EHd(this,function(){d(e,"GetMachineIdSuccess")&&(u(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",f.tK,f.Qp),a(f.UCe),c(new FHd(f.MRa.Q0b,f.MRa.P0b,f.MRa.O0b,f.MRa.c_b)))},function(a){d(e,"GetMachineIdFailure")&&(u(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",g.Qp),b(a))},d,e)},oRc:function(){this.tK=null;GHd(this);this.Bdb+=3E3;this.Bdb=Math.min(this.Bdb,3E5)},mac:function(a){try{this.MRa=
a,this.dYd=a.y5a+"?"+a.Fca,this.tK=a.tK,this.QQd=a.Fca,this.UCe=a.y5a}catch(b){u(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",b.toString())}},$ig:function(){this.hjc=!1;var a=this,b=this;HHd(this,function(b){var d=a.QQd!==b.Fca,e=a.tK!==b.tK,f=a.tK;a.mac(b);a.$ja&&(e?(u(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",f||"null",b.tK),tHd(a.Rr,null)):(a.Rr.Ua.Ha("SPC",new IHd(d,e),null),JHd(a)))},function(){o6&&p6(o6,
2,3);JHd(b)},!0)},Dkg:function(){this.Bdb=1E3}};function KHd(a,b,c){b||(b={});b.ConnectionState=w.q4b.toString(a.$ja);c||a.Rr.Ua.Ha("RCF",new LHd(1,b),null)}
function MHd(a,b,c,d){d||(d={});d.IsNetworkOfflineAfterRequestComplete=!!a.eg.g1.bA;d.IsRequestSucceeded=c;b&&(d.EnqueueTime=b.TD,d.InvokedTime=b.Ws,d.CompletedTime=b.Yw,b.Mj&&("X-CorrelationId"in b.Mj&&(d.CorrelationId=b.Mj["X-CorrelationId"]),"X-OfficeCluster"in b.Mj&&(d["X-OfficeCluster"]=b.Mj["X-OfficeCluster"])));u(38633565,500,c?50:15,q6(d))}
function HHd(a,b,c,d){var e=null;u(4317445,500,50,"Getting MachineId from server for [{0}]",a.Qp);var f={},g=NHd(a.Nad);f["X-CorrelationId"]=Ae().toString();a.q7a&&""!==a.q7a?g=String.format("{0}&{1}={2}",g,"rr",a.q7a):a.g8a&&""!==a.g8a&&(g=String.format("{0}&{1}={2}",g,"rr",a.g8a),f["RTC-TokenProofkey"]="True",f["RTC-IsWacJsBootFsRequest"]="True");g=a.wse+"?"+g;d&&(f.FSType="polling");var h={};h.IsNetworkOfflineBeforeSendRequest=!!a.eg.g1.bA;h.HasAvailableConnectionsBeforeSendRequest=xua(a.eg);h.MaxConnectionsAllowed=
a.eg.yIc;h.IsRefreshMachineId=d;a.peb&&!a.Oad?(OHd(a,PHd(a,null,h,b,c,d),QHd(a,null,h,c,d)),a.Oad=!0):(a.zh&&(e=a.zh.Di("WebServiceCall","GetMachineIdFromTheServer")),o6&&p6(o6,2,0),0>Tk(a.eg,g,1,null,f,"X-CorrelationId RtcErrorCode X-OfficeCluster X-NewEnv X-MSEdge-Ref X-OfficeFE X-OFFICEFD".split(" "),1,PHd(a,e,h,b,c,d),QHd(a,e,h,c,d),null,null,a.bsa,"3",!0,null,null)&&(5<a.kGb&&200>a.kGb&&u(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",
a.kGb),window.setTimeout(function(){a.kGb++;c("-1")},1E3)))}
function QHd(a,b,c,d,e){return function(f){RHd(0,1,!1);b&&b.Lf();a.q7a=null;a.g8a=null;MHd(a,f.Pa,!1,c);var g=null,h="unknown",k="unknown";f.Pa&&((h=f.Pa.Mj)&&"RtcErrorCode"in h&&(g=h.RtcErrorCode.toString()),h=w.J4.toString(f.Pa.Se),k=f.Pa.kg.toString());c.FindSessionFailureReason="FindSessionRequestFailed";c.HttpErrorCode=k;c.HttpErrorStatus=h;c.RtcErrorCode=g;u(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",h,k,
a.Qp,g,e);KHd(a,c,e);d(k)}}
function PHd(a,b,c,d,e,f){return function(g){RHd(0,1,!1);b&&b.Lf();a.q7a=null;a.g8a=null;MHd(a,g.Pa,!0,c);var h=SHd(g.Pa.Ce,"FindSession",null);if(h){if(Object.getType(h)!==Object)h=null;else{for(var k in h);b:if("enabled"in h){for(var l=(k=h.enabled)?a.$wg:a.Zwg,m=l.length,n=0;n<m;++n)if(!(l[n]in h)){h=null;break b}var r,l=(r=new zHd,r.ksb=h.enabled,r.hrb=h.errorMessage,r.nd=Ae().toString(),r);k&&(l.y5a=h.url,l.Fca=h.queryString,l.tK=h.connectionString,l.c_b=h.throttling_globalMaxNumberOfOutstandingMessages,l.O0b=
h.throttling_maxNumberOfOutstandingMessages,l.P0b=h.throttling_timeToWaitForResponse,l.Q0b=h.throttling_messageDelay);h=l}else h=null}if(h){if(h.ksb&&h.Fca&&h.tK){u(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",a.Qp);g=g.Pa;try{k=r=!1;var t=g.Mj,v=cj(g.Request.get_url());if(t&&"X-NewEnv"in t){var x=t["X-NewEnv"].toString().toLocaleLowerCase();k="true"===x;r="false"===x}var t=!1,y=0<=v.toLocaleLowerCase().indexOf("collab");k&&!y?t=!0:r&&y&&(t=!0);if(t){y={};y.HostName=v;y.Status=
w.J4.toString(g.Se);y.HttpStatus=g.kg.toString();var z=g.Request.get_headers(),E;for(E in z){var H={key:E,value:z[E]},O=H.key;O&&0<O.length&&(v=0,H.value&&(v=H.value.toString().length),y["r_"+O]=v)}if(g.Mj)for(var Q,U=(Q=new (Ca.$$(String)),Q.ga("X-CorrelationId"),Q.ga("X-OfficeCluster"),Q.ga("RtcErrorCode"),Q.ga("X-OfficeFE"),Q.ga("X-OFFICEFD"),Q.ga("X-MSEdge-Ref"),Q),V=g.Mj,Z=U.$$lge();Z.$$mn();){var Y=Z.$$cu();Y in V&&(y[Y]=V[Y])}var ca=g.Request.get_url();if(ca){var la=ca.indexOf("?");if(-1!==
la)for(var ra=ca.substr(la+1).split("&"),z=0;z<ra.length;++z){var sa=ra[z].split("=");if(2===sa.length){var ua=sa[0];if(ua&&0<ua.length){E=0;var xa=sa[1];xa&&(E=xa.length);y["q_"+ua]=E}}}}var Ea=go(y);u(559437006,500,15,Ea)}}catch(Sa){u(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Sa.toString())}d(h);return}c.FindSessionFailureReason="FindSessionInvalidResponse";c.IsRtcEnabled=h.ksb;c.IsQueryStringEmpty=!h.Fca;c.IsConnectionStringEmpty=!h.tK;u(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
a.Qp,h.ksb,!h.Fca,!h.tK)}else c.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",u(8745097,500,15,"Could not translate server response to findSession response for [{0}]",a.Qp)}else c.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",u(7372827,500,10,"Could not deserialize response data for [{0}]",a.Qp);KHd(a,c,f);e(null)}}
function OHd(a,b,c){u(50448152,500,50,"Using FindSessionUtils find session response");a.peb.AAg().CW(function(){ab(a.peb.AAg())?(u(50448153,500,50,"FindSessionUtils find Session resulted in success"),b(a.peb.BAg())):(u(50448154,500,15,"FindSessionUtils find Session resulted in error"),c(a.peb.BAg()))})}function GHd(a){a.hjc&&(window.clearTimeout(a.Lxe),a.hjc=!1)}function JHd(a){GHd(a);a.hjc=!0;a.Lxe=window.setTimeout(a.krf,a.d2c)}
function THd(a){var b=(new Date).getTime();a=a.Mwe+a.Bdb-b;0>a&&(a=0);return a}function EHd(a,b,c,d,e){u(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",a.tK);if(a.tK)b();else{var f=THd(a);window.setTimeout(function(){a.sendFindSessionRequestToServerInternal(b,c,d,e)},f)}}
AHd.prototype.VFg=function(a,b,c,d){if(c(d,"RequestMachineId")){this.Mwe=(new Date).getTime();c=Rk();var e=this,f=this;HHd(this,function(b){var c=Rk();e.mac(b);JHd(e);a();b=Rk()-c;u(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",b)},function(a){var c=Rk();f.tK=null;GHd(f);o6&&p6(o6,2,3);b(a);a=Rk()-c;u(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",a)},!1);c=Rk()-c;u(577599296,345,50,"SFSRTS - TimeElapsed: {0}",c)}};AHd.prototype.sendFindSessionRequestToServerInternal=AHd.prototype.VFg;
function BHd(a,b,c,d,e,f){this.Vhd=a;a=String.format("{0}={1}","ClientId",nh(d));a=String.format("{0}&{1}={2}",a,"usid",nh(e));a=String.format("{0}&{1}={2}",a,"UserApp",nh(c.toString()));a=String.format("{0}&{1}={2}",a,"UserType",nh((1).toString()));a=String.format("{0}&{1}={2}",a,"UserVersion",nh(b));a=String.format("{0}&{1}={2}",a,"clientProtocol",nh("1.0"));(b=4===c?String.format("{0}={1}","NoAuth","1"):f?Bs?String.format("{0}={1}","WacUserType",nh(Bs)):null:null)&&(a=String.format("{0}&{1}",a,
b));this.eqe=a}BHd.prototype={yKa:null,Vhd:null,eqe:null};function NHd(a){a.yKa&&""!==a.yKa||(a.yKa=a.Vhd(),u(575784194,500,a.yKa&&""!==a.yKa?50:15,"Query signature delegate called for refresh returned: {0} ",a.yKa));var b=String.format("{0}={1}","qs",nh(a.yKa));return String.format("{0}&{1}",b,a.eqe)}
function UHd(a){this.Gcf=Function.createDelegate(this,this.Rfe);this.eg=a;this.lt=Array(3);for(a=0;3>a;a++){this.lt[a]=Array(7);for(var b=0;7>b;b++)this.lt[a][b]=0}this.UZb=this.Rad=this.wjc=!1;this.ajc=0}
UHd.prototype={UZb:!1,uSd:null,PQd:null,iSd:0,nYd:0,lt:null,eg:null,wjc:!1,Rad:!1,jfd:0,Jxe:0,ajc:0,Rfe:function(){if(this.wjc){this.ajc++;if((new Date).getTime()-this.jfd<5E3+this.Jxe){for(var a={},b=0;3>b;b++)for(var c=0;7>c;c++)if(2!==b||3===c||!c){var d=window.AppRealtimeChannel.ApiType.toString(b)+window.AppRealtimeChannel.EventCountType.toString(c);a[d]=this.lt[b][c]}a.FSDomain=this.uSd;a.ConnectionDomain=this.PQd;a.FSRetryInterval=this.iSd;a.MaxPayloadSize=this.nYd;a.LogNumber=this.ajc;1===
this.ajc&&(b=VHd().dhc.toString(),a.FSLatencies=b,b=VHd().ZEb.toString(),a.ConLatencies=b);a=go(a);u(50644352,500,15,a)}this.jfd=(new Date).getTime();for(a=0;3>a;a++)for(b=0;7>b;b++)this.lt[a][b]=0;this.wjc=!1}}};function p6(a,b,c){2!==b&&!a.Rad||a.UZb||!window.navigator.onLine||a.eg.g1.bA||(a.lt[b][c]++,a.wjc=!0)}function WHd(a,b){a.Jxe=b;window.setInterval(a.Gcf,b);a.jfd=(new Date).getTime()}
function XHd(a,b,c,d,e,f,g,h,k,l,m,n){this.z1e=Function.createDelegate(this,this.vIf);this.Bvf=Function.createDelegate(this,this.Ele);this.UOd=Function.createDelegate(this,this.one);this.bgf=Function.createDelegate(this,this.Zge);this.c2e=Function.createDelegate(this,this.oJf);this.Tkf=Function.createDelegate(this,this.Fag);this.Skf=Function.createDelegate(this,this.Eag);this.blf=Function.createDelegate(this,this.jbg);this.ixf=Function.createDelegate(this,this.vsg);this.cmf=Function.createDelegate(this,
this.ucg);this.dmf=Function.createDelegate(this,this.vcg);this.C3e=Function.createDelegate(this,this.D5b);this.IQ=new (Da.$$(wa.$$(Do.aBb,YHd)));this.qed=(new Date(0)).getTime();this._clientId=a;this.TLb=b;this.vT=0;this.zh=d;this.Bfc=h;this.qZa=g;this.xP=k;this.dqe=e;this.AIa=f;this.Qp=c;this.lt=l;this.Zd=m;this.eg=n;this.L5d=1>100*Math.random()}
XHd.prototype={_clientId:null,wkd:!1,x0:null,vT:0,Zd:null,LNb:function(){return this.AIa.LNb()},dqe:null,aFb:1,w0:null,TLb:null,zh:null,QDe:0,Bfc:null,AIa:null,qZa:null,Qp:null,lt:null,eg:null,xP:null,ub:function(){this.xP.Ua.Ka("RC",this.C3e);this.xP.Ua.Ka("UPSR",this.dmf);this.xP.Ua.Ka("UPSC",this.cmf);lua(this.eg,this.lt);var a=this;Zi(function(){a.lt.Rie();o6&&o6.Rfe()});ZHd(this);$Hd();this.xP.Ua.Ka("SPC",this.ixf)},one:function(a,b){return a!==this.aFb?(u(4309017,500,50,"ConnectionToken verification failed for {0}",
b),!1):!0},e9a:function(){if(2!==this.vT&&1!==this.vT){u(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Qp);yHd(this.Bfc);var a=VHd();a.Ghd=a.kFc();this.nea(1,this.vT);this.Ele()}},Ele:function(){var a=this.aFb;this.wkd=!1;this.lt.Vac();this.AIa.zTc(this.c2e,this.bgf,this.qZa.rbf,this.UOd,a)},Zge:function(a){this.lt.Xac();var b=null;!a||"documentsessiondeleted"!==(b=a.toLowerCase())&&"documentsessionexpired"!==b?this.D5b(null,null):(u(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",
this.Qp,a),this.Hka())},D5b:function(a,b){u(4309018,500,50,"Disconnecting the connection [{0}]",this.x0);a=(a=2===this.vT||1===this.vT)&&!this.qZa.H5a;var c=!0,d=0;b&&Object.getType(b)!==Object.getType(Sys.EventArgs.Empty)&&b.g2b&&""!==b.g2b&&(a=!0,this.AIa.V3c(b.g2b),c=b.$4d,d=b.rLc);a&&this.nea(1,this.vT);++this.aFb;this.qZa.cfa();aId(this,c);this.AIa.oRc();ZHd(this);a&&window.setTimeout(this.Bvf,Math.min(d,3E4))},vsg:function(){var a=null,b,c,d=(c=this.AIa.R6b(b={val:a}),a=b.val,c);this.w0.qs=
d;u(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Qp,a)},oJf:function(a){this.qed=(new Date).getTime();var b=null,c,d;this.w0.qs=(d=this.AIa.R6b(c={val:b}),b=c.val,d);this.Zd.QCc&&(this.w0.url=a,o6&&(o6.PQd=cj(a)));var e=null;this.zh&&(e=this.zh.Di("WebServiceCall","ConnectToServer"));u(3290048,500,50,"Connecting to server for client [{0}]",this.Qp);a={};this.TLb&&(a.transport=1===this.TLb.length?this.TLb[0]:this.TLb);a.pingInterval=null;RHd(1,0,
!1);a.waitForPageLoad=!1;var f=this,g=this;this.w0.start(a,null).done(function(a){f.lt.Nie();RHd(1,1,!0);u(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",a.id,b)}).fail(function(a){u(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",g.AIa.mnd(),b,g.Qp);g.Zge(null);g.lt.Mie(a);RHd(1,1,!1);a={CorrelationId:b,ErrorDetails:a,ConnectionState:w.q4b.toString(g.vT)};g.xP.Ua.Ha("RCF",new LHd(0,a),null)}).always(function(){e&&
e.Lf();o6&&(o6.UZb=!1)})},Hka:function(){this.vT?(this.lt.Oie(),o6&&(o6.UZb=!0),u(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Qp),this.qZa.H5a=!0,this.Bfc.AC(),this.nea(0,this.vT),this.D5b(null,null),this.qZa.H5a=!1):u(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Qp)},s_a:function(a){this.xP.s_a(a)},w3c:function(a){return this.v3c(0,a)},v3c:function(a,b){var c=new (bb.$$(Object));this.xP.Ua.Ha("SP",new bId(a,b,c),null);return c.Wf()},
$nc:function(a){this.xP.$nc(a)},m$a:function(a){return this.IQ.hc(a)&&this.IQ.K(a).hc(0)?this.IQ.K(a).K(0).UG:null},D6b:function(){for(var a={},b=this.IQ.GetEnumerator();b.$$mn();){var c=b.$$cu();c.Aa().hc(0)&&(a[c.Dg()]=c.Aa().K(0).UG)}return a},vcg:function(a,b){for(a=b.d8d.GetEnumerator();a.$$mn();){var c=a.$$cu();this.IQ.hc(c.Dg())||this.IQ.ea(c.Dg(),new (wa.$$(Do.aBb,YHd)));var d=c.Aa();this.IQ.K(c.Dg()).ea(b.qh,new YHd(d.Presence,new Date(d.TimeStamp)));c.Dg()!==this._clientId||b.qh||this.xP.Ua.Ha("MPU",
new Hra(d.Presence),null)}},ucg:function(a,b){a=b.Eqb;b=a.length;for(var c=0;c<b;++c)this.IQ.Mc(a[c])},Qea:function(a,b,c){var d=new (bb.$$(Object));cId(this.xP,a,b,c,d);return d.Wf()},Yya:function(a){this.xP.Yya(a)},KFa:function(a){var b,c,d,e,f,g;(e=this.IQ.ng(a,d={val:b},null),b=d.val,e)&&(g=b.ng(0,f={val:c},null),c=f.val,g)?(a=(a=c)&&a.Uca?(new Date).getTime()-a.Uca.getTime()>(this.Zd.m5a?6E4:this.Zd.l5a)?2:1:1,c=new Lra(a,c.Uca)):c=null;return c},Cxa:function(a){var b=new (bb.$$(Object));this.xP.Ua.Ha("UCI",
new CIa(a,b),null);return b.Wf()},Ax:function(){return this._clientId},L5d:!1,nea:function(a,b){if((1!==this.vT||b||1!==a)&&this.vT!==b){var c=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.vT,b,a]));u(3290053,500,10,c)}if(this.vT!==a){switch(a){case 2:o6&&(o6.Rad=!0);this.x0=this.w0.id;u(3249539,500,50,"Established connection [{0}] for client [{1}]",this.x0,this.Qp);if((c=this.w0)&&c.transport&&
c.transport.name){var c=c.transport.name,d=c.toLowerCase();"websockets"===d?u(4290723,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"serversentevents"===d?u(4290752,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"foreverframe"===d?u(4290753,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"longpolling"===d?u(4290754,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"mocktransport"!==d&&u(4290755,500,15,"Unknown transport protocol encountered - '{0}'",c)}else u(4290722,500,10,"Transport protocol name is missing");
u(4298369,500,50,"Retrieving complete session state");c=null;this.zh&&(c=this.zh.Di("WebServiceCall","Receive First Presence"));var d=this.xP,e=this.UOd,f=this.aFb,g=this.Bfc,h=this.z1e;var k=new (wa.$$(Do.aBb,Object));if(this.IQ.hc(this._clientId))for(var l=this.IQ.K(this._clientId).$$ge();l.$$mn();){var m=l.$$cu();k.ea(m.Dg(),m.Aa().UG)}d.Ua.Ha("RPS",new dId(e,f,g,h,k,c),null);this.Zd.LLc&&(c=100*Math.random()<=this.Zd.MLc,(eId||(eId=new fId(this.xP,this.Zd,c))).af());break;case 1:2===b&&u(4298644,
500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.x0);break;case 0:if(eId&&eId.Lf(),this.qZa.H5a)u(3249543,500,50,"Connection [{0}] has been explicitly closed",this.x0);else{1===b&&(u(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.x0),this.lt.pBb());2===b&&u(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.x0);this.D5b(null,null);return}}this.vT=a;this.xP.Ua.Ha("CSC",new Gra(a,b),null)}},jbg:function(){if(this.Zd.wQa){var a=Lk(this.LNb(),"mid",!1);u(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.x0,a)}else u(522716053,500,50,"Detected that the connection [{0}] is slow",this.x0)},Eag:function(){u(3249545,600,15,"SignalR ERROR for connection [{0}];",this.x0)},Fag:function(a){a=q6(a);if(this.Zd.wQa&&a.startsWith("Keep alive timed out.")){var b=Lk(this.LNb(),
"mid",!1);u(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",a,b)}else this.L5d&&2E3>this.QDe&&!a.startsWith("Invok")&&!a.startsWith("Trigger")&&(u(578950464,500,50,"SignalR lib: {0}",a),this.QDe++)},vIf:function(){var a,b=[],c,d;(d=this.IQ.ng(this._clientId,c={val:a},null),a=c.val,d)&&this.IQ.Mc(this._clientId);for(d=this.IQ.Wo().$$ge();d.$$mn();)c=d.$$cu(),Array.add(b,c);d=b.length;for(var e=0;e<d;++e)c=b[e],this.IQ.Mc(c);a&&this.IQ.ea(this._clientId,a);this.xP.Ua.Ha("IPSC",new Kra(b),null)}};
function gId(a){switch(a){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",a,"Unknown SignalR state");}}function hId(a){var b=0;a.w0.state||(b=a.qed+15E3-(new Date).getTime(),0>b&&(b=0));return b}
function aId(a,b){function c(){if(a.wkd)u(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{a.wkd=!0,e.stop(!0,b)}catch(c){u(591692191,500,15,"Stopping connection failed: {0}",c.message)}}var d=hId(a),e=a.w0,f=a.x0;0<d?(u(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",f,d),window.setTimeout(c,d)):(u(36804372,500,50,"Stopping connection [{0}].",f),c())}
function ZHd(a){var b=++a.aFb;a.qed=(new Date(0)).getTime();a.w0=a.dqe();a.xP.Ua.Ha("RP",new iId(a.w0),null);a.w0.stateChanged(function(c){a.one(b,"StateChangedSignalR")&&a.nea(gId(c.newState),gId(c.oldState))});a.w0.connectionSlow(a.blf);a.w0.error(a.Skf);a.w0.log=a.Tkf}function jId(){return function(){return!1}}
function $Hd(){try{var a=$.signalR;if(!a)throw Error.invalidOperation("Failed to retrieve Signalr object");var b=a.version;if(!b)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===b){var c=a.transports;if(!c)throw Error.invalidOperation("Failed to retrieve transports object");var d=c.longPolling;if(!d)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!d.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");
d.supportsKeepAlive=jId()}}catch(e){u(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",e.message)}}function YHd(a,b){this.UG=a;this.Uca=b}YHd.prototype={UG:null,Uca:null};
function kId(a,b,c,d,e,f,g,h,k){var l=lId(),m=Jp?Jp:"1.0",n=mId(a,b),r=l.zDc?nId(n):new oId,t;o6||(o6=new UHd(d));t=o6;l.L4d&&WHd(t,l.K4d);var v="",v=g&&""!==g?g:"/rtc2/";t.uSd=cj(v);var x=v+"signalr";g=v+"findsession";v=new pId;k=k||qId();vb(556867617,500,31E3>=l.p2b,"Client attempting to override max payload size beyond absolute limit");var y=Math.min(l.p2b,31E3);t.nYd=y;t=new rId(l,new sId(v),a,n,function(a){return new tId(a.createHubProxy("realtimeChannelHub"))},f,k,r,t,y);h||(h=DHd(b,d,g,f,m,
a,n,k,e,null,null));h.d_e(l.bsa);b=new uHd(n);a=new XHd(a,c?c.split(","):null,n,f,function(){return window.$.hubConnection(x)},h,t,b,k,r,l,d);a.ub();return a}function mId(a,b){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",a,uId(Do.Cbc.toString(3)),uId(Do.Dbc.toString(1)),b)}function uId(a){return a?a.charAt(0).toLocaleUpperCase()+a.substring(1,a.length):a}function vId(){}
function nId(a){wId||(wId=new vId,u(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",a));return wId}
vId.prototype={igd:0,kJb:0,Lye:0,Jye:0,Kye:0,Oye:0,Nye:0,Mye:0,qeb:null,ehc:null,oed:null,jfb:null,eIb:null,RJa:null,ped:null,wed:null,ved:null,lIb:null,Ded:null,ghc:null,Bpe:0,RCe:0,GIb:0,ofd:0,Vac:function(){this.igd++;this.oed=new Date;this.qeb||(this.qeb=new Date)},Nie:function(){this.kJb++;this.RJa=new Date;this.ehc||(this.ehc=this.RJa);this.lIb=this.RJa;this.qeb&&1===this.kJb&&(this.GIb=Math.max(this.GIb,this.RJa.getTime()-this.qeb.getTime()));this.jfb&&1<this.kJb&&(this.GIb=Math.max(this.GIb,
this.RJa.getTime()-this.jfb.getTime()));this.eIb&&1<this.kJb&&(this.ofd=Math.max(this.ofd,this.RJa.getTime()-this.eIb.getTime()))},Xac:function(){this.Lye++;this.ped=new Date},pBb:function(){this.Jye++;this.jfb=new Date},Oie:function(){this.Kye++;this.eIb=new Date},Z1c:function(){this.wed=new Date;this.Oye++},qBb:function(){this.ghc||(this.ghc=new Date);this.Nye++},UUa:function(){this.ved=new Date;this.Mye++},eye:!1,Rie:function(){if(!this.eye&&this.igd){var a=this.Q4b();u(39321871,500,15,go(a));
this.eye=!0}},Mie:function(a){var b,c,d;xId(a,b={val:b},c={val:c},d={val:d});b=b.val;c=c.val;d=d.val;b&&200!==b&&(u(40157596,500,15,go({HttpErrorCode:b,HttpErrorStatus:c,Exception:d})),400<=b&&499>=b&&this.Bpe++,500<=b&&599>=b&&this.RCe++)},Jzb:function(){this.Ded=new Date},Kzb:function(){this.jfb=this.lIb=new Date},Q4b:function(){return{numberOfConnectionAttempts:this.igd,numberOfSuccessfulConnections:this.kJb,numberOfFailedConnections:this.Lye,numberOfDisconnectedConnections:this.Jye,numberOfExplicitDisconnectedConnections:this.Kye,
numberOfSentMessages:this.Oye,numberOfReceivedMessages:this.Nye,numberOfLostMessages:this.Mye,firstConnectionAttempt:this.qeb?this.qeb:null,firstMessageReceived:this.ghc?this.ghc:null,firstConnectionSuccess:this.ehc?this.ehc:null,lastConnectionAttempt:this.oed?this.oed:null,lastConnectionSuccess:this.RJa?this.RJa:null,lastConnectionFailure:this.ped?this.ped:null,lastMessageSent:this.wed?this.wed:null,lastMessageLost:this.ved?this.ved:null,lastDisconnect:this.jfb?this.jfb:null,lastExplicitDisconnect:this.eIb?
this.eIb:null,lastTimeOnline:this.lIb?this.lIb:null,lastTimeOffline:this.Ded?this.Ded:null,maxDisconnectedTimeMs:this.GIb,maxExplicitDisconnectedTimeMs:this.ofd,clientConnectionErrors:this.Bpe,serverConnectionErrors:this.RCe}}};function oId(){}oId.prototype={Vac:function(){},Nie:function(){},Xac:function(){},pBb:function(){},Oie:function(){},Z1c:function(){},qBb:function(){},UUa:function(){},Rie:function(){},Mie:function(){},Jzb:function(){},Kzb:function(){}};function tId(a){this.QB=a}
tId.prototype={QB:null,Cxa:function(a){return this.QB.invoke("UpdateClientInfo",a)},Qea:function(a,b){return this.QB.invoke("SendUpdateNotification",a,b)}};function yId(){}
function lId(){var a=L;if(!a){var b;return b=new yId,b.TPd=!1,b.m5a=!1,b.l5a=9E5,b.QCc=!1,b.fMc=!1,b.gMc=!0,b.zDc=!1,b.bsa=9E4,b.LLc=!1,b.MLc=5,b.q2b=3E5,b.o2b=2E4,b.p2b=8E3,b.wQa=!1,b}var c;return c=new yId,c.TPd=a.ia("AwayStatusManagerIsEnabled"),c.m5a=a.ia("AwayStatusOneMinuteTimeoutIsEnabled"),c.l5a=a.fd("AwayCoauthorThresholdMs",9E5),c.QCc=a.ia("RtcAllowCrossDomainAccessEnabled"),c.fMc=a.ia("ShouldLogOnContentNotification"),c.gMc=a.ia("ShouldLogOnHostSubscriptionNotification"),c.zDc=a.ia("RtcClientMetricsEnabled"),
c.bsa=a.fd("RtcFindSessionRequestTimeoutInMS",6E4),c.L4d=a.ia("RtcJsClientFrequentlyLogsMetrics"),c.OLc=a.fd("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),c.K4d=a.fd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),c.LLc=a.ia("RtcClientMessageTelemetryEnabled"),c.MLc=a.fd("RtcClientMessageTelemetrySampleSize",5),c.q2b=a.fd("RtcSendTelemetryMessageIntervalInMS",3E5),c.o2b=a.fd("RtcLogClientMessageMetricsTimeOutInMs",2E4),c.p2b=a.fd("RtcMaxPayloadSizeInCharactersOverride",8E3),c.wQa=a.fc("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",
!1),c}yId.prototype={TPd:!1,m5a:!1,l5a:0,QCc:!1,fMc:!1,gMc:!1,zDc:!1,bsa:0,L4d:!1,OLc:0,K4d:0,LLc:!1,MLc:0,q2b:0,o2b:0,p2b:0,wQa:!1};function zId(){this.Ua=new re}function qId(){return AId||(AId=new zId)}zId.prototype={Ua:null,s_a:function(a){this.Ua.Ka("CSC",a)},$nc:function(a){this.Ua.Ka("PU",a)},Yya:function(a){this.Ua.Ka("UNR",a)}};function BId(a,b){a.Ua.Ka("CPSWM",b)}function cId(a,b,c,d,e){a.Ua.Ha("SUN",new CId(b,c,d,e),null)}function tHd(a,b){a.Ua.Ha("RC",b,null)}
function bId(a,b,c){bId.initializeBase(this);this.qh=a;this.Z1b=b;this.Qtb=c}bId.prototype={qh:0,Z1b:null,Qtb:null};function CId(a,b,c,d){CId.initializeBase(this);this.qh=a;this.a8d=b;this.cRd=c;this.Qtb=d}CId.prototype={qh:0,a8d:null,cRd:!1,Qtb:null};function iId(a){iId.initializeBase(this);this.uTd=a}iId.prototype={uTd:null};function dId(a,b,c,d,e,f){dId.initializeBase(this);this.oNc=a;this.tZb=b;this.OQd=c;this.NEc=e;this.CQd=d;this.GMc=f}
dId.prototype={GMc:null,NEc:null,CQd:null,OQd:null,tZb:0,oNc:null};function DId(a,b){DId.initializeBase(this);this.qh=a;this.d8d=b}DId.prototype={qh:0,d8d:null};function EId(a){EId.initializeBase(this);this.Eqb=a}EId.prototype={Eqb:null};function FId(a,b,c,d){FId.initializeBase(this);this.g2b=a;this.rLc=b;this.htb=c;this.$4d=d}FId.prototype={g2b:null,rLc:0,htb:null,$4d:!1};function IHd(a,b){IHd.initializeBase(this);this.czf=a;this.VAf=b}IHd.prototype={czf:!1,VAf:!1};
function LHd(a,b){LHd.initializeBase(this);this.mSd=a;this.hrb=b}LHd.prototype={mSd:0,hrb:null};function GId(a){GId.initializeBase(this);this.D3d=a}GId.prototype={D3d:null};
function rId(a,b,c,d,e,f,g,h,k,l){this.uYb=Function.createDelegate(this,this.$$b);this.JKd=Function.createDelegate(this,this.ohe);this.KKd=Function.createDelegate(this,this.XZc);this.eYb=Function.createDelegate(this,this.I$b);this.nae=Function.createDelegate(this,this.Cxa);this.ktf=Function.createDelegate(this,this.v3c);this.whf=Function.createDelegate(this,this.Q6f);this.xhf=Function.createDelegate(this,this.R6f);this.zhf=Function.createDelegate(this,this.T6f);this.yhf=Function.createDelegate(this,
this.S6f);this.ntf=Function.createDelegate(this,this.Qea);this.vjf=Function.createDelegate(this,this.E9f);this.khd=new (wa.$$(Do.ADb,Object));var m=new window.Map;m.set("SkipAria","True");var n,m=(n=new ALa,n.extendedProperties=m,n),r;this.$Ge=(r=new BLa,r.kpiName="ContentUpdateNotificationReceived",r.kpiType=0,r.optionalProperties=m,r.blockFutureEmissionDurationInMs=3E5,r);this.NJb=L.Va("OwningFeatureCrewForRtcNotificationKpis");rId.initializeBase(this,[g]);this.Zd=a;this.hgd=this.ggd=0;this.rhb=
b;this.rhb.boc(this.Ulf);this._clientId=c;this.cBe=e;this.Rr.Ua.Ka("RP",this.yjf);this.Rr.Ua.Ka("RPS",this.vjf);this.Rr.Ua.Ka("SUN",this.ntf);this.Rr.Ua.Ka("IPU",this.yhf);this.Rr.Ua.Ka("IUNR",this.zhf);this.Rr.Ua.Ka("IPSU",this.xhf);this.Rr.Ua.Ka("IPSC",this.whf);this.Rr.Ua.Ka("SP",this.ktf);this.Rr.Ua.Ka("UCI",this.nae);this.zh=f;this.Qp=d;this.lt=h;this.nJ=k;this.KIb=l;this.xIa=window.$$as(String,F.od.Application)||""}
rId.prototype={Zd:null,QB:null,ggd:0,hgd:0,Exe:!1,_clientId:null,cBe:null,zh:null,vjc:0,Qp:null,lt:null,nJ:null,KIb:0,xIa:null,G9f:function(a,b){this.QB=this.cBe(b.uTd);this.rhb.Fd();this.QB.QB.on("presenceUpdated",this.eYb);this.QB.QB.on("persistentStateUpdated",this.KKd);this.QB.QB.on("persistentStateCleared",this.JKd);this.QB.QB.on("updateNotification",this.uYb)},nea:function(a,b){this.$ja=b.yK;if(2===b.yK){for(a=this.khd.$$ge();a.$$mn();)b=a.$$cu(),this.Qea(null,new CId(b.Dg(),b.Aa(),!1,new (bb.$$(Object))));
this.khd=new (wa.$$(Do.ADb,Object))}},E9f:function(a,b){b.CQd();for(a=0;3>a;++a)HId(this,a,b)},v3c:function(a,b){a=b.Z1b;var c,d=b.Qtb;p6(this.nJ,1,0);try{c=IId(a,this.KIb)}catch(l){p6(this.nJ,1,3);u(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",l.message);d.SX(l);return}var e=new (Da.$$(window.Common.PresenceDataEntryForClients)),f;e.ea(this._clientId,(f=new window.Common.PresenceDataEntryForClients,f.Presence=a,f.TimeStamp=(new Date).getTime(),f));
this.Rr.Ua.Ha("UPSR",new DId(b.qh,e),null);if(2!==this.$ja)this.lt.UUa(),p6(this.nJ,1,2),d.Uh(null);else{var g=this.vjc.toString();++this.vjc;var h=this;f=new JId(function(){return KId(h,b.qh,c,g)},g);f=LId(this.rhb,"0,"+b.qh).ga(f);var k=this;MId(f,function(a){2===a&&p6(k.nJ,1,6);d.Uh(null)});NId(f,function(){})}},Cxa:function(a,b){a=b.Atc;var c=b.Qtb,d;try{d=IId(a,this.KIb)}catch(f){u(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",f.message);c.SX(f);
return}try{var e=this;this.QB.Cxa(d).done(function(){u(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(a){e.H5a||u(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",q6(a));c.Uh(null)})}catch(f){u(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",f.message),c.Uh(null)}},Qea:function(a,b){var c=b.qh;a=b.a8d;var d=b.cRd,e=b.Qtb,f;p6(this.nJ,0,0);try{f=IId(a,this.KIb)}catch(l){p6(this.nJ,0,3);u(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",
l.message);e.SX(l);return}if(2!==this.$ja)d?this.khd.ea(c,a):(this.lt.UUa(),p6(this.nJ,0,2)),e.Uh(null);else{var g=this.vjc.toString();++this.vjc;var h=this;b=new JId(function(){return OId(h,c,f,g)},g);b=LId(this.rhb,"1,"+c).ga(b);var k=this;MId(b,function(a){2===a&&p6(k.nJ,0,6);e.Uh(null)});NId(b,function(){})}},cfa:function(){this.QB.QB.off("presenceUpdated",this.eYb);this.QB.QB.off("persistentStateUpdated",this.KKd);this.QB.QB.off("persistentStateCleared",this.JKd);this.QB.QB.off("updateNotification",
this.uYb)},S6f:function(a,b){this.I$b(b.sEa,b.oEc)},I$b:function(a){this.lt.qBb();this.XZc(0,a)},R6f:function(a,b){this.XZc(b.qh,b.sEa)},XZc:function(a,b){this.lt.qBb();PId(this,a,b,null)},Q6f:function(a,b){this.ohe(b.Eqb)},ohe:function(a){this.lt.qBb();if(wb.xVa(500,100))for(var b=0;b<a.length;++b);a.length&&(this.Rr.Ua.Ha("UPSC",new EId(a),null),this.Rr.Ua.Ha("PSC",new Kra(a),null),this.Rr.Ua.Ha("PU",new Fra({},a),null))},T6f:function(a,b){this.$$b(b.Dk,b.Oya)},$$b:function(a,b){this.Zd.fMc&&!a&&
u(40128990,500,50,"Received ContentUpdate notification from the server");if(!a&&this.NJb&&0<this.NJb.length){var c,d;var e=(c=new CLa,c.topLevelKpiName="ContentUpdateNotificationReceived",c.featureName="RtcNotification",c.crewAlias=this.NJb,c.vetoPillar=window.Common.QosPillarName.toString(4),c);try{d=window.healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(Ce(),e)}catch(h){qba(521457890,383,10,h,"Failed to initialize extendedHealth"),d=null}d&&d.logKpiUsage(this.$Ge)}this.Zd.gMc&&13===a&&
u(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",b||"<none>"));this.lt.qBb();if(5===a){var f;try{if(b&&""!==b){var g=JSON.parse(b);f=new FId(g.rr,g.rbp,g.rd,g.sa)}else f=null}catch(h){u(593844380,500,15,"Error when parsing reconnect hint: {0}",h.message),f=null}a=f?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",f.htb,f.rLc):"Received client reconnection request from the server without params.";u(18637071,
500,50,a);tHd(this.Rr,f)}else f=SHd(b,String.format("UpdateNotification-{0}",Do.ADb.toString(a)),null),this.Rr.Ua.Ha("UNR",new Ira(a,f),null)}};
function PId(a,b,c,d){if(wb.xVa(500,100))for(var e in c);delete c[a._clientId];if(!Vg(c)){for(var f in c){e={key:f,value:c[f]};var g=e.key;c[g]=SHd(e.value,"Presence",g)}f=new (Da.$$(window.Common.PresenceDataEntryForClients));var h=(new Date).getTime(),k;for(k in c){e={key:k,value:c[k]};var g=e.key,l;if(d)l=d[g],l.Presence=e.value;else{var m;l=(m=new window.Common.PresenceDataEntryForClients,m.Presence=e.value,m.TimeStamp=h,m)}f.ea(g,l)}a.Rr.Ua.Ha("UPSR",new DId(b,f),null);switch(b){case 0:a.Exe||
(u(4539734,500,50,"Raising first presence update notification for [{0}]",a.Qp),a.Exe=!0,F.hn&&(F.hn.IsCoauthSession=!0));a.Rr.Ua.Ha("PU",new Fra(c,[]),null);break;default:a.Rr.Ua.Ha("PSU",new Jra(b,c),null)}}}
function OId(a,b,c,d){var e=null,f=new QId,g=new RId;u(3249505,500,50,"Sending update notification for [{0}]",a.Qp);if(2!==a.$ja)return a.lt.UUa(),p6(a.nJ,0,2),u(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",a.Qp),SId(g),g;a.zh&&3===b&&20>a.hgd&&(e=a.zh.Di("WebServiceCall","Send WetContent Update"),a.hgd++);f.af();r6(g.uYa,1);a.QB.Qea(b,c).done(function(){a.lt.Z1c();p6(a.nJ,0,1);u(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",d,a.Qp);
r6(g.Ina,1);f&&(f.Lf(),f.Qq()>a.Zd.OLc?p6(a.nJ,0,4):p6(a.nJ,0,5))}).fail(function(b){a.H5a||(a.lt.UUa(),p6(a.nJ,0,3),u(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",d,q6(b),a.Qp));r6(g.Ina,2)}).always(function(){e&&e.Lf()});return g}
function KId(a,b,c,d){var e=null,f=new QId,g=new RId;u(3249501,500,50,"Sending presence update for [{0}]",a.Qp);if(2!==a.$ja)return a.lt.UUa(),p6(a.nJ,1,2),u(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",a.Qp),SId(g),g;a.zh&&20>a.ggd&&(e=a.zh.Di("WebServiceCall","Send Presence Message"),a.ggd++);f.af();r6(g.uYa,1);try{a.QB.QB.invoke("UpdatePersistentState",b,c).done(function(){a.lt.Z1c();p6(a.nJ,1,1);u(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",
d,a.Qp);r6(g.Ina,1);f&&(f.Lf(),f.Qq()>a.Zd.OLc?p6(a.nJ,1,4):p6(a.nJ,1,5))}).fail(function(b){a.H5a||(a.lt.UUa(),p6(a.nJ,1,3),u(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",d,q6(b),a.Qp));r6(g.Ina,2)}).always(function(){e&&e.Lf()})}catch(h){u(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",h.message),p6(a.nJ,1,3),r6(g.Ina,2)}return g}
function HId(a,b,c){try{a.QB.QB.invoke("GetCompletePersistentStateWithMetadata",b).done(function(d){if(c.oNc(c.tZb,"GetCompletePresenceSuccess")){xHd(c.OQd);u(3249540,500,50,"Successfully retrieved complete session state for [{0}]",a.Qp);a.Rr.Ua.Ha("RMID",null,null);var e={},f;for(f in d){var g={key:f,value:d[f]};e[g.key]=g.value.Presence}PId(a,b,e,d);a.Rr.Ua.Ha("CPSWM",new GId(d),null);c.NEc.hc(b)&&(d=c.NEc.K(b),e=new (bb.$$(Object)),a.Rr.Ua.Ha("SP",new bId(b,d,e),null))}}).fail(function(b){c.oNc(c.tZb,
"GetCompletePresenceFail")&&(u(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",q6(b),a.Qp),tHd(a.Rr,null))}).always(function(){c.GMc&&c.GMc.Lf()})}catch(d){u(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",c.tZb,d.message)}}
function IId(a,b){var c;try{c=Id(a)}catch(d){throw a=String.format("Failed to JSON-serialize payload : {0}",d),u(18637072,500,10,a),Error.argument("payload",a);}if(c.length>b)throw a=String.format("Payload exceeds maximum length: {0} > {1}.",c.length,b),u(18637074,500,10,a),Error.argument("payload",a);return c}
function SHd(a,b,c){if(!a)return null;if(Object.getType(a)!==String)return a=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",b,Object.getType(a).getName(),c),u(18637075,500,10,a),null;var d=null;try{d=kn(a)}catch(e){a=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",b,e,c),u(18637077,500,10,a)}return d}
function q6(a){if(!a)return"";if(String.isInstanceOfType(a))return a.toString();try{return Id(a)}catch(b){return a.toString()}}function xId(a,b,c,d){b.val=0;c.val=null;d.val=null;if(a)try{var e=a.source;e&&Object.getType(e)===String&&(d.val=e);var f=a.context;f&&(a=f,b.val=a.status?a.status:0,c.val=a.statusText?a.statusText:null)}catch(g){}}function QId(){}
QId.prototype={nk:null,ykd:null,Qq:function(){return this.nk?this.ykd?this.ykd.getTime()-this.nk.getTime():(new Date).getTime()-this.nk.getTime():0},af:function(){this.nk=new Date},Lf:function(){this.ykd=new Date}};function RId(){this.uYa=new (s6.$$(w.XWc));this.Ina=new (s6.$$(w.UWc))}RId.prototype={uYa:null,Ina:null};function SId(a){r6(a.uYa,2);r6(a.Ina,2)}function NId(a,b){a=a.Ina;a.$ba=b;TId(a)}function MId(a,b){a=a.uYa;a.$ba=b;TId(a)}
function s6(){this.cqe=this.Qb["AppRealtimeChannel.CompletionTask$1"].T===Number||Type.isEnum(this.Qb["AppRealtimeChannel.CompletionTask$1"].T)?0:this.Qb["AppRealtimeChannel.CompletionTask$1"].T===Boolean?!1:null}
s6.$$=function(a){var b=Do.__tc=Do.__tc||{},c="CompletionTask$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];s6.apply(this,a)};d.registerClass("AppRealtimeChannel.__tc."+c);d.prototype.Qb={"AppRealtimeChannel.CompletionTask$1":{T:a},ctor:s6};a=s6.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};s6.prototype={R9c:!1,npe:!1,$ba:null};
function TId(a){a.R9c&&a.$ba&&!a.npe&&(a.npe=!0,a.$ba(a.cqe))}function r6(a,b){a.R9c||(a.R9c=!0,a.cqe=b,TId(a))}function JId(a,b){this.OCe=a;this.L6a=b}JId.prototype={OW:function(){return this.OCe()},L6a:null,OCe:null};function UId(a,b){this.Cjd=a;this.VMc=b;this.QRa=VId;this.ZKa=this.KLb=this.SFb=0}function VId(a,b){return window.setTimeout(a,b)}UId.prototype={ZKa:0,KLb:0,SFb:0,Cjd:null,LJa:!1,Ymc:null,qhb:null,bfb:!1,VMc:null,QRa:null};
function WId(a,b){a.LJa=!1;a.qhb&&b&&(a.SFb++,SId(a.qhb));a.Ymc=null;a.qhb=null}function XId(a,b,c){a.KLb++;WId(a,!0);a.LJa=!0;a.Ymc=b;a.qhb=c}function YId(a){0<a.ZKa&&0<a.SFb&&u(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",a.VMc,a.SFb,a.ZKa);0<a.ZKa&&0<a.KLb&&u(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",a.VMc,a.KLb,a.ZKa)}
function ZId(a,b){this.ltf=Function.createDelegate(this,this.hmg);ZId.initializeBase(this,[a,b]);this.nfb=(new Date(0)).getTime();this.UDc=function(){return(new Date).getTime()}}
ZId.prototype={HIc:0,nfb:0,UDc:null,ub:function(a){this.bfb||(this.HIc=a,this.bfb=!0)},ga:function(a){this.bfb||this.ub(200);this.ZKa++;var b=this.UDc(),c=new RId;this.nfb>b&&(this.nfb=b);this.LJa?(WId(this,!0),XId(this,a,c)):this.nfb+this.HIc<=b?this.hCb(a,c):(XId(this,a,c),this.QRa(this.ltf,this.nfb+this.HIc-b));return c},hmg:function(){if(this.LJa){var a=this.Ymc,b=this.qhb;WId(this,!1);this.hCb(a,b)}},hCb:function(a,b){this.nfb=this.UDc();a=this.Cjd(a);MId(a,function(a){r6(b.uYa,a)});NId(a,function(a){r6(b.Ina,
a)})}};function $Id(a,b){this.mtf=Function.createDelegate(this,this.Rze);this.hif=Function.createDelegate(this,this.H7f);this.Ua=new re;$Id.initializeBase(this,[a,b]);this.jJb=0;this.NLb=[];this.tQa=aJd}function aJd(a){window.clearTimeout(a)}
$Id.prototype={kme:0,BIc:0,tQa:null,jJb:0,NLb:null,afb:!1,dld:0,Cfc:0,Qfc:0,ga:function(a){this.bfb||this.ub(15E3,5);this.ZKa++;var b=new RId;this.LJa?XId(this,a,b):this.jJb<this.BIc?this.hCb(a,b):(XId(this,a,b),this.afb=!1);return b},hCb:function(a,b){a=this.Cjd(a);var c=this.QRa(this.hif,this.kme);++this.jJb;Array.add(this.NLb,c);var d=this.Cfc;MId(a,function(a){r6(b.uYa,a)});var e=this;NId(a,function(a){e.Cfc===d&&(e.Cfc===d&&(--e.jJb,e.tQa(c),Array.remove(e.NLb,c),e.LJa&&e.LJa&&!e.afb&&(e.dld=
e.QRa(e.mtf,0),e.afb=!0)),r6(b.Ina,a))})},Rze:function(){this.afb=!1;if(this.LJa){var a=this.Ymc,b=this.qhb;WId(this,!1);this.hCb(a,b)}},H7f:function(){++this.Qfc;var a=Math.floor(this.BIc/2);this.Qfc>a&&(this.Qfc=-1E9,this.Ua.Ha("TMUDM",null,null))},boc:function(a){this.Ua.Ka("TMUDM",a)},Fd:function(){this.ZKa=this.KLb=this.SFb=this.Qfc=0;++this.Cfc;for(var a=this.NLb,b=a.length,c=0;c<b;++c)this.tQa(a[c]);this.jJb=0;this.NLb=[];WId(this,!0);this.afb&&(this.tQa(this.dld),this.dld=0,this.afb=!1)},
ub:function(a,b){this.bfb||(this.kme=a,this.BIc=b,this.bfb=!0)}};function pId(){}pId.prototype={};function bJd(a,b){return new ZId(a,b)}function cJd(a,b){return new $Id(a,b)}function sId(a){this.Ua=new re;this.mjc=new (Da.$$(oHd));this.kjc=new (Da.$$(pHd));this.Oxg=a;this.Ceb=cJd(function(a){return a.OW()},"GlobalMaxOustandingThrottler");var b=this;this.Ceb.boc(function(){b.Ua.Ha("TMUDM",null,null)})}
sId.prototype={Oxg:null,mjc:null,kjc:null,Ceb:null,Zd:null,Ueb:!1,ub:function(a){this.Ueb||(this.Zd=a,this.Ceb.ub(this.Zd.aNc,this.Zd.VSd),this.Ueb=!0)},Fd:function(){for(var a=this.mjc.GetEnumerator();a.$$mn();){var b=a.$$cu();YId(b.Aa())}for(a=this.kjc.GetEnumerator();a.$$mn();)b=a.$$cu(),YId(b.Aa()),b.Aa().Fd();YId(this.Ceb);this.Ceb.Fd()},boc:function(a){this.Ua.Ka("TMUDM",a)}};
function LId(a,b){a.Ueb||a.ub(new FHd(200,15E3,5,1E3));var c,d,e;if(e=a.mjc.ng(b,d={val:c},null),c=d.val,!e){var f,g,h;(h=a.kjc.ng(b,g={val:f},null),f=g.val,h)||(f="MaxOutstandingThrottler-"+b,c=a.Ceb,f=cJd(c.Qzc||(c.Qzc=Function.createDelegate(c,c.ga)),f),f.ub(a.Zd.aNc,a.Zd.mYd),f.boc(function(){a.Ua.Ha("TMUDM",null,null)}),a.kjc.ga(b,f));c="MaxRateThrottler-"+b;c=bJd(f.Qzc||(f.Qzc=Function.createDelegate(f,f.ga)),c);c.ub(a.Zd.BYd);a.mjc.ga(b,c)}return c}
function FHd(a,b,c,d){this.BYd=a;this.aNc=b;this.mYd=c;this.VSd=d}FHd.prototype={BYd:0,aNc:0,mYd:0,VSd:0};function dJd(){this.i$c=0;this.dhc=eJd();this.ZEb=eJd();this.LIa=this.mXa=0;this.kFc=function(){return new Date}}function VHd(){fJd||(fJd=new dJd);return fJd}dJd.prototype={H6d:!1,Ghd:null,dhc:null,ZEb:null,mXa:0,LIa:0,i$c:0,kFc:null};function gJd(a,b){var c=b.getTime()-a.Ghd.getTime();a.Ghd=b;return c}
function RHd(a,b,c){var d=VHd();d.H6d||(c&&(d.H6d=!0),c=d.kFc(),!a&&5<d.mXa||1===a&&5<d.LIa||(d.i$c<a?(1===d.mXa%2&&(d.dhc[d.mXa]=-1,d.mXa++),d.i$c=a,1===b&&(d.ZEb[d.LIa]=-1,d.LIa++),d.ZEb[d.LIa]=gJd(d,c),d.LIa++):a?(d.ZEb[d.LIa]=gJd(d,c),d.LIa++):(d.dhc[d.mXa]=gJd(d,c),d.mXa++)))}function eJd(){for(var a=Array(6),b=0;b<a.length;b++)a[b]=0;return a}
function fId(a,b,c){this.itf=Function.createDelegate(this,this.Il);this.Vqf=Function.createDelegate(this,this.xig);this.Zd=b;this.yfd=c;this.Pgb=!1;this.Rr=a;this.Rr.Yya(this.Vqf)}
fId.prototype={Rr:null,yfd:!1,Pgb:!1,Jna:null,Djd:0,Zd:null,kfd:0,af:function(){if(this.yfd&&!this.Pgb){var a=this.Zd.q2b;this.kfd=this.Zd.o2b;a<=this.kfd?(u(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Zd.q2b,this.Zd.o2b),this.yfd=!1):(this.Pgb=!0,this.Djd=window.setInterval(this.itf,a))}},Il:function(){if(this.Pgb){var a=wl().toString();this.Jna=
new hJd(a);cId(this.Rr,16,a,!1,new (bb.$$(Object)));var b=this;window.setTimeout(function(){if(b.Jna&&b.Jna.VWc===a){if(0<b.Jna.a9b.Qa()){var c=b.Jna.a9b.Jd().join(",");u(571339719,500,15,"ClientMessageLatencies:[{0}]",c)}else u(562312150,500,50,"No client message latencies recorded");b.Jna=null}},this.kfd)}},Lf:function(){this.Djd&&(window.clearInterval(this.Djd),this.Pgb=!1)},xig:function(a,b){16===b.Dk?cId(this.Rr,17,b.Oya,!1,new (bb.$$(Object))):17===b.Dk&&this.Pgb&&b.Oya&&(a=b.Oya)&&this.Jna&&
a.toString()===this.Jna.VWc&&(a=(new Date).getTime()-this.Jna.mke,this.Jna.a9b.ga(a))}};function hJd(a){this.VWc=a;this.mke=(new Date).getTime();this.a9b=new (Ca.$$(Number))}hJd.prototype={VWc:null,mke:0,a9b:null};sHd.registerClass("AppRealtimeChannel.ARtcMessageHandler");uHd.registerClass("AppRealtimeChannel.ConnectedUsageKpiLogger",null,eHd);zHd.registerClass("AppRealtimeChannel.FindSessionResponse");AHd.registerClass("AppRealtimeChannel.FindSessionStrategy",null,fHd);BHd.registerClass("AppRealtimeChannel.FindSessionStrategy.FindSessionQueryStringGenerator");
UHd.registerClass("AppRealtimeChannel.FrequentLoggingMetrics");XHd.registerClass("AppRealtimeChannel.RealtimeChannel",null,n6,Oc);YHd.registerClass("AppRealtimeChannel.RealtimeChannel.PresenceData");(function(){}).registerClass("AppRealtimeChannel.RealtimeChannel.RealtimeChannelFactory");vId.registerClass("AppRealtimeChannel.RealtimeChannelMetrics",null,gHd,Rga);oId.registerClass("AppRealtimeChannel.NoopRealtimeChannelMetrics",null,gHd,Rga);
tId.registerClass("AppRealtimeChannel.RealtimeChannelProxy",null,hHd,iHd);yId.registerClass("AppRealtimeChannel.RealtimeChannelSettings",null,kHd);zId.registerClass("AppRealtimeChannel.RtcEventHub",null,jHd);bId.registerClass("AppRealtimeChannel.SendPersistentStateEventArgs",Sys.EventArgs);CId.registerClass("AppRealtimeChannel.SendUpdateNotificationEventArgs",Sys.EventArgs);iId.registerClass("AppRealtimeChannel.RefreshProxyEventArgs",Sys.EventArgs);
dId.registerClass("AppRealtimeChannel.RefreshAllPersistentStateEventArgs",Sys.EventArgs);DId.registerClass("AppRealtimeChannel.UpdatePersistentStateRequestEventArgs",Sys.EventArgs);EId.registerClass("AppRealtimeChannel.UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs);FId.registerClass("AppRealtimeChannel.RefreshConnectionReconnectArgs",Sys.EventArgs);IHd.registerClass("AppRealtimeChannel.SessionPropertiesChangedEventArgs",Sys.EventArgs);
LHd.registerClass("AppRealtimeChannel.RtcConnectFailedEventArgs",Sys.EventArgs);GId.registerClass("AppRealtimeChannel.GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs);rId.registerClass("AppRealtimeChannel.RtcMessageHandler",sHd);(function(){}).registerClass("AppRealtimeChannel.RtcUtils");QId.registerClass("AppRealtimeChannel.SimpleStopwatch");RId.registerClass("AppRealtimeChannel.MessageStatus",null,lHd);JId.registerClass("AppRealtimeChannel.MessageHandler",null,mHd);UId.registerClass("AppRealtimeChannel.ThrottlerBase");
ZId.registerClass("AppRealtimeChannel.MaxRateThrottler",UId,oHd,nHd);$Id.registerClass("AppRealtimeChannel.MaxOutstandingThrottler",UId,pHd,nHd);pId.registerClass("AppRealtimeChannel.ThrottlerFactory",null,qHd);sId.registerClass("AppRealtimeChannel.ThrottlerManager",null,rHd);FHd.registerClass("AppRealtimeChannel.ThrottlerManagerSettings");dJd.registerClass("AppRealtimeChannel.LatencyMetrics");fId.registerClass("AppRealtimeChannel.ClientToClientMessageTelemetry");hJd.registerClass("AppRealtimeChannel.MessageLatencyDetails");
var o6=null,wId=null,AId=null,fJd=null,eId=null;Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function iJd(a){this.Z2a=a}iJd.prototype={Z2a:null,m$a:function(a){return this.Z2a.m$a(a)},KFa:function(a){return this.Z2a.KFa(a)}};
function jJd(a,b,c,d,e){this.Ipb=Function.createDelegate(this,this.E_c);this.pYb=Function.createDelegate(this,this.B_c);this.dispose=this.ha;this.tSe=a.toLowerCase();this.gba=b;this.fq=c;this.Bp=d;this.Ul=e;this.Bp.Mga(this.pYb);this.Ul.qa.Ka("SU",this.Ipb)}
jJd.prototype={tSe:null,gba:0,fq:null,Bp:null,Ul:null,ha:function(){Ppb(this.Bp,this.pYb);this.Ul.qa.eb("SU",this.Ipb)},E_c:function(a,b){if(a=b.ju.Md())if(a.gob(!!kJd(a)||lJd(this,a)),a.Ac)for(b=vA(a);b.jd();){var c=b.oa();Dz(c)&&(c=window.$$as(SD,c))&&(c.p$=a.zoc())}},B_c:function(a,b){a=b.xc;a.mIc=new Date;a.gob(!!kJd(a)||lJd(this,a))}};function mJd(a){return a?a.ta(String,mYa,""):""}function kJd(a){return a?a.ta(String,rXa,""):""}
function nJd(a,b){var c="";b&&lJd(a,b)&&(c=b.nb(String,wXa));return c}function lJd(a,b){if(!b||JO(b))return!1;var c=b.ta(String,wXa,"");return new Date-b.KNb()<a.gba&&!!c&&c.toLowerCase()!==a.tSe}Type.registerNamespace("PowerpointPresence");VK=window.PowerpointPresence||{};function oJd(){}oJd.registerInterface("PowerpointPresence.IEditorPresenceTracker");function pJd(){}pJd.registerInterface("PowerpointPresence.ITypingLockHandler");function qJd(){}qJd.registerInterface("PowerpointPresence.IPptRealtimeChannelMetrics");
window.PowerpointPresence.SerializableLockData=VK.lKg=function(a,b,c,d,e,f){this.clientId=a;this.slideId=b;this.shapeId=c;this.lockType=d;this.rowId=e;this.cellId=f};function rJd(){}rJd.registerInterface("PowerpointPresence.ITextContentRecordFactory");function sJd(a,b,c,d){this.yCd=a;this.$a=b;this.Xi=c;this.aja=d;this.t3a=new Date;this.gba=-1}
sJd.prototype={yCd:null,$a:null,Xi:null,aja:null,bSb:null,cSb:null,t3a:null,gba:0,OHc:!1,Vxb:function(){return""},Wxb:function(){return""},sPc:function(){},tPc:function(){return!1}};function t6(a){return wh(a,"\u00a0"," ").trim()}function tJd(a,b){a=a||"";b=b||"";if(a.length!==b.length)return null;for(var c=[],d=0;d<a.length;d+=1)a.charAt(d)!==b.charAt(d)&&c.push(d);return 0<c.length?fo("Length",a.length,"FirstDiffPos",c[0],"DiffCount",c.length):null}
function uJd(a,b){a.bSb=b?a.Vxb():a.Wxb();a.cSb=new Date}
function vJd(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q){this.Lsf=Function.createDelegate(this,this.hlg);this.Grf=Function.createDelegate(this,this.Mjg);this.uxf=Function.createDelegate(this,this.Jsg);this.sYb=Function.createDelegate(this,this.R_c);this.txf=Function.createDelegate(this,this.Isg);this.qId=Function.createDelegate(this,this.X2f);this.v3e=Function.createDelegate(this,this.rLf);this.vxf=Function.createDelegate(this,this.Ksg);this.Lvf=Function.createDelegate(this,this.aqg);this.Frf=Function.createDelegate(this,
this.Ljg);this.uYb=Function.createDelegate(this,this.$$b);this.iP=Function.createDelegate(this,this.RK);this.Kkf=Function.createDelegate(this,this.rag);this.lQf=new on("",ResourceStrings.L_GhostUserName,"#C0C0C0",new pn(1),null,null,null,null,!1,!1,!1,0,null,0);this.Slb={};this.Tlb={};this.Qlb={};this.UQe=window.Box4.App.hp;this.jBd={};this.$pc={};this.bqc={};this.VQe=window.Box4.App.hp;this.xvc=(new Date(0)).getTime();this.yvc=(new Date(0)).getTime();this.aTb=(new Date(0)).getTime();this.izd=(new Date(0)).getTime();
this.mpa=a;this.Rx=b;this.l2a=c;this.Z2a=d;this.Hb=e;this.ob=f;this.pa=g;this.vKe=h;this.oC=k;this.$a=l;this.je=m;this.F2a=n;this.Crc=r.eGc;this.Yp=t;this.aja=v;this.ra=x;this.GBd=y;this.ke=z;this.ke.qa.Ka("RUAI",this.Kkf);(this.At=L.ia("PPTCanvasPresenceBubbleUXEnabled"))&&uz(this.pa,this.iP);this.Z2a.Yya(this.uYb);this.uYe=E;this.ge=H;this.BXe=O;this.za=r;this.PBa=Q;wJd(this)}
vJd.prototype={Crc:!1,mpa:null,Rx:null,Z2a:null,Hb:null,ob:null,pa:null,vKe:null,oC:null,$a:null,je:null,F2a:null,aja:null,GBd:null,ke:null,uYe:null,ge:0,BXe:null,Yp:null,ra:null,za:null,PBa:null,l2a:null,Qxd:null,tXe:!0,uSe:0,pTe:0,rXe:!1,At:!1,Ljg:function(){for(var a=Ba(this.Slb),b=a.length,c=0;c<b;++c){var d=a[c],e=window.$$as(tQ,this.Slb[d]);if(e){var f=e.Md();f&&f.oc()?nJd(this.aja,f)||xJd(this,d)||(delete this.Slb[d],kJd(f)||e.Hv()?R(18956362,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
yJd(this,e)):delete this.Slb[d]}else delete this.Slb[d]}},Mjg:function(){for(var a=Ba(this.Tlb),b=a.length,c=0;c<b;++c){var d=a[c],e=window.$$as(fGb,this.Tlb[d]);if(e){var f=e.rU();f&&f.oc()?mJd(f)||xJd(this,d)||(delete this.Tlb[d],e.tcb()):delete this.Tlb[d]}else delete this.Tlb[d]}},rLf:function(){for(var a=[],b=new Date,c=zJd(this),d=c.length,e=0;e<d;++e){var f=c[e];f.XB()&&b-f.KNb()>this.Yp.$$a&&a.push(f.Md().rt())}0<a.length&&R(21565510,828,15,"Following objects are locked longer than {0} : {1}",
this.Yp.$$a,a.join(";"))},aqg:function(){for(var a=new Date,b=zJd(this),c=b.length,d=0;d<c;++d){var e=b[d];e.XB()||ZO(e.Md())&&AJd(this)||!e.Hw()||e.ZX()||!(a-e.xRe>this.Yp.bDb)||e.RL()||hHb(e)}},Ksg:function(){if(this.UQe>=this.VQe&&this.Qxd){var a;(a=(a=this.oC.kH(this.Qxd))?OP(0,a.sb()):null)&&a.oc()&&BJd(this,a.Sg(),a.get_shapeId(),2,"","")}this.VQe=new Date},Isg:function(){for(var a=Ba(this.$pc),b=a.length,c=0;c<b;++c){var d=window.$$as(YM,this.$pc[a[c]]);d&&d.oc()&&BJd(this,d.Sg(),d.get_shapeId(),
3,"","")}this.$pc={}},Jsg:function(){for(var a=Ba(this.bqc),b=a.length,c=0;c<b;++c){var d=window.$$as(bN,this.bqc[a[c]]);if(d&&d.oc()){var e=OP(0,d);BJd(this,e.Sg(),e.get_shapeId(),3,iV(d).toString(),d.faa().toString())}}this.bqc={}},X2f:function(a,b){b&&b.xc?(a=window.$$as(KN,b.xc),a)?a.ZN||a.gtb||b.oh.Na!==zq.Na||(b=VP(a),a=this.je.Oda(a),b&&(a?(b=CJd(b.Sg(),b.get_shapeId(),iV(a).toString(),a.faa().toString()),this.bqc[b]=a):(a=DJd(b.Sg(),b.get_shapeId()),this.$pc[a]=b))):R(20821964,828,10,"Invalid argument."):
R(20821962,828,10,"Invalid argument.")},hlg:function(a){a=window.$$as(EJd,a.nw);var b=a.cL,c;if(c=b?b.oc():!1)c=(c=this.hl(b))?IQ(c):!1;c&&BJd(this,b.Sg(),b.get_shapeId(),1,"","");a.r5c=!0},hl:function(a){return window.$$as(tQ,Fy(a,this.Hb.Zm.Eb()))},eag:function(a){if(!(this.Yp.swb||this.Yp.w9a&&ZO(a)||JO(a)||this.mpa.Dy())){var b=new Si(2,1,this.Yp.q5c,this.Lsf,90,"78",!1,0);b.nw=new EJd(a,!1);this.ob.Vb(b);this.jBd[DJd(a.Sg(),a.get_shapeId())]=b}},RK:function(a,b){for(a=0;a<b.sz.length;a++){var c=
b.sz[a],d=window.$$as(YM,c.fz.na);d&&d.oc()&&(d=window.$$as(tQ,Uy(d,this.ge)))&&(d=this.GBd.lH(d.Md()))&&(1===c.f_?d.Bzb():c.f_||d.mXc())}},dag:function(a){if(!(this.Yp.swb||this.Yp.w9a&&ZO(a)||JO(a)||this.Yp.fRc)){var b=DJd(a.Sg(),a.get_shapeId()),c=window.$$as(Si,this.jBd[b]);if(c){var d=window.$$as(EJd,c.nw);this.ob.ih(c);d&&d.r5c&&BJd(this,a.Sg(),a.get_shapeId(),4,"","");this.jBd[b]=null}}},rag:function(a,b){FJd(this,b.ju)},R_c:function(a,b){if((b=window.$$as(pN,b.xc))&&(a=window.$$as(fGb,Fy(b,
this.ge)))&&b.oc()){b=mJd(b);var c=GJd(this,a.rU());b?(b=this.Lda(b,"EditingBy"),a.WTa(b),HJd(this,a)):c?(b=this.Lda(c.ik,"EditingBy"),a.WTa(b),HJd(this,a)):b||GJd(this,a.rU())||a.tcb()}},$$b:function(a,b){if(this.za.s2d&&!this.rXe&&8===b.Dk&&this.PBa&&IJd(this,b)){R(41185738,814,50,"Log coauth activity");this.rXe=!0;var c=this;this.PBa.CW(function(){ab(c.PBa).Jn("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled",null)})}7===b.Dk&&((a=b.Oya)?a.clientId===this.l2a?R(19145675,828,15,"Lock notification : lock notification from myself recieved"):
(R(17602627,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",a.clientId,this.l2a),a=new JJd(a.clientId,a.slideId,a.shapeId,a.lockType,a.rowId,a.cellId),KJd(this,a),LJd(this,a)):R(19145673,828,10,"Lock notification: invalid lock data recieved"))},Lda:function(a,b){var c=this.Rx.Lda(a);if(c)return c;R(19140752,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",a,b);return this.lQf}};
function MJd(a,b){var c=new Si(0,1,0,function(){NJd(a,b)},90,"79",!1,0);a.ob.Vb(c)}
function LJd(a,b){var c=window.$$as($M,a.ra.Ma());if(c&&Zub(b.nh,c.gc().Cba)){var d=b.n7,c=b.ik;if(a.ra.Ma()){var e=a.ra.Ma().RP(d);if(e)if(b.WUb&&b.YUb&&a.Yp.O5b){var f;d=b.YUb;f=b.WUb;var g=bQ(window.$$as(YM,e));if(g){for(var e=null,g=YP(g),h=g.length,k=0;k<h;++k)for(var l=ZP(g[k]),m=l.length,n=0;n<m;++n){var r=l[n];if(iV(r).toString()===d&&r.faa().toString()===f){e=r;break}}f=e}else f=null;f&&f.oc()&&(d=window.$$as(fGb,Fy(f,a.ge)))&&!mJd(f)&&(b=a.Lda(c,OJd(b.Rlb)),d.WTa(b),HJd(a,d))}else JO(e)||
a.Crc&&ZO(e)&&(a.Yp.w9a||AJd(a))||!(d=a.hl(e))||(PJd(a,d,a.Lda(c,OJd(b.Rlb))),QJd(a,d))}}}function CJd(a,b,c,d){return String.format("{0}#{1}#{2}#{3}#{4}",a.Pc(),a.Be(),b,c,d)}function DJd(a,b){return String.format("{0}#{1}#{2}",a.Pc(),a.Be(),b)}function HJd(a,b){var c;if(b){c=b.rU();var d=VP(c);c=CJd(d.Sg(),d.get_shapeId(),iV(c).toString(),c.faa().toString())}else c=null;c&&(a.Tlb[c]=b)}function QJd(a,b){var c;(c=b?DJd(b.Md().Sg(),b.Md().get_shapeId()):null)&&(a.Slb[c]=b)}
function xJd(a,b){if(!b)return null;var c=window.$$as(JJd,a.Qlb[b]);return c?0>=RJd(a,c)?a.Qlb[b]=null:c:null}function GJd(a,b){if(YM.isInstanceOfType(b)){b=window.$$as(YM,b);if(!b.Sg())return null;b=DJd(b.Sg(),b.get_shapeId());return xJd(a,b)}if(bN.isInstanceOfType(b)){var c=window.$$as(bN,b);b=VP(c);if(!b.Sg())return null;b=CJd(b.Sg(),b.get_shapeId(),iV(c).toString(),c.faa().toString());return xJd(a,b)}return null}
function SJd(a,b){switch(b){case 1:return a.Yp.p5c;case 2:return a.Yp.GUc;case 3:return a.Yp.x6c;case 4:return a.Yp.Lwb}R(20821980,828,10,"Unknown lock type");return 0}function RJd(a,b){return SJd(a,b.Rlb)-(new Date-b.fRe)}function KJd(a,b){if(b&&b.nh){var c=b.WUb&&b.YUb?CJd(new zJ(b.nh),b.n7,b.YUb,b.WUb):DJd(new zJ(b.nh),b.n7);if(4===b.Rlb)a.Qlb[c]=b;else{var d=window.$$as(JJd,a.Qlb[c]);d?(d=RJd(a,d),RJd(a,b)>d&&(a.Qlb[c]=b)):a.Qlb[c]=b}}}
function OJd(a){switch(a){case 1:return"StartEditing";case 2:return"ImeTyping";case 3:return"Typing";case 4:return"EndEditing"}R(20821976,828,10,"Unknown lock type");return"Unknown lock type"}
function IJd(a,b){if(!b||null===b.Oya)return!1;a:{b=b.Oya;var c=null;try{c=b}catch(g){}if(null===c||!c.length){var d=null;try{d=b}catch(g){R(41185744,828,10,"UpdateHint can't convert to RTC message.")}if(null!==d){b=[d];break a}}b=c}c=b.length;for(d=0;d<c;++d){var e=b[d];if(e&&e.clientId)if(e.clientId.toLowerCase()===a.l2a.toLowerCase())a.uSe++,a.xvc=a.xvc===(new Date(0)).getTime()?(new Date).getTime():a.xvc,a.yvc=(new Date).getTime();else{var f=a,e=f.Lda(e.clientId,""),f=f.Lda(f.l2a,"");e&&f&&e.ku===
f.ku&&e.ED===f.ED||(a.pTe++,a.aTb=a.aTb===(new Date(0)).getTime()?(new Date).getTime():a.aTb,a.izd=(new Date).getTime())}}return 5<=a.uSe&&5<=a.pTe&&(a.izd>=a.xvc&&a.aTb<=a.yvc||a.yvc>=a.aTb&&a.yvc<=a.izd)&&1<=TJd(a.Rx)?!0:!1}function PJd(a,b,c){b.WTa(c);b.OI()&&xR(a.pa)}function yJd(a,b){var c=a.GBd.lH(b.Md());c&&(c.$dc(null),b.tcb(a.tXe||!c.Gnd()))}
function NJd(a,b){if(!b||b.Hv())R(18994447,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!b);else{var c=b.Md();if(!(JO(c)||a.Crc&&ZO(c)&&(a.Yp.w9a||AJd(a)))){var d=kJd(c);d?PJd(a,b,a.Lda(d,"EditingBy")):(c=nJd(a.aja,c))?(PJd(a,b,a.Lda(c,"EditingByInSameWorker")),QJd(a,b)):(c=GJd(a,b.Md()))?(PJd(a,b,a.Lda(c.ik,OJd(c.Rlb))),QJd(a,b)):b.XB()&&yJd(a,b)}}}
function BJd(a,b,c,d,e,f){try{var g=new window.PowerpointPresence.SerializableLockData(a.l2a,b.Cba,c,d,e,f);a.Z2a.Qea(7,g,!1)}catch(h){R(17602625,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",a.l2a,h.stack)}}function FJd(a,b){b.OI()||b.Md().ta(Boolean,gu,!0)?MJd(a,b):NJd(a,b)}
function zJd(a){var b=[];if(!a.ra.Ma())return b;var c=a.ra.Ma().jn(!1);if(!c)return b;for(var d=c.length,e=0;e<d;++e){var f=c[e],g=a.hl(f);g&&!g.Hv()?b.push(g):R(21836046,828,50,"Shape {0} on active slide doesn't have valid view element",f.rt())}return b}function AJd(a){return a.Yp.O5b&&a.Yp.yRc}
function wJd(a){R(20821920,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",a.Crc,UJd(a.Yp));a.Yp.swb||(0<a.Yp.jbb?a.ob.Vb(new Si(2,2,a.Yp.jbb,a.Frf,90,"71",!1,0)):R(20821922,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<a.Yp.bDb?(a.ob.Vb(new Si(2,2,a.Yp.bDb/2,a.Lvf,90,"72",!1,0)),a.tXe=!1):R(21565471,804,50,"Switch to fidelity delay after unlock is disabled"),0<a.Yp.a8b?a.ob.Vb(new Si(2,2,a.Yp.a8b,a.vxf,
90,"73",!1,0)):R(20030493,804,50,"IME typing lock notification disabled"),0<a.Yp.$$a?a.ob.Vb(new Si(2,2,a.Yp.$$a,a.v3e,90,"74",!1,0)):R(21565474,804,50,"Lock leack detection is disabled"),a.vKe.Ka("CU",function(b,c){a.UQe=new Date;b=c.Cc();a.Qxd=b?b.querySelector(".Paragraph"):null}),a.Yp.gRc||AJd(a)||(hA(a.F2a,a.qId),0<a.Yp.qcb?a.ob.Vb(new Si(2,2,a.Yp.qcb,a.txf,90,"75",!1,0)):R(20821953,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),AJd(a)&&(hA(a.BXe,a.sYb),hA(a.F2a,a.qId),
a.uYe.Qd(),0<a.Yp.qcb&&a.ob.Vb(new Si(2,2,a.Yp.qcb,a.uxf,90,"76",!1,0)),0<a.Yp.jbb&&a.ob.Vb(new Si(2,2,a.Yp.jbb,a.Grf,90,"77",!1,0))))}function EJd(a,b){this.cL=a;this.r5c=b}EJd.prototype={cL:null,r5c:!1};function VJd(){}VJd.prototype={clientId:null};function WJd(a,b,c,d){this.Msf=Function.createDelegate(this,this.ilg);this.Rz=a;this.TO=b;this.fYe=c;this.iOe=d;this.Rz.Yya(this.Msf)}
WJd.prototype={Rz:null,TO:null,fYe:!1,iOe:null,ilg:function(a,b){b.Dk||(this.iOe.Sf("CU"),this.fYe||this.EC())},EC:function(){!F.mg&&this.TO.Poa()&&this.TO.EC(null,null,null)}};function XJd(a){this.Xoa={};this.ik=a.Px;this.ub(a)}XJd.prototype={ik:null,ub:function(a){if(a=a.UX())for(var b=a.length,c=0;c<b;++c){var d=a[c];d.ID!==this.ik&&(this.Xoa[d.ID]=new Date)}}};
function JJd(a,b,c,d,e,f){if(!a||!b||0>c)throw Error.argumentNull("LockEntry");this.ik=a;this.nh=b;this.n7=c;this.Rlb=d;this.YUb=e;this.WUb=f;this.fRe=new Date}JJd.prototype={ik:null,nh:null,n7:0,fRe:null,Rlb:0,WUb:null,YUb:null};function YJd(a,b,c,d,e){this.otf=Function.createDelegate(this,this.qmg);this.VCg=Ae();this.hK=e;c.Fk()&&(ZJd(this,a),d.Ua.Ka("SPC",this.otf));this.fNa=new (ga.$$(fHd))(function(){return b()})}
YJd.prototype={Lha:null,fNa:null,DY:!1,KRe:null,tKe:null,ysc:!1,hK:null,bsa:0,d_e:function(a){return this.bsa=a},LNb:function(){return this.DY?this.KRe:this.fNa.Aa().LNb()},V3c:function(a){this.fNa.Aa().V3c(a)},mnd:function(){return this.DY?this.tKe:this.fNa.Aa().mnd()},R6b:function(a){R(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.DY,this.ysc);return this.DY?(a.val=this.Lha.nd||this.VCg.toString(),
R(40130654,500,50,"CorrelationId after FindSession: {0}",a.val),String.format("{0}&{1}={2}",this.Lha.Fca,"corrid",nh(a.val))):this.ysc?this.fNa.Aa().R6b(a):(R(51140183,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),a.val=null)},zTc:function(a,b,c,d,e){R(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.DY);this.DY?(a(this.Lha.y5a),c(new FHd(this.Lha.Q0b,this.Lha.P0b,this.Lha.O0b,this.Lha.c_b))):(this.fNa.Aa().zTc(a,
b,c,d,e),this.ysc=!0);this.hK&&this.hK.xk(26,!this.ysc)},oRc:function(){R(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.DY);this.DY?this.DY=!1:this.fNa.Aa().oRc()},nea:function(a,b){R(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.DY);this.DY||this.fNa.Aa().nea(a,b)},qmg:function(){R(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",
this.DY);this.DY=!1}};function ZJd(a,b){a.DY?R(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set"):(a.Lha=b,a.Lha&&(a.DY=!0,b=a.Lha,a.KRe=b.y5a+"?"+b.Fca,a.tKe=a.Lha.tK))}function $Jd(a,b,c,d){$Jd.initializeBase(this,[a,b,c,d])}
function aKd(){if(window.Box4.App.Pb()){var a=window.Box4.App.Pb().me;if(a&&(a.Rnc(bKd),a=a.oi())&&(a=a.Ej)){var b=window.Box4.App.Cg;if(b&&b.Cx()&&(b=B().H(n6,null))){var c=L.ia("Box4ThrottleInboundRequests"),d=new uIa(11,1);cKd=cKd||new $Jd(b,a,c,d);cKd.EC()}}}}function bKd(a){cKd||(a.$yc(bKd),aKd())}function dKd(a){this.JUe=a;this.tI=new (bb.$$(Oc));this.tI.Uh(this.JUe)}dKd.prototype={tI:null,JUe:null,uce:function(){return this.tI.Wf()}};
function eKd(a,b,c,d,e,f){this.Zjf=Function.createDelegate(this,this.n$f);this.Z4a=Function.createDelegate(this,this.Pla);this.O4a=Function.createDelegate(this,this.nAb);this.eBd=a;this.ri=b;this.Pw=c;dzb(this.Pw,this.O4a);this.Jj=d;this.jxc=f;window.$addHandler(window,"visibilitychange",this.Z4a);this.FVe=e;this.FVe.Ua.Ka("RCF",this.Zjf)}
eKd.prototype={eBd:null,ri:null,Pw:null,Jj:null,FVe:null,jxc:null,p2a:0,q2a:0,JSe:0,Jvc:0,yY:null,Qsc:null,WRb:null,gia:null,UAa:null,X1a:null,itc:!1,htc:!1,mtc:!1,ltc:!1,jtc:!1,nAb:function(a,b){b.csb||(this.ltc=this.mtc=!0)},Pla:function(){window.document.hidden&&(this.htc=this.itc=!0)},n$f:function(a,b){a=b.mSd;if(b=b.hrb){if(!a){var c,d,e;xId(b.ErrorDetails,c={val:c},d={val:d},e={val:e});c=c.val;d=d.val;e=e.val;b.HttpErrorCode=c;b.HttpErrorStatus=d;b.Exception=e;delete b.ErrorDetails;if(!c&&this.jxc&&
0<this.jxc.length)try{c=!0;var f=window.location.hostname.toLowerCase(),g=this.jxc.split(";"),h=g.length;for(d=0;d<h;++d)if(f.endsWith(g[d])){c=!1;break}b.IsCORS=c.toString()}catch(k){b.Unexpected=k.message}}R(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.ri.Dy(),window.document.hidden,this.Jj.YR,w.e3c.toString(a),go(b));this.jtc||(f=yK(b,"HttpErrorCode",-1),this.jtc=500<=f&&
599>=f||1===a&&"FindSessionRequestFailed"!==b.FindSessionFailureReason?!0:!1)}},Vac:function(){this.p2a++;this.WRb=new Date;this.yY||(this.yY=new Date,this.itc=window.document.hidden,this.mtc=!this.Jj.YR)},Xac:function(){this.JSe++;var a={numberOfFailedConnections:this.JSe,numberOfConnectionAttempts:this.p2a,firstConnectionAttempt:this.yY?this.yY.toISOString():"",lastConnectionAttempt:this.WRb?this.WRb.toISOString():"",lastExplicitDisconnect:this.X1a?this.X1a.toISOString():"",lastConnectionFail:(new Date).toISOString(),
disconnectedDurationMs:this.gia&&0<this.Jvc?WGd(this.ri,this.gia,new Date):this.yY&&0<this.p2a?WGd(this.ri,this.yY,new Date):0,hasPageHiddenOrNetworkIssue:this.gia&&0<this.Jvc?this.htc||this.ltc:this.yY&&0<this.p2a?this.itc||this.mtc:!1};this.jtc?u(41702299,500,15,go(a)):u(36804375,500,15,go(a))},pBb:function(){this.Jvc++;this.gia=new Date;this.htc=window.document.hidden;this.ltc=!this.Jj.YR}};
function fKd(a){if(a.UAa){if(a.yY&&1===a.q2a)return WGd(a.ri,a.yY,a.UAa);if(a.gia&&1<a.q2a)return WGd(a.ri,a.gia,a.UAa)}return 0}
function gKd(a,b){a.q2a++;a.UAa=new Date;a.Qsc?fKd(a)>a.eBd.NLc&&(a={hasExceededReconnectionThrehold:!0,numberOfSuccessfullConnections:a.q2a,numberOfConnectionAttempts:a.p2a,firstConnectionAttempt:a.yY?a.yY.toISOString():"",lastConnectionSuccess:a.UAa?a.UAa.toISOString():"",lastUnexpectedDisconnect:a.gia?a.gia.toISOString():"",lastExplicitDisconnect:a.X1a?a.X1a.toISOString():"",reconnectDurationInMs:fKd(a),hasPageHiddenOrNetworkIssue:hKd(a)},R(36804373,500,15,go(a))):(a.Qsc=a.UAa,ve().ed("FirstPresenceUpdated",
(new Date).getTime().toString()),fKd(a)>a.eBd.NLc&&(a={hasExceededConnectionThrehold:!0,numberOfConnectionAttempts:a.p2a,firstConnectionAttempt:a.yY?a.yY.toISOString():"",firstConnectionSuccess:a.Qsc?a.Qsc.toISOString():"",lastExplicitDisconnect:a.X1a?a.X1a.toISOString():"",connectDurationInMs:fKd(a),connectionDurationFromStopWatchInMs:b,hasPageHiddenOrNetworkIssue:hKd(a)},R(36804373,500,15,go(a))))}function hKd(a){return a.yY&&1===a.q2a?a.itc||a.mtc:a.gia&&1<a.q2a?a.htc||a.ltc:!1}
function iKd(){this.zwc=[];iKd.initializeBase(this)}iKd.prototype={oka:function(a){a&&(R(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",a.ik,a.Qx.toString()),Array.add(this.zwc,a))},kbc:function(a){(a=u6(this,a))&&this.nbb(a);return a},nbb:function(a){a&&(R(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",a.ik,a.Qx.toString()),Array.remove(this.zwc,a))},k9:function(){return this.zwc}};
function u6(a,b){a=a.zwc;for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e.ik===b)return e}return null}
function jKd(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U,V,Z,Y,ca){this.qif=Function.createDelegate(this,this.$7f);this.DJd=Function.createDelegate(this,this.j6f);this.yxf=Function.createDelegate(this,this.Nsg);this.aof=Function.createDelegate(this,this.hfg);this.d2e=Function.createDelegate(this,this.qJf);this.bqf=Function.createDelegate(this,this.mhg);this.Z7=Function.createDelegate(this,this.EUa);this.lB=Function.createDelegate(this,this.VK);this.mYb=Function.createDelegate(this,this.u_c);this.W7=
Function.createDelegate(this,this.Xua);this.S4a=Function.createDelegate(this,this.FAb);this.ypb=Function.createDelegate(this,this.rAb);this.ap=Function.createDelegate(this,this.Lt);this.Yz=Function.createDelegate(this,this.tH);this.XAc=Function.createDelegate(this,this.IYc);this.Bdf=Function.createDelegate(this,this.d2f);this.kmf=Function.createDelegate(this,this.Ecg);this.iP=Function.createDelegate(this,this.RK);this.PO=new iKd;this.CKe=[];this.bRe=new Date;jKd.initializeBase(this);this.y2=a;a.sU()||
RFd(a,V);this.Fc=b;this.Rz=c;this.ik=d.eh;this.BM=d.G2b;this.ud=e;this.Ub=O;this.zmb=H;this.hK=Q;this.Pw=Z;this.C2=Y;this.DO=ca;var la=this;U.pb(function(a){la.am=a});this.Rz.s_a(this.d2e);this.Rz.$nc(this.aof);L.ia("PPTForceUpdateEditorTableEnabled")&&this.Rz.Yya(this.yxf);BId(qId(),this.DJd);this.tud&&dzb(this.Pw,this.qif);this.UBa=this.BM.Di("WebServiceCall","RtcConnection");j6(this.hK,27);this.Rz.e9a();this.ri=r;this.to=t;this.DRb=v.rHc;this.txd=v.LWd;this.DNa=v.y1b;this.EPe=v.j1d;this.Fxd=Fi;
this.fuc=v.Fk()&&v.VKc;this.pa=f;uz(this.pa,this.iP);this.uo=g;this.uo.qa.Ka("VSIL",this.kmf);this.ke=h;aR(this.ke,this.Bdf);this.My=k;this.My.qa.Ka("ETC",this.XAc);this.zi=x;qM(this.zi,this.Yz);nK(this.zi,this.ap);this.zi.qa.Ka("OR",this.ypb);this.bJe=v.p2d;this.tud=v.Q5d;this.fa=m;this.ra=l;this.GTb=n;this.aQb=y;this.pqa=z;this.SMa=E;if(v.Fk()){this.zi.qa.Ka("SATEI",this.S4a);Qyb(this.zi,this.W7);this.zi.qa.Ka("SE",this.mYb);var ra=this;this.Fc.Nf(function(){RFd(ra.y2,ye(ra.Fc).UserName);ra.y2.ED||
$Gd(ra.y2);OY(ra.Ub)||(R(539874445,814,50,"PresenceManager : Disconnect from RTC"),ra.Hka());ra.fuc&&vM(ra.zi,ra.lB)});this.Fxd&&v3b(this.zi,this.Z7)}R(540366595,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.Fxd)}function kKd(a){var b="";switch(a){case 2:b="Connected";break;case 1:b="Connecting";break;case 0:b="Disconnected"}return b}function lKd(a,b){if(!a&&!b)return!1;if(!a&&b||a&&!b||a.length!==b.length)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!0;return!1}
jKd.prototype={y2:null,Fc:null,ik:null,Rz:null,ud:null,BM:null,ri:null,to:null,pa:null,uo:null,ke:null,My:null,fa:null,ra:null,GTb:null,DRb:!1,txd:!1,DNa:!1,EPe:!1,Fxd:!1,fuc:!1,zi:null,aQb:null,pqa:null,SMa:null,hK:null,am:null,bJe:0,Pw:null,C2:null,DO:null,DKe:null,QPb:!0,G1a:!1,UBa:null,zmb:null,Ub:null,vNe:!1,QLe:!1,tud:!1,aMe:!1,ywc:null,Wb:function(){this.fa.ua(4236240734,1,this.bqf,96)},mhg:function(a,b,c,d,e){e.Etb=mKd(this,e.gh);e.H3d=TJd(this);return 32},$7f:function(a,b){b.csb||(j6(this.hK,
40),this.QLe=!0)},j6f:function(a,b){a=this.hK;if(b=b.D3d){var c=[],d;for(d in b){var e={key:d,value:b[d]};e.value&&Array.add(c,e.value.Presence)}a.xk(38,c.length);a.xk(37,0<c.length);j6(a,39)}a.KUe.Uh(!0);qId().Ua.eb("CPSWM",this.DJd)},qJf:function(a,b){R(8958534,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",kKd(b.rRa),kKd(b.yK),this.ik);switch(b.yK){case 2:this.UBa.Lf();a=this.UBa.Qq();j6(this.hK,28);nKd(this);gKd(this.zmb,a);break;case 1:2===
b.rRa&&this.zmb.pBb();this.zmb.Vac();break;case 0:if(this.QPb)oKd(this);else if(2===b.rRa){var c=this;window.setTimeout(function(){c.Rz.e9a()},0);R(8958536,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",ZGd(this.ud).getTime());this.zmb.pBb()}}},w3c:function(a,b){try{this.y2.ED||$Gd(this.y2);var c=new $2(a,b,0),d=new $ad(this.y2.Ax(),a,c,this.y2.rDc,this.y2.qDc,this.y2.HFc,this.y2.ED,this.y2.hw,this.y2.sU(),1,this.QLe);this.y2.ED||R(573669703,814,15,"PresenceManager : SendPresence; empty email for user");
var e=this;this.Rz.w3c(d.Qxb()).CW(function(){R(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",e.ik,c.toString(),ZGd(e.ud).getTime())});this.bRe=new Date;SGd(this.hK);pKd(this,a,b);R(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.ik,c.toString(),ZGd(this.ud).getTime());qKd(this,c)}catch(f){R(8958542,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",
f.toString(),this.ik)}},hfg:function(a,b){a=!!this.am&&O2(this.am);R(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.ik,a);if(!a){a=this.hK;var c=b.sEa;if(!(Ee(c)||VK.Mka.toString(33)in a.QO)){var d=Date.now();a.xk(33,d);a.Gvd=NFd(a,cld(a),d);a.xk(32,a.Gvd);a.xk(30,wn(c));a.am&&a.xk(29,a.am.nBd)}a=null;this.BM&&(a=this.BM.Di("ServerNotification","Presence Updated"));try{rKd(this,b)}finally{a&&a.Lf()}}},Nsg:function(a,b){R(591737425,
814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",b.Dk,this.ik)},RK:function(){if(cV(this.ra)){var a=sKd(this),b=cV(this.ra);CJ(this.DKe,b)&&!lKd(a,this.CKe)||tKd(this)}else R(50943645,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")},d2f:function(a,b){b.LM?cV(this.ra)?tKd(this):R(50943649,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):R(50943647,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")},
Ecg:function(a,b){cV(this.ra)?Array.contains(sKd(this),b.dz.get_shapeId())&&tKd(this):R(50943651,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")},IYc:function(a,b){var c=b.rWc;a=b.zee;var d=uKd(this,b.MOc),c=uKd(this,c);this.ud.Xj.mpa.U7a.Ha(vKd,new Era(this.ri.Px,null,d,c,null,0,0,a),null);if(a=this.ri.UX()){c=b.rWc;for(d=0;d<c.length;d++){var e=this.aQb,f=c[d].ID,g=e.Xoa[f];g&&(R(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
e.ik,f,(new Date).getTime()-g.getTime()),delete e.Xoa[f])}c=[];b=b.MOc;for(d=0;d<b.length;d++){var h=b[d],e=h.ID;e!==this.ri.Px&&((f=u6(this.PO,e))?TGd(this.SMa,f.jAa,h.EmailAddress):Array.add(c,e))}b=this.aQb;for(d=0;d<c.length;d++)c[d]in b.Xoa||c[d]===b.ik||(b.Xoa[c[d]]=new Date);2<=a.length&&R(8958550,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.ik,a.length);b=[];d=[];c=a.length;for(e=0;e<c;++e)h=a[e],Array.add(b,h.ID),h.ID===this.ri.Px||
u6(this.PO,h.ID)||Array.add(d,h.ID);R(8958552,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",this.ik,a.length,b.join(","),d.join(","));a=this.PO.k9();b=a.length;for(d=0;d<b;++d){var c=a[d],k,l;(l=V3(this.ri,c.ik,k={val:h}),h=k.val,l)?!this.DRb||h.ColorIndex?(e=c,cV(this.ra).Sa(e.nh)&&e.Qx.Lu&&e.Qx.Lu.length&&R(8958602,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",e.ik,e.Qx.toString(),this.ik,ZGd(this.ud).getTime()),R(8958604,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",e.ik,e.Qx.toString(),this.ik,ZGd(this.ud).getTime()),e=this.pqa.rua(new CW(h.EmailAddress,null,h.Name,null,!1,null),h.ColorIndex,h.ID,0),XGd(c,new on(c.ik,h.Name,e,new pn(1),null,null,c.dBd,null,!1,!1,!1,0,null,0)),UGd(this.GTb,new Z2(c.nh,c.Qx.Lu,c.Sx,!0,mKd(this,
c.nh),TJd(this))),R(8958556,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",c.ik,c.Qx.toString(),c.Sx.Zz,this.ik)):R(8958554,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",c.ik,c.Qx.toString(),this.ik):(e=c.Sx?c.Sx.Zz:"",R(8958558,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",
c.ik,c.Qx.toString(),e,this.ik))}this.Ha("PresenceChanged",null,null)}else R(8958548,814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.ik)},tH:function(a,b){a=this.aQb;for(var c=Object.keys(a.Xoa),d=c.length,e=0;e<d;++e){var f=c[e];R(37590345,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",a.ik,f,(new Date).getTime()-a.Xoa[f].getTime())}a.Xoa={};5!==b.ZV&&
(R(539874446,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.Hka())},FAb:function(){R(540366596,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.G1a||(R(40411793,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.G1a=!0)},Xua:function(){R(540366597,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");this.G1a||(R(40411795,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.G1a=
!0)},u_c:function(){R(572842309,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.Hka()},EUa:function(a,b){R(40411797,814,50,"PresenceManager : OnWopiTokenRefreshed");try{b.rsb?(R(594040906,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",kKd(this.Rz.vT)),this.G1a=!1,this.fuc&&!OY(this.Ub)?R(41169368,814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.QPb||2!==this.Rz.vT?this.e9a():(a=
{},a.qs=this.DO.uk().ql,R(540366598,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.Rz.Cxa(a))):R(594040903,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){R(594040901,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",c)}},Lt:function(a,b){this.EPe&&this.G1a||this.fuc&&!OY(this.Ub)?R(40411799,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",
this.G1a,OY(this.Ub)):4!==b.E8||this.QPb?this.e9a():(R(41473159,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),nKd(this))},VK:function(a,b){b.T_b&&!OY(this.Ub)&&(R(41169371,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.Hka())},e9a:function(){R(539874721,814,50,"PresenceManager : Connect");this.QPb=!1;this.Rz.e9a()},rAb:function(){var a;a=this.Rz;(a=a.KFa(a._clientId))&&(2===a.Se||new Date-this.bRe>this.bJe)&&(R(39196701,814,
50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),tKd(this))},OZf:function(){var a=this.PO.k9();if(0<a.length)for(var b=a.length,c=0;c<b;++c){var d=a[c];if(d.Qx&&d.Qx.nh)return!0}return!1},nbb:function(a){a&&(this.PO.nbb(a),a.Sx&&UGd(this.GTb,new Z2(a.nh,a.Qx.Lu,a.Sx,!1,mKd(this,a.nh),TJd(this))))},ZGa:function(a){if(a){for(var b=0;b<a.length;b++)a[b]=a[b].toLowerCase();for(var b=a.length,c=0;c<b;++c){var d=a[c];R(8958596,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",
d);(d=this.PO.kbc(d))?d.Sx?UGd(this.GTb,new Z2(d.nh,d.Qx.Lu,d.Sx,!1,mKd(this,d.nh),TJd(this))):R(8958600,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):R(8958598,814,15,"PresenceManager : RemovePresence; entry did not exist")}}},Qce:function(a){for(var b=[],c=this.PO.k9(),d=c.length,e=0;e<d;++e){var f=c[e],g;if(g=f.Qx)a:{var h=f;if((g=a)&&h.nh.Sa(g.Sg())&&h.Qx&&h.Qx.Lu)for(var h=h.Qx.Lu,k=h.length,l=0;l<k;++l)if(h[l]===g.get_shapeId()){g=!0;break a}g=!1}g&&f.Sx&&Array.add(b,
f.Sx)}return b},wxb:function(){for(var a=[],b=this.PO.k9(),c=b.length,d=0;d<c;++d){var e=b[d];e.Sx&&Array.add(a,e.Sx)}return a},Lda:function(a){if(!a)return null;a=a.toLocaleLowerCase();for(var b=this.PO.k9(),c=b.length,d=0;d<c;++d){var e=b[d];if(e.Sx&&e.Sx.eh===a)return e.Sx}return wKd(this,a)},kbc:function(a){var b=u6(this.PO,a);this.nbb(b);R(38339840,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",b?b.ik:a+" not found",this.ik)},wyg:function(a){this.Ka("PresenceChanged",
a)},k9:function(){return this.PO.k9()},Hka:function(){try{R(539874722,814,50,"PresenceManager : Disconnect");if(!this.QPb){var a=this.zmb;a.WRb&&!a.UAa&&!a.gia&&a.Xac();a.X1a=new Date;a.p2a=0;a.q2a=0;a.Jvc=0;a.yY=null;a.WRb=null;a.gia=null;a.UAa=null;a.jtc=!1}this.QPb=!0;this.Rz.Hka()}catch(b){R(19924552,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",b.message,b.stack)}}};
function qKd(a,b){var c=[a.ri.sU()],d=0;a=a.PO.k9();for(var e=a.length,f=0;f<e;++f){var g=a[f];g.Qx.nh.Sa(b.nh)&&!lKd(g.Qx.Lu,b.Lu)&&(d++,g.Sx&&Array.add(c,g.Sx.ku))}if(0<d){a={};for(g=f=e=0;g<c.length;++g){var h=c[g];h&&h.length||(h="anonymous",f++);h in a||(a[h]=!0,e++)}R(8958606,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",d+1,b.Lu&&0<b.Lu.length?"shape":"slide",e,f)}}
function wKd(a,b){var c,d,e,f=(e=V3(a.ri,b,d={val:c}),c=d.val,e);e=a.Rz.m$a(b);d=!!e;if(!f&&!d)return R(50942363,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",b),null;e=d?e:null;f||R(50942365,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",b);d||R(50942367,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",b);d&&f&&R(50942369,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",b,e.clientId!==
c.ID,e.email!==c.EmailAddress);a=a.pqa.rua(f?new CW(c.EmailAddress,null,c.Name,null,!1,null):new CW(OFd(a.SMa,e.email)||e.email,null,e.userName,null,!1,null),f?c.ColorIndex:null,f?c.ID:e.clientId,0);return new on(b,f?c.Name:e.userName,a,new pn(1),null,null,d?e.clientType:0,null,!1,!1,!1,0,null,0)}function pKd(a,b,c){a.DKe=b;a.CKe=c}function TJd(a){return(a=a.wxb())?a.length:0}
function xKd(a,b){var c=[];a=a.PO.k9();for(var d=a.length,e=0;e<d;++e){var f=a[e];f.nh.Sa(b)&&f.Sx&&Array.add(c,f.Sx)}return c}function yKd(a,b){b&&(b.Sx?R(51130898,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",b.ik):(a=wKd(a,b.ik))?XGd(b,a):R(51130896,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",b.ik))}function zKd(a){var b=new dga;b.EmailAddress=a.EmailAddress;b.Id=a.ID;b.Name=a.Name;return b}
function uKd(a,b){for(var c=new (Wb.$$(String,dga))(null),d=0;d<b.length;d++){var e=b[d];if(e&&e.ID!==a.ri.Px)if(e.EmailAddress){var f=u6(a.PO,a.ri.Px);f&&f.jAa&&e.EmailAddress&&f.jAa.toUpperCase()===e.EmailAddress.toUpperCase()||c.ea(e.EmailAddress.toUpperCase(),zKd(e))}else c.ea(e.ID,zKd(e))}return c.Iy()}function tKd(a){cV(a.ra)?a.w3c(cV(a.ra),sKd(a)):R(50943643,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}
function rKd(a,b){var c=b.sEa,d;for(d in c){var e={key:d,value:c[d]};try{var f;var g=e.value;if(g&&g.clientId){var h=SFd(g.data),e=0;g.clientType&&8>=g.clientType&&(e=g.clientType);f=new $ad(g.clientId,h.nh,h,g.chatThreadId,g.chatThreadDiscoveryUri,g.inChat,g.email,new pn(g.capabilities),g.userName,e,g.fHasClientEverExperiencedNetworkLoss)}else R(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),f=null;if(f&&f.ik!==a.ik){var k=f.ik;!a.vNe&&a.DNa&&2!==a.ri.R1&&(a.vNe=!0,a.to.yDb(2),
R(40383241,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));R(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",k,f.Qx.toString());var l=f.jAa;if(!OFd(a.SMa,l)){var m,n,r;(r=V3(a.ri,k,n={val:m}),m=n.val,r)&&TGd(a.SMa,l,m.EmailAddress)}var e=a,t=f,v=e,x=t;try{var y=v.hK;if(!(3<y.Bwc.Wf().Th||y.am&&y.am.nBd||y.Gvd||u6(v.PO,x.ik)||v.tud&&x.htd)){yKd(v,x);var z=x.Sx;z&&z.eh&&(v.aMe||v.ywc||(v.aMe=!0,v.ywc=B().H(VFa,null)),v.ywc&&RGd(v.ywc,
z.eh,z&&1===z.v5a?1:0))}}catch(ra){R(51130947,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",ra.toString())}var E=e.Rz.KFa(t.ik);if(E&&2===E.Se)R(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",t.ik);else a:{var H=u6(e.PO,t.ik);if(H){var O=e,Q=H,U=t,v=x=void 0;(x=!Q.nh.Sa(U.nh))&&R(8958592,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Q.nh,U.nh);var V;if(V=O.txd)O=Q,V=O.nh.Sa(U.nh)&&
lKd(O.Qx.Lu,U.Qx.Lu);(v=V)&&R(8958594,814,50,"Shape Presence Changed");if(!x&&!v)break a;R(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",t.ik,H.Qx.toString(),t.Qx.toString(),e.ik);e.nbb(H)}if(t){e.PO.oka(t);var Z=e.aQb,Y=t.ik,ca=Z.Xoa[Y];ca&&(R(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",Z.ik,
Y,(new Date).getTime()-ca.getTime()),delete Z.Xoa[Y]);yKd(e,t);t.Sx?UGd(e.GTb,new Z2(t.nh,t.Qx.Lu,t.Sx,!0,mKd(e,t.nh),TJd(e))):R(51130900,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",t.ik)}}var la=a.hK;la.hAd||(la.hAd=Date.now(),la.xk(31,la.hAd),Xkd(la,{}))}}catch(ra){R(8958562,814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",ra.toString(),a.ik)}}d=a.hK;try{3<d.Bwc.Wf().Th||Ee(c)||(j6(d,34),mb(d.Bwc,!0))}catch(ra){u(51242146,
814,10,ra.toString())}a.ZGa(b.oEc);R(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");a.Ha("PresenceChanged",null,null)}function oKd(a){var b=a.PO.k9();if(b&&b.length){for(var b=Array.clone(b),c=b.length,d=0;d<c;++d)a.nbb(b[d]);a.Ha("PresenceChanged",null,null)}}function sKd(a){if(!a.txd)return null;var b=[];a=a.pa.Tb();for(var c=0;c<a.length;++c)Array.add(b,a[c].get_shapeId());0<b.length&&b.sort();return b}
function nKd(a){var b=a.Rz.D6b();rKd(a,new Fra(b,null));tKd(a)}function mKd(a,b){return(a=xKd(a,b))?a.length:0}function AKd(){this.yHd=Function.createDelegate(this,this.x$a);this.Cpb=Function.createDelegate(this,this.d_c);this.$ob=Function.createDelegate(this,this.W9b);this.kBc=Function.createDelegate(this,this.b9f)}function BKd(){var a=Jp;return String.format("{0}, {1}, {2}",CKd(Do.Cbc.toString(3)),CKd(Do.Dbc.toString(1)),a)}
function CKd(a){return a?a.charAt(0).toLocaleUpperCase()+a.substring(1,a.length):a}
AKd.prototype={Xj:null,J:null,Rx:null,Psc:null,E2:null,rg:null,cRb:null,sKe:0,kxc:null,Jsd:!1,Rpc:null,Fud:!1,Xb:function(){return"Presence"},wc:function(a){this.sKe=(new Date).getTime();this.J!==a&&(this.J=a,this.E2=this.J.H(CK,null),this.rg=this.E2.Jda(1,this.Xb()),this.Jsd=!1,this.Fud=this.J.H(T,null).T_d);this.Xj=this.J.H(F,null);a=this.J.H(T,null);this.Jsd||DKd(this);var b=a.xQd&&a.eSa?!1:a.Fk(),c=EKd(this,this.J.H(a3,null),this.J.H(ad,null),b);if($H("PresenceInit.EarlyReturnOnNullRTC")){if(!c)return;
C(D(this.J.ma(Oc,null)),function(){return c});C(D(this.J.ma(n6,null)),function(){return c})}else if(C(D(this.J.ma(Oc,null)),function(){return c}),C(D(this.J.ma(n6,null)),function(){return c}),!gc(this.J,n6))return;FKd(this,a)},ub:function(){var a=this.J.H(WK,null);a.xk(21,GKd);a.xk(22,this.sKe);a.xk(24,(new Date).getTime());this.J.H(xN,null).Vf()?WI(HKd(this),"PresentationId"):yzb(this.J.H(KK,null),this.Cpb);var b=this;mPb(this.J.H(AM,null),function(){WI(HKd(b),"B2IFinished")})},d_c:function(){WI(HKd(this),
"PresentationId");this.J.H(KK,null).qa.eb("PIDRD",this.Cpb)},b9f:function(){this.kxc&&this.J.H(Dd,null).ih(this.kxc);this.J.H(b3,null).qa.eb("PRTCC",this.kBc);gc(this.J,n6)||(this.wc(B()),this.ub())},W9b:function(a,b){2!==b.rXc||gc(this.J,n6)||(this.wc(B()),this.ub());gc(this.J,n6)&&this.J.H(b3,null).qa.eb("CSC",this.$ob)},x$a:function(){this.J.H(WK,null).xk(4,this.J.H(Rwb,null).mAd);this.J.H(WK,null).xk(23,(new Date).getTime());var a;this.J.H(T,null).gLc?(a=this.J.H(X2,null),a=a.Qh?a.Qh.FindSessionResponse:
null):a=this.J.H(Xwb,null).qrb;a&&(a=SHd(a,"PresencePackage","Deserialize existing FindSession response"),this.mac(a));try{a="";this.J.H(Q$c,null);a=this.rg.jq("presencemanager");this.J.H(jKd,null).Wb();R(8958613,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized");this.rg.lq(a);this.J.H(S2,null).f0b=!0;R(8958608,814,50,"PresencePackage::Init; Presence downloaded");window.Box4.App.TPc&&(a=this.rg.jq("contentnotification"),aKd(),this.rg.lq(a));a=this.rg.jq("resolve");
var b=this.J.H(WK,null);b.Zwc&&!b.ruc&&(b.ruc=!0,b.Zwc.Ua.Ka(ygc,b.Dpb));this.Rx=this.J.H(Y2,null);this.J.H(zga,null);this.J.H(Oc,null);this.Xj.ud.za.PEc&&(R(41501659,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.Xj.ud.Pq().Ab(2052777571,2,null));this.J.H(fN,null);this.J.H(SFa,null);this.J.H(cWb,null);this.J.H(IKd,null);this.J.H(QIb,null);this.J.H(aHd,null);this.Xj.ud.za.lTd&&this.J.H(JKd,null);this.rg.lq(a);j6(this.J.H(WK,null),25);var c=this.J.H(X2,null);if(c.Qh){var d=
!!c.Qh.PresenceException,e=!window.isNaN(c.Qh.PresenceDownloadEditorTableHttpStatus)&&200!==c.Qh.PresenceDownloadEditorTableHttpStatus||!window.isNaN(c.Qh.PresenceFindSessionHttpStatus)&&200!==c.Qh.PresenceFindSessionHttpStatus,b={};b.EarlyFindSessionEnabled=c.YY.gLc;b.EditorCount=c.asc?c.asc.length:0;b.ShouldConnectToRtcByDefault=c.Ksd;b.EditorTableHttpStatus=c.Qh.PresenceDownloadEditorTableHttpStatus;b.FindSessionHttpStatus=c.Qh.PresenceFindSessionHttpStatus;b.CachedException=c.Qh.PresenceException;
b.IsFindSessionResponseEmpty=!c.Qh.FindSessionResponse;b.IsEditorTableResponseEmpty=!c.Qh.CoauthHandlerResponse;b.RtcBootTokenContainsValue=!!c.cBd;R(41501202,804,d||e?15:50,go(b))}}catch(f){R(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",f)}this.cRb=null},ha:function(){this.Rx?this.Rx.Hka():R(36823630,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.J.H(WK,null).dispose()},mac:function(a){if(a)try{var b;this.Psc=(b=new zHd,b.ksb=a.enabled,
b.hrb=a.errorMessage,b.y5a=a.url,b.Fca=a.queryString,b.tK=a.connectionString,b.c_b=a.throttling_globalMaxNumberOfOutstandingMessages,b.O0b=a.throttling_maxNumberOfOutstandingMessages,b.P0b=a.throttling_timeToWaitForResponse,b.Q0b=a.throttling_messageDelay,b);this.Fud&&this.Rpc&&ZJd(this.Rpc,this.Psc)}catch(c){R(38876692,828,10,"Exception caught while creating FindSessionResponse: {0}",c)}}};
function KKd(a,b,c,d,e){function f(){return CHd(b.Xca,b.lZb,g,b.G2b,Jp,b.eh,BKd(),e,b.ZLc,function(){if(F.sh)return F.sh;var b=a.J.H(xN,null).uk().ql;b||R(50914973,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return b},VGd(a.J.H(X2,null)))}var g=c,g=g.endsWith("/")?g+"findsession":g+"/findsession";R(594061459,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",g,b.lZb.i6);c=!!a.Psc;return a.Fud||c?(a.Rpc=new YJd(a.Psc,f,d,e,
a.J.H(WK,null)),a.Rpc):f()}function HKd(a){a.cRb||(a.cRb=new Vtb(a.yHd,["PresentationId","B2IFinished","RTCConfigured"]));return a.cRb}
function EKd(a,b,c,d){R(591190043,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",d);c.eh=b.eh;var e=null,f=null;c=qId();if(d){var f=ye(L)[S(368)]+"rtc2",g,h;d=f={val:f};var e=g={val:g},k=h={val:h},l=d.val;e.val=0;var m=a.J.H(X2,null);Ukd(m);d.val=m.EVe;d.val?(d=a.J.H(X2,null),Ukd(d),k.val=d.Ksd):(e.val=1,d.val=a.J.H(S2,null).J4d,d.val?k.val=a.J.H(S2,null).v5d:(e.val=2,d.val=l,k.val=!0));f=f.val;g=g.val;h=h.val;d=!a.J.H(VH,null).Dy();e=a.J.H(S2,null).lSd;k=a.J.H(S2,null).aWd;R(50651971,
828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",LKd.toString(g),d,h,e,k);if(2===g&&!e)return a.J.H(b3,null).qa.Ka("PRTCC",a.kBc),MKd(a),null;if(!h&&!d)return a.J.H(b3,null).qa.Ka("CSC",a.$ob),null;e=KKd(a,b,f,a.J.H(T,null),c)}return kId(b.eh,b.Xca,b.M4d,b.lZb,b.ZLc,b.G2b,f,e,c)}
function MKd(a){var b=1E3*a.J.H(T,null).W3d;0<b&&(a.kxc=new Si(2,1,b,function(){a.J.H(S2,null).lSd=!0;a.J.H(b3,null).qa.eb("PRTCC",a.kBc);gc(a.J,n6)||(a.wc(B()),a.ub())},90,"111",!1,0),a.J.H(Dd,null).Vb(a.kxc))}
function FKd(a,b){C(D(lc(a.J.ma(dKd,null),SFa)),function(){return new dKd(a.J.H(Oc,null))});C(D(lc(a.J.ma(XJd,null),oJd)),function(){return new XJd(a.J.H(VH,null))});C(D(lc(a.J.ma(eKd,null),qJd)),function(){return new eKd(a.J.H(a3,null),a.J.H(VH,null),a.J.H(MK,null),a.J.H(NK,null),qId(),b.I4d)});C(D(lc(lc(lc(lc(a.J.ma(jKd,null),Y2),Bga),Xad),Aga)),function(){return new jKd(a.J.H(ad,null),L,a.J.H(n6,null),a.J.H(a3,null),a.Xj.ud,a.J.H(UM,null),a.J.H(FN,null),a.J.H(iR,null),a.J.H(b3,null),a.J.H(GN,null),
a.J.H(dd,null),a.J.H(Vad,null),a.J.H(VH,null),a.J.H(S2,null),b,a.J.H(FK,null),a.J.H(oJd,null),a.J.H(Yad,null),a.J.H(Zad,null),a.J.H(qJd,null),a.J.H(LK,null),a.J.H(WK,null),kc(a.J,XK),a.J.H(X2,null).o7b(),a.J.H(MK,null),a.J.H(YH,null),a.J.H(iK,null))});C(D(a.J.ma(dbd,null)),function(){return new dbd(a.J.H(Y2,null))});C(D(a.J.ma(IKd,null)),function(){return new IKd(a.J.H(iR,null),a.J.H(GN,null),a.J.H(Y2,null),a.J.H(ql,null),a.J.H(cWb,null),a.J.H(fR.$$(AQ),null),a.J.H(WM,null),a.J.H(Yv,null).Eb(),a.J.H(xQ,
null).Eb(),a.J.H(W2,null),b.Psa)});C(D(lc(a.J.ma(jJd,null),fN)),function(){return new jJd(a.J.H(ad,null).Ax(),b.t5d,a.J.H(ON,null),iA(a.J.H(Ow,null),10),a.J.H(iR,null))});var c=new NKd(b.BRd,b.p6d,b.o6d,b.TRd,b.ETd,b.FTd,b.U7d,b.V7d,b.j4d,b.FRd,b.yRd,b.N6d,b.lYd,b.DRd,b.C1b,b.B1b);C(D(lc(a.J.ma(OKd,null),pJd)),function(){return new OKd(a.J.H($R,null),a.J.H(fR.$$(AQ),null),a.J.H(UM,null),a.J.H(b3,null),a.J.H(jR,null))});C(D(lc(a.J.ma(vJd,null),cWb)),function(){return new vJd(window.Box4.App.Cg,a.J.H(Y2,
null),a.J.H(ad,null).Ax(),a.J.H(n6,null),a.J.H(tS,null),a.J.H(Dd,null),a.J.H(UM,null),a.J.H(vy,null),a.J.H(BS,null),a.J.H(ZM,null),a.J.H(NN,null),iA(a.J.H(Ow,null),12),b,c,a.J.H(fN,null),a.J.H(GN,null),a.J.H(fR.$$(AQ),null),a.J.H(iR,null),a.J.H(pJd,null),a.J.H($R,null).Eb(),iA(a.J.H(Ow,null),16),mc(Zc,kc(B(),Zc)))});C(D(a.J.ma(QIb,null)),function(){return new PKd});C(D(a.J.ma(rJd,null)),function(){return new QKd(a.J.H(ZM,null),a.J.H(NN,null),a.J.H(Sv,null),a.J.H(fN,null))});C(D(a.J.ma(JKd,null)),
function(){return new JKd(a.J.H(EK,null),a.J.H(iR,null),gdb(),iA(a.J.H(Ow,null),12),a.J.H(GN,null),a.J.H(EN,null),a.J.H(fN,null),a.J.H(UM,null),a.J.H(b3,null),a.J.H(ZM,null),a.J.H(NN,null),a.J.H(rJd,null),c)});C(D(a.J.ma(aHd,null)),function(){var b=a.J.H(ad,null),c=a.J.H(Oc,null),f=a.J.H(Aga,null),g=a.J.H(zga,null),h=new (bb.$$(Aga));h.Uh(f);f=new (bb.$$(Oc));f.Uh(c);return new aHd(b,f.Wf(),h.Wf(),g,a.J.H(Dd,null),a.Xj.ud.za.m5a?6E4:a.Xj.ud.za.l5a,a.Xj.ud.Pq().hof,JS().St,L.ia("PeoplesWellExtraButtonInfoIsEnabled"))});
C(D(a.J.ma(Q$c,null)),function(){return new iJd(a.J.H(n6,null))});WI(HKd(a),"RTCConfigured")}function DKd(a){D(lc(a.J.ma(on,null),ad));C(D(lc(a.J.ma(RKd,null),zga)),function(){return new RKd(a.J.H(VH,null))});a.Jsd=!0}function LKd(){}LKd.prototype={coauthHandlerResponse:0,popSessionResponse:1,defaultFallback:2};LKd.registerEnum("PowerpointPresence.PresencePackage.RtcDiscoverType",!1);
function SKd(a,b,c,d,e){this.KBc=Function.createDelegate(this,this.d1c);this.dispose=this.ha;this.At=L.ia("PPTCanvasPresenceBubbleUXEnabled");var f=new kFd;f.ga(String,0,ck(ak,"MoreUsersGlyph_16x16x32"));f.ga(String,5,bk);f.ga(String,1,ck(ak,this.At?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));f.ga(String,4,bk);f.ga(Number,6,e);f.ga(Boolean,8,Di);f.ga(Number,12,b);f.ga(Boolean,11,d);this.At&&(f.ga(Function,16,this.KBc),f.ga(Boolean,17,!0));this.At?(b=new GEd(f),this.Ks=b.f5b(a,
!1)):(b=new hFd(f),this.Ks=b.mKf(a,c,!1))}
SKd.prototype={Ks:null,At:!1,ha:function(){this.Ks.dispose()},d1c:function(){return e_b(document.getElementById("EditingThumbnailsPanel"))},zP:function(a){this.Ks?(R(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",a.eh),this.Ks.zP(a)):R(8958617,814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",a.eh)},V_:function(a){this.Ks?(R(8958623,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",a.eh),this.Ks.V_(a.eh)):R(8958621,
814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",a.eh)},Qe:function(){if(this.Ks)if(R(8958627,814,50,"PresencePawn:Clear at PresencePawn "),this.Mda())for(var a=this.Mda(),b=a.length,c=0;c<b;++c)this.V_(a[c]);else R(8958657,814,50,"PresencePawn:Clear - Pawn has no users");else R(8958625,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")},Mda:function(){return this.Ks?this.Ks.TNb():null},$4c:function(){this.Ks&&(this.At&&
this.Ks.EHa(),this.Ks.Pbb())},uUc:function(){this.Ks&&this.Ks.EHa()}};function PKd(){}PKd.prototype={DKf:function(a,b,c,d,e){return new SKd(a,b,c,d,e)}};
function IKd(a,b,c,d,e,f,g,h,k,l,m){this.D9e=Function.createDelegate(this,this.OTf);this.Fkf=Function.createDelegate(this,this.mag);this.Mkf=Function.createDelegate(this,this.uag);this.Lkf=Function.createDelegate(this,this.sag);this.huf=Function.createDelegate(this,this.Lng);this.guf=Function.createDelegate(this,this.Kng);this.xBc=Function.createDelegate(this,this.$_c);this.Y4a=Function.createDelegate(this,this.PAb);this.W4a=Function.createDelegate(this,this.MAb);this.ovf=Function.createDelegate(this,
this.Tcc);this.Ezd=[];this.gwc=[];if(!b)throw Error.argumentNull("graphTopologyManager");if(!c)throw Error.argumentNull("presenceManager");if(!d)throw Error.argumentNull("dragInputManager");if(!e)throw Error.argumentNull("coauthStateChangesHandler");this.ke=a;this.ra=b;this.Rx=c;this.Jo=d;this.yMa=e;this.c7=f;this.Mb=g;this.ge=h;this.ara=k;this.eV=l;this.cK=m;W3(this.eV,this.ovf);aR(this.ke,this.W4a);this.ke.qa.Ka("TR",this.Y4a);HJb(this.ke,this.xBc);this.swd=L.ia("PPTCanvasPresenceFloodGateSurveyEnabled");
(this.At=L.ia("PPTCanvasPresenceBubbleUXEnabled"))&&this.swd&&(this.FMe=L.fd("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.GMe=L.fd("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",3),this.Rud=0,this.PBa=mc(wga,kc(B(),wga)));GJb(this.ke,this.guf);this.ke.qa.Ka("SL",this.huf);this.ke.qa.Ka("SLH",this.Lkf);this.ke.qa.Ka("SPH",this.Mkf);this.ke.qa.Ka("HPH",this.Fkf)}
IKd.prototype={ke:null,ra:null,Rx:null,Jo:null,yMa:null,c7:null,Mb:null,eV:null,ge:0,ara:0,cK:!1,PBa:null,Rud:0,FMe:0,GMe:0,swd:!1,At:!1,gtc:null,ftc:null,MAb:function(){if(cV(this.ra)){R(8958659,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",cV(this.ra));var a=cV(this.ra);if(cV(this.ra)&&cV(this.ra).Sa(a)&&(R(8958665,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",a),a=new Yx,a.Set(this.ra.Ma()),a.Jb(1))){do if(0<
a.oa().nb(Number,Ns)){var b=window.$$as(YM,a.oa());b&&TKd(this,b)}while(a.Rf(1))}}},Tcc:function(a,b){if(this.Jo.it){R(50442244,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active.");if(!this.ftc){var c=this;this.ftc=new Si(2,1,0,function(){UKd(c)},90,"68",!1,0);ke().Vb(this.ftc)}b&&this.gwc.push(b)}else VKd(this,b),WKd(this,b)},PAb:function(a,b){XKd(this,[b.WMc])},$_c:function(a,b){XKd(this,b.eta)},oka:function(a,b){var c=YKd(this,a);c?(c.oka(b),ZKd(this),R(21770508,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",
a.toString())):R(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",a.toString())},ZGa:function(a,b){var c=YKd(this,a);c?c.ZGa(b):R(21770510,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",a.toString())},Kng:function(a,b){a=b.ju;$Kd(this,a.Md())&&(this.Ezd.push(a),this.gtc||(this.gtc=new Si(2,1,0,this.D9e,90,"69",!1,0),ke().Vb(this.gtc)))},OTf:function(){this.gtc=null;for(var a=this.Ezd,b=a.length,c=0;c<b;++c){var d=a[c];if(!$Kd(this,
d.Md()))return;TKd(this,d.Md())}Array.clear(this.Ezd)},Lng:function(a,b){WU(this.c7,b.ju.Md()).$dc(b.$1b)},sag:function(a,b){(b.ju.XB()||b.ju.UBd)&&(a=this.c7.lH(b.ju.Md()))&&a.N4c()},uag:function(a,b){(a=this.c7.lH(b.ju.Md()))&&a.Zng()},mag:function(a,b){(a=this.c7.lH(b.ju.Md()))&&a.u9()}};function $Kd(a,b){return!!a.ra.Ma()&&a.ra.Ma().gc().Sa(b.Sg())}function aLd(a){var b=null;a.ra.Ma()&&(b=a.ra.Ma().jn(!1));return b||[]}
function bLd(a,b,c){for(var d=aLd(a),e=d.length,f=0;f<e;++f){var g=d[f];Array.contains(b,g.get_shapeId())&&(g=WU(a.c7,g))&&g.ZGa(c)}}function cLd(a,b,c){for(var d=!1,e=aLd(a),f=e.length,g=0;g<f;++g){var h=e[g];if(Array.contains(b,h.get_shapeId())&&!h.get_smartArtModelId()){var k=window.$$as(tQ,Uy(h,a.ge));k&&!h.get_smartArtModelId()&&((h=WU(a.c7,h))?(k.ZB()&&h.LEd(!1),h.oka(c),ZKd(a),k.ZB()&&h.Bzb()):d=!0)}}d||R(8958685,814,50,"PresencePresenter::AddShapePresence succeeded")}
function TKd(a,b){var c=window.$$as(tQ,Uy(b,a.ge));if(c&&!b.get_smartArtModelId()){var d=a.Rx.Qce(b);if(d)if(d.length){f=WU(a.c7,b);f.x$d();b=d.length;for(var e=0;e<b;++e)f.oka(d[e]),ZKd(a)}else{var f=a.c7.lH(b);f&&f.x$d()}FJd(a.yMa,c)}}function WKd(a,b){cV(a.ra)&&cV(a.ra).Sa(b.nh)&&b.Lu&&(b.TQa?cLd(a,b.Lu,b.Wia):bLd(a,b.Lu,b.Wia))}
function ZKd(a){a.At&&a.swd&&!(a.Rud>=a.GMe)&&a.PBa&&a.PBa.CW(function(){ab(a.PBa).Jn("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",a.FMe)&&a.Rud++})}
function dLd(a,b){for(var c=b.length,d=0;d<c;++d){var e=b[d],f=window.$$as($M,e);if(f)if(e=f.gc(),f=window.$$as(iGb,Fy(f,a.ara))){R(21770516,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",e.toString());e=xKd(a.Rx,e);f.Wm&&f.Wm.Qe();e&&e.length?f.z8a():f.mSa();for(var g=e.length,h=0;h<g;++h){var k=e[h];R(17056460,814,50,"PresenceManager : UpdatePresence - Add updated Presence position for ClientId {0}",k.eh);f.oka(k)}}else R(21770514,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",
e.toString());else R(593242145,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",e.gc().toString())}}function eLd(a){var b=a.ra.Ed;if(!b)throw Error.argumentNull("Presentation is null");dLd(a,b.Rj||[])}function YKd(a,b){var c=FO(a.Mb,b);return c?window.$$as(iGb,Fy(c,a.ara)):(R(21770512,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",b.toString()),null)}
function XKd(a,b){for(var c=[],d=b.length,e=0;e<d;++e){var f=b[e],f=a.cK?EEb(a.Mb,f):FO(a.Mb,f);a.cK&&0>=f.d0a()||f&&Array.add(c,f)}dLd(a,c)}function VKd(a,b){b.TQa?a.oka(b.nh,b.Wia):a.ZGa(b.nh,b.Wia)}
function UKd(a){a.ftc=null;eLd(a);if(cV(a.ra)&&0<a.gwc.length){for(var b={},c={},d=cV(a.ra),e=a.gwc,f=e.length,g=0;g<f;++g){var h=e[g];if(d.Sa(h.nh)&&h.Lu&&h.Wia){h.Wia.eh in c||(b[h.Wia.eh]=h.Wia,c[h.Wia.eh]=new (Wb.$$(Number,Number))(0));for(var k=c[h.Wia.eh],l=h.Lu,m=l.length,n=0;n<m;++n){var r=l[n],t=h.TQa?1:0;k.hc(r)?0<(k.K(r)^t)&&k.ea(r,t):k.ga(r,t)}}}for(var v in b)if(d={key:v,value:b[v]},e=d.key,e in c){var x=[],y=[];c[e].zg(function(a,b){0<b?y.push(a):x.push(a);return!0});0<x.length&&bLd(a,
x,d.value);0<y.length&&cLd(a,y,d.value)}a.gwc=[]}}function RKd(a){this.ri=a}RKd.prototype={ri:null};function cHd(a,b){if(!b||!b.value)return null;b=b.value;var c=b.userName;if(!c&&a.ri){var d,e,f;if(f=V3(a.ri,b.clientId,e={val:d}),d=e.val,f)c=d.Name}var g;return g=new on,g.eh=b.clientId,g.rDc=b.chatThreadId,g.qDc=b.chatThreadDiscoveryUri,g.HFc=b.inChat,g.ED=b.email,g.hw=new pn(b.capabilities),g.ku=c,g}
function NKd(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x){this.swb=a;this.q5c=b;this.p5c=c;this.Lwb=d;this.a8b=e;this.GUc=f;this.qcb=g;this.x6c=h;this.jbb=k;this.gRc=l;this.fRc=m;this.bDb=n;this.$$a=r;this.w9a=t;this.yRc=v;this.O5b=x}NKd.prototype={q5c:0,p5c:0,Lwb:0,a8b:0,GUc:0,qcb:0,x6c:0,jbb:0,swb:!1,gRc:!1,fRc:!1,bDb:0,$$a:0,w9a:!1,yRc:!1,O5b:!1};
function UJd(a){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",a.swb,a.q5c,a.p5c,a.Lwb,a.a8b,a.GUc,a.qcb,a.x6c,a.jbb,a.gRc,a.fRc,a.bDb,a.$$a,a.w9a,a.yRc,a.O5b)}function fLd(a,b,c,d){fLd.initializeBase(this,[a,b,c,d]);this.UDd=QO(a)}
fLd.prototype={UDd:!1,Md:function(){return window.$$as(YM,this.yCd)},Vxb:function(){for(var a=new (Ca.$$(String)),b=dP(this.Md()),c=b.length,d=0;d<c;++d){var e=this.Xi.Text(b[d]);e&&0<e.length&&a.ga(e)}return a.Jd().join(" ")},Wxb:function(){return this.$a.ila(this.Md())},sPc:function(){try{var a=this.Vxb()||"",b=this.bSb||"";if(a!==b){var c=t6(a)===t6(b),d=this.UDd||QO(this.Md());if(!c&&!d&&!ZO(this.Md())){var e=fo("Shape",this.Md().rt(),"Start",kI(this.t3a),"LastSnapshotTime",kI(this.cSb),"EverEdit",
this.OHc,"Type",this.h7b());e.Expiration=-1<this.gba?(new Date(this.gba)-this.t3a).toString():null;var f=a.length-b.length;f?e.TextLengthDelta=f:e.SameLengthDiffDetails=tJd(a,b);R(25539747,814,15,Id(e))}}}catch(g){R(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",g)}},tPc:function(){try{var a=kJd(this.Md());if(a&&0<a.length)return!1;var b=this.Wxb()||"",c=this.bSb||"";if(b!==c&&0>b.indexOf(c)&&!(0<=t6(b).indexOf(t6(c))||ZO(this.Md()))){var d=fo("Shape",this.Md().rt(),"Start",kI(this.t3a),
"LastSnapshotTime",kI(this.cSb),"TextLengthDelta",b.length-c.length,"Type",this.h7b());R(25981903,814,15,Id(d))}}catch(e){R(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",e)}return!0},h7b:function(){return ZO(this.Md())?"Table":JO(this.Md())?"SmartArt":$O(this.Md())?"TextBox":RO(this.Md())?"PlaceHolder":bU(this.Md())?"Shape":"Unknown"}};function gLd(a,b,c,d,e){gLd.initializeBase(this,[a,b,d,e]);this.je=c}
gLd.prototype={je:null,rU:function(){return window.$$as(bN,this.yCd)},Vxb:function(){var a=new (Ca.$$(String)),b=this;this.je.OUa(this.rU(),function(c){(c=b.Xi.Text(c))&&0<c.length&&a.ga(c)});return a.Jd().join(" ")},Wxb:function(){var a=new (Ca.$$(String));this.je.OUa(this.rU(),function(b){b.fb(zq)&&(b=b.nb(String,zq))&&0<b.length&&a.ga(b)});return a.Jd().join(" ")},sPc:function(){try{var a=this.Vxb()||"",b=this.bSb||"";if(a!==b&&t6(a)!==t6(b)){var c=fo("TableCellNode",hLd(this)+"/"+this.rU().rt(),
"Start",kI(this.t3a),"LastSnapshotTime",kI(this.cSb),"EverEdit",this.OHc);c.Expiration=-1<this.gba?(new Date(this.gba)-this.t3a).toString():null;var d=a.length-b.length;d?c.TextLengthDelta=d:c.SameLengthDiffDetails=tJd(a,b);R(37748808,814,15,Id(c))}}catch(e){R(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",e)}},tPc:function(){try{var a=mJd(this.rU());if(a&&0<a.length)return!1;var b=this.Wxb()||"",c=this.bSb||"";if(b!==c&&0>b.indexOf(c)&&!(0<=t6(b).indexOf(t6(c)))){var d=fo("TableCellNode",
hLd(this)+"/"+this.rU().rt(),"Start",kI(this.t3a),"LastSnapshotTime",kI(this.cSb),"TextLengthDelta",b.length-c.length);R(37748812,814,15,Id(d))}}catch(e){R(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",e)}return!0}};function hLd(a){return(a=OP(0,a.rU()))?a.rt():"UnknownShape"}
function JKd(a,b,c,d,e,f,g,h,k,l,m,n,r){this.wI=Function.createDelegate(this,this.WI);this.xr=Function.createDelegate(this,this.Tj);this.nlf=Function.createDelegate(this,this.wbg);this.Hkf=Function.createDelegate(this,this.oag);this.Ekf=Function.createDelegate(this,this.lag);this.Ikf=Function.createDelegate(this,this.pag);this.E0e=Function.createDelegate(this,this.NGf);this.wlf=Function.createDelegate(this,this.Hbg);this.T4a=Function.createDelegate(this,this.JAb);this.jjf=Function.createDelegate(this,
this.j9f);this.nK={};this.hra={};this.pa=h;this.My=k;this.uc=a;this.zq=b;this.jNe=c;this.Bp=d;this.ra=e;this.ji=f;this.aja=g;this.$a=l;this.je=m;this.myc=n;this.Yp=r;this.pa.Ka("ProcessPreSelectionChanged",this.jjf);uz(this.pa,this.T4a);this.My.qa.Ka("TCVEL",this.wlf);this.uc.qa.Ka("IRR",this.E0e);vZ(this.zq,this.Ikf);this.zq.qa.Ka("CTE",this.Ekf);this.zq.qa.Ka("SL",this.Hkf);this.jNe.Ua.Ka("SIE",this.nlf);iH(this.Bp,this.xr);uO(this.ji,this.wI)}
JKd.prototype={nK:null,hra:null,unb:null,x3a:null,uc:null,zq:null,jNe:null,Bp:null,ra:null,ji:null,aja:null,pa:null,My:null,$a:null,je:null,myc:null,Yp:null,pag:function(a,b){a=window.$$as(YM,window.$$as(CQ,b.ju).sb());b=iLd(this.myc,a);this.nK[a.Ta().toString()]=b;uJd(b,!0)},lag:function(a,b){a=window.$$as(YM,window.$$as(CQ,b.ju).sb()).Ta().toString();a in this.nK&&(b=Date.now()+this.Yp.Lwb,this.nK[a].gba=b)},oag:function(a,b){a=window.$$as(YM,window.$$as(CQ,b.ju).sb()).Ta().toString();a in this.nK&&
delete this.nK[a]},j9f:function(){this.unb=jLd(this)},JAb:function(){this.x3a=jLd(this);if(!(!this.unb&&!this.x3a||this.unb&&this.x3a&&this.x3a.Ta().Sa(this.unb.Ta()))){if(this.unb){var a=this.unb.Ta().toString();if(a in this.nK){var b=Date.now()+this.Yp.Lwb;this.nK[a].gba=b}}this.x3a&&(a=iLd(this.myc,this.x3a),this.nK[this.x3a.Ta().toString()]=a,uJd(a,!0))}},Hbg:function(a,b){a=b.rU().Ta().toString();a in this.nK&&delete this.nK[a]},NGf:function(){kLd(this);for(var a=Object.keys(this.nK),b=a.length,
c=0;c<b;++c)uJd(this.nK[a[c]],!0)},wbg:function(){kLd(this);for(var a=Object.keys(this.nK),b=a.length,c=0;c<b;++c){var d=a[c],e=this.nK[d];e.sPc()}a=Object.keys(this.hra);b=a.length;for(c=0;c<b;++c)d=a[c],e=this.hra[d],e.tPc()&&delete this.hra[d]},Tj:function(a,b){if(b&&b.xc&&b.oh.Na===zq.Na){a=window.$$as(KN,b.xc);b=!b.xc.ZN;var c=this.je.Oda(a);if(c)lLd(this,c,b),mLd(this,c,b);else if(a=VP(a))lLd(this,a,b),mLd(this,a,b)}},WI:function(){this.hra={}}};
function mLd(a,b,c){var d=OP(0,b);d&&a.ra.Ma()&&a.ra.Ma().Pc()===d.get_sid()&&a.ra.Ma().Be()===d.get_cid()&&(d=b.Ta().toString(),c?d in a.hra&&delete a.hra[d]:(c=bN.isInstanceOfType(b)?mJd(window.$$as(bN,b)):kJd(window.$$as(YM,b)))&&0<c.length&&(d in a.hra?b=a.hra[d]:(b=iLd(a.myc,b),a.hra[d]=b),uJd(b,!1)))}function lLd(a,b,c){b=b.Ta().toString();if(b in a.nK){a=a.nK[b];if(b=window.$$as(fLd,a))b.UDd=QO(b.Md());uJd(a,!0);c&&(a.OHc=!0)}}
function kLd(a){for(var b=Object.keys(a.nK),c=b.length,d=0;d<c;++d){var e=b[d],f=a.nK[e];0<f.gba&&Date.now()>=f.gba&&delete a.nK[e]}}function jLd(a){var b=a.pa.Ib();if(!b||!b.Bb()||oB(b.Bb()))return null;b=b.Bb();return b.hb().na&&b.hb().na.oc()?a.je.Oda(b.hb().na):null}function QKd(a,b,c,d){this.$a=a;this.je=b;this.Xi=c;this.aja=d}QKd.prototype={$a:null,je:null,Xi:null,aja:null};
function iLd(a,b){return YM.isInstanceOfType(b)?new fLd(window.$$as(YM,b),a.$a,a.Xi,a.aja):bN.isInstanceOfType(b)?new gLd(window.$$as(bN,b),a.$a,a.je,a.Xi,a.aja):null}function OKd(a,b,c,d,e){this.NMd=Function.createDelegate(this,this.ocg);this.T4a=Function.createDelegate(this,this.JAb);this.dispose=this.ha;this.Lb=a;this.c7=b;this.pa=c;this.My=d;this.Ou=e;this.ZPb=!1}
OKd.prototype={Lb:null,c7:null,pa:null,My:null,Ou:null,ZPb:!1,Qd:function(){uz(this.pa,this.T4a);this.My.qa.Ka("TLSC",this.NMd)},ha:function(){this.pa.eb("ProcessPreSelectionChanged",this.T4a);this.My.qa.eb("TLSC",this.NMd)},JAb:function(){for(var a=null,b=lU(this.pa),c=b.length,d=0;d<c;++d){var e=window.$$as(pN,b[d]);if(e&&(e=window.$$as(fGb,Fy(e,this.Lb.Eb())))&&(a=e.Naa))break}MU(this.pa)?nLd(this,a):oLd(this)},ocg:function(a,b){a=b.$Qd;MU(this.pa)?nLd(this,a):oLd(this)}};
function pLd(a){var b=null,c=a.pa.Tb();1===c.length&&(b=window.$$as(tQ,Uy(c[0],a.Lb.Eb())));return b}function oLd(a){if(a.Lb.Zf()&&a.Lb.Zf().Cm()){var b=pLd(a);b&&ZO(b.Md())&&(WU(a.c7,b.Md()).$dc(null),H1b(b));a.ZPb&&R(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");a.Lb.Zf().OHa();a.ZPb=!1}}
function nLd(a,b){if(a.Lb.Zf()&&a.Lb.Zf().Cm()){var c=pLd(a);c&&(WU(a.c7,c.Md()).$dc(b),b&&(c.UBd=!0,b=new EQ(c),a.Ou.qa.Ha("SLH",b,null),c.UBd=!1));a.ZPb||R(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");a.Lb.Zf().qS(!1,14);a.ZPb=!0}}iJd.registerClass("PowerPointWebEditor.PresenceUserInfoGetter",null,Q$c,P$c);jJd.registerClass("PowerPointWebEditor.PptWetChangeHandler",null,fN,Sys.IDisposable);window.PowerpointPresence.SerializableLockData.registerClass("PowerpointPresence.SerializableLockData");
sJd.registerClass("PowerpointPresence.ATextContentRecord");vJd.registerClass("PowerpointPresence.CoauthStateChangesHandler",null,cWb);EJd.registerClass("PowerpointPresence.CoauthStateChangesHandler.ShapeNodeStartEditingNotificationTracking");VJd.registerClass("PowerpointPresence.ContentUpdateInfo");WJd.registerClass("PowerpointPresence.ContentNotificationManager");XJd.registerClass("PowerpointPresence.EditorPresenceTracker",null,oJd);JJd.registerClass("PowerpointPresence.LockEntry");
YJd.registerClass("PowerpointPresence.PptAssignRtcMachineStrategy",null,fHd);$Jd.registerClass("PowerpointPresence.PptContentNotificationManager",WJd);dKd.registerClass("PowerpointPresence.PPTRtcProvider",null,SFa);eKd.registerClass("PowerpointPresence.PptRealtimeChannelMetrics",null,qJd);iKd.registerClass("PowerpointPresence.PresenceDataManager",re);jKd.registerClass("PowerpointPresence.PresenceManager",re,Y2,Xad,Bga,Aga);AKd.registerClass("PowerpointPresence.PresencePackage",null,yo,ec);
SKd.registerClass("PowerpointPresence.PresencePawn",null,PIb,Sys.IDisposable);PKd.registerClass("PowerpointPresence.PresencePawnFactory",null,QIb);IKd.registerClass("PowerpointPresence.PresencePresenter");RKd.registerClass("PowerpointPresence.PresenceUtils",null,zga);NKd.registerClass("PowerpointPresence.RttLockSettings");fLd.registerClass("PowerpointPresence.ShapeContentRecord",sJd);gLd.registerClass("PowerpointPresence.TableCellContentRecord",sJd);JKd.registerClass("PowerpointPresence.TextContentMonitor");
QKd.registerClass("PowerpointPresence.TextContentRecordFactory",null,rJd);OKd.registerClass("PowerpointPresence.TypingLockHandler",null,pJd,Sys.IDisposable);var cKd=null,vKd="ETU",GKd=0,GKd=(new Date).getTime(),Ezc=new AKd;L&&L.ia("IsSyncConfigPresenceEnabled")?(Ezc.wc(B()),gc(Ezc.J,n6)&&Ezc.ub()):zo(gj(),Ezc,0,!1);
