var immersiveReader=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[13],{1229:function(e,t,n){"use strict";n.r(t);var r=n(947);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o)},947:function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookiePolicy=void 0,function(e){e[e.Disable=0]="Disable",e[e.Enable=1]="Enable"}(t.CookiePolicy||(t.CookiePolicy={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookiePolicy=t.launchWithoutContentAsync=t.launchAsync=t.close=t.renderButtons=void 0;var r=n(2);Object.defineProperty(t,"renderButtons",{enumerable:!0,get:function(){return r.renderButtons}});var o=n(3);Object.defineProperty(t,"close",{enumerable:!0,get:function(){return o.close}}),Object.defineProperty(t,"launchAsync",{enumerable:!0,get:function(){return o.launchAsync}}),Object.defineProperty(t,"launchWithoutContentAsync",{enumerable:!0,get:function(){return o.launchWithoutContentAsync}});var i=n(0);Object.defineProperty(t,"CookiePolicy",{enumerable:!0,get:function(){return i.CookiePolicy}}),"undefined"!=typeof window&&window.addEventListener("load",(function(){var e;window.hasOwnProperty("Promise")||((e=document.createElement("script")).src="https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/promise-polyfill.min.js",document.head.appendChild(e)),r.renderButtons()}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderButtons=void 0;var r={af:"Indompelende leser",am:"በህያው ስሜት ፈጣሪ ዕይታ አንባቢ",ar:"القارئ الشامل",as:"ইমাৰচিভ ৰিডাৰ",az:"İmmersiv Oxuyucu",be:"Імерсіўны чытальнік",bg:"Концентриран четец",bn:"মনোগ্রাহী পাঠক","bn-bd":"ইমার্সিভ পাঠক",bs:"Koncentrirani čitalac",ca:"Lector immersiu",cs:"Asistivní čtečka","cy-gb":"Darllenydd Ymdrwythol",da:"Forenklet læser",de:"Plastischer Reader",el:"Προηγμένο πρόγραμμα ανάγνωσης",en:"Immersive Reader",es:"Lector inmersivo",et:"Süvaluger",eu:"Irakurgailu murgiltzailea",fa:"خواننده همه‌جانبه",fi:"Syventävä lukuohjelma",fil:"Immersive Reader",fr:"Lecteur immersif","ga-ie":"Léitheoir tumthach",gd:"An leughadair ùr-nòsach",gl:"Lector avanzado",gu:"ઇમર્સિવ રીડર",ha:"Mai karatu Mai barbazawa",he:"תצוגת קריאה מודרנית",hi:"इमर्सिव रीडर",hr:"Stopljeni čitač",hu:"Modern olvasó",hy:"Խորասուզված ընթերցիչ",id:"Pembaca Imersif",ig:"Ọgụụ Kenzipụtara",is:"Aðgengilegt lestrarumhverfi",it:"Strumento di lettura immersiva",ja:"イマーシブ リーダー",ka:"იმერსიული წამკითხველი",kk:"Иммерсивті оқу құралы",km:"កម្មវិធីអានពណ៌រំលេចនៅលើអេក្រង់",kn:"ಇಮ್ಮರ್ಸಿವ್ ಓದುಗ",ko:"몰입형 리더",kok:"तंद्री लागिल्लो वाचक","ku-arab":"خوێنەری پڕ",ky:"Курчаган Окугуч",lb:"Immersive Reader",lo:"ຕົວອ່ານອິມເມີສີບ",lt:"Įtraukianti skaitytuvė",lv:"Tīrskata lasītājs",mi:"Pūpānui Rumaki",mk:"Сеопфатен читач",ml:"ഇമ്മേഴ്‌സീവ് റീഡർ",mn:"Идэвхтэй уншигч",mr:"इमर्सिव्ह वाचक",ms:"Pembaca Imersif",mt:"Qarrej Immersiv",ne:"इमेर्सिभ रिडर",nl:"Insluitende lezer","nn-no":"Engasjerande lesar",no:"Engasjerende leser",nso:"Go Bala ka Mongwalo o Mokoto",or:"ଇମରସିଭ୍ ରିଡର୍",pa:"ਇਮਰਸਿਵ ਰੀਡਰ","pa-arab":"گھیرن آلا مطالعہ کار",pl:"Czytnik immersyjny",prs:"خواننده نمایش",pt:"Leitura Avançada",quc:"Nim ucholajil sik'inel uwach",quz:"Wankisqa Ñawiq",ro:"Immersive Reader",ru:"Иммерсивное средство чтения",rw:"Insakazasoma",sd:"امرسو ريڊر",si:"ගිලෙන සුළු කියවනය",sk:"Imerzná čítačka",sl:"Potopni bralnik",sq:"Lexuesi kredhës","sr-cyrl-ba":"Концентрисани читалац","sr-cyrl-rs":"Концентрисани читалац","sr-latn-rs":"Koncentrisani čitalac",sv:"Avancerad läsare",sw:"Kisomaji cha Kuzamisha",ta:"அற்புதமான ரீடர்",te:"మంత్రముగ్ధులను చేసే పఠన సాధనం","tg-cyrl-tj":"Хонандаи фарогир",th:"โปรแกรมช่วยอ่าน",ti:"ኣንባቢ ሕሉው ስምዒት ፈጣሪ",tk:"Giňişleýin okaýjy",tn:"Sebadi sa Imesife",tr:"Tam Ekran Okuyucu",tt:"Чолгап алучы уку чарасы","ug-cn":"چۆكمە ئوقۇغۇچ",uk:"Занурення в текст",ur:"امرسیو مطالعہ کار",uz:"Immersiv mutolaa vositasi",vi:"Trình đọc Chân thực",wo:"Jàngukaay bu Rafet",xh:"Isifundi Esikhulu",yo:"Ìwò Alámùtán",zh:"沉浸式阅读器","zh-hant":"沈浸式閱讀程式",zu:"Isifundi Sokuzizwisa"};function o(e){var t=document.createElement("img");t.src="https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/immersive-reader-icon.svg";var n=e.getAttribute("data-icon-px-size")||"20";t.style.height=t.style.width=n+"px",t.style.verticalAlign="middle",t.style.marginTop="-2px";var r=e.getAttribute("data-locale")||"en";t.alt=s(r),e.appendChild(t)}function i(e){var t=document.createElement("span");t.style.marginLeft="8px",e.appendChild(t)}function a(e){var t=document.createElement("span"),n=e.getAttribute("data-locale")||"en";t.textContent=s(n),e.appendChild(t)}function s(e){return e=e.toLowerCase(),r[e]?r[e]:"zh-hk"===e||"zh-mo"===e||"zh-tw"===e?r["zh-hant"]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:r.en))}t.renderButtons=function(e){var t=document.createElement("style");t.innerHTML=".immersive-reader-button{cursor:pointer;display:inline-block;padding:5px;} .immersive-reader-button:hover{background:rgba(0,0,0,.05);border-radius:2px",document.head.appendChild(t);var n=[].slice.call(document.getElementsByClassName("immersive-reader-button"));e&&e.elements&&(n=e.elements);for(var r=0,d=n;r<d.length;r++){var u=d[r];u.setAttribute("role","button");var l=u.getAttribute("data-locale")||"en";switch(u.setAttribute("aria-label",s(l)),u.textContent="",u.getAttribute("data-button-style")||"icon"){case"icon":o(u);break;case"text":a(u);break;case"iconAndText":o(u),i(u),a(u)}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.close=t.resetLoadingForTest=t.launchWithoutContentAsync=t.launchAsync=void 0;var o=n(0),i=n(4),a={};a[i.ErrorCode.TokenExpired]="The access token supplied is expired.",a[i.ErrorCode.Throttled]="You have exceeded your quota.",a[i.ErrorCode.ServerError]="An error occurred when calling the server to process the text.",a[i.ErrorCode.InvalidSubdomain]="The subdomain supplied is invalid.";var s,d,u,l,c=!1,m=!1;t.launchAsync=function(e,t,n,s){return c?Promise.reject("Immersive Reader is already launching"):new Promise((function(d,u){if(e)if(n)if(n.chunks)if(n.chunks.length){c=!0;var l=Date.now();(s=r({uiZIndex:1e3,timeout:15e3,useWebview:!1,allowFullscreen:!0,hideExitButton:!1,cookiePolicy:o.CookiePolicy.Disable},s)).uiZIndex&&"number"==typeof s.uiZIndex||(s.uiZIndex=1e3);var m=s.parent?s.parent:document.body,p=null,f=document.createElement("div"),h=s.useWebview?document.createElement("webview"):document.createElement("iframe");h.allow="autoplay",h.title="Immersive Reader Frame",h.setAttribute("aria-modal","true");var v=document.createElement("style");v.innerHTML="body{height:100%;overflow:hidden;}";var g=function(){p&&(window.clearTimeout(p),p=null)},y=function(){m.contains(f)&&m.removeChild(f),window.removeEventListener("message",w),g(),v.parentNode&&v.parentNode.removeChild(v)},b=function(){if(y(),s.onExit)try{s.onExit()}catch(e){}};y();var w=function(r){if(r&&r.data&&"string"==typeof r.data)if("ImmersiveReader-ReadyForContent"===r.data){g();var o={cogSvcsAccessToken:e,cogSvcsSubdomain:t,request:n,launchToPostMessageSentDurationInMs:Date.now()-l,disableFirstRun:s.disableFirstRun,readAloudOptions:s.readAloudOptions,translationOptions:s.translationOptions,displayOptions:s.displayOptions,sendPreferences:!!s.onPreferencesChanged,preferences:s.preferences};h.contentWindow.postMessage(JSON.stringify({messageType:"Content",messageValue:o}),"*")}else if("ImmersiveReader-Exit"===r.data)b();else if(r.data.startsWith("ImmersiveReader-LaunchResponse:")){var m=null,p=null,v=null;try{v=JSON.parse(r.data.substring("ImmersiveReader-LaunchResponse:".length))}catch(e){}if(v&&v.success){var y={command:"PlayState",parameters:"Play"},w={command:"PlayState",parameters:"Pause"};m={container:f,sessionId:v.sessionId,charactersProcessed:v.meteredContentSize,postLaunchOperations:{pause:function(){h.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:w}),"*")},play:function(){h.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:y}),"*")}}}}else p=v&&!v.success?{code:v.errorCode,message:a[v.errorCode],sessionId:v.sessionId}:{code:i.ErrorCode.ServerError,message:a[i.ErrorCode.ServerError]};c=!1,m?(g(),d(m)):p&&(b(),u(p))}else if(r.data.startsWith("ImmersiveReader-Preferences:")&&s.onPreferencesChanged&&"function"==typeof s.onPreferencesChanged)try{s.onPreferencesChanged(r.data.substring("ImmersiveReader-Preferences:".length))}catch(e){}};window.addEventListener("message",w),p=window.setTimeout((function(){y(),c=!1,u({code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+s.timeout+" ms)"})}),s.timeout),s.allowFullscreen&&h.setAttribute("allowfullscreen",""),h.style.cssText=s.parent?"position: static; width: 100%; height: 100%; left: 0; top: 0; border-width: 0":"position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0",s.useWebview&&h.addEventListener("loadstop",(function(){h.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")}));var k=(s.customDomain?s.customDomain:"https://learningtools.onenote.com/learningtoolsapp/cognitive/")+"reader?exitCallback=ImmersiveReader-Exit&sdkPlatform=js&sdkVersion=0.5.4";k+="&cookiePolicy="+(s.cookiePolicy===o.CookiePolicy.Enable?"enable":"disable"),s.hideExitButton&&(k+="&hideExitButton=true"),s.uiLang&&(k+="&omkt="+s.uiLang),h.src=k,f.style.cssText=s.parent?"position: relative; width: 100%; height: 100%; border-width: 0; -webkit-perspective: 1px; z-index: "+s.uiZIndex+"; background: white; overflow: hidden":"position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+s.uiZIndex+"; background: white; overflow: hidden",f.appendChild(h),m.appendChild(f),document.head.appendChild(v)}else u({code:i.ErrorCode.BadArgument,message:"Chunks must not be empty"});else u({code:i.ErrorCode.BadArgument,message:"Chunks must not be null"});else u({code:i.ErrorCode.BadArgument,message:"Content must not be null"});else u({code:i.ErrorCode.BadArgument,message:"Token must not be null"})}))},t.launchWithoutContentAsync=function(e){if(c)return Promise.reject("Immersive Reader is already launching");c=!0;var t=Date.now();(e=r({uiZIndex:1e3,timeout:15e3,useWebview:!1,allowFullscreen:!0,hideExitButton:!1,cookiePolicy:o.CookiePolicy.Disable},e)).uiZIndex&&"number"==typeof e.uiZIndex||(e.uiZIndex=1e3);var n=null,p=document.createElement("div"),f=e.useWebview?document.createElement("webview"):document.createElement("iframe");f.allow="autoplay",f.title="Immersive Reader Frame",f.setAttribute("aria-modal","true");var h=document.createElement("style");h.innerHTML="body{height:100%;overflow:hidden;}";var v=function(){n&&(window.clearTimeout(n),n=null)},g=function(){document.body.contains(p)&&document.body.removeChild(p),window.removeEventListener("message",w),c=!1,m=!1,s=null,v(),h.parentNode&&h.parentNode.removeChild(h)},y=function(){if(g(),e.onExit)try{e.onExit()}catch(e){}},b=function(){if(m&&s){var n={apiResponse:s,launchToPostMessageSentDurationInMs:Date.now()-t,disableFirstRun:e.disableFirstRun,readAloudOptions:e.readAloudOptions,translationOptions:e.translationOptions,displayOptions:e.displayOptions,sendPreferences:!!e.onPreferencesChanged,preferences:e.preferences};f.contentWindow.postMessage(JSON.stringify({messageType:"ContentModelWithOptions",messageValue:n}),"*")}},w=function(t){if(t&&t.data&&"string"==typeof t.data)if("ImmersiveReader-ReadyForContent"===t.data)v(),m=!0,b();else if("ImmersiveReader-Exit"===t.data)y();else if(t.data.startsWith("ImmersiveReader-LaunchResponse:")){var n=null,r=null,o=null;try{o=JSON.parse(t.data.substring("ImmersiveReader-LaunchResponse:".length))}catch(e){}if(o&&o.success){var s={command:"PlayState",parameters:"Play"},l={command:"PlayState",parameters:"Pause"};n={container:p,sessionId:o.sessionId,charactersProcessed:o.meteredContentSize,postLaunchOperations:{pause:function(){f.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:l}),"*")},play:function(){f.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:s}),"*")}}}}else r=o&&!o.success?{code:o.errorCode,message:a[o.errorCode],sessionId:o.sessionId}:{code:i.ErrorCode.ServerError,message:a[i.ErrorCode.ServerError]};c=!1,n?(v(),d&&d(n)):r&&(y(),u&&u(r))}else if(t.data.startsWith("ImmersiveReader-Preferences:")&&e.onPreferencesChanged&&"function"==typeof e.onPreferencesChanged)try{e.onPreferencesChanged(t.data.substring("ImmersiveReader-Preferences:".length))}catch(e){}};g(),window.addEventListener("message",w),n=window.setTimeout((function(){g(),c=!1;var t={code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+e.timeout+" ms)"};u?u(t):l=t}),e.timeout),e.allowFullscreen&&f.setAttribute("allowfullscreen",""),f.style.cssText="position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0",e.useWebview&&f.addEventListener("loadstop",(function(){f.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")}));var k="https://learningtools.onenote.com/learningtoolsapp/cognitive/reader?exitCallback=ImmersiveReader-Exit&skipearlygcm=true&sdkPlatform=js&sdkVersion=0.5.4";k+="&cookiePolicy="+(e.cookiePolicy===o.CookiePolicy.Enable?"enable":"disable"),e.hideExitButton&&(k+="&hideExitButton=true"),e.uiLang&&(k+="&omkt="+e.uiLang),f.src=k,p.style.cssText="position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+e.uiZIndex+"; background: white; overflow: hidden",p.appendChild(f),document.body.appendChild(p),document.head.appendChild(h);var C={cancelAndCloseReader:y,provideApiResponse:function(e){return e?200!==e.status?Promise.reject({code:i.ErrorCode.BadArgument,message:"Unsuccessful Api Response"}):e.data?e.meta?(s=e,b(),new Promise((function(e,t){d=e,u=t,l&&(t(l),l=null)}))):Promise.reject({code:i.ErrorCode.BadArgument,message:"No meta in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No data in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No Api Response"})}};return new Promise((function(e,t){e(C)}))},t.resetLoadingForTest=function(){c=!1},t.close=function(){window.postMessage("ImmersiveReader-Exit","*")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0,function(e){e.BadArgument="BadArgument",e.Timeout="Timeout",e.TokenExpired="TokenExpired",e.Throttled="Throttled",e.ServerError="ServerError",e.InvalidSubdomain="InvalidSubdomain"}(t.ErrorCode||(t.ErrorCode={}))}])}},[[1229,0]]]);
//# sourceMappingURL=immersiveReader.min.js.map