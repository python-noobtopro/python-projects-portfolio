var WRd="S",XRd="OSC:FEQ";function YRd(a,b,c){c=new Si(2,1,0,function(){b()},92,c,!1,0);a.Vb(c)}function eSd(a,b){a.Ka(WRd,b)}function fSd(a,b){var c=new Ko;c.commentId="";a&&(c.commentId=a);return new Io(b,c)}function $6(a,b){for(var c=0;c<a.JO.Qa();++c)Array.enqueue(a.JO.K(c).lAa,b)}
function gSd(a){a.Qec||u(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");var b;b=33;a.toe&&(b|=2);a.HBe&&(b|=8);a.MFe&&(b|=16);a.yye&&(b|=4);a.Pmc&&(b|=64);a.zAe&&(b|=128);return b}
function a7(a,b){function c(){if(F.mg)u(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(var b=0;b<a.JO.Qa();++b)for(var c=a.JO.K(b);0<c.lAa.length;){var f=Array.dequeue(c.lAa);if(JFa.isInstanceOfType(f)){var g=c.g2;g(f)}else Io.isInstanceOfType(f)&&(g=c.g2,g(f.type,f.payload))}}b?c():a.$ud||(a.$ud=!0,YRd(a.ob,function(){c();a.$ud=!1},XRd))}
function c7(a,b,c,d){if(!b)throw u(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");var e=Ae().toString();a=a.bxe.Aa();d=new CEa(b,a,d,e,!1);d.commentId=c;u(42796192,327,50,"History Record Generated. [RecordType: {0}]",b);return d}function hSd(a){if(!a)return null;var b=new (Wb.$$(String,String))(null);a.zg(function(a,d){b.ga(a,d);return!0});return b}
w.Ca.Ys.cva.prototype.FWb=q(-1712423107,function(a){this.T5.FWb(a);return a});hX.prototype.FWb=q(-1811154939,function(a){return this.w7a=a});QQb.prototype.Obc=q(-1335946621,function(a){this.Zqa&&this.a3.Kc(a)&&this.Zqa.setSelectedTaskPane(a,2)});Jo.prototype.Uva=q(-784673402,function(a,b){var c=new Ko;c.changes=[];var d;c.contextDetails=(d=new GFa(b),d.nextPopulatedContextDetails=a,d);$6(this,new Io(10,c));a7(this,!1)});Jo.prototype.myb=q(-1236012336,function(a){$6(this,fSd(a,7));a7(this,!1)});
Jo.prototype.GB=q(-38167692,function(a){$6(this,fSd(a,6));a7(this,!1)});gFa.prototype.xCa=q(1863290615,function(a){this.pxg=a;for(var b=this.bSa,c=b.length,d=0;d<c;++d)b[d].xCa(a);return a});hFa.prototype.xCa=q(916470403,function(a){return this.Zsa=a});iFa.prototype.xCa=q(451643603,function(a){return this.Zsa=a});kFa.prototype.xCa=q(237844459,function(a){return this.Zsa=a});gFa.prototype.ACa=q(944880242,function(a){this.Fxg=a;for(var b=this.bSa,c=b.length,d=0;d<c;++d)b[d].ACa(a);return a});
hFa.prototype.ACa=q(-445670810,function(a){return this.ata=a});iFa.prototype.ACa=q(1124036118,function(a){return this.ata=a});kFa.prototype.ACa=q(1824118270,function(a){return this.ata=a});function nSd(a){a.Kqa&&(dSd(a.Kqa,"SlideBorderHighlighted"),dSd(a.Kqa,"CommentsHighlightAnimation"))}
function oSd(a,b,c){if(!b)return null;if(WP(b)){var d=OP(0,b);if(!d)return null;if(xFb(d)===c)return d}window.$$as($M,b)?d=!0:(d=OP(0,b),d=!!d&&VO(d));if(d)for(b=aH(b),d=b.Jb(1);d;d=b.Rf(1))if(d=oSd(a,d,c))return d;return null}function l1d(a){if(null===a)throw Error.argumentNull("node");var b=a.ta(String,uZa,"");a=a.ta(String,NYa,"");return b?b:a}function q1d(a){if(null===a)throw Error.argumentNull("node");return a.ta(Boolean,jXa,!1)}
function wSd(a){var b;return lN(a,MWa,(b=new Yda,b.X=0,b.Y=0,b),!0)}function xSd(a,b,c){eSd(b,function(){a.bbb.K(c)[0].Ayb=!0})}function ySd(a,b){var c=new JFa;c.eventType=3;c.viewContainerVisibilityState=b;for(b=0;b<a.JO.Qa();++b)Array.enqueue(a.JO.K(b).lAa,c);a7(a,!0)}function zSd(a,b){var c=new Ko;c.modelCapabilityFlags=a;c.richTextCapabilityFlags=b;return new Io(12,c)}
function ASd(a,b,c,d,e){var f=new Ko;f.numberOfComments=a;f.numberOfThreads=b;var g;f.contextDetails=(g=new GFa(c),g.nextPopulatedContextDetails=d,g);f.contextDrafts=e;f.rehydrationDrafts=null;return new Io(0,f)}function BSd(a,b,c){var d=new Ko;d.comments=a;d.numberOfThreads=b;d.tasks=c;return new Io(2,d)}function CSd(a,b){var c=new IFa;c.comments=a;c.tasks=b;return new Io(1,c)}
function DSd(a){a.uv||(u(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),a.Kke());return a.uv}function ESd(a){return new Promise(function(b,c){a.Qec?b(gSd(a)):a.pke().then(function(){b(gSd(a))}).catch(function(a){c(a)})})}function FSd(a,b){var c={};c.insert=a;c.attributes=b;return c}function GSd(){var a=new Eo(L.Va("PresenceUserId")||"",L.Va("PresenceProvider")||"",F.l0||"","");a.IsCurrentUser=!0;return a}
function Fzc(a,b,c,d,e){if(2!==b&&3!==b)return u(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;b=c7(a.cya,b,d,e);b.assignee=a.Nkc.UHa(c);return b}function HSd(a,b){var c=a;if(a&&b){var d,e,f;(f=b.ng(a,e={val:d},null),d=e.val,f)?c=d.CommentId:(u(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",a),c=a)}return c}
function ISd(a,b,c){if(1!==b.type)throw Error.argument("createRecordTemplate");var d="Synthesized-"+b.recordId+"-"+a.Ufd;a.Ufd++;var e;return e=new CEa(c,b.user,b.time,d,!1),e.commentId=b.commentId,e}function JSd(a){return A(a.ph.schedule.startDate)&&A(a.ph.schedule.endDate)}function KSd(a,b){for(var c=-1,d=0;d<a.ph.assignees.length;d++)if(a.Leb.Sa(a.ph.assignees[d],b)){c=d;break}return c}
function LSd(a){if(!a.Mne)return u(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise(function(a,c){c(EU(-2130915313))});if(a.Pjd)return u(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(function(){});a.Ylc||(L.ia("DynamicBundlesIsEnabled")?a.Ylc=window.appResourceLoader.loadChunk("sharedComments"):a.Ylc=a.Rp.Ni("sharedComments"));return a.Ylc.then(function(){a.Pjd||(a.LZa&&a.LZa.pb(function(a){a.Jn("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane",null)}),window.sharedComments.instantiate(a.$pe,a.DEe,a.fAe,a.JFe,a.wxe,a.oue,a.uv));a.Pjd=!0})}function MSd(a){a?(a=hSd(a.extensions),a=new zEa(a)):a=null;return a}
function $Sd(a){if(a){a=Sd(a);if(-1===a.indexOf("Selected")&&-1!==a.indexOf("BlobObject")&&-1===a.indexOf("UnsupportedObjectText"))return 2;if(-1===a.indexOf("Selected")&&(-1!==a.indexOf("NormalTextRun")||-1!==a.indexOf("EOP")||-1!==a.indexOf("UnsupportedObjectText")||-1!==a.indexOf("CommentStart")||-1!==a.indexOf("SpellingError")||-1!==a.indexOf("ContextualSpellingAndGrammarError")||-1!==a.indexOf("AdvancedProofingIssue")||-1!==a.indexOf("SpellingErrorSuperscript")||-1!==a.indexOf("FindHit")||-1!==
a.indexOf("LastReplacedFindHit")||-1!==a.indexOf("MergeHighlight")||-1!==a.indexOf("BreakObjectText")))return 1;if(-1!==a.indexOf("WACImageContainer"))return 3}return 0}function aTd(a,b){a=D7b(a);b=D7b(b);return a<=b?(b+.05)/(a+.05):(a+.05)/(b+.05)}function dTd(a){return a===Ho.nc?0:a===Ho.ikg?1:a===Ho.vMf?2:a===Ho.Metadata?3:null}Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};M.S4b=function(){};M.S4b.prototype={previous:0,next:1};
M.S4b.registerEnum("PowerPointWebEditor.CommentSelectDirection",!1);M.fSc=function(){};M.fSc.prototype={findNextComment:0,findPreviousComment:1,findNextActiveComment:2,findPreviousActiveComment:3};M.fSc.registerEnum("PowerPointWebEditor.FindCommentRequestType",!1);function e_d(){}e_d.registerInterface("PowerPointWebEditor.ICommentContextDetailsUpdateHelper");function f_d(){}f_d.registerInterface("PowerPointWebEditor.ICommentEditor");function g_d(){}g_d.registerInterface("PowerPointWebEditor.IFindCommentLogic");
function h_d(){}h_d.registerInterface("PowerPointWebEditor.IPptOfficeSharedCommentAPI");function i_d(){}i_d.registerInterface("PowerPointWebEditor.IRTEFocusActionHelper");
function k0d(a,b,c,d,e,f,g,h,k,l,m){this.qWe=[];if(!l)throw Error.argumentNull("appSettingsManager");if(!m)throw Error.argumentNull("viewElementEventNotifier");this.zd=b;this.Jxc=this.p3a=!1;this.vPb=a;this.gWe=c;this.Vza=this.Zza=null;this.Bn=d;this.pa=e;this.hY=f;this.Laa=g;this.h2=h;this.nKe=k;this.Fc=l;this.oK=m;this.h2.uBb(this.nKe)}
k0d.prototype={p3a:!1,Jxc:!1,vPb:!1,zd:null,gWe:null,h2:null,nKe:null,Fc:null,oK:null,Zza:null,Vza:null,Bn:null,pa:null,hY:null,Laa:null,I0b:null,Gy:function(){return this.Fc.ia("CommentTextAnchoringUIEnabled")},v2b:!1,G3c:function(a){this.vPb=a}};function l0d(a){return a.I0b&&a.I0b.XY?a.I0b.XY.wt:null}function m0d(a,b){var c;b=(c=new Hrb,c.h5a=0,c.qh=0,c.oca=b,c.g7a=a.h2.MLa()?a.h2.MLa().oca:null,c);a.h2.oCb(b)}
function n0d(a,b){var c=[],d=a.Vza;b&&!d&&(d=w7(a));var e=w7(a)?w7(a):cR(a.pa);e||b&&d||m0d(a,c);var f=null,g=[],h=!1;if(x7(b)&&d&&0<dP(d).length&&(!l0d(a)||b.commentId!==l0d(a).commentId)){var k=o0d(b,d);if(k&&k.Vf()&&(h=Lm("{"+b.commentId+"}{1}"),c.push(new p0d(k,h,1)),h=!0,k=a.Laa.hl(d))){g.push(k);var l=k.Md();l&&JO(l)&&(f=l)}}if(a.v2b||e&&0<dP(e).length)if(lT(a.pa),d=y7(a.Bn))for(var m=d.length,n=0;n<m;++n){var r=d[n];if(!(!x7(r)||!a.v2b&&r.anchorShape!==e.get_shapeId()||h&&r.commentId===b.commentId)&&
(l=a.v2b?z7(a,r):e)&&(k=o0d(r,l))&&k.Vf()){var t=5,v=!!l0d(a)&&r.commentId===l0d(a).commentId;v&&(t=0);r=Lm("{"+r.commentId+"}{1}");c.push(new p0d(k,r,t));if(k=a.Laa.hl(l))g.push(k),l=k.Md(),!f&&l&&v&&JO(l)&&(f=l)}}b=a.qWe;h=b.length;for(d=0;d<h;++d)!(k=b[d])||Array.contains(g,k)||k.Md()&&JO(k.Md())||(k.sGc=!1,k.XB()||!k.Hw()||k.ZX()||hHb(k));b=null;h=g.length;for(d=0;d<h;++d)k=g[d],(l=k.Md())&&JO(l)?(b||(b=l),f||e!==l||(f=l)):(k.sGc=!0,k.Hw()||(R(554264394,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),
lHb(k,!1)));f||MQ(a.pa)||!b||(f=b);a.qWe=g;e=new eJb(f);a.oK.qa.Ha("CVOSC",e,null);m0d(a,c)}function z7(a,b){if(!b)return null;try{return q0d(a.Laa,b)}catch(c){return R(572663241,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",c),null}}function r0d(a){a.Vza&&(a.Gy()||a.Vza!==w7(a))&&t0d(a,a.Vza,3,!1,!1);a.Jxc&&!a.p3a&&u0d(a,3);n0d(a,null)}
function v0d(a,b,c,d,e,f){var g;if(g=a.vPb&&b){if(!(e=!e))a:{if(e=y7(a.Bn)){g=e.length;for(var h=0;h<g;++h)if(b.commentId===e[h].commentId){e=!0;break a}}e=!1}g=e}if(g){g=z7(a,b);if(a.Gy()||w7(a)!==g||!g)(e=(!a.Gy()||w7(a)!==g)&&!!w7(a))&&sT(a.pa,w7(a)),w0d(a),g?(h=a.Gy()&&x7(b),a.Vza===g?x0d(a,b,g)?t0d(a,g,4,h,a.Gy()&&h&&e):a.Zza=g:x0d(a,b,g)?t0d(a,g,0,h,d&&(!a.Gy()||e)):a.Zza=g,c=!!c&&c===b.commentId,(h||c)&&f||(b=String.format(ResourceStrings.L_CommentAnchoringShapeSelection,b.authorName,b.dt.toDateString(),
b.dt.toLocaleTimeString()),iyd(a.hY,g,b))):(u0d(a,0),a.zd&&a.zd.ie()&&a.zd.ie().ii()&&(b=(a.zd.ie().ii().Sd+1).toString(),b=String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,b,a.zd.ie().ii().lD()),$5(a.hY,b))),!f&&e&&a.pa.Hl(w7(a),!0,!1);n0d(a,null)}}function x0d(a,b,c){if(!a.Gy()||!x7(b))return!0;a=y7(a.Bn);return Yn(a,function(a){return!x7(a)&&a.anchorShape===c.get_shapeId()})}function w0d(a){a.vPb&&(a.p3a?u0d(a,2):w7(a)&&t0d(a,w7(a),2,!1,!1),n0d(a,null))}
function u0d(a,b){if(a.zd&&a.zd.ie())switch(b){case 0:a.zd.ie().xua();a.p3a=!0;break;case 2:nSd(a.zd.ie());a.p3a=!1;break;case 1:a.zd.ie().xua();a.Jxc=!0;break;case 3:nSd(a.zd.ie()),a.Jxc=!1}}function t0d(a,b,c,d,e){var f=WU(a.gWe,b);if(f)switch(c){case 0:f.Jka(a.Gy()&&d,e);a.Zza=b;break;case 1:f.bda();a.Vza=b;break;case 2:f.Ri();a.Zza=null;break;case 3:a.Gy()&&w7(a)&&w7(a)===b&&l0d(a)&&x0d(a,l0d(a),b)?f.Jka(x7(l0d(a)),e):f.Ri();a.Vza=null;break;case 4:c=a.Gy()&&d,f.Fg.E6c(c?0:2,!1),a.Zza=b}}
function w7(a){return a.Zza&&a.Zza.oc()?a.Zza:null}
function A7(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y){this.beginDraftingAsync=this.BeginDraftingAsync;this.commit=this.Commit;this.endCommentSession=this.EndCommentSession;this.deleteComment=this.DeleteComment;this.selectComment=this.SelectComment;this.highlightComment=this.HighlightComment;this.setThreadResolvedState=this.SetThreadResolvedState;this.selectFirstThreadInNextCommentContext=this.SelectFirstThreadInNextCommentContext;this.selectLastThreadInPreviousCommentContext=this.SelectLastThreadInPreviousCommentContext;
this.registerForCommentEvents=this.RegisterForCommentEvents;this.unregisterForCommentEvents=this.UnregisterForCommentEvents;this.registerForAction=this.RegisterForAction;this.unregisterForAction=this.UnregisterForAction;this.loadThreads=this.LoadThreads;this.presentLinkToComment=this.PresentLinkToComment;this.checkAtMentionCapability=this.CheckAtMentionCapability;this.resolveSupported=this.ResolveSupported;this.Xa=a;this.Wpa=b;this.jsc=c;this.AIe=d;this.ob=e;this.Fc=f;this.sYe=g;this.Hjb=h;this.xia=
k;this.qPb=l;this.uPb=m;this.ssc=n;this.I6=r;this.YTe=t;this.iKe=v;this.fa=x;this.za=y}function y0d(a,b){for(var c=0;c<a.length;c++)if(a[c].commentId===b)return c;return-1}function z0d(){if($H("CommentsFpsIsEnabled"))try{var a=kc(B(),Zc);a&&a.pb(function(a){a.Jn("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS",null)})}catch(b){R(562698251,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",b)}}
function A0d(a){if($H("CommentsTasksFpsIsEnabled")&&a&&a.Task)try{var b=kc(B(),Zc);b&&b.pb(function(a){a.Jn("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS",null)})}catch(c){R(560214749,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",c)}}A7.prototype={Xa:null,Wpa:null,jsc:null,AIe:null,ob:null,Fc:null,sYe:null,Hjb:null,qPb:null,uPb:null,iKe:null,fa:null,za:null,ssc:!1,YTe:!1,I6:!1,Cvc:!1,xia:null};
function G0d(a,b,c){if("temp-id"===b)throw EU(-2130915327);c.commentBody&&(a.Fc.ia(S(896))?H0d(a,b,c,!0):YRd(a.ob,function(){H0d(a,b,c,!1)},"GenericCommentsTask"))}
function H0d(a,b,c,d){for(var e=Array.clone(E0d(a.Xa)),f=null,g=e.length,h=0;h<g;++h){var k=e[h];if(k.commentId===b){f=k;break}}if(!f)throw R(41497052,805,10,"Comment ID not found, UI and model in a mismatched state."),EU(-2130915323);(g=F.l0)&&0<g.length&&g!==f.author.DisplayName&&R(40990366,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",F.XVa||F.oN);g=new Date;f=I0d(f.commentBody,null).Vab;c=I0d(c.commentBody,g);g=a.Wpa;h=c.Vab;k=c.qXc;if(J0d(g)){var l=B7(g,b);
if(l){var m=g.Cb.Ue(15,0);try{m.Jc(l);K0d(l);var n=window.$$as(OM,l);n&&(J(n,QWa,h),TT(n,iYa,k))}finally{m&&m.dispose()}R(523845857,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",b)}else R(523845858,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",b);b=g.A6;b.lsd+=1}else R(523845856,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable");d||f!==c.Vab||(d=a.jsc,b=Array.clone(F0d(a.Xa)),$6(d,BSd(e,a.Xa.bOa,b)),a7(d,!1))}
function L0d(a,b,c,d){var e=I0d(b,new Date),f="";a.I6&&(f=c.commentId?c.commentId:Ae().toString());var g=null;if(!A(d))a:{var h=a.sYe,k=f;if(d=d.Task)try{var l=I0d(b,new Date).Vab,m;if(h.Duc){var n,r=(n=new uea,n.Asignees=[],n),t=h.Dxc,v=!d.taskId;if(!d)throw u(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(v&&!k)throw u(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");var h=[],x=new Date;if(v){var y=c7(t.cya,1,k,x);h.push(y)}y=
null;if(d.assigneeUpdate){if(!d.assigneeUpdate.assigneesToAdd||!d.assigneeUpdate.assigneesToRemove){var z="Invalid AssigneeUpdate.";u(536999254,327,15,"Invalid AssigneeUpdate.");throw Error.argument("Schedule",z);}for(var E=0;E<d.assigneeUpdate.assigneesToAdd.length;E++){var H=Fzc(t,2,d.assigneeUpdate.assigneesToAdd[E],k,x);H&&h.push(H)}for(E=0;E<d.assigneeUpdate.assigneesToRemove.length;E++)(H=Fzc(t,3,d.assigneeUpdate.assigneesToRemove[E],k,x))&&h.push(H)}else d.assignee&&(v||(E=c7(t.cya,4,k,x),
h.push(E)),H=c7(t.cya,2,k,x),y=t.Nkc.UHa(d.assignee),H.assignee=y,h.push(H));if(d.title){var O=c7(t.cya,9,k,x);O.title=d.title;h.push(O)}else if(v&&b){var Q=c7(t.cya,9,k,x),U=t.oqe,H=y;if(!b)throw u(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");var V;try{V=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0)}catch(Jb){throw u(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var E=O=b=
0,y=/\s+/g,Z=new Sys.StringBuilder,Y=V.ops,ca=Y.length;for(V=0;V<ca;++V){var la=Y[V];if(la.attributes&&la.attributes.atmention&&la.attributes.atmention.email&&H){var ra=la.attributes.atmention.email;0<ra.length&&(ra===H.UserId||ra===H.Email||ra===bFa(H.UserId))&&(O=b,E=O+la.insert.length)}var sa=la.insert.replace(y," ");b+=sa.length;Z.append(sa)}!E&&H&&u(592998805,327,10,"Assignee was not found in comment text",H.Provider);var ua=Z.toString().trimEnd();b=ua.length;var xa,Ea;if(255<b){var Sa,Wa,Z=
(255-(E-O))/2;0>O-Z?(Wa=gma(Gh(),ua,255-U.rLa.length),xa=ua.substring(0,Wa)+U.rLa,Ea="Trimmed End"):E+Z>b?(Sa=hma(Gh(),ua,b-255+U.rLa.length),xa=U.rLa+ua.substring(Sa,b),Ea="Trimmed Start"):(Sa=hma(Gh(),ua,O-Z+U.rLa.length),Wa=gma(Gh(),ua,E+Z-U.rLa.length),xa=U.rLa+ua.substring(Sa,Wa)+U.rLa,Ea="Trimmed Both")}else Ea="No Trim",xa=ua;u(592998804,327,50,Ea);Q.title=xa;h.push(Q)}if(d.schedule){if(d.schedule.startDate>d.schedule.endDate)throw z="Invalid schedule.",u(42796188,327,10,z),Error.argument("Schedule",
z);var Ga=c7(t.cya,5,k,x);Ga.schedule=d.schedule;h.push(Ga)}if(!A(d.completion)){var Va=d.completion;if(0>Va||100<Va)throw u(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");v||u(595198538,327,50,"Task progress change. [Progress: {0}]",Va);var ya=c7(t.cya,6,k,x);ya.completion=Va;h.push(ya)}if(!A(d.priority)){var jb=d.priority;if(0>jb||10<jb)throw u(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");var gb=c7(t.cya,10,k,x);gb.priority=
jb;h.push(gb)}for(var Ab=h.length,k=0;k<Ab;++k){var Eb=h[k];if(2===Eb.type)if(Eb.assignee){var rb,kb=(rb=new Dea,rb.DisplayName=Eb.assignee.DisplayName,rb.FullName=Eb.assignee.DisplayName,rb.UserId=Eb.assignee.UserId,rb.ProviderId=Eb.assignee.Provider,rb.Email=Eb.assignee.Email,rb);r.Asignees.push(kb)}else R(555103715,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null.");else 9===Eb.type&&(r.Title=Eb.title)}r.Asignees?(r.Title||(R(555103745,845,15,
"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),r.Title=l),m=r):(R(555103744,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),m=null)}else{var ib=new uea;if(d.assignee){var Pb=new Dea,Xa=d.assignee;Pb.DisplayName=Xa.Name;Pb.FullName=Xa.Name;Pb.UserId=Xa.UserPrincipalName;Pb.ProviderId="O365";Pb.Email=Xa.UserPrincipalName;ib.Asignees=[Pb]}ib.Title=d.title?d.title:l;m=ib}l=m;if(!l){g=null;break a}l.CompletionPercentage=d.completion?
d.completion:0;g=l;break a}catch(Jb){R(555103746,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",Jb)}g=null}Ab=M0d(a.Xa);(d=c.parentId?null:N0d(a.Xa))&&(Ab=O0d(a.Xa));l=a.Wpa;m=f;r=e.Vab;c=c.parentId;a=a.Xa;Eb=cR(a.pa);a.NIe=Eb?Eb:a.zd.ie().ii();P0d(l,m,r,c,Ab,a.NIe,e.qXc,g,d);return f?f:"temp-id"}
A7.prototype.OGf=function(a){if(!a)return new Promise(function(a,b){b(EU(-2130915327))});var b=dTd(a.sessionType);if(A(b))return new Promise(function(a,b){b(EU(-2130915317))});if(2===b&&"temp-id"===a.commentId)return new Promise(function(a,b){b(EU(-2130915324))});var c=this;return new Promise(function(d,e){YRd(c.ob,function(){var f=E0d(c.Xa),g=null,h=-1;R(593588952,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",b);try{switch(b){case 0:if(c.YTe)try{h=Gzc(c.Xa,!0)}catch(ra){R(51192584,801,
10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",ra),h=f.length}else h=f.length;g=new fWb(b,a,"");c.Cvc=!0;break;case 1:if(!a.threadId||!a.threadId.length)throw EU(-2130915324);a:{for(var k=a.threadId,l=!1,m=0;m<f.length;m++){if(l&&f[m].commentId!==k&&f[m].parentId!==k){h=m;break a}f[m].commentId===k&&(l=!0)}h=l?f.length:-1}if(-1===h)throw EU(-2130915323);if(c.Fc.fc("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var n=a.threadId,r;a:{k=!1;for(l=0;l<f.length;l++)if(f[l].commentId===
n&&(k=!0),k&&f[l].parentId===n){r=!0;break a}r=!1}var t=new T0d(c.uPb),v=y0d(f,n);if(-1!==v&&!r){var x=f[v],y=x.author?x.author.IsCurrentUser:!1;if(x&&x.commentBody&&!y){var z,E;var H=x.commentBody;if(""===H)E="";else{f=0;r="";try{for(var O=Sys.Serialization.JavaScriptSerializer.deserialize(H,!0).ops,Q=O.length,H=0;H<Q;++H){var U=O[H];if(U.attributes&&U.attributes.atmention){if(!f){var V=U.attributes.atmention.fullName,v="";if(V){var Z=V.split(" ");0<Z.length&&(v=Z[0])}r+=v}f+=1}else{var Y=U.insert?
U.insert:"";" "!==Y&&0<Y.length&&(f=0,r+=Y)}}}catch(ra){u(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}E=r}(z=0<E.length&&50>=E.split(" ").length?E:null)&&t.uPb.hv(n,z)}}}g=new fWb(b,a,a.threadId);break;case 2:if(!a.commentId||!a.commentId.length)throw EU(-2130915324);h=y0d(f,a.commentId);if(-1===h)throw EU(-2130915323);g=new fWb(b,a,a.commentId);break;case 3:h=y0d(f,a.threadId);g=new fWb(b,a,a.threadId);break;default:throw EU(-2130915322);
}if(!g)throw EU(-2130915322);var ca;var la=c.Xa;if(!la.Vsd)throw R(527501440,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),EU(-2130915320);if(la.Oi)R(527501441,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),ca=EU(-2130915319);else{if(null===g)throw Error.argumentNull("session");if(!g.tPb.length&&g.Ji)ca=EU(-2130915327);else{la.Oi=g;la.Uva(!0);g.Ji||(C7(la,0),D7(la)||U0d(la,g));if(D7(la)||!D7(la))E7(la),la.kKe=
!0,la.Qmb=la.Ia.kf().Nd===(D7(la)?"EditingCommentsPanelFocus":"EditingCommentsContainersFocus"),V0d(la.g3a,!0);la="";g.VJ&&(la=g.VJ.draftId);R(527501442,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",la);ca=null}}if(ca)throw ca;}catch(ra){e(ra);return}ca=new xFa;la=c.Fc.Va("UserName");g=c.Fc.Va(S(387));n=c.Fc.Va(S(388));t=$H("PPTPlumbEmailThroughCG")?bFa(g||""):"";ca.author=new jma(g,n,la,t,!0);ca.insertIndex=h;ca.authorName=la;ca.authorIdentity=new String;d(ca)},"GenericCommentsTask")})};
A7.prototype.BeginDraftingAsync=A7.prototype.OGf;
A7.prototype.Bta=function(a,b,c){if(!this.Xa.Oi)throw R(594358352,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.Xa.lKe),EU(-2130915320);var d=this.Xa.Oi.VJ;if(!d)throw R(594358350,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),EU(-2130915320);var e=dTd(d.sessionType);if(A(e))throw EU(-2130915317);if(a!==d.draftId)throw EU(-2130915327);var f=this.I6?Ae().toString().toUpperCase():"";W0d(this.Xa);switch(e){case 0:R(593830418,
805,50,"CommentAPI::Commit - Create Comment {0}",f);a={};d=this.Xa;if(d.oY){var g=0,e="";if(I_(d)){var h=cR(d.pa);h&&(g=S0d(d,0,LP(h).y).y);if(h=y7(d.Bn))for(var k=h.length,l=0;l<k;++l){var m=h[l];!m.commentId||Hzc(d,m)===g&&(e=m.commentId)}}var n,g=(n=new F7,n.contentId=f,n.containerContentType=0,n.anchorTop=g,n.anchorLeft=0,n);I_(d)?d.Eu.updateDraftingAndPosition(g,!1,e):d.Eu.updateDrafting(g,!1);d.Eu.selectContainer(f,!0)}a.commentId=f;this.Cvc=!1;this.Xa.Dvc=f;A0d(c);z0d();return L0d(this,b,a,
c);case 1:return R(593830416,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",d.threadId,f),a={},a.parentId=d.threadId,a.commentId=f,A0d(c),z0d(),L0d(this,b,a,c);case 2:return R(593830414,805,50,"CommentAPI::Commit - Edit comment {0}",d.commentId),c={},c.commentBody=b,G0d(this,d.commentId,c),a;case 3:R(593830412,805,50,"CommentAPI::Commit - Update Metadata {0}",d.threadId);b=d.threadId;if(A(c.Resolve))throw EU(-2130915327);n=(f=c.Resolve.isResolved)?100:0;A(c.Task)||(n=c.Task.completion);X0d(this.Wpa,
b,f?1:0,n);f&&(this.Xa.irc=!0);return d.threadId;default:throw EU(-2130915322);}};A7.prototype.Commit=A7.prototype.Bta;A7.prototype.rFa=function(a){R(593371615,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",a);this.Xa.rFa(a,this.Cvc?9:1);this.Cvc=!1};A7.prototype.EndCommentSession=A7.prototype.rFa;A7.prototype.QQc=function(a){if("temp-id"===a)throw EU(-2130915327);R(593830410,805,50,"CommentAPI::DeleteComment - {0}",a);this.Wpa.QQc(a)};A7.prototype.DeleteComment=A7.prototype.QQc;
A7.prototype.GB=function(a){"temp-id"!==a&&G7(this.Xa,a,0,!1)};A7.prototype.SelectComment=A7.prototype.GB;A7.prototype.myb=function(a){if("temp-id"!==a){var b=this.Xa;b.k8a(Y0d(b,a),0)}};A7.prototype.HighlightComment=A7.prototype.myb;A7.prototype.hng=function(a,b){X0d(this.Wpa,a,b?1:0,b?100:0);b&&Z0d(this.Xa,a)};A7.prototype.SetThreadResolvedState=A7.prototype.hng;A7.prototype.Xlg=function(){$0d(this.Xa)};A7.prototype.SelectFirstThreadInNextCommentContext=A7.prototype.Xlg;A7.prototype.Ylg=function(){a1d(this.Xa)};
A7.prototype.SelectLastThreadInPreviousCommentContext=A7.prototype.Ylg;A7.prototype.jfg=function(a){if(a=b1d(this.Wpa,a)){a=JSON.stringify({sId:a.Pc(),cId:a.Be()});var b={};b.nav=d9b(a);b.mode="copy";R(557396323,805,50,"PresentLinkToComment: nav:{0}",a);this.fa.jb(981334692,2,b,null)}else R(557396322,805,50,"PresentLinkToComment failed")};A7.prototype.PresentLinkToComment=A7.prototype.jfg;
A7.prototype.pjg=function(a){var b=this;ESd(this.iKe).then(function(c){var d=b.jsc,e=E0d(b.Xa),f=b.Xa.bOa,g=b.Xa.r6(),h=F0d(b.Xa),k=b.Hjb.y6a,l=new tFa(a);c&&Array.enqueue(l.lAa,zSd(c,d.dxg));c=e?e.length:0;Array.enqueue(l.lAa,ASd(c,f,g,k,null));c&&Array.enqueue(l.lAa,CSd(e,h));d.JO.ga(l);a7(d,!1)})};A7.prototype.RegisterForCommentEvents=A7.prototype.pjg;A7.prototype.msg=function(a){uFa(this.jsc,a)};A7.prototype.UnregisterForCommentEvents=A7.prototype.msg;
A7.prototype.ojg=function(a,b){this.AIe.WS(a,b);this.Xa.Fb.Tf(!1)};A7.prototype.RegisterForAction=A7.prototype.ojg;A7.prototype.lsg=function(){};A7.prototype.UnregisterForAction=A7.prototype.lsg;A7.prototype.d0f=function(){R(40490383,805,10,"LoadThreads is not supported on WAC")};A7.prototype.LoadThreads=A7.prototype.d0f;A7.prototype.OHf=function(){var a=this;return new Promise(function(b){L.Nf(function(){a.xia?a.xia.atMentionsEnabledAsync().then(function(a){b(a);return null}):b(!1)})})};
A7.prototype.CheckAtMentionCapability=A7.prototype.OHf;A7.prototype.Ikg=function(){return this.ssc};A7.prototype.ResolveSupported=A7.prototype.Ikg;function c1d(a,b,c,d,e,f,g){this.qc=a;this.ra=b;this.wkb=c;this.OJ=d;this.rWe=e;this.Fb=f;this.ob=g;this.y6a=0}
c1d.prototype={qc:null,ra:null,wkb:null,OJ:null,rWe:null,Fb:null,ob:null,Uva:function(a,b){if(a||1!==this.y6a)if(2>this.qc.il())this.ra.Ma()&&d1d(this.ra.Ma())?e1d(this,5):e1d(this,1);else{var c=dI("UpdateNextPopulatedContextDetails",2),d=this;this.wkb.hSc(function(a,f,g){f1d(d,a,f,g,c,b)},c)}},y6a:0};function e1d(a,b){a.y6a=b;var c=1===a.Fb.Ic();a.rWe.Uva(b,c)}
function f1d(a,b,c,d,e,f){var g=1;if(a.ra.Ma()){var h=a.ra.Ma().Sd,k=!1,l=!1,m=!1;c&&b&&(b=b.Sd,b<h?k=!0:b===h?l=!0:(m=!0,d||(k=!0)));0<=f&&(f<h?k=!0:f===h?l=!0:m=!0);m?g=k||l?3:2:k?g=4:l&&(g=5)}e1d(a,g);e.Sj(!1,null);YRd(a.ob,function(){a.Fb.Tf(!1)},"GenericCommentsTask")}function g1d(a){this.hnf=Function.createDelegate(this,this.C4);this.Wpa=a;this.Cia=[];this.Frc=new gvd(1E3,this.hnf)}
g1d.prototype={C4:function(){var a=this.Cia;this.Cia=[];for(var b=0;b<a.length;b++){var c=a[b];this.Wpa.Azb(c.commentId,new pJ(c.pos.X,c.pos.Y))}},Frc:null,Wpa:null,Cia:null};function h1d(a,b,c,d,e,f,g,h,k,l,m,n,r,t){this.dispose=this.ha;this.Oza=d;this.Cb=e;this.ra=f;this.vha=g;this.TCg=h;this.Fc=k;this.Gd=l;this.pa=m;this.A6=n;this.rrd=r;this.ec=t;this.kC=a;this.qPb=c;this.psc=!b;j1d(this);this.bzb()}
h1d.prototype={Aaa:null,Oza:null,Cb:null,ra:null,vha:null,TCg:null,Gd:null,pa:null,kC:null,A6:null,ec:null,Fc:null,rrd:null,qPb:null,psc:!1,ha:function(){},sU:function(){return ye(this.Fc).UserName},f0a:function(){return ye(this.Fc)[S(387)]},U_a:function(){return ye(this.Fc)[S(388)]},Sga:function(){return this.Fc.ia("SlideResizePerfImprovementEnabled")},QQc:function(a){var b=this.A6;b.Erd+=1;if(J0d(this)){b=this.Cb.qe(15,0,null,null,!1);try{b.Jc(this.Aaa),k1d(this,a,this.Aaa),b.xe(869210402)}finally{b&&
b.dispose()}}else R(523845849,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")},PQc:function(a){var b=Date.now();if(a){var c=this.A6;c.Crd+=1}else c=this.A6,c.Ard+=1;var d=this.ra.Ed;if(d&&(c=d.Rj)){var e=this.Cb.qe(15,0,null,null,!1);try{e.Jc(d);for(var f=c.length,d=0;d<f;++d){var g=window.$$as($M,c[d]);if(g&&g.sS())for(var h=Xy(g).Jb(16),k=H7(g.sS()),l=k.length,m=0;m<l;++m){var n=k[m];(a?1===n.status:1)&&k1d(this,n.commentId,h)}else R(523845854,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",
g)}e.xe(a?2766426586:1737510757)}finally{e&&e.dispose()}R(523845855,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-b,a)}},Azb:function(a,b){if(J0d(this)){var c=B7(this,a);if(c){if(null===b)throw Error.argumentNull("pos");var d=this.Cb.Ue(15,0);try{d.Jc(c);K0d(c);var e,f=window.$$as(OM,c),g=(e=new Yda,e.X=b.x,e.Y=b.y,e);TT(f,MWa,g)}finally{d&&d.dispose()}R(523845888,805,50,"CommentManager::MoveComment - Moved comment {0}",a)}else R(523845889,805,
10,"CommentManager::MoveComment - Failed to find comment node {0}",a);b=this.A6;b.oKe.Kc(a)||(b.Myd+=1,b.oKe.ga(a))}else R(523845859,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")},bzb:function(){var a=0,b=0,c=this.ra.Ed;if(c&&(c=c.Rj)){for(var d=new (Ca.$$(String)),e=c.length,f=0;f<e;++f){var g=window.$$as(VN,c[f]);if(g&&g.sS())for(var g=H7(g.sS()),h=g.length,k=0;k<h;++k){var l=g[k];x7(l)?b+=1:l.textAnchoringInfo&&d.ga(l.commentId);a+=1}}this.A6.bzb(a,b,d)}}};
function b1d(a,b){a=a.ra.Ed;if(!a)return null;a=a.Rj;if(!a)return null;for(var c=a.length,d=0;d<c;++d){var e=a[d],f=window.$$as(VN,e);if(f)for(var f=H7(f.sS()),g=f.length,h=0;h<g;++h){var k=f[h];if(b===k.commentId)return e;if(k.Children)for(var k=k.Children,l=k.length,m=0;m<l;++m)if(b===k[m].commentId)return e}}return null}
function Q0d(a,b){if(!b)return[];var c=H7(b.sS());if(!c||a.Sga()&&!c.length){if(!c)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return c}c.sort(function(c,e){var f=oSd(a.ec,b,c.anchorShape),f=f?LP(f):new pJ(0,0),g=oSd(a.ec,b,e.anchorShape),g=g?LP(g):new pJ(0,0);f.y+=c.pos.Y;g.y+=e.pos.Y;f.x+=c.pos.X;g.x+=e.pos.X;var h=f.y-g.y;h||(h=f.x-g.x)||(h=c.dt-e.dt);return h});return c}
function I7(a){if(a){var b=l1d(a),c=new $ba,d=window.$$as(OM,a);if(d){c.dt=d.dNb();c.anchorShape=d.ta(Number,QYa,0);var e=wSd(d),f;c.pos=(f=new Kb,f.X=e.X,f.Y=e.Y,f);c.text=d.nb(String,QWa);c.authorName=d.ta(String,tPa,F.l0);c.userId=d.ta(String,FXa,"");c.providerId=d.ta(String,GXa,"")}c.status=m1d(a);c.commentId=b;a=window.$$as(OM,d);a.fb(vZa)?(b=new uea,b.Title=a.nb(String,vZa),b.StartDate=a.ta(Date,wZa,new Date),b.DueDate=a.ta(Date,xZa,new Date),b.CompletionPercentage=a.ta(Number,zZa,0),b.Asignees=
lN(a,yZa,[],!0),b.TaskHistoryRecords=lN(a,WZa,[],!1),a=b):a=null;c.taskInfo=a;d=window.$$as(OM,d);d.fb(o_a)&&d.fb(p_a)?(a=new vea,a.StartPos=d.nb(Number,o_a),a.EndPos=d.nb(Number,p_a),a.TextBodyHash=d.ta(Number,q_a,0),a.TextBodyLength=d.ta(Number,r_a,0),a.AnchoringShape=lN(d,n_a,new Xba,!0),d=a):d=null;c.textAnchoringInfo=d;return c}return null}function n1d(a,b){b=B7(a,b);if(!b)return null;var c=window.$$as(OM,b).ta(String,OYa,"");return c?B7(a,c):b}
function B7(a,b){a=Xy(a.Aaa);for(var c=oy(a);c;){var d=l1d(c);if(b===d)return c;c=WA(a)}return null}function J0d(a){return!!a.Aaa&&a.Aaa.oc()}function d1d(a){return a?(a=a.sS())?!!oy(aH(a)):!1:!1}function o1d(a,b,c){if(!a)return null;if(a=a.sS()){a=aH(a);for(var d=c?a.iz(-1):oy(a);d;){if(!(bsb(d)||b&&m1d(d)))return I7(d);d=c?a.qu(-1):WA(a)}}return null}function p1d(a){if(!a.Aaa)return!1;var b=Xy(a.Aaa);if(q1d(a.Aaa))return!0;for(a=oy(b);a;){if(q1d(a))return!0;a=WA(b)}return!1}
function j1d(a){var b=a.ra.Ma();a.Aaa=b?Xy(b).Jb(16):null}function H7(a){var b=[];if(!a||39!==a.get_type())return b;a=Xy(a);for(var c=oy(a);c;){if(40===c.get_type()){var d=window.$$as(OM,c).ta(String,OYa,""),c=I7(c);if(d)for(var e=b,f=e.length,g=0;g<f;++g){var h=e[g];h.commentId===d&&(h.Children||(h.Children=[]),h.Children.push(c))}else b.push(c)}c=WA(a)}return b}function y7(a){return H7(a.Aaa)}
function X0d(a,b,c,d){if(J0d(a)){var e=B7(a,b);if(e){var f=a.Cb.Ue(15,0);try{f.Jc(e);K0d(e);if(null===e)throw Error.argumentNull("comment");J(e,PYa,c);var g=window.$$as(OM,e);J(g,zZa,d);a.Fc.ia("TasksHistoryEnabled")&&r1d(e,a.sU(),a.f0a(),a.U_a())}finally{f&&f.dispose()}if(Izc()){d=I7(e);if(!d){R(524100423,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===c?(a=a.A6,a.ebb=d.taskInfo?a.ebb+1:a.ebb,a.KGa+=1):c||(a=a.A6,a.kcb=d.taskInfo?a.kcb+1:a.kcb)}else 1===c&&(a=a.A6,
a.KGa+=1);R(523845891,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",b,c)}else R(523845892,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",b)}else R(523845890,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}
function k1d(a,b,c){$H("IsDeselectShapeOnDeleteCommentEnabled")&&vT(a.pa)&&(R(538714369,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),xR(a.pa));for(var d=Xy(c),e=oy(d),f=new (Ca.$$(NG));e;){var g=l1d(e),h=window.$$as(OM,e).ta(String,OYa,"");b!==g&&b!==h||f.ga(e);e=WA(d)}if(f&&0<f.Qa()){K0d(c);for(c=f.$$lge();c.$$mn();)d=c.$$cu(),d=Xy(d),ez(d,39),dy(d);R(523845850,805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",b)}else R(523845851,
805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",b);a=a.A6;a.Grd+=1}
function s1d(a,b,c,d,e,f,g,h,k,l){C0d(a.qPb).then(function(m){t1d&&(R(523845844,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",a.psc,m),a.A6.yKe=m?1:2,t1d=!1);if(J0d(a)){var n=!1,r=0,t=0;e&&(n=!0,r=e.x,t=e.y);var v=a.Cb.Ue(15,0);try{var x=a.Aaa;v.Jc(x);var y=Xy(x),z=window.$$as(my,a.Oza.Gn(1074135127));K0d(z);if(null===z)throw Error.argumentNull("comment");J(z,NYa,"");if(null===z)throw Error.argumentNull("comment");J(z,uZa,b);var x=null,E=window.$$as(OM,z);if(E){J(E,
OWa,n);if(n){var H,O=(H=new Yda,H.X=r,H.Y=t,H);TT(E,MWa,O)}var Q,U=new Date;Q=(Date.UTC(U.getUTCFullYear(),U.getUTCMonth()+1,U.getUTCDate(),U.getUTCHours(),U.getUTCMinutes())-Date.UTC(U.getFullYear(),U.getMonth()+1,U.getDate(),U.getHours(),U.getMinutes()))/6E4;J(E,PWa,Q);TT(E,iYa,g);if(x=window.$$as(YM,f)){var V=x.get_shapeId();J(E,QYa,V)}d&&J(E,OYa,d);if(h){if(!h)throw Error.argumentNull("taskInfo");J(E,vZa,h.Title);J(E,zZa,h.CompletionPercentage);TT(E,yZa,h.Asignees)}if(k){if(!k)throw Error.argumentNull("textAnchoringInfo");
TT(E,n_a,k.AnchoringShape);J(E,o_a,k.StartPos);J(E,p_a,k.EndPos);J(E,q_a,k.TextBodyHash);J(E,r_a,k.TextBodyLength)}J(E,QWa,c)}var Z=a.f0a(),n=!Z,Y=!a.U_a(),ca=!a.sU();(n||Y)&&R(523845847,805,n&&!Y?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",n,Y,ca);$H("Comments.UseNameInPlaceOfUserId")&&n&&!Y&&(Z=ca?ResourceStrings.anonymousCommentAuthor:a.sU());r1d(z,a.sU(),Z,a.U_a());if(ca){if(null===z)throw Error.argumentNull("comment");var la=window.$$as(OM,z);la&&J(la,SWa,
ResourceStrings.anonymousCommentAuthor)}y.Xf(z,1);R(523845848,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",b,!!h,!!k,!!x)}finally{v&&v.dispose()}Izc()?d?(v=B7(a,d))?(v=I7(v))?(y=a.A6,z=c.length-1,Z=!!k,(Y=!!h)&&v.taskInfo?y.Ggc+=1:Y&&(y.Fgc+=1),Jzc(y,b,z,Z,Y)):R(524100422,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):R(524100421,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):
(v=a.A6,y=c.length-1,z=!!k,Z=!!h,v.Xbb=Z?v.Xbb+1:v.Xbb,Jzc(v,b,y,z,Z)):Jzc(a.A6,b,c.length-1,!!k,!!h)}else R(523845846,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable");l&&l.Lf();return m}).catch(function(a){R(523845845,805,10,JSON.stringify(a));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}
function P0d(a,b,c,d,e,f,g,h,k){var l=a.kC.Di("UserAction","AddComment");lj(L)?s1d(a,b,c,d,e,f,g,h,k,l):a.Fc.Nf(function(){s1d(a,b,c,d,e,f,g,h,k,l)})}function Izc(){return $H("Comments.LogTasksTelemetry")}function u1d(a,b,c,d){this.OJ=a;this.zd=b;this.Lb=c;this.je=d}u1d.prototype={OJ:null,zd:null,Lb:null,je:null,hl:function(a){if(null===a)throw Error.argumentNull("shapeNode");return window.$$as(tQ,Uy(a,this.Lb.Eb()))}};
function q0d(a,b){if(null===b)throw Error.argumentNull("comment");if(!b.anchorShape)return null;b=n1d(a.OJ,b.commentId);b=I7(b);if(!b)return null;a=a.zd.ie()?a.zd.ie().ii():null;return a?a.JF(b.anchorShape):(R(557090388,805,50,"ActiveSlide is null"),null)}
function v1d(a,b){if(null===b)throw Error.argumentNull("comment");if(b=q0d(a,b)){if(ZO(b)){var c=bQ(b);if(!c)return R(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",b.get_shapeId()),null;a=Uy(c,a.Lb.Eb());return a&&a.Xd()?oJ(new Sys.UI.Bounds(a.Xd().clientLeft,a.Xd().clientTop,a.Xd().clientWidth,a.Xd().clientHeight)):(R(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",b.get_shapeId()),null)}if(a=a.hl(b))return a=
a.Zc().Ja,oJ(new Sys.UI.Bounds(a.clientLeft,a.clientTop,a.clientWidth,a.clientHeight))}return null}function H_d(){this.Hm=Function.createDelegate(this,this.vm);this.yNa=!!L&&L.ia("PptReactTabbedTaskPanesM2IsEnabled")}
H_d.prototype={J:null,uO:null,krc:null,HBa:null,hrc:null,xia:null,YYe:null,kPa:null,OXe:null,wRe:null,i1a:!1,I6:!1,WMa:!1,ard:null,kC:null,wTe:"6F1926CF-E872-4C4C-9393-3956FCFEB98A",OJ:null,dC:!1,wc:function(a){this.J=a;this.dC=this.J.H(T,null).sZb;this.kC=this.J.H(oc,null);this.kPa=new KFa(ke(),"CommentPane");C(D(lc(a.ma(x1d,null),f_d)),function(){return new x1d});var b=this.J.H(hK,null).IN(),c=2===b||3===b;this.i1a=c;this.WMa=1===b;var d=this;C(D(lc(a.ma(Kzc,null),Lzc)),function(){return new Kzc(d.J.H(EK,
null),d.J.H(md,null),d.J.H(GN,null),d.J.H(vBb,null),b)});var e=this;C(D(lc(a.ma(h1d,null),z1d)),function(){return new h1d(e.kC,b,e.J.H(o7,null),e.J.H(CS,null),e.J.H(BN,null),e.J.H(GN,null),e.J.H(vBb,null),e.J.H(f_d,null),e.J.H(md,null),e.J.H(JN,null),e.J.H(UM,null),e.J.H(Lzc,null),e.J.H(Gwb,null),e.J.H(aN,null))});var f=this.i1a||!this.WMa;this.OJ=this.J.H(z1d,null);f&&C(D(a.ma(fR.$$(tGb),null)),function(){return new (lR.$$(tGb))(function(b,c){var d=null,e=window.$$as(tQ,Uy(b,a.H(Yv,null).Eb()));
e&&!e.Hv()&&(b=a.H(pFd,null).vQc(a.H(UM,null),null,b,c,e.$r,16),d=new A1d(b),d.Mm(e.$r),TQ(e,d,5),d.hf(KQ(e)||e.Hw()));return d})});var g=this;C(D(this.J.ma(B1d,null)),function(){return new u1d(g.OJ,g.J.H(wQ,null),g.J.H($R,null),a.H(NN,null))});var h=this;C(D(this.J.ma(C1d,null)),function(){return new D1d(h.J.H($R,null).Ve(),h.J.H(wQ,null),h.OJ)});var k=this.i1a||!this.WMa,l=this;C(D(this.J.ma(E1d,null)),function(){return new F1d(l.J.H(B1d,null),l.J.H(C1d,null),new G1d(k),l.J.H(o7,null),k,k)});var m=
this.J.H(md,null).ia("CommentTextAnchoringUIEnabled")&&!this.WMa,n=this;C(D(this.J.ma(H1d,null)),function(){return new H1d(m,n.J.H(Bo,null))});var r=new k0d(f,this.J.H(wQ,null),f?this.J.H(fR.$$(tGb),null):null,this.OJ,this.J.H(UM,null),this.J.H(eld,null),this.J.H(B1d,null),this.J.H(IH,null),this.J.H(H1d,null),this.J.H(md,null),this.J.H(hR,null));C(D(a.ma(i_d,null)),function(){return new I1d(a.H(wd,null),a.H(ud,null),a.H(IR,null))});var t=this;C(D(lc(this.J.ma(Jo,null),Fo)),function(){return new Jo(t.J.H(Dd,
null))});var v=this.J.H(md,null).ia("TasksHistoryEnabled");v&&C(D(this.J.ma(IEa,null)),function(){var a=new oFa(!0,v,!0,!1),b=new $Ea,c=new (ga.$$(Eo))(GSd),d=new gFa;a.i9c&&(d.bSa.push(new iFa),d.bSa.push(new kFa));a.Yre&&d.bSa.push(new hFa(b,c));d.ACa(a.i9c);d.xCa(a.sxe);c=new pFa(c,d);return new nFa(b,d,c,new qFa,"",5,0,a.Lka)});var x=this;C(D(lc(this.J.ma(J1d,null),K1d)),function(){return new J1d(x.J.H(md,null),v?x.J.H(IEa,null):null,v)});C(D(lc(this.J.ma(fFa,null),HEa)),function(){return new fFa});
this.I6=this.J.H(md,null).ia(S(896))&&(c||!this.WMa);var y=this.J.H(T,null).r7a,z=this;C(D(lc(lc(this.J.ma(L1d,null),SS),GS)),function(){return new L1d(z.OJ,z.J.H(Lzc,null),z.J.H(dd,null),z.J.H(GK,null),z.J.H(IR,null),z.J.H(ql,null),z.J.H(xd,null),z.J.H(cL,null),z.J.H(ud,null),z.J.H(sK,null),z.J.H(UM,null),z.J.H(IR,null).Zc(),z.J.H(wQ,null),z.J.H(jR,null),z.J.H(iR,null),z.J.H(tS,null),z.J.H(GN,null),z.J.H(Ow,null),z.J.H(Gwb,null),z.J.H(Dd,null),z.J.H(K1d,null),z.J.H(Fo,null),z.kPa,z.J.H(i_d,null),
Di,z.J.H(e_d,null),z.J.H(g_d,null),z.J.H($R,null).Ve(),z.J.H(eS,null),z.J.H(xQ,null),z.J.H(EK,null),z.J.H(AT,null),z.J.H(E1d,null),z.kC,r,z.J.H(md,null),kc(z.J,bv),z.J.H(FN,null),f,a.H(eK,null),a.H(iK,null),z.I6,iA(a.H(Ow,null),10),a.H(fS,null),a.H(o7,null),k,a.H(ZM,null),kc(a,Kea),a.H(nv,null),a.H(hK,null),z.dC,a.H(Qw,null),z.J.H(T,null),y?z.J.H(Up,null):null,z.J.H(T,null).u6?z.J.H(SZ,null):null)});var E=this;C(D(lc(this.J.ma(DFa,null),JEa)),function(){return new DFa(E.J.H(dd,null),E.J.H(SS,null).DIe)});
var H=this;C(D(lc(this.J.ma(J7,null),eWb)),function(){return new J7(H.J.H(SS,null),H.J.H(cL,null),H.wTe)});var O=new M1d(this.J.H(WM,null),this.J.H(GN,null),new N1d(this.J.H(RNb,null)),this.OJ,this.J.H(md,null).ia(S(459)),ic(this.J,SS)),Q=this;C(D(this.J.ma(g_d,null)),function(){return new O1d(O,Q.J.H(Dd,null))});var U=this;C(D(this.J.ma(P1d,null)),function(){return new P1d(U.J.H(EK,null),U.J.H(GN,null),U.J.H(Dd,null),iA(U.J.H(Ow,null),7),U.J.H(e_d,null),U.J.H(SS,null))});var V=this;C(D(this.J.ma(e_d,
null)),function(){return new c1d(V.J.H(WM,null),V.J.H(GN,null),V.J.H(g_d,null),V.OJ,V.J.H(Fo,null),V.J.H(GK,null),V.J.H(Dd,null))});var Z=this;C(D(this.J.ma(Q1d,null)),function(){var a=Z.J.H(SS,null);return new Q1d(a.bff||(a.bff=Function.createDelegate(a,a.Oge)),window.Box4.App.hE.Wh,Gw())});var Y=this;C(D(this.J.ma(IR,null)),function(){return new R1d(Y.J.H(ES,null),Y.J.H(GK,null),Y.J.H(T,null).vca,Y.J.H(sL,null),Y.dC)});var ca=this;C(D(this.J.ma(S1d,null)),function(){return new S1d(ca.J.H(Fo,null),
kc(ca.J,e3))})},ub:function(){ve().ed("CommentsPackageInitialize",(new Date).getTime());var a=this.kC.Di("UserAction","InitCommentsPackage"),b={};this.dC||(this.HBa=this.J.H(IR,null).Zc());this.uO=this.J.H(SS,null);this.uO.Qd();var c=a.Qq();b.CommentFrameInitMS=c;this.J.H(GS,null);var d=this.krc=this.J.H(Q1d,null);iH(iA(d.LQb,39),d.fGd);iH(iA(d.LQb,40),d.hGd);var e=d.L6,f=rob(3),g=null,h,k;(k=e.bbb.ng(f,h={val:g}),g=h.val,!k)||0>=g.length||g[0]||(xSd(e,d,f),g[0]=new Dob(d));d=a.Qq();b.CommentPropertyTrackerInitMS=
d-c;this.ard=this.J.H(P1d,null);this.YYe=this.J.H(eWb,null);e=ze(ye(L).SessionStartInfoJson.toString());c=e.Ring||"Unknown";e=e.WACDatacenter||"Unknown";f=this.J.H(T,null).YFc;g=(g=L.Va("LokiComplianceEnvironment"))&&""!==g?g:L.Va("SovereignEnvironmentName");this.OXe=new Jm("PowerPoint",Jp,null,null,vp,c,e,!f,this.J.H(dd,null),null,g);c=ao(F.ag);this.wRe=new yAa(Di,c?c._name:Sys.CultureInfo.CurrentCulture.name,rs,Cna);this.dC||(this.HBa.id=this.wTe);T1d(this);L.Nf(this.Hm);if(c=this.J.H(jR,null))e=
new dJb,c.qa.Ha("CPL",e,null);c=a.Qq();b.CommentReactPaneInitMS=c-d;d=this.J.H(IR,null);e=this.J.H(JR,null);this.dC||(!this.yNa||this.yNa&&!document.getElementsByClassName("CommentPanel").length)&&e.xC(d);e.Q$a(2);this.J.H(cL,null).wS("EditingCommentsPanelFocus","main",d,!d.lf());d=a.Qq();b.CommentPaneInitMS=d-c;L.fc("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.J.H(S1d,null).Qd();a.Lf();R(538280202,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
b,this.J.H(md,null).ia(S(896)))},vm:function(){this.J.H(GK,null).Tf(!1)},ha:function(){if(this.krc){var a=this.krc;hH(iA(a.LQb,40),a.hGd);hH(iA(a.LQb,39),a.fGd)}this.uO&&this.uO.dispose();this.ard&&this.ard.ha();this.xia=null},Xb:function(){return"PowerPointWebEditor.CommentsPackage"}};
function U1d(a){ve().ed("SharedCommentsLoadStart",(new Date).getTime());var b=a.J.H(Cc,null).Rp,c=a.J.H(LEa,null),d=a.J.H(HEa,null);ve().ed("CommentActivationManagerInitStart",(new Date).getTime());d.Qd(b,a.hrc,a.OXe,a.xia,new Lo(a.YYe,a.kPa),a.wRe,null,DSd(c),null,null);ve().ed("InstantiateSharedComments",(new Date).getTime());LSd(d).then(function(){ve().ed("InitRichContentEditAPI",(new Date).getTime());V1d(a.uO);ve().ed("LoadFloatingContainerManager",(new Date).getTime());wZ(a.J)("floatingContainerManager").then(function(){ve().ed("FloatingContainersInitStart",
(new Date).getTime());W1d(a.uO);ve().ed("FloatingContainersInitialized",(new Date).getTime());if(a.J.H(T,null).APd){var b=y7(a.OJ);if(b&&0<b.length){b=a.uO;if(X1d(b)){var c=Y0d(b,X1d(b)),d=b.zd.ie().ii().Pc(),h=d===window.parseInt(Y1d(b));if(c){1!==c.status&&2!==c.status||b.H4c();b.GB(c,null,!0,!0,0,1,!1);var k=cV(b.ra),c=new Date;b.A6.h9b("OnDeepLinkedCommentSelected",c,k);Mzc("DeepLinkedCommentSelected",c);R(527501403,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
X1d(b),Y1d(b))}else h&&b.Kd.dr((k=new Lb,k.Code=389,k.Source=4,k),b.Ya.Hc,null,!1),R(527501402,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",X1d(b),Y1d(b),window.parseInt(d))}ve().ed("SharedCommentsDeepLinkComplete",(new Date).getTime());cOb(null,"SharedCommentsDeepLinkComplete")}else R(538280205,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(function(a){R(538280206,801,10,"Failed to load the resources for the floating container UI + "+
a.toString())})})}
function T1d(a){ve().ed("InitOfficeSharedComments",(new Date).getTime());C0d(a.J.H(o7,null)).then(function(b){ve().ed("InitOfficeSharedCommentsInternal",(new Date).getTime());mc(window.Common.App.People.IExternalPeopleAPI,kc(a.J,window.Common.App.People.IExternalPeopleAPI)).CWo(function(c){a.xia=ab(c);a.xia||R(538280203,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");a.J.H(T,null).Fk()&&(c=a.J.H(md,null).Va(S(368)),a.xia.$N.FWb(c+"p"));c=["contextmenu"];a.dC||Gxa(a.HBa,c);
var d=b&&(a.i1a||!a.WMa),e=a.J.H(md,null).ia("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");C(D(lc(a.J.ma($1d,null),LEa)),function(){return new $1d(a.J.H(md,null),a.J.H(T,null),a.xia,a.WMa,d,a.I6)});C(D(lc(a.J.ma(A7,null),h_d)),function(){return new A7(a.J.H(SS,null),a.OJ,a.J.H(Fo,null),a.J.H(JEa,null),a.J.H(Dd,null),a.J.H(md,null),a.J.H(K1d,null),a.J.H(e_d,null),a.xia,a.J.H(o7,null),a.J.H(S1d,null),d,a.I6,e,a.J.H(LEa,null),a.J.H(dd,null),a.J.H(T,null))});a.hrc=a.J.H(h_d,null)},
11).CW(function(){a.hrc&&a.hrc.checkAtMentionCapability().then(function(b){b&&((b=kc(a.J,Zc))?b.pb(function(a){a.Jn("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane",null)}):R(538280204,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});U1d(a)})})}
function Kzc(a,b,c,d,e){this.Yz=Function.createDelegate(this,this.tH);this.ap=Function.createDelegate(this,this.Lt);this.oKe=new (Ca.$$(String));this.Adc=new (Ca.$$(String));this.j3c=new (Ca.$$(String));this.Hfc=new (Ca.$$(String));this.j7a=this.o5b=this.o7a=window.Box4.App.hp;if(!a)throw Error.argumentNull("coreEventHandler");if(!b)throw Error.argumentNull("appSettingsManager");this.uc=a;this.Fc=b;this.ra=c;this.vha=d;this.jKe=e;nK(this.uc,this.ap);qM(this.uc,this.Yz)}
Kzc.prototype={uc:null,Fc:null,ra:null,vha:null,jKe:0,dqc:0,lsd:0,Grd:0,$qd:0,Myd:0,KGa:0,crd:0,yKe:0,bDd:0,Gpd:0,RWb:0,GVb:0,HVb:0,z9b:0,t9b:0,U8b:0,Y8b:0,Erd:0,Brd:0,Ard:0,Crd:0,Epa:null,jVb:0,ebb:0,kcb:0,Xbb:0,Ggc:0,Fgc:0,DOb:function(){return this.Fc.ia("CommentTextAnchoringCreateNewEnabled")},bzb:function(a,b,c){this.crd=a;this.bDd=b;this.j3c=c;Nzc(this)},h9b:function(a,b,c){var d={};d.Event=a;d.Time=b.getTime();d.SlideId=c.toString();!this.Epa&&(this.Epa={},a=window.parseInt(this.Fc.Va("CurrentSlideId")),
a=a!==Number.NaN&&a!==aK.Pc()?BJ(a,0):this.ra.Ed.Rxb(0))&&(this.Epa.SlideId=a.toString(),a=this.ra.Ed.dTa(a.Pc()))&&(a=window.$$as($M,a).sS(),this.Epa.HasComments=xec(0,a),this.Epa.HasActiveComments=yec(0,a));a=this.Epa;d.LandingSlide=a;a={};a.Ring=F.od.Ring;a.Host=F.od.Host;a.UiHost=F.od.UiHost;a.SessionOrigin=F.od.SessionOrigin;a.ApplicationMode=F.od.ApplicationMode;a.Browser=F.od.Browser;a.Os=F.od.Os;d.SessionDimensions=a;a={};a.UserClickTime=ve().ts("UserClickTime");a.DocPageNavigationStart=ve().ts("DocPageNavigationStart");
a.FrameNavigationStart=ve().ts("FrameNavigationStart");a.RequestPostBootAppSettingStart=ve().ts("RequestPostBootAppSettingStart");a.RequestPostBootAppSettingEnd=ve().ts("RequestPostBootAppSettingEnd");a.RequestPostBootAppExecutionStart=ve().ts("RequestPostBootAppExecutionStart");a.ExtCommonPackageLoadStart=ve().ts("ExtCommonPackageLoadStart");a.ExtCommonPackageLoaded=ve().ts("ExtCommonPackageLoaded");a.ExtCommonPackageInitialized=ve().ts("ExtCommonPackageInitialized");a.ChronosPackageLoaded=ve().ts("ChronosPackageLoaded");
a.VisiToggled=0<Hia();d.PerfMetrics=a;a={};a.CommentPackageLoaded=ve().ts("CommentPackageLoaded");a.CommentsPackageInitialize=ve().ts("CommentsPackageInitialize");a.InitOfficeSharedComments=ve().ts("InitOfficeSharedComments");a.InitOfficeSharedCommentsInternal=ve().ts("InitOfficeSharedCommentsInternal");a.SharedCommentsLoadStart=ve().ts("SharedCommentsLoadStart");a.InstantiateSharedComments=ve().ts("InstantiateSharedComments");a.InitRichContentEditAPI=ve().ts("InitRichContentEditAPI");a.LoadFloatingContainerManager=
ve().ts("LoadFloatingContainerManager");a.FloatingContainersInitStart=ve().ts("FloatingContainersInitStart");a.FloatingContainersInitialized=ve().ts("FloatingContainersInitialized");a.SharedCommentsDeepLinkComplete=ve().ts("SharedCommentsDeepLinkComplete");a.CreateNewCloudPolicyStart=ve().ts("CreateNewCloudPolicyStart");a.CreateNewCloudPolicyEnd=ve().ts("CreateNewCloudPolicyEnd");d.CommentPerfMetrics=a;d.CommentFileType=this.jKe;d.CommentDeepLinkedOpen=!!this.Fc.Va("CurrentCommentId");d.StandaloneCommentJsEnabled=
!0;d.LoadSharedCommentsEarly=!0;d.FetchFullAppSettingsOnBoot=this.Fc.fc("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);d.PrefetchCommentCloudPolicy=this.Fc.fc("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);R(523845836,805,15,Id(d))},qH:function(){R(523845840,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.dqc,this.lsd,this.Grd,this.$qd/this.dqc,this.Myd,
this.KGa,this.crd,this.jKe,this.yKe);R(523845841,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.bDd,this.Gpd,this.RWb,this.GVb,this.HVb,this.t9b,this.U8b,this.z9b,this.Y8b);R(523845842,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.Erd,this.Brd,this.Ard,this.Crd);R(523845843,845,15,"Task(s) - Added:{0}",this.jVb);
var a={};a.ResolvedTasksCount=this.ebb;a.UnresolvedTasksCount=this.kcb;a.TasksCreatedNewThreadCount=this.Xbb;a.TasksReassignedInReplyCount=this.Ggc;a.TasksCreatedInReplyCount=this.Fgc;R(524100420,845,15,Id(a))},Lt:function(){Nzc(this)},tH:function(){this.qH()}};function Mzc(a,b){var c=[],d;Array.add(c,(d=new eb,d.name="EventName",d.string=a,d));var e;window.Otel.Telemetry.Z_((e=new hb,e.name="CommentsBootEvents",e.durationMs=b.getTime()-Ozc(),e.dataFields=c,e))}
function Ozc(){var a=ve().ts("DocPageNavigationStart");if(!ve().ts("UserClickTime"))return a;var b=ve().ts("UserClickTime");return 6E4>a-b?b:a}function Nzc(a){R(523845837,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",a.crd,a.jKe);R(523845838,805,15,"Text Anchor(s) - OnOpen:{0}",a.bDd);R(523845839,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",a.DOb(),a.Fc.ia("TasksForCommentsEnabled"))}
function Pzc(a,b,c,d){b&&b.textAnchoringInfo&&!Qzc(a,b.commentId)&&(b.textAnchoringInfo.EndPos<=b.textAnchoringInfo.StartPos?(c?d?a.Y8b+=1:a.t9b+=1:a.z9b+=1,a.Hfc.ga(b.commentId)):0>=b.textAnchoringInfo.TextBodyLength&&(a.Adc.Kc(b.commentId)?a.Adc.Mc(b.commentId):(a.U8b+=1,a.Hfc.ga(b.commentId))))}function Qzc(a,b){return a.j3c.Kc(b)||a.Hfc.Kc(b)}function Rzc(a,b){a.o5b===window.Box4.App.hp&&(a.o5b=new Date,a.h9b("OnFloatingCommentsRendered",a.o5b,b))}
function Jzc(a,b,c,d,e){a.dqc+=1;a.$qd+=c;d&&(a.Gpd+=1,a.Adc.ga(b));e&&(a.jVb+=1)}function Q1d(a,b,c){this.hGd=Function.createDelegate(this,this.eJf);this.fGd=Function.createDelegate(this,this.cJf);Q1d.initializeBase(this);this.zYe=a;this.LQb=b;this.L6=c}
Q1d.prototype={zYe:null,LQb:null,L6:null,Dh:function(){this.zYe()},eJf:function(a,b){b.oh!==MWa&&b.oh!==QWa&&b.oh!==NYa&&b.oh!==jXa&&b.oh!==PYa&&b.oh!==o_a&&b.oh!==p_a||this.Ha(WRd,null,null)},cJf:function(a,b){b.oh!==yq&&b.oh!==jXa||this.Ha(WRd,null,null)}};function x1d(){}x1d.prototype={};function r1d(a,b,c,d){if(null===a)throw Error.argumentNull("comment");if(a=window.$$as(OM,a))J(a,tPa,b),J(a,FXa,c),J(a,GXa,d)}function K0d(a){if(null===a)throw Error.argumentNull("comment");J(a,jXa,!0)}
function a2d(){}a2d.prototype={Pm:null,Comment:null,g_:0,s3c:null};function P1d(a,b,c,d,e,f){this.OId=Function.createDelegate(this,this.b4f);this.ZLd=Function.createDelegate(this,this.Sag);this.dispose=this.ha;this.uc=a;this.ra=b;this.ob=c;this.fAd=d;this.f3e=e;this.Xa=f;mD(this.fAd,this.ZLd);this.uc.qa.Ka("CC",this.OId)}
P1d.prototype={uc:null,ra:null,fAd:null,ob:null,f3e:null,Xa:null,ha:function(){this.uc.qa.eb("CC",this.OId);nD(this.fAd,this.ZLd)},b4f:function(){var a=this.ra.Ma(),b=this;YRd(this.ob,function(){b.ra.Ma()===a&&a&&b.Xa.Uva(!0)},"GenericCommentsTask")},Sag:function(a,b){if(2===b.NM){var c=this.ra.Ma(),d=this;YRd(this.ob,function(){d.ra.Ma()===c&&c&&d.Xa.Uva(!0)},"GenericCommentsTask")}}};function T0d(a){this.uPb=a}T0d.prototype={uPb:null};
function S1d(a,b){this.KPa=Function.createDelegate(this,this.yTa);this.aqe=a;this.o8c=b}
S1d.prototype={aqe:null,o8c:null,Qd:function(){var a=this;this.o8c.pb(function(b){b.wub("AugLoop_SmartReply_SmartReply");b.bbc("AugLoop_SmartReply_SmartReply",a.KPa)})},hv:function(a,b){var c,d,e,f=(e=new xJa,e.parentPath=["Signal",hKa()],e.items=[(d=new Np,d.body=(c=new gKa,c.commentId=a,c.comment=b,c),d)],e);this.o8c.pb(function(a){a.KHa(f)})},yTa:function(a){if(a){var b=new (Ca.$$(String));if(a&&a.CommentId&&a.ResultSets&&0<a.ResultSets.length&&a.ResultSets[0].Documents&&0<a.ResultSets[0].Documents.length){for(var c=
a.ResultSets[0].Documents,d=c.length,e=0;e<d;++e)b.ga(c[e].Caption);0<b.Qa()&&(c=this.aqe,b=b.Jd(),d=new Ko,d.commentId=a.CommentId,d.smartReplies=b,$6(c,new Io(15,d)),a7(c,!1))}else R(557593412,327,10,"Invalid response from SmartReplies request")}else R(557593411,327,50,"Smart reply invocation returned null annotations.")}};
function H1d(a,b){H1d.initializeBase(this);this.HOe=a;this.Ug=b;this.ptc=[new KH("CommentHighlight",null),new KH("CommentHighlightClicked",null),new KH("CommentHighlightClickedTextFill",null),new KH("CommentHighlightPipeClicked",null),new KH("CommentHighlightRest",null),new KH("CommentHighlightRestDark",null),new KH("CommentHighlightPipeRest",null),new KH("CommentHighlightHovered",null),new KH("CommentHighlightHoveredDark",null),new KH("CommentHighlightPipeHovered",null),new KH("CommentHighlightPipeHoveredDark",
null)]}
H1d.prototype={ptc:null,Ug:null,HOe:!1,UH:function(){return!!this.Ug&&this.Ug.UH()},cib:function(){return this.HOe},CGa:function(a,b){var c=this.XR.iaa();if(c&&!c.qh){var c=this.XR.iaa().oca,d=Array.isInstanceOfType(c)?c:null;if(d){for(var e=null,f=null,c=new (Wb.$$(Km,b2d))(null),g=d.length,h=0;h<g;++h){var k=d[h];k.Y6a.Vf()&&Array.contains(k.Y6a.rJ,a)&&(k.ph?1===k.ph&&(f=k.rZb):e=k.rZb,c.ea(k.rZb,k.Y6a))}b=b.querySelectorAll("*");d=new ($b.$$(Km));g=new ($b.$$(Km));for(h=0;h<b.length;h++)if(k=b[h],
M3b(this,k),k.parentNode){var l=jl(k,"CommentStartGuids"),m=jl(k,"CommentEndGuids"),n=[!1,!1,!1];if(l)for(var r=l.length,t=0;t<r;++t){var v=l[t];if(c.hc(v)){var x=c2d(c.K(v),a),y;if(!(y=c.K(v).dTd)){if(x=!(2!==x&&x||this.UH())){y=c.K(v);x=v===f;y=d2d(y);var z=x?e2d:f2d,x=aTd(y,x?g2d:h2d);y=aTd(y,z);x=x<y}y=x}y&&(c.K(v).dTd=!0,d.ga(v));g.ga(v);i2d(c,a,v,e,f,n,!0)}}if(m)for(l=m.length,r=0;r<l;++r)t=m[r],g.Kc(t)&&(g.Mc(t),d.Mc(t),i2d(c,a,t,e,f,n,!1));$Sd(k)&&(m=(l=0<d.Qa())&&!!f&&d.Kc(f),r=!!e&&g.Kc(e),
t=!!f&&g.Kc(f),0<g.Qa()&&!this.UH()&&0<=k.parentNode.className.indexOf("TextRun")&&(Od(k.parentNode,"CommentHighlight"),t?Od(k.parentNode,m?"CommentHighlightHoveredDark":"CommentHighlightHovered"):r?(Od(k.parentNode,"CommentHighlightClicked"),l=k.parentNode.className.match(/\bHighlight\b/),(!l||1>l.length)&&Od(k.parentNode,"CommentHighlightClickedTextFill")):Od(k.parentNode,l?"CommentHighlightRestDark":"CommentHighlightRest")),n[1]?Od(k,m?"CommentHighlightPipeHoveredDark":"CommentHighlightPipeHovered"):
n[0]?Od(k,"CommentHighlightPipeClicked"):n[2]&&Od(k,"CommentHighlightPipeRest"))}}}},jVc:function(a,b){if(a=Array.isInstanceOfType(a)?window.$$as(Array,a):null){if(0<a.length){var c=window.$$as(p0d,a[0]);if(!c)return}for(var d=a.length,e=0;e<d;++e)if(c=a[e],c.Y6a.Vf())for(var c=c.Y6a.rJ,f=c.length,g=0;g<f;++g){var h=c[g];h&&(e9b(h),b.val.ga(h))}}}};function i2d(a,b,c,d,e,f,g){a=c2d(a.K(c),b);2!==a&&(g?a:1!==a)||(d&&d.Sa(c)&&(f[0]=!0),e&&e.Sa(c)&&(f[1]=!0),f[2]=!0)}function b2d(){}
b2d.prototype={rJ:null,OQ:null,z$:null,dTd:!1,URa:0,IQa:0,Ttb:0,Stb:0,Vf:function(){return!!this.OQ&&!!this.z$&&!!this.rJ}};function c2d(a,b){var c=3;b&&(!j2d(a)&&a.OQ.Sa(b)?c=2:a.OQ.Sa(b)?c=0:a.z$.Sa(b)&&(c=1));return c}function j2d(a){return!a.OQ.Sa(a.z$)}function d2d(a){if(!a.Vf())return 4278190080;a=Ky(a.OQ,a.URa+1);if(!a)return 4278190080;a=gy(a);return a?(a=vE(a))&&a.FLa()?a.naa():4278190080:4278190080}
function k2d(a){var b=0;if(a.Vf())if(j2d(a))for(var b=b+(Hy(a.OQ)-a.URa),b=b+a.IQa,c=1;c<a.rJ.length-1;c++){var d=a.rJ[c];d&&(b+=Hy(d)+1)}else b=a.IQa-a.URa;return b}
function Szc(a,b){var c=(a.Stb&4294967295)>>>0;if(b.TextBodyLength===a.Ttb&&c!==b.TextBodyHash&&!m2d.Kc(a.Stb)){m2d.ga(a.Stb);var c=R,d;a:{d=a.rJ;for(var e=d.length,f=0;f<e;++f){var g=window.$$as(KN,d[f]);if(g&&-1!==g.fe.indexOf("\ufffc")){d=!0;break a}}d=!1}c(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",d)}return b.TextBodyLength===a.Ttb}function p0d(a,b,c){this.Y6a=a;this.rZb=b;this.ph=c}p0d.prototype={Y6a:null,rZb:null,ph:0};
function n2d(a,b){this.Cxc=a;this.Eg=b}n2d.prototype={Cxc:null,Eg:null,zrd:null,Hia:null,vQe:!1};
function o2d(a,b){function c(){Gl(a.Eg,"notifications")}function d(){Fl(a.Eg,"notifications")}window.Common.UISurfaces.tS().then(function(e){var f;H0(e,f={val:a.zrd});a.zrd=f.val;a.zrd=null;var g,h;f=(h=new Fm,h.target=".EditingRibbonPanel",h.title=ResourceStrings.l_DeleteAllCommentsCalloutTitle,h.content=b,h.showCloseIcon=!0,h.useTeachingStyles=!1,h.calloutProps=(g=new xha,g.directionalHint=6,g.isBeakVisible=!1,g.onDismiss=c,g.preventDismissOnScroll=!0,g.preventDismissOnResize=!0,g),h);var k;g=(k=
new Em,k.onShow=d,k);k=e.callout(f);a.zrd=e.addNotification(k,g)})}function q2d(){var a=new Dj;Ej(a,0);tm(a,ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null,null)}
function r2d(a,b,c){var d=new Dj;Ej(d,4);tm(d,ResourceStrings.l_DeleteAllCommentsConfirmationTitle,c?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,function(d){1===d?(b.PQc(c),s2d(a.Cxc,c)?q2d():o2d(a,c?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),R(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
c)):R(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",c)},null)}
function t2d(a,b,c,d){b?D7(a.Cxc)&&1===b.hF.length&&c.Ma()&&CJ(u2d(b).gc(),c.Ma().gc())||window.Common.UISurfaces.tS().then(function(e){var f;H0(e,f={val:a.Hia});a.Hia=f.val;a.Hia=null;var g;f=(g=new Jza,g.label=1<b.hF.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton,g.onExecute=function(){a:{var f=a.Cxc;if(c.Ed&&c.Ed.Rj){var g;b:{g=Q0d(b.Bn,u2d(b));for(var h=g.length,k=0;k<h;++k){var l=g[k];if(1===l.status){g=l;break b}}g=
null}if(g)if(D7(f)||f.H4c(),c.Ma()&&CJ(c.Ma().gc(),u2d(b).gc()))G7(f,g.commentId,1,!0);else for(f=c.Ed.Rj,h=f.length,k=0;k<h;++k)if(CJ(f[k].gc(),u2d(b).gc())){f=new a2d;f.Pm=u2d(b);f.Comment=g;f.g_=1;f.s3c=dI("SelectResolvedCommentCrossSlide",1);break a}}else R(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",c.Ed?"Presentation.Slides":"Presentation")}c.Ma().Sd!==u2d(b).Sd&&d.s4(u2d(b).Sd);H0(e,f={val:a.Hia});a.Hia=f.val;a.Hia=null},g);
var h;g=(h=new Jza,h.label=ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton,h.onExecute=function(){a.vQe=!0;var b;H0(e,b={val:a.Hia});a.Hia=b.val;a.Hia=null},h);var k,l;h=(l=new Fm,l.target=".EditingRibbonPanel",l.title=ResourceStrings.L_CommentReviewResolvedCalloutTitle,l.content=b.Aoc(),l.primaryButtonProps=f,l.secondaryButtonProps=g,l.useTeachingStyles=!1,l.showCloseIcon=!0,l.calloutProps=(k=new xha,k.directionalHint=6,k.gapSpace=4,k.isBeakVisible=!1,k.onDismiss=function(){Gl(a.Eg,
"notifications")},k.preventDismissOnScroll=!0,k.preventDismissOnResize=!0,k),l);var m;k=(m=new Em,m.onShow=function(){Fl(a.Eg,"notifications")},m);m=e.callout(h);a.Hia=e.addNotification(m,k)}):R(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}function H0(a,b){b.val&&a.removeNotification(b.val)}
function M1d(a,b,c,d,e,f){this.wkf=Function.createDelegate(this,this.K$f);this.xkf=Function.createDelegate(this,this.L$f);this.dispose=this.ha;this.qc=a;this.ra=b;this.Osc=c;this.OJ=d;this.Ewd=e;this.ve=new v2d;this.QMe=f}
M1d.prototype={qc:null,ra:null,Osc:null,ve:null,OJ:null,Ewd:!1,QMe:null,fza:function(){return this.QMe.Aa()},ha:function(){this.Osc.ha();this.ve=this.Osc=null},gSc:function(a,b,c){w2d(this,0,!1,a,b,c)},iSc:function(a,b,c){w2d(this,1,!1,a,b,c)},hSc:function(a,b){w2d(this,0,!0,a,b,!1)},L$f:function(a){fI(this.ve.um,"IsCompletedSearchInClient","false");wI(this.ve.um,"ServerSearchEndTime",new Date);iI(this.ve.um,"IsServerSearchSucceeded","true");a?(this.ve.kHa=a,-1===this.g$a(this.ve.kHa.TargetSlideId)?
x2d(this):this.ve.kda(y2d(this,this.ve.kHa.TargetSlideId),this.ve.kHa.TargetComment,this.ve.kHa.IsFirstComment,this.ve.kHa.IsLastComment)):x2d(this)},K$f:function(){fI(this.ve.um,"IsCompletedSearchInClient","false");wI(this.ve.um,"ServerSearchEndTime",new Date);iI(this.ve.um,"IsServerSearchSucceeded","false");R(25011742,805,50,"OnServerFindFailed");x2d(this)},g$a:function(a){var b=this.ra.Ed;if(!b)throw Error.argumentNull("Presentation is null");if(a){b=b.Rj||[];a=new zJ(a);for(var c=0;c<b.length;c++)if(b[c]&&
$ub(b[c].gc(),a))return c}return-1}};function x2d(a){a.ve.kda&&a.ve.kda(null,null,!1,!1)}function y2d(a,b){return b?FO(a.qc,new zJ(b)):null}function z2d(a,b){wI(a.ve.um,"ServerSearchStartTime",new Date);if(b){var c=a.Osc;b=b.gc();var d=a.ve.rbb,e=a.xkf;a=a.wkf;0<c.o2a&&null!==e&&(R(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",c.o2a),e(null));c.Qqa=b;c.eVe=d;c.EC(e,a,null)}}
function A2d(a,b,c,d){a.ve.kHa=null;for(var e=a.ve.Hle=c;-1<e;e--)if(b[e]&&ZN(b[e])){var f;a:{var g=a;f=d;var h=sO(g.qc,b[e].gc());if(g.fza()){g=Q0d(g.OJ,h);for(h=(g?g.length:0)-1;0<=h;h--){var k=g[h];if(!f||!k.status){f=k;break a}}f=null}else f=o1d(h,f,!0)}if(f){a.ve.kda(b[e],f,!1,!1);return}}else{z2d(a,b[e]);return}if(c<b.length-1){b=a.ra.Ed;if(!b)throw Error.argumentNull("Presentation is null");b=b.Rj||[];Xn(b)?x2d(a):A2d(a,b,b.length-1,d)}else x2d(a)}
function B2d(a,b,c,d){a.ve.kHa=null;for(var e=a.ve.Hle=c;e<b.length;e++)if(b[e]&&ZN(b[e])){var f;a:{var g=a;f=d;var h=sO(g.qc,b[e].gc());if(g.fza()){for(var h=(g=Q0d(g.OJ,h))?g.length:0,k=0;k<h;k++){var l=g[k];if(!f||!l.status){f=l;break a}}f=null}else f=o1d(h,f,!1)}if(f){a.ve.kda(b[e],f,!1,!1);return}}else{z2d(a,b[e]);return}if(0<c){b=a.ra.Ed;if(!b)throw Error.argumentNull("Presentation is null");b=b.Rj||[];Xn(b)?x2d(a):B2d(a,b,0,d)}else x2d(a)}
function w2d(a,b,c,d,e,f){var g=a.ra.Ed;if(!g)throw Error.argumentNull("Presentation is null");e||(e=dI("FindComment",0),iI(e,"FindCommentRequestType",M.fSc.toString(b)));iI(e,"IsCompletedSearchInClient","true");if(a.Ewd&&a.ra.Ma()){if(!a.ra.Ma())throw Error.argumentNull("ActiveSlide is null");var h=a.ra.Ma().Sd,g=g.Rj||[];a.ve.kda=d;a:{if(f)switch(b){case 0:d=2;break a;case 1:d=3;break a}d=b}a.ve.rbb=d;a.ve.um=e;c?z2d(a,g[h>=g.length-1?0:h+1]):1===b?A2d(a,g,h-1,f):B2d(a,g,h+1,f)}else iI(e,"IsBRSOn",
a.Ewd.toString()),d(null,null,!1,!1)}function v2d(){}v2d.prototype={Hle:0,rbb:0,kda:null,kHa:null,um:null};function O1d(a,b){this.zof=Function.createDelegate(this,this.Cfg);this.dispose=this.ha;this.yAa=a;this.ob=b;this.Cia=[];this.pvc=0}
O1d.prototype={ob:null,yAa:null,Cia:null,ksc:null,pvc:0,ha:function(){this.yAa.dispose();this.Cia=this.yAa=null;R(25985481,805,50,"MaxQueuedEntryNum: {0}",this.pvc)},gSc:function(a,b,c){this.xda(1,a,b,c)},iSc:function(a,b,c){this.xda(0,a,b,c)},hSc:function(a,b){this.xda(2,a,b,!1)},xda:function(a,b,c,d){iI(c,"AlreadyQueuedEntryCount",this.Cia.length.toString());var e,f=this;a=(e=new C2d,e.Type=a,e.kda=function(a,c,d,e){b(a,c,d,e);f.ksc=null;D2d(f)},e.um=c,e.NNc=d,e);Array.enqueue(this.Cia,a);this.pvc=
Math.max(this.pvc,this.Cia.length);D2d(this)},Cfg:function(){var a=Array.dequeue(this.Cia);1===a.Type?this.yAa.gSc(a.kda,a.um,a.NNc):a.Type?this.yAa.hSc(a.kda,a.um):this.yAa.iSc(a.kda,a.um,a.NNc)}};function D2d(a){0<a.Cia.length&&!a.ksc&&(a.ksc=new Si(2,1,0,a.zof,90,"49",!1,0),a.ob.Vb(a.ksc))}function C2d(){}C2d.prototype={Type:0,um:null,kda:null,NNc:!1};
function E2d(a,b){E2d.initializeBase(this);if(null===a)throw Error.argumentNull("slideId");this.RequestType=b;this.StartSlideId=a.toString();this.FFindModernComments=!0}E2d.prototype={StartSlideId:null,RequestType:0,FFindModernComments:!1,yk:function(){return 88}};function F2d(){F2d.initializeBase(this)}F2d.prototype={FindCommentResult:null};function N1d(a){this.dispose=this.ha;N1d.initializeBase(this);this.qX=2;this.o2a=0;this.Ql=!1;this.pk=a;this.pk.ma(this)}
N1d.prototype={pk:null,Qqa:null,eVe:0,qAa:null,YBa:null,o2a:0,Ql:!1,ha:function(){this.Ql||(1===this._state&&this.pk.iT(this),this.Ql=!0,this.o2a=0)},Uoa:function(){return 0<this.o2a&&!this.Ql},KF:function(){return!1},SFa:function(){return!!this.ee&&2===this.ee.Se||this.Uoa()},pbb:function(){if(1===this._state)$p(this.ee,new E2d(this.Qqa,this.eVe)),this.ee.Se=1,this._state=3;else if(3===this._state&&this.ee&&2===this.ee.Se)if(R(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",
this.ee.pbc,this.ee.Ws,this.ee.Yw),2===this.ee.uA&&this.ee.fp&&1===this.ee.fp.length){var a=this.ee.fp[0];a.StatusCode?this.LC(a):this.A4(a)}else this.LC(null)},EC:function(a,b){this.o2a++;this.YBa=a;this.qAa=b;$C(this.pk)},FC:function(){},LC:function(a){R(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.ee.TP,this.ee.uA,a?a.StatusCode:-1);G2d(this,a,!1)},A4:function(a){G2d(this,a,!0)}};
function G2d(a,b,c){a.o2a--;a._state=1;if(c){c=null;try{c=Sys.Serialization.JavaScriptSerializer.deserialize(b.FindCommentResult)}catch(d){R(523249095,805,10,"Cannot parse find comment result: {0}",d)}a.YBa(c)}else a.qAa(null,-1)}function H2d(a,b){if(!a||1>a.length)throw Error.argument("ISlideNode[] slides");if(!b)throw Error.argumentNull("ICommentGraphManager graphManager");this.WWe=a;this.Bn=b;this.hF=[];this.ub()}
H2d.prototype={WWe:null,Bn:null,hF:null,Aoc:function(){return I2d(this)},ub:function(){for(var a=this.WWe,b=a.length,c=0;c<b;++c)for(var d=a[c],e=H7(d.sS()),f=e.length,g=0;g<f;++g)if(1===e[g].status){this.hF.push(d);break}if(1>this.hF.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}};
function I2d(a){switch(a.hF.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,a.hF[1].Sd+1,a.hF[0].Sd+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,a.hF[2].Sd+1,a.hF[1].Sd+1,a.hF[0].Sd+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,a.hF[3].Sd+1,a.hF[2].Sd+1,a.hF[1].Sd+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,
a.hF[a.hF.length-1].Sd+1,a.hF[a.hF.length-2].Sd+1,a.hF[a.hF.length-3].Sd+1,a.hF.length-3)}}function u2d(a){return a.hF[a.hF.length-1]}function A1d(a){this.dispose=this.ha;this.Fg=a}
A1d.prototype={Fg:null,Jka:function(a,b){this.Fg.E6c(a?0:2,b);this.Fg.Gf()},Ri:function(){this.Fg.uIf();this.Fg.Gf()},bda:function(){this.Fg.E6c(1,!1);this.Fg.Gf()},Mm:function(a){this.Fg.Mm(a)},QC:function(a){this.Fg.QC(a)},$w:function(){return this.Fg.$w()},xB:function(a){return this.Fg.JTa(a)},hx:function(a){this.Fg.hx(a)},ha:function(){this.Fg.ha()},ez:function(){this.Fg.ez()},dx:function(a){return this.Fg.dx(a)},MC:function(a){return this.Fg.MC(a)},uB:function(a,b){this.Fg.uB(a,b)},rj:function(){return this.Fg.rj()},
hf:function(a){this.Fg.hf(a);return a},te:function(a,b){this.Fg.te(a,b)},$j:function(a){this.Fg.$j(a)},pq:function(a){this.Fg.pq(a)},uu:function(a){this.Fg.uu(a)},vs:function(a){this.Fg.vs(a)},ry:function(a,b){this.Fg.ry(a,b)},Hd:function(){}};function $1d(a,b,c,d,e,f){$1d.initializeBase(this);this.Fc=a;this.za=b;this.Gzd=c;this.nSe=f;this.Pmc=this.Fc.ia("TasksForCommentsEnabled")&&!d;this.MFe=!1;this.HBe=e;this.zAe=this.yye=!0;this.Kke();this.pke()}
$1d.prototype={Fc:null,za:null,Gzd:null,nSe:!1,Kke:function(){this.uv={};var a=this.Pmc&&L.ia("TasksCreationFromReplyEnabled");this.uv.CommentsFluentUI="true";this.uv.CommentsFluentUIV2="true";this.uv.CommentTasks=this.Pmc.toString();$H("DeprecateIE.SharedCommentAppCapabilities")?this.uv.DisabledChangeGates=this.Fc.Va("DisabledChangeGatesInSharedComments"):this.uv.DisabledChangeGates=di()?"WebThemeIntegrationHighContrastFixes,":""+this.Fc.Va("DisabledChangeGatesInSharedComments");this.uv.DiscreteHostedComments=
"true";this.uv.NewCommentButton="true";this.uv.PersonaColor="true";this.uv.LivePersonaPicker="true";this.uv.AtMentionFloodgateSurvey=L.ia("AtMentionUserFloodGateCampaignIsEnabled").toString();this.uv.CommentTasksFromReply=a.toString();this.uv.LogDraftCommentIdPair=this.nSe.toString();this.uv.HyperlinksInComments="true";this.uv.SmartReplies=this.Fc.fc("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.uv.NewModelState="true";this.uv.TaskPaneWithNewInfrastructure=this.za.sZb.toString();
this.uv.NewSelectionInteractions="true";this.uv.ExtendedDrafting="true";this.uv.LinkToComment="true";this.uv.PersonaIconImageForWeb="true";this.uv.NoDiscardOnFocusLoss="true";this.uv.WebThemeIntegration="true";this.uv.TaskHistoryRecordIDs=this.Fc.fc("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()},pke:function(){var a=this;return new Promise(function(b,c){a.Gzd?a.Gzd.atMentionsEnabledAsync().then(function(c){a.toe=c;a.Qec=!0;b(a.Qec)}):(u(528307426,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
c(EU(-2130915320)))})}};
function L1d(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z,E,H,O,Q,U,V,Z,Y,ca,la,ra,sa,ua,xa,Ea,Sa,Wa,Ga,Va,ya,jb,gb,Ab,Eb,rb,kb,ib,Pb,Xa,Jb,gd,bd,Vd,hd,rc,Vc,Yb){this.vCd=Function.createDelegate(this,this.qee);this.QEd=Function.createDelegate(this,this.Cfe);this.kwf=Function.createDelegate(this,this.grg);this.DXb=Function.createDelegate(this,this.N1f);this.dAc=Function.createDelegate(this,this.PQc);this.Zpb=Function.createDelegate(this,this.hhg);this.irf=Function.createDelegate(this,this.Wig);this.w5e=Function.createDelegate(this,
this.q6b);this.Duf=Function.createDelegate(this,this.qog);this.Euf=Function.createDelegate(this,this.rog);this.nNd=Function.createDelegate(this,this.Peg);this.mGd=Function.createDelegate(this,this.BLf);this.$Wb=Function.createDelegate(this,this.rIf);this.iCc=Function.createDelegate(this,this.tog);this.MWd=Function.createDelegate(this,this.Aqe);this.ejf=Function.createDelegate(this,this.e9f);this.Uif=Function.createDelegate(this,this.G8f);this.Tif=Function.createDelegate(this,this.F8f);this.iP=Function.createDelegate(this,
this.RK);this.qYb=Function.createDelegate(this,this.jag);this.LR=Function.createDelegate(this,this.xea);this.$Hd=Function.createDelegate(this,this.u2f);this.aQa=Function.createDelegate(this,this.GAb);this.mYb=Function.createDelegate(this,this.u_c);this.iJd=Function.createDelegate(this,this.h5f);this.ELd=Function.createDelegate(this,this.X$f);this.Gpb=Function.createDelegate(this,this.C_c);this.vId=Function.createDelegate(this,this.a3f);this.Xz=Function.createDelegate(this,this.DW);this.CMd=Function.createDelegate(this,
this.Qbg);this.HLd=Function.createDelegate(this,this.bag);this.Ykf=Function.createDelegate(this,this.$ag);this.Kpb=Function.createDelegate(this,this.F_c);this.JLd=Function.createDelegate(this,this.gag);this.BLd=Function.createDelegate(this,this.U$f);this.Hpb=Function.createDelegate(this,this.D_c);this.BKd=Function.createDelegate(this,this.C8f);this.JFd=Function.createDelegate(this,this.PEf);this.MOd=Function.createDelegate(this,this.Nme);this.E4a=Function.createDelegate(this,this.fUa);this.F4a=Function.createDelegate(this,
this.a4f);this.jGe=["EditingRTEView","EditingCommentsPanelFocus","EditingCommentsContainersFocus","EditingCommentsContainersRTEFocus"];this.Pdd=-1;this.dispose=this.ha;if(!Ga)throw Error.argumentNull("appSettingsManager");if(!Q)throw Error.argumentNull("commentEventHost");if(!b)throw Error.argumentNull("commentTelemetryManager");this.dC=Vd;this.fa=c;this.Fb=d;this.vM=e;this.Jo=f;this.Yc=g;this.Ia=h;this.Eg=k;this.Dc=l;this.pa=m;this.zd=r;this.Ou=t;this.zq=v;this.Bn=a;this.A6=b;this.uDg=new g1d(a);
this.yR=x;this.ra=y;this.aVb=iA(z,40);this.Ucc=$H("PreventCommentDraftDeletionOnPageContentChange")?iA(z,7):iA(z,8);this.D2a=n;this.X6=r.ie()?r.ie().CMa:null;this.s2=Z;this.jzf=E;this.ob=H;this.qY=Q;this.kPa=U;this.Lyd=O;this.g3a=V;this.rPb=Y;this.wkb=ca;this.Le=sa;this.eTb=la;this.Ul=ra;this.DPb=ua;this.$o=xa;this.WNa=Ea;this.kC=Sa;this.Tn=Wa;this.Fc=Ga;this.uo=ya;this.gkb=jb;this.oY=new (Ca.$$(F7));this.Kd=gb;this.Ya=Ab;this.MBa=rb;this.I6=Eb;this.xd=kb;this.$a=Xa;this.MVe=Jb;this.gM=gd;this.r1a=
bd;this.za=rc;this.xq=Vc;this.WF=Yb;this.k1a=Pb;this.fia=!1;this.fa.G4(this);this.Bjb=new n2d(this,this.Eg);if(!Va)throw Error.argumentNull("InteractiveViewManagerFuture");this.kwd=Va;this.DIe=J2d(this);this.dC&&K2d(this.vM,L2d(this));this.Gd=hd;var Fa=this;C0d(ib).then(function(a){a||Fa.G3c(!1)})}
L1d.prototype={fa:null,Fb:null,pa:null,zd:null,Ou:null,zq:null,xd:null,Le:null,Fc:null,kwd:null,r1a:null,vM:null,D2a:null,X6:null,Em:null,qBd:null,uDg:null,j1a:!0,n1a:!1,yR:null,ra:null,aVb:null,Ucc:null,Bn:null,A6:null,Jo:null,Yc:null,Ia:null,Eg:null,Dc:null,ob:null,Lyd:null,qY:null,kPa:null,g3a:null,eTb:null,Ul:null,DPb:null,$o:null,kKe:!1,s2:!1,jtd:!1,rQb:!1,wtd:!1,Ep:!1,bOa:0,Qmb:!1,oxc:!1,NIe:null,p7:null,m3a:null,gMa:null,DIe:null,Oi:null,Pwc:null,Sza:null,rPb:null,wkb:null,ENa:!1,WNa:null,
kC:null,fMe:!1,Tn:null,uo:null,oY:null,Eu:null,Vsd:!1,Kd:null,Ya:null,MBa:null,$a:null,gM:null,gkb:!1,I6:!1,VBd:!1,mVe:null,Bjb:null,Xha:2147483647,Yib:0,k1a:!1,dC:!1,lKe:0,Dvc:null,irc:!1,MVe:null,Gd:null,fia:!1,Fwc:!1,za:null,xq:null,WF:null,Gy:function(){return this.Fc.ia("CommentTextAnchoringUIEnabled")},DOb:function(){return this.Fc.ia("CommentTextAnchoringCreateNewEnabled")},Sga:function(){return this.Fc.ia("SlideResizePerfImprovementEnabled")},Qd:function(){this.Ep=1===this.Fb.Ic();this.dC||
(this.s2?Sys.UI.DomElement.addCssClass(this.D2a,M2d.JFg):Sys.UI.DomElement.addCssClass(this.D2a,M2d.IFg));var a=this.Ia.$c("EditingCommentsPanelFocus");a.wK=!0;a.n_a=!0;var b=this;Tl(a,function(a){var c=!$H("FixAltF12KeboardingInCommentPane")||!a||"TabbedTaskPaneFocus"!==a.Nd;N2d(b,!0,!a||"EditingRTEView"!==a.Nd&&c,!0)});var c=this;Sl(a,function(a,b){a=("ReactTransientUI"===b.Nd||"EditingRibbonPanelFocus"===b.Nd)&&"EditingCommentsPanelFocus"===a.Nd;b="EditingCommentsPanelFocus"===b.Nd||"document"===
b.Nd||"EditingRTEView"===b.Nd||"EditingCommentsContainersFocus"===b.Nd||P2d(c)&&"TabbedTaskPaneFocus"===b.Nd||a;N2d(c,!1,!1,b)});var d=this.Ia.$c("EditingRTEView"),e=this;Tl(d,function(a,b){if(a&&"EditingCommentsPanelFocus"!==a.Nd&&"EditingCommentsContainersFocus"!==a.Nd&&"EditingRTEView"===b.Nd)if(D7(e))e.q6b();else if(e.Oi){a="";switch(e.Oi.Ji){case 0:a=e.Oi.VJ?e.Oi.VJ.draftId:"";break;case 1:case 2:(b=n1d(e.Bn,e.Oi.tPb))&&(a=I7(b).commentId)}e.Eu.selectContainer(a,!0)}e.Qmb=!0});var f=this;Sl(d,
function(){f.Qmb=!1});this.dC||this.Yc.EB("click",this.D2a,this.F4a,null,a.n_a,!1);this.Wb();this.Ou.qa.Ka("BSS",this.E4a);aR(this.Ou,this.MOd);BQ(this.zq,this.JFd);this.Ul.qa.Ka("PVZC",this.BKd);this.uo.qa.Ka("SNS",this.Hpb);this.uo.qa.Ka("SND",this.BLd);vZ(this.Ou,this.JLd);this.Ou.qa.Ka("SBC",this.Kpb);this.k1a&&(nIb(this.Ou,this.Ykf),this.Ou.qa.Ka("SRO",this.HLd),this.Ou.qa.Ka("SBU",this.HLd));iH(this.aVb,this.CMd);mD(this.Ucc,this.Xz);PG(this.aVb,this.vId);iH(this.MBa,this.Gpb);this.MBa.Ua.Ka("OVI",
this.ELd);this.xd.qa.Ka("FFOD",this.iJd);this.DPb.qa.Ka("SE",this.mYb);qM(this.DPb,this.aQa);this.zd.ie()&&this.zd.ie().CMa&&(this.fUa(this,null),this.Nme(this,null));this.Fb.o1(this.$Hd);this.Fb.u_a(this.LR);GJb(this.zq,this.qYb);this.zq.qa.Ka("SR",this.qYb);uz(this.pa,this.iP)},jag:function(a,b){if(this.Em){if(b=(a=b.ju)&&a.Md())a=a.Md().Sg(),b=!!this.ra&&!!cV(this.ra)&&cV(this.ra).Sa(a);b&&Q2d(this.Em,y7(this.Bn))}},G3c:function(a){this.I6=this.gkb=a;this.Tn.G3c(a)},$ag:function(){this.Em&&R2d(this.Em)},
bag:function(a,b){if(this.Em)if(b=b.ju.Md()){var c=y7(this.Bn);if(c&&c.length){a=[];for(var d=c.length,e=0;e<d;++e){var f=c[e];f.anchorShape===b.get_shapeId()&&a.push(f)}b=this.Em;c=a.length;for(d=0;d<c;++d)for(var e=a[d],f=b.lia,g=f.length,h=0;h<g;++h){var k=f[h];k.wt.commentId===e.commentId&&k.WVa(S0d(b.Xa,k.wt.pos.X,k.wt.pos.Y))}}}else R(527501376,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")},F8f:function(){if(this.Eu){try{if(P2d(this)&&this.vM){var a=window.$$as(zxb,
this.vM);a&&(a.A5d=!!this.Oi)}}catch(b){R(527501377,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",b)}V2d(this);(a=U2d(this))&&a.status&&C7(this,1)}},G8f:function(){W2d(this);var a=!this.Sga()||!(this.g4()&&this.fia);K7(this,!1,!1,a)},e9f:function(a){this.Yib!==a&&(this.Yib=a,this.zd&&this.zd.ie()&&qxb(this.zd.ie(),2,!1,this.Yib))},xea:function(a){X2d(this,a)},Qbg:function(a,b){a=I7(b.xc);if(this.Gy()&&a&&(b.oh===o_a||b.oh===p_a||b.oh===q_a||b.oh===r_a)){var c=
x7(a);c&&Y2d(this);if(a.textAnchoringInfo&&!c&&(b.oh===r_a||b.oh===q_a)){b=this.A6;var d=Tzc(a.commentId),c=z7(this.Tn,a),e=this.zd.ie().Eb();if(!Qzc(b,a.commentId)){var f;if(f=c){a:{f=dP(c);for(var g=0,h=f.length,k=0;k<h;++k){var l=window.$$as(uv,Uy(f[k],e));if(l)for(var l=l.Xd().getElementsByClassName("NormalTextRun"),m=0;m<l.length;m++){var n=l[m],r=jl(n,"CommentStartGuids");r&&(g+=Wn(r,d)?1:0);(n=jl(n,"CommentEndGuids"))&&(g+=Wn(n,d)?1:0);if(2===g){d=!0;break a}}}d=!1}f=!d}f?Pzc(b,a,c,!0):Pzc(b,
a,c,!1)}}}},DW:function(a,b){if(b&&(a=window.$$as(TM,b.xc),b=b.NM,a&&2===b&&((b=this.yR.hg())&&b.Rj&&0>=b.Rj.length&&D7(this)&&o3d(this,!1,!1),this.Oi))){b=this.Oi.H6;!b&&this.ra.Ma()&&(b=this.ra.Ma().gc());a:{a=aH(a);for(var c=a.Jb(2);c;c=a.Rf(2))if((c=window.$$as(TN,c))&&CJ(c.gc(),b)){a=!0;break a}a=!1}a||Z2d(this)}},a3f:function(a,b){a=I7(b.xc);if(this.Gy()&&a&&x7(a)&&(b=z7(this.Tn,a))){b=dP(b);for(var c=b.length,d=0;d<c;++d)$2d(window.$$as(SD,b[d]),Tzc(a.commentId))}},X$f:function(a,b){a=window.$$as(YM,
b.xc);this.Gy()&&a&&0<dP(a).length&&(b.SFc&192||b.SFc&4)&&Y2d(this)},C_c:function(a,b){a=b.oh;b=b.xc;if(a===sq||a===tq)if(a=y7(this.Bn)){for(var c=a.length,d=0;d<c;++d){var e=a[d];e.pos.Y=LP(b).y;e.pos.X=LP(b).x}T2d(this)}},u_c:function(){R(527501399,805,this.Yhb()?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.Yhb())},GAb:function(a,b){R(527501400,805,this.Yhb()?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",M.lHa.toString(b.ZV),this.Yhb())},
ha:function(){this.Em&&(this.Em.ha(),this.Em=null);this.WNa&&(this.WNa.dispose(),this.WNa=null);this.Ou.qa.eb("BSS",this.E4a);zR(this.Ou,this.MOd);OGb(this.Ou,this.JFd);this.Ul.qa.eb("PVZC",this.BKd);this.uo.qa.eb("SNS",this.Hpb);this.uo.qa.eb("SND",this.BLd);this.Ou.qa.eb("OTE",this.JLd);this.Ou.qa.eb("SBC",this.Kpb);hH(this.MBa,this.Gpb);this.MBa.Ua.eb("OVI",this.ELd);this.xd.qa.eb("FFOD",this.iJd);hH(this.aVb,this.CMd);nD(this.Ucc,this.Xz);RG(this.aVb,this.vId);this.Fb.pCa(this.$Hd);this.DPb.qa.eb("SE",
this.mYb);wM(this.DPb,this.aQa);this.Fb.Znb(this.LR);this.dC||this.Yc.Sb("click",this.D2a,this.F4a);a3d(this);this.X6=this.D2a=null;this.zq.qa.eb("SA",this.qYb);this.zq.qa.eb("SR",this.qYb);SC(this.pa,this.iP)},r6:function(){return this.Ep},JLa:function(){return!!this.Oi},rog:function(a,b,c,d,e){if(1===c)return!this.ra.Ma()||b3d(this)?8:2;R(36983504,805,50,"New Comment Pane opened.");this.vM.jab(!!e&&e.AutoShowHide);return 2},qog:function(a,b,c,d,e,f){if(1===d)return a&&(b=this.A6,c=cV(this.ra),b.o7a===
window.Box4.App.hp&&(b.o7a=new Date,b.h9b("OnCollabCornerCommentsEnabled",b.o7a,c),Mzc("CollabCornerCommentsEnabled",b.o7a))),a?32:8;c3d(this,D7(this),!!f&&f.AutoShowHide);return a?32:8},rIf:function(a,b,c,d,e){if(1===c&&PU(this.pa))return 8;1!==c&&((this.rQb=!!e&&e.ShouldCanvasTakeFocus)||E7(this),uR(this.pa),this.wtd=!0);return 2},Peg:function(a,b,c,d){if(1===d&&(this.ENa||!this.p7))return 8;this.rQb=!1;return a?32:8},BLf:function(a,b,c,d){return(1!==d||!this.Ep&&this.p7)&&this.zd.ie()?a?32:8:8},
GB:function(a,b,c,d,e,f,g){uR(this.pa);b=U2d(this)?U2d(this).commentId:null;g||d3d(this);f?a?this.qY.GB(a.commentId):this.qY.GB(null):f||(f=z7(this.Tn,a))&&gP(f)&&(f=Qba.toString(gP(f)),$5(this.Tn.hY,f));this.Em&&this.Em.GB(a,!0);!D7(this)&&this.Eu&&a&&a!==this.gMa&&(f=n1d(this.Bn,a.commentId))&&(f=I7(f),this.Eu.selectContainer(f.commentId,!this.rQb&&!g&&!this.wtd),this.wtd=!1,this.zd&&this.zd.ie()&&CDb(this.zd.ie(),5,!1,this.Yib));g||this.rQb||E7(this);!this.Tn||!this.vM.lf()&&this.vM.lf()||(v0d(this.Tn,
a,b,!0,!1,g),x7(a)&&!g&&Y2d(this));this.Fb.Tf(!1)},k8a:function(a,b){if(this.gMa!==a){if(this.Tn)if(a){var c=this.Tn;if(c.vPb){var d=z7(c,a);if(d){if(c.Gy()||w7(c)!==d)(c.Gy()?!x7(a):x0d(c,a,d))?t0d(c,d,1,!1,!1):c.Vza=d}else u0d(c,1);n0d(c,a)}}else r0d(this.Tn);this.gMa=a;b&&(this.gMa?this.qY.myb(this.gMa.commentId):this.qY.myb(null));this.Em&&this.Em.k8a(this.gMa,!0)}},qN:function(a,b){b=!$H("FixAltF12KeboardingInCommentPane")||b;N2d(this,a,b,!0)},C8f:function(){this.Em&&!this.k1a&&R2d(this.Em);
T2d(this);I_(this)&&Uzc(this)},fUa:function(){this.fia=this.g4()||g3d(this);this.Tn&&this.fia&&(w0d(this.Tn),r0d(this.Tn));this.Fc.ia(S(195))&&(e3d(this),f3d(this))},Nme:function(){this.Fc.ia(S(195))||e3d(this);this.ra.Ma()||this.fUa(this,null);j1d(this.Bn);if(this.zd.ie()){var a=this.zd.ie().CMa;this.X6=a;this.Em&&(this.Em.Gk=a)}var a=this.zd&&this.zd.ie()?Q0d(this.Bn,this.zd.ie().ii()):y7(this.Bn),b;b=-1;if(this.Sza&&this.zd.ie())if(this.Sza.Pm!==this.zd.ie().ii())R(527501407,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(a&&0<a.length){if(D7(this))b=1===this.Sza.g_?0:a.length-1;else if(1===this.Sza.g_)for(var c=0;c<a.length;c++){if(!a[c].status){b=c;break}}else for(c=a.length-1;0<=c;c--)if(!a[c].status){b=c;break}if(0<=b&&b<a.length){var c=a[b],d=this.Sza.Comment;d.dt===c.dt&&d.commentId===c.commentId&&d.authorName===c.authorName||R(527501408,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide")}}c=this.g4()||g3d(this);!this.za.r7a||this.Fwc||c||(E3b(this.xq,"canvas","comments"),
this.Fwc=!0);D7(this)||(c?(W2d(this),V2d(this)):this.g4()?(W2d(this),K7(this,!0,!1,!0)):this.Sga()&&!this.fia?K7(this,!1,!1,!1):K7(this,!1,!1,!0),h3d(this));i3d(this,a,!1,b);this.Oi&&this.Oi.H6&&this.ra.Ma()&&this.Oi.vuc&&CJ(this.Oi.H6,this.ra.Ma().gc())?(G7(this,this.Oi.tPb||this.Oi.VJ.draftId,0,!1),this.Oi.vuc=!1):-1<b&&G7(this,a[b].commentId,0,!1);this.Sza&&(this.Sza.s3c.Sj(!1,null),this.Sza=null);this.Uva(!1);-1!==b&&this.Em&&(this.Em.k8a(null,!1),this.Em.GB(a[b],!1));this.Fc.ia(S(195))||f3d(this)},
PEf:function(){if(this.VBd){try{t2d(this.Bjb,this.mVe,this.ra,this.Le)}catch(a){R(527501404,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",a)}this.VBd=!1}},Uva:function(a){var b=Vzc(this);this.rPb.Uva(a,b)},xsg:function(a){this.Oi&&!this.Oi.H6&&(this.Oi.H6=a)},D_c:function(a,b){this.gkb&&(a=b.dz,j3d(this,a),this.Gy()&&a&&0<dP(a).length&&Y2d(this))},gag:function(a,b){this.gkb&&(a=b.ju.Md(),j3d(this,a),this.Gy()&&Y2d(this))},RK:function(a,b){if(this.Gy()&&
b&&b.gm&&vT(this.pa)&&(a=y7(this.Bn))){b=!1;for(var c=a.length,d=0;d<c;++d)if(x7(a[d])){b=!0;break}b&&((a=tT(this.pa))?j3d(this,a):R(527501405,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}},U$f:function(){if(this.gkb){var a=Wzc(this),a=String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,a.toString());$5(this.Tn.hY,a);C7(this,1)}},F_c:function(){this.gkb&&C7(this,1)},h5f:function(a,b){"document"===b.Rja&&(a=ResourceStrings.l_SlidePanel+
", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,Wzc(this).toString()),$5(this.Tn.hY,a));"document"===b.GRa&&C7(this,1)},Oge:function(){p1d(this.Bn)?this.Oi&&(this.Oi.Ji&&1!==this.Oi.Ji?this.Oi&&2===this.Oi.Ji&&this.I6&&i3d(this,y7(this.Bn),!0,-1):(this.I6&&i3d(this,y7(this.Bn),!0,-1),this.Oi.Ji||(this.oxc=!0))):i3d(this,y7(this.Bn),!0,-1)},H4c:function(){D7(this)||this.fa.Ab(1991203991,2,null);d3d(this)},Lk:function(a){return this.Dc.Lk(a)},k9d:function(){this.Pwc||(this.Pwc=
new Si(0,1,0,this.irf,90,"48",!1,0),this.ob.Vb(this.Pwc))},u2f:function(a){X2d(this,1===a.Ic())},rFa:function(a,b){if(this.Oi){if(this.Oi.VJ&&this.Oi.VJ.draftId!==a)throw R(527501443,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",a,this.Oi.VJ.draftId),EU(-2130915327);this.lKe=b}9!==b||D7(this)||this.Ia.vz("document");this.Oi=null;this.Fb.Tf(!1);if(this.Eu&&!D7(this)){var c,d=[(c=new F7,c.contentId=a,c.containerContentType=0,c.anchorTop=0,c.anchorLeft=
0,c)];this.Eu.detachContainers(d);this.g4()||K7(this,!1,!1,!0)}this.g3a.lsb&&W0d(this);R(527501444,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",a,b)},zae:function(a){if(L.ia("CommentCopyPasteEnabled")&&!this.Bjb.vQe)for(var b=a.length,c=0;c<b;++c)for(var d=H7(a[c].sS()),e=d.length,f=0;f<e;++f)if(1===d[f].status){this.mVe=new H2d(a,this.Bn);this.VBd=!0;return}},Wb:function(){this.Gy()&&1!==this.r1a.IN()&&(this.fa.ya(1016800201,1,this.iCc),this.fa.ua(775043447,
1,this.Zpb,97));this.Fc.ia("EnableDeleteAllComments")&&(this.fa.ya(469473574,1,this.dAc),this.fa.ya(1737510757,1,this.dAc),this.fa.ya(2766426586,1,this.dAc));this.fa.ya(410757179,1,this.iCc);this.fa.ua(847427893,2147483648,this.Zpb,97);this.fa.ua(922960965,1,this.Zpb,97);this.fa.ua(3845423030,1,this.Zpb,97);this.fa.ua(992822777,1,this.Zpb,97);this.fa.ya(3515478954,1,this.DXb);this.fa.ya(3239802471,1,this.DXb);this.fa.ya(2948875536,1,this.DXb);this.fa.ya(285353861,1,this.DXb);this.fa.ya(3853697946,
1,this.kwf);L.fc("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.fa.ya(567929329,1,this.QEd),this.fa.ya(36098707,1,this.vCd));this.Of()},Of:function(){var a=this.Ia.$c("main"),b=this.Ia.$c("EditingRTEView"),c=this.Ia.$c("SmartArtTextPaneFocus");a.kb(ag(123,1),3853697946);b.kb(ag(123,1),3853697946);c.kb(ag(123,1),3853697946);for(var a=this.Ia.$c("EditingCommentsPanelFocus"),b=[a,this.Ia.$c("EditingThumbnailsPanelFocus"),this.Ia.$c("EditingNotesPanelFocus"),this.Ia.$c("document"),this.Ia.$c("editing")],
c=b.length,d=0;d<c;++d){var e=b[d],f=Yf()?4:1;e.kb(ag(77,Il()|f),1221260928)}a.kb(ag(78,1),1221260928)},Wig:function(){this.Pwc=null;this.Oge()},a4f:function(){E7(this);uR(this.pa);return!1},q6b:function(){if(D7(this)){var a=this.kPa,b=new JFa;b.eventType=2;for(var c=0;c<a.JO.Qa();++c)Array.enqueue(a.JO.K(c).lAa,b);a7(a,!0)}},N1f:function(){return 32},PQc:function(a,b,c){var d;if(!this.Fc.ia("EnableDeleteAllComments")||this.Ep||this.Oi&&this.Oi.VJ)d=8;else if(1===c)d=m3d(this,a);else a:{switch(a){case 469473574:a=
this.Bn;b=Date.now();c=a.A6;c.Brd+=1;if(c=y7(a)){var e=a.Cb.qe(15,0,null,null,!1);try{e.Jc(a.ra.Ma());d=c.length;for(var f=0;f<d;++f)k1d(a,c[f].commentId,a.Aaa);e.xe(469473574)}finally{e&&e.dispose()}R(523845853,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-b)}else R(523845852,805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide");(d=y7(this.Bn))&&d.length?q2d():o2d(this.Bjb,ResourceStrings.l_DeleteAllCommentsOnSlideCallout);
break;case 1737510757:r2d(this.Bjb,this.Bn,!1);break;case 2766426586:r2d(this.Bjb,this.Bn,!0);break;default:R(527501452,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",a);d=2;break a}d=32}return d},tog:function(a,b,c,d,e){if(1===c)return!this.ra.Ma()||b3d(this)?8:32;c=!D7(this);b=this.kC.Di("UserAction",String.format("ShowHideComments: {0}",c?"ShowPane":"HidePane"));R(36983504,805,50,"New Comment Pane opened.");410757179===a?(a=!this.j1a,this.vM&&(this.j1a=
!b3d(this)&&a,this.j1a||(ySd(this.kPa,1),this.vM.Qo(!1,!1),DT(this.Ia,"EditingCommentsPanelFocus",!1))),n3d(this)):this.Gy()&&1016800201===a?(this.n1a=!this.n1a,this.Tn.v2b=this.n1a,n3d(this)):o3d(this,c,!!e&&e.AutoShowHide);b&&b.Lf();return 32},grg:function(){var a=this.Ia.kf().Nd;if(this.Oi&&this.Oi.VJ)return"document"===a?(E7(this),$H("FixAltF12KeboardingInCommentPane")||$H("SelectCommentDuringAlt12ActiveDraftEnable")&&D7(this)&&G7(this,this.Oi.VJ.draftId,1,!1)):this.Ia.Qf("document",!1),32;if(this.Tn.p3a||
w7(this.Tn)){if("document"===a||this.Gy()&&"SmartArtTextPaneFocus"===a){a=w7(this.Tn);if(!D7(this)){var b=0;a&&(b=a.get_shapeId());p3d(this,b,!1)}E7(this);return 32}if(Wn(this.jGe,a)){a=U2d(this);if(this.Gy()&&a&&x7(a)){if(b=o0d(a,w7(this.Tn)),b.Vf()){for(var c=[],d=0;d<b.rJ.length;d++){var e=b.rJ[d];e&&c.push(dW(e,b.OQ.Sa(e)?b.URa:0,b.z$.Sa(e)?b.IQa:Hy(e)))}var f=new dz(c,0,-1,null,null);if(a.textAnchoringInfo.AnchoringShape&&a.textAnchoringInfo.AnchoringShape.SmartArtNodeId){this.Ia.Qf("SmartArtTextPaneFocus",
!1);var g=this;this.kwd.pb(function(a){(a=window.$$as(LR,a.Bf()))&&s8a(g.kwd.Da(),window.$$as(mA,a),f)})}else this.Ia.Qf("document",!1),cz(this.pa,f)}}else this.Ia.Qf("document",!1);return 32}}else{if(Wn(this.jGe,a))this.Ia.Qf("document",!1);else{a=null;a=this.zd&&this.zd.ie()?Q0d(this.Bn,this.zd.ie().ii()):R0d(this,y7(this.Bn));if(!Xn(a))for(b=a.length,c=0;c<b;++c)if(d=a[c],D7(this)||!d.status){G7(this,d.commentId,1,!1);break}E7(this)}return 32}return 8},Aqe:function(){if(this.za.r7a&&!this.Fwc){ZI(this.xq,
"canvas","comments");YI(this.xq,"canvas","comments");this.Fwc=!0;var a=this.A6,b=cV(this.ra);a.j7a===window.Box4.App.hp&&(a.j7a=new Date,a.h9b("OnAllFloatingContainersVisible",a.j7a,b),Mzc("AllFloatingContainersVisible",a.j7a))}this.WF&&(a=this.WF,a.mc&&a.xt&&a.xt.Zc()&&(a.WF.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(a.CPd,600)))},g4:function(){var a=y7(this.Bn);if(!a||!a.length)return!1;a=kU(a,function(a){return!a.status});return!!a&&0<a.length},hhg:function(a,b,c,d,e){922960965===
a?e.On=D7(this):3845423030===a||847427893===a?e.On=D7(this):992822777===a?e.On=this.j1a:this.Gy()&&775043447===a&&(e.On=this.n1a);return!this.ra.Ma()||b3d(this)?16:32},Cfe:function(a,b,c,d,e){return 2!==c?32:(a=Xzc(e))&&Yzc(this,a)?32:8},qee:function(a,b,c,d,e){if(2!==c)return 32;if(b=a=Xzc(e))a:{if(a.sId!==this.zd.ie().ii().Pc()){b=BJ(a.sId,a.cId);b=G3d(this,b);if(!b){b=!1;break a}this.Le.s4(b.Sd)}(b=Yzc(this,a))?(1!==b.status&&2!==b.status||this.H4c(),G7(this,a.commentId,1,!1),b=!0):b=!1}return b?
32:8},jzf:null,Yhb:function(){return!!this.Oi},tIf:function(a){this.Oi&&q3d(this,a)},L_:function(a){if(2===a.UQ()&&1624461388===a.Sh&&(a=this.$o.O6b(!0),4124932790===a||3006547192===a||469473574===a||1737510757===a||2766426586===a)){var b=this;window.Common.UISurfaces.tS().then(function(a){var d=b.Bjb,e;H0(a,e={val:d.zrd});d.zrd=e.val;H0(a,a={val:d.Hia});d.Hia=a.val;d.zrd=null;d.Hia=null})}},K_:function(){}};
function Yzc(a,b){a=a.ra.Ed;if(!a)return null;a=a.Rj;if(!a)return null;for(var c=a.length,d=0;d<c;++d){var e=window.$$as(VN,a[d]);if(e&&e.Pc()===b.sId)for(var e=H7(e.sS()),f=e.length,g=0;g<f;++g){var h=e[g];if(h.commentId===b.commentId)return h;if(h.Children&&h.Children.length)for(var h=h.Children,k=h.length,l=0;l<k;++l){var m=h[l];if(m.commentId===b.commentId)return m}}}return null}
function Xzc(a){if(!a)return null;a=a.NavigationId;if(!a)return null;try{var b=JSON.parse(a);return window.parseInt(b.sId)===Number.NaN?null:b}catch(c){return R(523352019,805,10,"ExtractNavParams - Exception while parsing navigation id",c),null}}function r3d(a){var b=y7(a.Bn);b&&0<b.length&&(a.fMe=!0)}
function c3d(a,b,c){b&&!c?a.dC&&s3d()?d3d(a):(DT(a.Ia,"EditingCommentsPanelFocus",!0),E7(a),a.q6b()):c?b&&a.Ia.wS("EditingCommentsPanelFocus","main",a.vM,!1):0<Wzc(a)||a.Oi&&a.Oi.VJ?DT(a.Ia,"EditingCommentsContainersFocus",!0):DT(a.Ia,"EditingCommentsPanelFocus",!1);c||r3d(a)}
function m3d(a,b){switch(b){case 469473574:return y7(a.Bn)&&y7(a.Bn).length?32:8;case 1737510757:return s2d(a,!1)?32:8;case 2766426586:return 1!==a.r1a.IN()&&s2d(a,!0)?32:8;default:return R(527501451,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",b),2}}
function s2d(a,b){a=a.ra.Ed;if(!a)return!1;a=a.Rj;if(!a)return!1;for(var c=a.length,d=0;d<c;++d){var e=window.$$as(VN,a[d]);if(e)if(e=H7(e.sS()),b)for(var f=e.length,g=0;g<f;++g){if(1===e[g].status)return!0}else{if(e&&0<e.length)return!0}else R(527501449,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found")}return!1}function N2d(a,b,c,d){a.jtd=b;a.Fb.Tf(!1);($H("FixAltF12KeboardingInCommentPane")||!a.dC)&&a.jtd&&c&&a.q6b();b||d||C7(a,1)}
function W0d(a){a.kKe=!1;V0d(a.g3a,!1);a.Qmb&&(a.Ia.vz(D7(a)?"EditingCommentsPanelFocus":"EditingCommentsContainersFocus"),a.Qmb=!1)}function q3d(a,b){if(a.Oi){if(!a.Oi.VJ)throw R(527501446,805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",b),EU(-2130915320);a.rFa(a.Oi.VJ.draftId,b)}else R(527501447,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",b),a.rFa("",b)}
function E7(a){P2d(a)&&d3d(a);a.jtd?a.Oi&&a.g3a.lsb&&!t3d(a)&&a.Ia.vz("EditingRTEView"):a.Ia.vz(D7(a)?"EditingCommentsPanelFocus":"EditingCommentsContainersFocus")}
function i3d(a,b,c,d){a.s2=Di;!a.Em&&a.X6&&(a.Em=new u3d(a.X6,a,a.WNa,a.s2,a.j1a),a.Tn.I0b=a.Em);if(b){var e="";if(b){for(var f=b.length,g=0;g<f;++g){var h=b[g],e=e+(h.commentId+";");if(h.Children)for(var k=h.Children,l=k.length,m=0;m<l;++m)e+=k[m].commentId+";"}R(527501445,805,15,"LogCommentIds() - {0}",e)}var n=null;a.Gy()&&vT(a.pa)&&(n=a.pa.Ib());var r=0<b.length?b[b.length-1]:null;if(a.Em){var t=a.Em.XY?a.Em.XY.wt:null,v=t?t.commentId:null;a.Em.Dsc=a.s2;Q2d(a.Em,b);a.Tn&&(a.g4()||g3d(a))&&(w0d(a.Tn),
r0d(a.Tn));a.Em.GB(null,!1);if(a.Oi){var x=Y0d(a,a.Oi.tPb);a.Tn&&v0d(a.Tn,x,v,!1,!1,!1);a.Em.GB(x,!0)}else if(c&&t){var y=Y0d(a,t.commentId);a.Tn&&(D7(a)||!y||1!==y.status&&2!==y.status)&&(a.Em.GB(t,!1),v0d(a.Tn,t,v,!1,!0,!1))}else a.oxc&&r&&(G7(a,r.commentId,1,!1),a.Em.GB(r,!1));v3d(a.Em,a.n1a);a.n1a&&n0d(a.Tn,a.gMa)}a.bOa=b.length;b=R0d(a,b);var z,E=a.Lyd,H=b,O=a.Ep;if(null===H)throw Error.argumentNull("comments");for(var Q=new (Ca.$$(zAa)),U=H.length,V=0;V<U;++V){var Z=H[V];Q.ga(w3d(E,Z,"",O));
if(Z.Children&&0<Z.Children.length)for(var Y=Z.Children,ca=Y.length,la=0;la<ca;++la)Q.ga(w3d(E,Y[la],Z.commentId,O))}z=Q.Jd();a.p7=z;var ra,sa=a.Lyd,ua=b;if(null===ua)throw Error.argumentNull("comments");for(var xa=new (Ca.$$(DEa)),Ea=ua.length,Sa=0;Sa<Ea;++Sa){var Wa=ua[Sa];if(Wa.taskInfo&&Wa.taskInfo.Asignees&&0<Wa.taskInfo.Asignees.length){var Ga;var Va=sa,ya=Wa;if(Va.Duc&&Va.Dxc&&0<ya.taskInfo.TaskHistoryRecords.length)try{for(var jb,gb=ya.taskInfo.TaskHistoryRecords,Ab=gb.length,Eb=Array(Ab),
rb=0;rb<Ab;++rb){var kb=rb,ib=gb[rb],Pb=null;ib.User&&(Pb=new Eo(ib.User.UserId,ib.User.ProviderId,ib.User.DisplayName,""));var Xa=new CEa(x3d(ib.HistoryRecordType),Pb,ib.DtTime,ib.RecordId,!1);Xa.commentId=ib.CommentId;ib.Assignee&&(Xa.assignee=new Eo(ib.Assignee.UserId,ib.Assignee.ProviderId,ib.Assignee.DisplayName,""));ib.StartDate&&ib.DueDate?(Xa.schedule=new yEa,Xa.schedule.startDate=ib.StartDate?ib.StartDate:null,Xa.schedule.endDate=ib.DueDate?ib.DueDate:null):ib.StartDate&&!ib.DueDate?R(594338575,
845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!ib.StartDate&&ib.DueDate&&R(594338573,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Jb=ib.Priority;0<Jb?Xa.priority=Jb:R(594338571,845,10,"Priority is negative");var gd=ib.CompletionPercentage;0<=gd?Xa.completion=gd:R(594338569,845,10,"Percent complete is negative");Xa.title=ib.Title;Xa.undoId=ib.UndoId;Eb[kb]=Xa}jb=Eb;var bd=new (Da.$$(EEa));bd.ga(ya.commentId,
new EEa(ya.commentId,100===ya.taskInfo.CompletionPercentage));var Vd,hd=Va.Dxc,rc=ya.commentId,Vc=ya.commentId,Yb=jb,Fa=bd;if(!rc)throw u(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Vc)throw u(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Yb||!Yb.length)throw u(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Yb[0].type){var hc="First record must be a Create record.";u(42796184,327,
10,hc);throw Error.argument(hc);}for(var uc=[],Dc=null,id,Gd=Yb,Bd=new ($b.$$(String)),Fb=new ($b.$$(String)),Lc=Gd.length-1;0<=Lc;Lc--){var Wc=Gd[Lc],vd=Fb.Kc(Wc.recordId);vd||-1!==Wc.type||(Fb.Kc(Wc.undoId)?u(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Fb.ga(Wc.undoId));if(vd||-1===Wc.type)Bd.Kc(Wc.recordId)?u(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Bd.ga(Wc.recordId)}id=Bd;for(var $d=Yb.length,
fe=0;fe<$d;++fe){var sc=Yb[fe];if(!id.Kc(sc.recordId)){var jc=HSd(sc.commentId,Fa),cc,xc=hd,ie=sc,Xc=jc,Ge,Pc=ie,Wd=YEa(Pc.user),jd=new CEa(Pc.type,Wd,Pc.time,Pc.recordId,Pc.isLossy);jd.commentId=Pc.commentId;jd.anchorExtensionList=MSd(Pc.anchorExtensionList);jd.recordExtensionList=MSd(Pc.recordExtensionList);Pc.assignee&&(jd.assignee=YEa(Pc.assignee));if(Pc.schedule){var Xd=Pc.schedule,Le=new yEa;Le.startDate=Xd.startDate;Le.endDate=Xd.endDate;jd.schedule=Le}jd.completion=Pc.completion;jd.title=
Pc.title;jd.priority=Pc.priority;jd.undoId=Pc.undoId;Ge=jd;Ge.commentId=Xc;Ge.user=xc.Nkc.UHa(ie.user);Ge.assignee=xc.Nkc.UHa(ie.assignee);cc=Ge;if(1===cc.type){var kd=[];hd.Lka&&Dc&&Dc.ph&&(kd=Dc.ph.assignees);Dc=new lFa(hd.Leb,cc,hd.VIa,hd.TIa,hd.UIa,hd.Lka,kd);uc.push(Dc)}else if(Dc){var Cd=Dc,Yd=cc;switch(Yd.type){case 2:-1===KSd(Cd,Yd.assignee)&&Cd.ph.assignees.push(Yd.assignee);break;case 3:var Yc=KSd(Cd,Yd.assignee);0<=Yc&&Cd.ph.assignees.splice(Yc,1);break;case 4:Array.clear(Cd.ph.assignees);
break;case 5:Cd.ph.schedule=Yd.schedule;break;case 6:Cd.ph.completion=Yd.completion;break;case 9:Cd.ph.title=Yd.title;break;case 10:Cd.ph.priority=Yd.priority;break;case 0:Cd.ph.isLossy=!0;break;case 1:u(595198540,327,10,"Create record passed for state evaluation");break;case 7:Cd.H_b=!0;break;case 8:Cd.H_b=!1;break;case -1:u(51139905,327,10,"Undo record passed for state evaluation");break;default:Cd.ph.isLossy=!0}Yd.isLossy&&(Cd.ph.isLossy=!0);var Rd=Yd,Me=Cd.wDa[Cd.wDa.length-1],Zd=Me.records[Me.records.length-
1];Cd.Leb.Sa(Zd.user,Rd.user)&&Me.commentId===Rd.commentId&&Zd.time.getTime()===Rd.time.getTime()?Cd.wDa[Cd.wDa.length-1].records.push(Yd):mFa(Cd,Yd)}else throw hc="Undo resulted in ignoring of Task creation without also ignoring records after the create record.",u(595198539,327,10,hc),Error.argument(hc);}}var Te=null,we=[];if(Dc){Dc.H_b||(Te=Dc.ph);for(var Ue=null,Qb=uc.length,sd=0;sd<Qb;++sd){var Hd=uc[sd],ue;var Ne=Hd,fg=Ue;if(fg){var Ef=Array.clone(Ne.wDa),qf=Ef[0],rf=qf.records.shift();if(!Ne.FUc){var He=
ISd(Ne,rf,4);qf.records.unshift(He)}if(fg.ph.completion!==fg.UIa&&Ne.ph.completion===Ne.UIa){var zf=ISd(Ne,rf,6);zf.completion=Ne.UIa;qf.records.unshift(zf)}if(fg.ph.priority!==fg.TIa&&Ne.ph.priority===Ne.TIa){var Oe=ISd(Ne,rf,10);Oe.priority=Ne.TIa;qf.records.unshift(Oe)}if(!JSd(fg)&&JSd(Ne)){var dh=ISd(Ne,rf,5);dh.schedule=new yEa;qf.records.unshift(dh)}if(fg.ph.title!==fg.VIa&&Ne.ph.title===Ne.VIa){var Qh=ISd(Ne,rf,9);Qh.title=Ne.VIa;qf.records.unshift(Qh)}if(fg.H_b){var rh=ISd(Ne,rf,8);qf.records.unshift(rh)}ue=
Ef}else ue=Ne.wDa;Array.addRange(we,ue);Ue=Hd}}var Rh=HSd(Vc,Fa);if(Te){var Pe=Te,Af=Vc,sh=Te.completion,Bh=sh;if(Af&&Fa){var xe=void 0,df=void 0,Ch=void 0;(Ch=Fa.ng(Af,df={val:xe},null),xe=df.val,Ch)?(Bh=xe.ResolveState?100:100===sh?0:sh,Bh!==sh&&u(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",Af)):u(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",Af)}Pe.completion=Bh}Vd=new DEa(rc,Rh,Te,we);var Vf=ya,
Ji=Vd,Ff=Va.Duc,pe=Ji.currentState,Ie=Vf.taskInfo,Rg=!1,Gf=$H("SetTaskFromTaskStateInsteadOfHistory");Ie.StartDate.toString()!==pe.schedule.startDate.toString()&&(Gf&&(pe.schedule.startDate=Ie.StartDate),Rg=!0,R(592724131,845,10,"Start Date does not match. From Comment State: {0}  From History State:{1}",Ie.StartDate.toString(),pe.schedule.startDate.toString()));Ie.DueDate.toString()!==pe.schedule.endDate.toString()&&(Gf&&(pe.schedule.endDate=Ie.DueDate),Rg=!0,R(592724129,845,10,"End Date does not match. From Comment State: {0}  From History State:{1}",
Ie.DueDate.toString(),pe.schedule.endDate.toString()));Ie.CompletionPercentage!==pe.completion&&(Gf&&(pe.completion=Ie.CompletionPercentage),Rg=!0,R(592724127,845,10,"Completion percentage does not match. From Comment State: {0}  From History State:{1}",Ie.CompletionPercentage,pe.completion));Ie.Title!==pe.title&&(Gf&&(pe.title=Ie.Title),Rg=!0,R(592724125,845,10,"Title does not match. From Comment State: {0}  From History State:{1}",Ie.Title,pe.title));Ie.Asignees[0].UserId!==pe.assignees[0].UserId&&
(Gf&&(pe.assignees[0].UserId=Ie.Asignees[0].UserId),Rg=!0,R(592724123,845,10,"Assigned to user id does not match. From Comment State: {0}  From History State:{1}",Ie.Asignees[0].UserId,pe.assignees[0].UserId));Ie.Asignees[0].DisplayName!==pe.assignees[0].DisplayName&&(Gf&&(pe.assignees[0].DisplayName=Ie.Asignees[0].DisplayName),Rg=!0,R(592724121,845,10,"Assigned to display name does not match. From Comment State: {0}  From History State:{1}",Ie.Asignees[0].DisplayName,pe.assignees[0].DisplayName));
Ie.Asignees[0].ProviderId!==pe.assignees[0].Provider&&(Gf&&(pe.assignees[0].Provider=Ie.Asignees[0].ProviderId),Rg=!0,R(592724119,845,10,"Assigned to provider id does not match. From Comment State: {0}  From History State:{1}",Ie.Asignees[0].ProviderId,pe.assignees[0].Provider));Ie.Asignees[0].Email!==pe.assignees[0].Email&&(Gf&&(pe.assignees[0].Email=Ie.Asignees[0].Email),Ff||(Rg=!0,R(592724117,845,10,"Assigned to email does not match. From Comment State: {0}  From History State:{1}",Ie.Asignees[0].Email,
pe.assignees[0].Email)));if(Rg&&Ff){for(var wg=Vf,Dh=Ji,ki=new (Ca.$$(String)),Ki=Dh.history,Hf=Ki.length,Eh=0;Eh<Hf;++Eh)for(var Sh=Ki[Eh].records,Sg=Sh.length,wi=0;wi<Sg;++wi){var xg=Sh[wi].type;ki.ga(window.Common.Comments.HistoryRecordType.toString(xg))}var Tg=ki.Jd().join(" ");if(ki.Qa()!==wg.taskInfo.TaskHistoryRecords.length){for(var $h=new (Ca.$$(String)),gg=wg.taskInfo.TaskHistoryRecords,Fh=gg.length,Mb=0;Mb<Fh;++Mb)xg=gg[Mb].HistoryRecordType,$h.ga(window.Common.Comments.HistoryRecordType.toString(xg));
var If=$h.Jd().join(" ");R(545136792,845,10,"LogTaskHistoryDetailsForMismatch Task History {0}, Shared Task History {1}",If,Tg)}}Ga=Vd}catch(ou){R(594338567,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",ou.message),Ga=null}else{var ig=new yEa;ig.startDate=ya.taskInfo.StartDate;ig.endDate=ya.taskInfo.DueDate;var th=new Eo(ya.taskInfo.Asignees[0].UserId,"","","");th.DisplayName=ya.taskInfo.Asignees[0].DisplayName;th.Provider=ya.taskInfo.Asignees[0].ProviderId;th.Email=ya.taskInfo.Asignees[0].Email;
var hg=Array(1);hg[0]=th;Ga=new DEa(ya.commentId,ya.commentId,new AEa(!1,ya.taskInfo.Title,hg,ig,ya.taskInfo.CompletionPercentage,0),[])}Ga&&xa.ga(Ga)}}ra=xa.Jd();a.m3a=ra;if(c){a.Uva(!0);var Pf=a.qY,jg=Array.clone(a.p7),bj=Array.clone(a.m3a);$6(Pf,BSd(jg,a.bOa,bj));a7(Pf,!1);a.oxc&&r&&a.qY.GB(r.commentId)}else{var eh=[];if(g3d(a))var fh=Gzc(a,!1),Li,eh=[(Li=new FFa,Li.draftId=a.Oi.VJ.draftId,Li.insertIndex=0>d?0:fh,Li)];if(0>d){var Ij=a.qY;$6(Ij,ASd(a.p7.length,a.bOa,a.Ep,a.rPb.y6a,eh));a7(Ij,!1)}else{var uh=
a.qY,zj=a.bOa,yi=a.Ep,qm=eh,un=new HFa;un.numberOfComments=a.p7.length;un.numberOfThreads=zj;un.selectedThreadIndex=d;var rm;un.contextDetails=(rm=new GFa(yi),rm.nextPopulatedContextDetails=0,rm);un.contextDrafts=qm;un.rehydrationDrafts=null;$6(uh,new Io(0,un));a7(uh,!1)}var xl=a.qY,ni=Array.clone(a.p7),fl=Array.clone(a.m3a);$6(xl,CSd(ni,fl));a7(xl,!1)}if(a.Dvc){var zi=Y0d(a,a.Dvc);zi&&(a.GB(zi,null,!0,!0,0,1,!1),a.Dvc=null)}else n&&cz(a.pa,n);var dk=y3d(a,b);if(a.oY&&dk&&a.oY.Qa()>dk.length&&a.Eu&&
dk){for(var Oi=a.oY.Jd(),fj=Oi.length,Qk=0;Qk<fj;++Qk){for(var Ih=Oi[Qk],sm=!1,Ap=dk,Vo=Ap.length,Wo=0;Wo<Vo;++Wo)if(Ih.contentId===Ap[Wo].commentId){sm=!0;break}sm||(a.Eu.detachContainers([Ih]),a.oY.Mc(Ih),R(527501394,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Ih.contentId))}a.g4()||a.JLa()||K7(a,!1,!1,!0)}z3d(a,dk);if(a.irc&&(a.irc=!1,!a.Tn.p3a&&!w7(a.Tn)&&a.zd.ie()))for(var Ul=Q0d(a.Bn,a.zd.ie().ii()),vn=Ul.length,Mm=0;Mm<vn;++Mm){var Xo=Ul[Mm];if(!Xo.status){a.GB(Xo,null,
!0,!0,0,0,!1);break}}a.oxc=!1}else{var nu=a.qY;$6(nu,ASd(0,0,a.Ep,1,null));a7(nu,!1);var at=a.qY;$6(at,CSd([],[]));a7(at,!1);a.bOa=0;a.Em&&(a.Em.Dsc=a.s2,Q2d(a.Em,null));a.p7=null;a.m3a=null;A3d(a,!1,!1);W2d(a)}}
function Gzc(a,b){var c=a.zd&&a.zd.ie()?Q0d(a.Bn,a.zd.ie().ii()):R0d(a,y7(a.Bn));if(!c||!c.length)return 0;var d=null;M0d(a)&&(d=S0d(a,M0d(a).x,M0d(a).y));for(var e=-1,f=0,g=0;g<c.length;g++){var h=z7(a.Tn,c[g]);if(!d&&h)break;if(h&&d){var k=LP(h).x,l=LP(h).y,k=k+c[g].pos.X,l=l+c[g].pos.Y;EP(h)&&(h=a.$a.qw(h),k+=h&&LP(h)?LP(h).x:0,l+=h&&LP(h)?LP(h).y:0);l=S0d(a,k,l);k=l.y;l=l.x;if(d.y<k)break;if(d.y>k||d.y===k&&d.x>=l)e=g,c[g].Children&&b&&(f+=c[g].Children.length)}else h||(e=g,c[g].Children&&b&&
(f+=c[g].Children.length))}return e+f+1}function F0d(a){return a.m3a?a.m3a:[]}function E0d(a){return a.p7?a.p7:[]}function X2d(a,b){a.Ep=b;a.k9d();$H("PreventCommentPaneCloseOnReadOnlyChanged")?Z2d(a):D7(a)&&a.Ep&&D7(a)&&a.fa.Ab(1991203991,2,null)}function b3d(a){return(a=a.yR.hg())?a.aib():!0}
function f3d(a){if(!a.fMe){var b=y7(a.Bn),b=!!b&&0<b.length;R(527501411,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",b);b?a.g4()&&K7(a,!0,!1,!0):(W2d(a),a.Sga()&&!a.fia?K7(a,!1,!1,!1):K7(a,!1,!1,!0))}}
function L2d(a){var b=new B3d;s3d()&&(b.focusCallback=a.w5e);var c;return c=new Im,c.title=ResourceStrings.L_Comments,c.hideHeader=!1,c.width=window.parseInt(s3d()?300:320),c.contentProps=b,c.location=2,c.onOpen=function(b){Gxa(b,["contextmenu"]);var c=a.Ia.$c("EditingCommentsPanelFocus");a.Yc.EB("click",b,a.F4a,null,c.n_a,!1)},c.onClose=function(b){o3d(a,!1,!1);a.Yc.Sb("click",b,a.F4a)},c.isModernPane=!0,c}
function K7(a,b,c,d){var e=a.g4();d&&(!e&&!a.fia||e&&a.fia)&&R(527501409,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!a.g4()&&!a.JLa()&&b&&!c||D7(a)&&b&&!c||a.g4()&&a.WF&&a.WF.lf()&&!b&&!c||!a.zd.ie()||!(c=a.zd.ie().xt)||(c.Gf(b),b=new cJb(b),a.Ou.qa.Ha("CCVC",b,null),d?a.Fb.jab(1):R(527501410,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),
CDb(a.zd.ie(),5,!1,a.Yib))}function A3d(a,b,c){a.vM&&(c||r3d(a),ySd(a.kPa,b?3:1),K7(a,!b,!1,!0),a.vM.Qo(!b3d(a)&&b,c),a.vM.lf()&&(a.j1a=!0))}
function O0d(a){if(!vT(a.pa))return null;var b=window.$$as(KN,a.pa.Ib().Bb().Hf().na);if(!b)return null;var c=window.$$as(uv,Uy(b,a.zd.ie().Eb()));if(!c)return null;var d=null,e=c.Xd().getElementsByClassName("Selected");if(0<e.length)d=e[e.length-1];else if(a.pa.Ib().jt){if(e=C3d(a))if(e=window.$$as(KN,e.Hf().na))e!==b?(b=window.$$as(uv,Uy(e,a.zd.ie().Eb())))&&(d=b.Xd()):d=c.Xd()}else return null;b=cR(a.pa);if(!b||!d)return null;b=window.$$as(tQ,Uy(b,a.zd.ie().Eb()));if(!b)return null;d=$l(d);b=$l(b.tt());
if(0>=d.width+d.height&&0>=b.width+b.height)return null;b=OJ(new pJ(d.x,d.y),new pJ(b.x,b.y));return D3d(a,b.x+d.width-5,b.y+10)}function M0d(a){var b=cR(a.pa);if(b){var c=LP(b);a.qBd=new pJ(Di?c.x:c.x+rU(b),c.y)}else a.qBd=null;return a.qBd}function Wzc(a){a=y7(a.Bn);var b=[];a&&(b=kU(a,function(a){return!a.status}));return b.length}
function p3d(a,b,c){var d=y7(a.Bn);if(d){for(var e=null,f=null,g=0,h=null,k=d.length,l=0;l<k;++l){var m=d[l];if((D7(a)||!m.status)&&m.anchorShape===b)if(a.Gy()&&vT(a.pa)&&x7(m)){var n=a.pa.Ib().Bb().hb(),r=a.pa.Ib().Bb().Hf(),t=o0d(m,z7(a.Tn,m));if(t&&t.Vf()){var v;if(v=U2d(a)&&U2d(a).commentId===m.commentId||t.Ttb===m.textAnchoringInfo.TextBodyLength)if(v=t,v.Vf()){var x=window.$$as(SD,n.na),y=window.$$as(SD,r.na);v=!(x&&y&&Array.contains(v.rJ,x)&&Array.contains(v.rJ,y))||x.Sa(v.OQ)&&(0>n.mb||n.mb<
v.URa)||y.Sa(v.z$)&&(0>r.Uc||r.Uc>v.IQa)?!1:!0}else v=!1;v&&(f?(t=k2d(t),t<g&&(f=m,g=t)):(f=m,g=k2d(t)))}else e=m,R(527501406,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null.")}else if(!f&&!h)if(a.Gy())x7(m)||(h=m);else{h=m;break}}f?G7(a,f.commentId,1,c):h?G7(a,h.commentId,1,c):a.Gy()&&vT(a.pa)&&!e?a.Tn&&C7(a,1):e&&G7(a,e.commentId,1,c)}}function j3d(a,b){b.get_shapeId()&&(a.Tn&&b!==w7(a.Tn)&&C7(a,1),p3d(a,b.get_shapeId(),!0))}
function e3d(a){a.ENa=!1;j1d(a.Bn);a.Em&&E3d(a.Em);a.Qmb=!1;a3d(a)}function D7(a){return a.vM.lf()}function o3d(a,b,c){A3d(a,b,c);n3d(a);c3d(a,b,c)}function n3d(a){!a.dC&&a.vM&&(a.D2a.style.display=a.vM.lf()?"flex":"none");a.Em&&(a.Em.Gf(a.j1a),v3d(a.Em,a.n1a),n0d(a.Tn,a.gMa))}function C7(a,b){b&&a.qY.GB(null);a.Em&&a.Em.GB(null,!1);if(a.Eu&&(a.Eu.deselectContainer(),a.zd&&a.zd.ie())){var c=5,d=cR(a.pa);d&&JO(d)&&(c=2);CDb(a.zd.ie(),c,!1,a.Yib)}a.Tn&&b&&(w0d(a.Tn),r0d(a.Tn));a.Fb.Tf(!1)}
function Vzc(a){var b=-1;if(!a.Oi)return b;a.Oi.H6?(a=G3d(a,a.Oi.H6))&&(b=a.Sd):a.zd.ie()&&a.zd.ie().ii()&&(b=a.zd.ie().ii().Sd);return b}
function F3d(a,b,c,d,e){wI(e,"FindCommentEndTime",new Date);a.ob.Vb(new Si(2,1,100,function(){if(a.ENa){a.ENa=!1;var f;if(a.Oi&&a.Oi.VJ.sessionType===Ho.nc)if(f=Vzc(a),0>f)f=!1;else if(c&&b){var g=a.zd.ie().ii().Sd;if(1===d){var h=f<=g&&g<b.Sd,g=b.Sd<=g&&g<f;f=f<=b.Sd&&!h||g}else h=f>=g&&g>b.Sd,g=b.Sd>=g&&g>f,f=f>b.Sd&&!h||g}else f=!0;else f=!1;if(f)G7(a,a.Oi.tPb||a.Oi.VJ.draftId,0,!1);else if(c&&b&&a.zd.ie().ii())if(b.gc().Sa(a.zd.ie().ii().gc()))a.GB(c,null,!0,!0,2,1,!1),iI(e,"CircularSelectCommentInSingleSlide",
M.S4b.toString(d)),e.Sj(!1,null);else{var k;a.Sza=(k=new a2d,k.Pm=b,k.Comment=c,k.g_=d,k.s3c=e,k);a.Le.s4(b.Sd)}else a.Fb.Tf(!1),iI(e,"NoCommentFound",M.S4b.toString(d)),e.Sj(!1,null)}},90,"47",!1,0))}function a1d(a){if(!a.ENa){var b=dI("SelectPreviousCommentCrossSlide",1),c=!D7(a);a.ENa=!0;a.wkb.iSc(function(c,e){F3d(a,c,e,0,b)},b,c)}}function $0d(a){if(!a.ENa){var b=dI("SelectNextCommentCrossSlide",1),c=!D7(a);a.ENa=!0;a.wkb.gSc(function(c,e){F3d(a,c,e,1,b)},b,c)}}
function U2d(a){return a.Em&&a.Em.XY?a.Em.XY.wt:null}function G7(a,b,c,d){!t3d(a)||b!==a.Oi.VJ.draftId&&b!==a.Oi.tPb?g3d(a)&&b===a.Oi.VJ.draftId?(a.qY.GB(b),a.Eu&&a.Eu.selectContainer(b,!0)):a.GB(Y0d(a,b),null,!0,!0,0,c,d):(b=G3d(a,a.Oi.H6),b)?1!==c&&(a.Oi.vuc=!0,a.Le.s4(b.Sd)):(R(527501401,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),a.rFa(a.Oi.VJ.draftId,0))}function Y0d(a,b){a=B7(a.Bn,b);return I7(a)}
function D3d(a,b,c){return new pJ(hD(a.eTb,b,0),hD(a.eTb,c,1))}function S0d(a,b,c){return new pJ(kA(a.eTb,b,0),kA(a.eTb,c,1))}
function J2d(a){var b=new (wa.$$(w.fN.T4b,Go)),c=new Go(1221260928,1);c.preCallback=a.$Wb;c.postCallback=a.mGd;b.ea(0,c);c=new Go(869210402,1);c.preCallback=a.$Wb;c.postCallback=a.mGd;b.ea(3,c);c=new Go(3774691014,1);c.preCallback=a.$Wb;c.postCallback=a.nNd;b.ea(2,c);c=new Go(1216077466,1);c.preCallback=a.$Wb;c.postCallback=a.nNd;b.ea(1,c);c=new Go(2281051331,1);c.preCallback=a.Euf;c.postCallback=a.Duf;c.delayActionsUntilRegistration=L.fc("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&
$H("DelayCommentsShowHideAction");b.ea(6,c);return b}function Z2d(a){if(a.Oi&&a.p7){var b=a.qY;$6(b,ASd(a.p7.length,a.bOa,a.Ep,a.rPb.y6a,null));a7(b,!1);var b=a.qY,c=Array.clone(a.p7),d=Array.clone(a.m3a);$6(b,CSd(c,d));a7(b,!1);q3d(a,2)}}
function Y2d(a){if(a.Gy()){var b=y7(a.Bn);if(b){for(var c=Date.now(),d=!1,e=new (Wb.$$(String,b2d))(null),f=b.length,g=0;g<f;++g){var h=b[g],k=o0d(h,z7(a.Tn,h));e.ea(h.commentId,k)}for(var g=b.length,l=0;l<g;++l)if(h=b[l],h.textAnchoringInfo&&(f=z7(a.Tn,h)))if(k=e.K(h.commentId),!k||!k.Vf()||Szc(k,h.textAnchoringInfo))for(var k=dP(f),m=k.length,n=0;n<m;++n)f=k[n],$2d(window.$$as(SD,f),Tzc(h.commentId));g=b.length;for(l=0;l<g;++l)if(h=b[l],(k=e.K(h.commentId))&&k.Vf()&&Szc(k,h.textAnchoringInfo)&&
(D7(a)||!h.status)){d=Tzc(h.commentId);I3d(a,k.OQ,d,k.URa,!0);if(j2d(k))for(h=1;h<k.rJ.length;h++){if(f=k.rJ[h])I3d(a,f,d,0,!0),k.z$.Sa(f)?I3d(a,k.z$,d,k.IQa,!1):I3d(a,f,d,Hy(f),!1)}else I3d(a,k.z$,d,k.IQa,!1);d=k;if(d.Vf()&&(d.OQ.gv(16,!0),j2d(d)))for(h=1;h<d.rJ.length;h++)(k=d.rJ[h])&&k.gv(16,!0);d=!0}d&&R(527501398,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-c)}}}
function I3d(a,b,c,d,e){for(var f=null,g=0;g<b.Ra.Ba();g++){var h=b.Ra.K(g);if(h.lc>=d){try{b.bta=!0;if(h.lc>d||!h.yb)a.gM.e0(b,g,d,f),h=b.Ra.K(g);J3d(h,c,e)}catch(l){R(527501396,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",l.toString())}finally{b.bta=!1}return}h.yb&&(f=h.yb)}if(Hy(b)>=d)try{b.bta=!0;a.gM.e0(b,b.Ra.Ba(),d,f);var k=b.Ra.K(b.Ra.Ba()-1);J3d(k,c,e)}catch(l){R(527501397,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",
l.toString())}finally{b.bta=!1}}function Tzc(a){return Lm("{"+a+"}{1}")}function J3d(a,b,c){a.Eh||nE(a,new xD(a));var d=a.Eh.or().Jf();b=new uD(a.Eh.or(),null,b,c,null,null);a.Eh.ga(b);d.Gr()}
function $2d(a,b){for(var c=0;c<a.Ra.Ba();c++){var d=a.Ra.K(c);if(d.Eh){for(var e=[],f=0;f<d.Eh.Ba();f++){var g=d.Eh.K(f);g.$h.Sa(b)&&e.push(g)}if(!(1>e.length))try{a.bta=!0;for(var h=e.length,f=0;f<h;++f)g=e[f],d.Eh.Mc(g)}catch(k){R(527501395,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",k.toString())}finally{a.bta=!1}}}}
function R0d(a,b){if(!b)return null;b.sort(function(b,d){var e=z7(a.Tn,b),e=e?LP(e):new pJ(0,0),f=z7(a.Tn,d),f=f?LP(f):new pJ(0,0);e.y+=b.pos.Y;f.y+=d.pos.Y;e.x+=b.pos.X;f.x+=d.pos.X;var g=e.y-f.y;g||(g=e.x-f.x)||(g=b.dt-d.dt);return g});return b}function W2d(a){if(a.Eu){for(var b=a.oY.Jd(),c=b.length,d=0;d<c;++d)a.Eu.detachContainers([b[d]]);a.oY.Qe()}a.g4()||a.JLa()||(a.Sga()&&!a.fia?K7(a,!1,!1,!1):K7(a,!1,!1,!0))}
function N0d(a){if(!(a.DOb()||a.Fc.ia("CommentTextAnchoringReadWriteEnabled")&&K3d(a))||!vT(a.pa))return null;R(527501384,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var b=0,c=0,d;if(a.pa.Ib().jt){if(d=C3d(a),!d)return R(527501385,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null}else d=a.pa.Ib().Bb();if(!d)return R(527501386,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),
null;var e,f,g,h=(g=M3d(tT(a.pa),d,e={val:b},f={val:c}),b=e.val,c=f.val,g);if(!h||0>b||0>c||0>=c-b)return R(527501387,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!h,c,b),null;e=new vea;e.StartPos=b;e.EndPos=c;if(uT(a.pa)&&h.get_smartArtModelId()){R(527501388,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");e.AnchoringShape=new Xba;b=Qm(h.get_smartArtModelId()).toString();
if(!b||!ko(b))return R(527501389,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!b),null;e.AnchoringShape.SmartArtNodeId=b;b=a.A6;b.GVb+=1}else if(h.SI()){R(527501390,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");c=window.$$as(pN,KU(h));if(!c)return R(527501391,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;b=iV(c).toString();
c=c.faa().toString();if(!(b&&c&&ko(b)&&ko(c)))return R(527501392,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!b,!c),null;e.AnchoringShape=new Xba;e.AnchoringShape.TableCell=new sea;e.AnchoringShape.TableCell.RowId=b;e.AnchoringShape.TableCell.ColId=c;b=a.A6;b.HVb+=1}b=window.$$as(KN,d.hb().na);d=window.$$as(KN,d.Hf().na);b!==d&&(a=a.A6,a.RWb+=1);R(527501393,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");
return e}function C3d(a){var b=a.pa.Ib().Bb();a=tB(a.pa.Ib());if(!b||!a)return null;var c=window.$$as(KN,b.hb().na),d=window.$$as(KN,a.hb().na);if(!c||!d)return null;c=window.$$as(pN,KU(c));d=window.$$as(pN,KU(d));return c&&d?c.hi()>d.hi()?b:a:null}function G3d(a,b){a=a.ra.Ed;if(!a)return null;a=a.Rj;if(!a)return null;for(var c=a.length,d=0;d<c;++d){var e=window.$$as(VN,a[d]);if(CJ(e.gc(),b))return e}return null}
function K3d(a){a=a.ra.Ed;if(!a)return!1;a=a.Rj;if(!a)return!1;for(var b=a.length,c=0;c<b;++c){var d=window.$$as(VN,a[c]);if(d)for(var d=H7(d.sS()),e=d.length,f=0;f<e;++f)if(x7(d[f]))return!0}return!1}function d3d(a){if(P2d(a)&&a.vM&&a.vM.lf()){a=a.vM;try{a.dC?a.Obc():a.VCd.Obc("EditingCommentsPanelFocus")}catch(b){R(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",b)}}}
function Z0d(a,b){if(a.Eu&&a.oY){for(var c=a.oY.$$lge();c.$$mn();){var d=c.$$cu();d.contentId===b&&(a.Eu.detachContainers([d]),a.oY.Mc(d))}a.g4()||a.JLa()||K7(a,!1,!1,!0)}}
function U0d(a,b){if(b&&!b.Ji){var c=0;if(I_(a))c=-a.Xha,Uzc(a);else{var d=cR(a.pa);d&&(c=S0d(a,0,LP(d).y).y)}var e,c=(e=new F7,e.contentId=b.VJ.draftId,e.containerContentType=0,e.anchorTop=c,e.anchorLeft=0,e);K7(a,!0,!0,!0);a.Eu.setDhcContainerPanel(N3d(a),a.s2);a.Eu.updateDrafting(c,!0);a.Eu.selectContainer(b.VJ.draftId,!0)}}
function Uzc(a){if(a.Eu){var b;a.zd&&a.zd.ie()&&a.zd.ie().ii()?(b=a.zd.ie().ii(),window.isNaN(b.Dm())?b=a.Xha:(b=b.Dm(),b=0>b?a.Xha:b)):b=a.Xha;b!==a.Pdd&&(a.Pdd=b,a.Eu.setSlideHeight(b))}}function Hzc(a,b){var c=z7(a.Tn,b);b=b.pos.Y;c&&(b+=LP(c).y,EP(c)&&(c=a.$a.qw(c),b+=c&&LP(c)?LP(c).y:0));return S0d(a,0,b).y}function y3d(a,b){if(!b||!b.length)return b;for(var c=new (Ca.$$($ba)),d=b.length,e=0;e<d;++e){var f=b[e];f.status?Z0d(a,f.commentId):c.ga(f)}return c.Jd()}
function z3d(a,b){if(a.zd.ie()&&a.Vsd){if(!a.Eu)try{O3d(a),R(527501379,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!a.Eu)}catch(m){R(527501380,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",m);return}var c=Date.now();if((b=y3d(a,b))&&b.length){var d=N3d(a);d.setAttribute("role","group");if(d){var e=new (Ca.$$(F7));if(b){I_(a)&&Uzc(a);for(var f=b.length,g=0;g<f;++g){var h=b[g];if(h.commentId){var k=
Hzc(a,h),l,h=(l=new F7,l.contentId=h.commentId,l.containerContentType=0,l.anchorTop=k,l.anchorLeft=0,l);e.ga(h)}}}a.oY=e;R(527501381,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",a.oY.Qa());if(!a.oY.Qa()&&!a.JLa()){K7(a,!1,!1,!0);R(527501382,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-c);return}a.Eu.setDhcContainerPanel(d,a.s2);a.Eu.attachContainers(a.oY.Jd());K7(a,!0,!1,!0)}R(527501383,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-c)}}}function N3d(a){return(a=a.zd&&a.zd.ie()?a.zd.ie().xt:null)?a.Zc():null}function a3d(a){if(a.Eu){var b=N3d(a);b&&a.Yc.Sb("click",b,a.F4a)}}function h3d(a){if(a.Eu){var b=N3d(a);if(b){var c=a.Ia.$c("EditingCommentsContainersFocus");a.Yc.EB("click",b,a.F4a,null,c.n_a,!1)}}}function T2d(a){var b=y7(a.Bn);z3d(a,b)}
function W1d(a){O3d(a);K7(a,!0,!1,!0);a.Vsd=!0;var b=N3d(a);Gxa(b,["contextmenu"]);if(a.Eu){a.Eu.setDhcContainerPanel(b,a.s2);var c,d=(c=new P3d,c.width=window.parseFloat(b.style.width),c.height=a.Xha,c.x=0,c.y=0,c);a.Eu.updateViewport(d);a.Eu.setCompactContainers(I_(a))}T2d(a);Rzc(a.A6,cV(a.ra));c=a.Ia.$c("EditingCommentsContainersFocus");c.wK=!0;c.n_a=!0;Tl(c,function(b){N2d(a,!0,!b||"EditingRTEView"!==b.Nd,!0)});Sl(c,function(b,c){b=("ReactTransientUI"===c.Nd||"EditingRibbonPanelFocus"===c.Nd)&&
"EditingCommentsContainersFocus"===b.Nd;c="EditingCommentsPanelFocus"===c.Nd||"document"===c.Nd||"EditingRTEView"===c.Nd||"EditingCommentsContainersFocus"===c.Nd||P2d(a)&&"TabbedTaskPaneFocus"===c.Nd||b;N2d(a,!1,!1,c)});P0b(a.Ia,"EditingCommentsContainersFocus",b);h3d(a);a.fa.ya(1991203991,2147483648,a.iCc)}
function V1d(a){a.Fc.ia("PPTSafeLinksIsEnabledForModernComments")&&a.MVe.pb(function(a){var c=window.sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();c?c.registerSafelinksNavigator(a.Rwf||(a.Rwf=Function.createDelegate(a,a.Jdc))):R(527501378,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}
function O3d(a){var b,c=(b=new Q3d,b.paneClosedCallback=a.Tif,b.paneOpenedCallback=a.Uif,b.positionsUpdatedScrollHeightCallback=a.ejf,b);a.za.r7a&&(c.allContainersVisibleCallback=a.MWd);a.Eu=window.floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(c)}function V2d(a){if(a.Eu&&a.Eu.isIntegratedExtensionEnabled()){var b=y7(a.Bn),c=!a.Sga()||!a.fia;b&&0<b.length&&(K7(a,!0,!0,c),T2d(a));g3d(a)&&U0d(a,a.Oi)}}
function g3d(a){return a.Oi&&a.ra.Ma()?!a.Oi.H6||CJ(a.Oi.H6,a.ra.Ma().gc()):!1}function t3d(a){return a.Oi&&a.Oi.H6&&a.ra.Ma()?!CJ(a.Oi.H6,a.ra.Ma().gc()):!1}function I_(a){return a.Fc.ia("EnableCompactingDHCs")}function s3d(){return!!G()&&!!G().rb()&&G().rb().tib()}function P2d(a){return a.Fc.ia("PptReactTabbedTaskPanesM2IsEnabled")}function Y1d(a){return a.Fc.Va("CurrentSlideId")}function X1d(a){return a.Fc.Va("CurrentCommentId")}
function J1d(a,b,c){this.sGf=/\<\@(.*?)\>|\[\@(.*?)\]/;this.N_f=/(?:https?:\/\/|www\.)[^\s]+/gi;this.tGf=/(\<\@.*?\>|\[\@.*?\]|(?:https?:\/\/|www\.)[^\s]+)/gi;this.Fc=a;this.Dxc=b;this.Duc=c}function x3d(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}
J1d.prototype={GFg:"[",Ufe:!1,Fc:null,Dxc:null,Duc:!1,f0a:function(){return ye(this.Fc)[S(387)]},U_a:function(){return ye(this.Fc)[S(388)]},uZf:function(a){return a.userId?"Author"===a.userId||this.f0a()===a.userId&&this.U_a()===a.providerId?!0:!1:!1}};
function I0d(a,b){var c=Sys.Serialization.JavaScriptSerializer.deserialize(a);a=[];b||(b=new Date);for(var d=new Sys.StringBuilder,c=c.ops,e=c.length,f=0;f<e;++f){var g=c[f];if(g.attributes){var h;if(g.attributes.atmention){var k=1<g.insert.length?g.insert.substring(1,g.insert.length):"";if(g.optional&&g.optional.atmention)h=1===g.attributes.atmention.resolveState?"[@"+k+"]":"<@"+k+">";else{h=1===g.attributes.atmention.resolveState?"[@"+k+"]":"<@"+k+">";var l;l=1===g.attributes.atmention.resolveState;
var m=b._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);l=l?m+"_Z":m;var n;Array.add(a,(n=new aca,n.FullName=g.attributes.atmention.fullName,n.DispName=k,n.Id=l,n.Email=g.attributes.atmention.email,n));b=new Date(b.getTime()+1)}}else g.attributes.link||R(36259077,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),h=g.insert;d.append(h)}else d.append(g.insert)}return new R3d(d.toString(),a)}
function w3d(a,b,c,d){if(null===b)throw Error.argumentNull("comment");var e,f=b.text;if(null===f)throw Error.argumentNull("nativeText");e=new rFa;for(var f=f.split(a.tGf),g=f.length,h=0;h<g;++h){var k=f[h],l=a.sGf.exec(k);if(l&&3===l.length){var m=new UEa;l[0].substring(0,1)===a.GFg?(m.fullName=l[2],m.resolveState=1):(m.fullName=l[1],m.resolveState=0);m.email="UnknownEmail";var n=new WEa;n.contentId="Pre-existing Mention";var l=e,k="@"+m.fullName,r=m,m=n,n={};n.fullName=r.fullName;n.email=r.email;
n.resolveState=r.resolveState;r={};r.atmention=n;k=FSd(k,r);m&&(r={},r.contentId=m.contentId,m={},m.atmention=r,k.optional=m);Array.add(l.Mdb.ops,k);a.Ufe||(a.Ufe=!0,R(37504223,845,15,"Rendering mention when AtMentions are disabled."))}else if((l=a.N_f.exec(k))&&1===l.length){var m=l[0],t,l=e,k=m,n=(t=new XEa,t.link=m,t),m={};m.link=n.link;r=m;700<=n.weight&&(r.weight=n.weight);n.italic&&(r.italic=!0);n.underline&&(r.underline=!0);n.strikethrough&&(r.strikethrough=!0);n.highlight&&(r.highlight=n.highlight);
n.color&&(r.color=n.color);n.paragraph&&(r.paragraph=n.paragraph);Array.add(l.Mdb.ops,FSd(k,m))}else a:{l=e;m=l.Mdb.ops;if(m.length&&(r=m.length-1,n=m[r],!n.attributes)){n.insert+=k;m[r]=n;l.Mdb.ops=m;break a}l={};l.insert=k;Array.add(m,l)}}e=Sys.Serialization.JavaScriptSerializer.serialize(e.Mdb);f=b.authorName;g=$H("PPTPlumbEmailThroughCG")?bFa(b.userId||""):"";t=b.dt;h=0;if(1===b.status||2===b.status)h|=8;d&&(h|=1);""===b.userId||"Author"===b.userId||3!==b.userId.split("::").length||a.f0a()===
b.userId&&a.U_a()===b.providerId||(h|=16);d=h;a=new jma(b.userId,b.providerId,f,g,a.uZf(b));return new zAa(b.commentId,c,e,a,t,d,null)}function I1d(a,b,c){this.yNa=!!L&&L.ia("PptReactTabbedTaskPanesM2IsEnabled")&&L.ia("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.Ia=a;this.Eg=b;this.DMa=c}I1d.prototype={Ia:null,Eg:null,DMa:null,lsb:!1};
function V0d(a,b){b?(a.yNa&&a.DMa&&a.DMa.lf()||Fl(a.Eg,"EditingRTEView"),Gl(a.Eg,"EditingCommentsPanelFocus"),a.Ia.vz("EditingRTEView")):(Gl(a.Eg,"EditingRTEView"),a.DMa.lf()&&!a.yNa&&Fl(a.Eg,"EditingCommentsPanelFocus"));a.lsb=b}function J7(a,b,c){this.openView=this.OpenView;this.closeView=this.CloseView;this.invokeModalConfirmationDialog=this.InvokeModalConfirmationDialog;this.Xa=a;this.Ia=b;this.identifier=c}J7.prototype={Xa:null,Ia:null,containerType:"full-pane",identifier:null};
J7.prototype.SIf=function(){o3d(this.Xa,!1,!1)};J7.prototype.CloseView=J7.prototype.SIf;J7.prototype.gdg=function(){o3d(this.Xa,!0,!1)};J7.prototype.OpenView=J7.prototype.gdg;
J7.prototype.bZf=function(a,b,c){var d=new Dj;c&&c.title&&c.body&&c.confirmButton&&c.cancelButton||(R(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),c=new LFa("","","",""));Ej(d,1);Fj(d,1,c.confirmButton);Fj(d,0,c.cancelButton);d.ogc=this.Ia.kf().Nd;d.bgd=!0;tm(d,c.title,c.body,1,function(c){1===c?(a(),d.ogc=null):b()},null)};J7.prototype.InvokeModalConfirmationDialog=J7.prototype.bZf;
function R1d(a,b,c,d,e){this.yNa=!!L&&L.ia("PptReactTabbedTaskPanesM2IsEnabled");this.dispose=this.ha;this.dC=e;this.Sy=a;this.Fb=b;this.dC||(this.HBa=document.createElement("div"),this.HBa.className="CommentPanel",this.HBa.style.position="absolute");this.mc=!1;this.IG=c;this.VCd=d}
R1d.prototype={Sy:null,Fb:null,HBa:null,mc:!1,IG:!1,VCd:null,dC:!1,pKe:null,ha:function(){},MF:function(a,b){if(this.yNa)return a;if(null===a)throw Error.argumentNull("availableArea");var c=b?dM(a,this.$f()):cM(a,this.$f());this.mc&&(b?dM(c,1):cM(c,1));this.dC||gM(this.HBa,c);return a},Qo:function(a,b){this.mc=a;this.yNa?this.dC?this.yN(this.mc):this.VCd.yN(this,this.mc,ResourceStrings.L_Comments,"EditingCommentsPanelFocus"):(this.Fb.jab(this.IG&&b?1:2),this.Sy.Tf(!1))},yN:function(a){var b=this;
window.Common.UISurfaces.rw().then(function(c){a?c.showTaskPane("EditingCommentsPanelFocus",b.pKe):c.hideTaskPane("EditingCommentsPanelFocus",2);return null}).catch(function(b){R(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",b.toString(),a.toString())})},Obc:function(){window.Common.UISurfaces.rw().then(function(a){a.setSelectedTaskPane("EditingCommentsPanelFocus",2);return null}).catch(function(a){R(572339909,833,10,"CommentsPane::SelectPane exception: {0}",a.toString())})},
A5d:!1,jab:function(a){this.Fb.jab(this.IG&&a?1:2)},lf:function(){return this.mc},Zc:function(){return this.HBa},aM:function(){return 18},$f:function(){return this.mc?M2d.KFg+1:0}};function K2d(a,b){a.pKe=b}Type.registerNamespace("PowerPointWeb.Comments");KT=window.PowerPointWeb||{};KT.fN=KT.fN||{};function z1d(){}z1d.registerInterface("PowerPointWeb.Comments.ICommentGraphManager");function Lzc(){}Lzc.registerInterface("PowerPointWeb.Comments.ICommentTelemetryManager");function K1d(){}K1d.registerInterface("PowerPointWeb.Comments.ISharedCommentModelTranslator");
function E1d(){}E1d.registerInterface("PowerPointWeb.Comments.ICommentMarkerViewElementFactory");function B1d(){}B1d.registerInterface("PowerPointWeb.Comments.ICommentMarkerAnchorHelper");function C1d(){}C1d.registerInterface("PowerPointWeb.Comments.ICommentMarkerPositionHelper");function B4d(){}B4d.registerInterface("PowerPointWeb.Comments.ICommentMarkerViewElement");function D1d(a,b,c){this.vO=a;this.zd=b;this.jrc=c}
function C4d(a,b,c){if(b&&c%360){var d=new pJ(a.x+Z7.x,a.y+Z7.y);D4d(d,c,b.Hg());a.jx(d.x-Z7.x,d.y-Z7.y)}}function D4d(a,b,c){qJ(a,0-c.x,0-c.y);var d=Math.PI/180*b;b=a.x*Math.cos(d)-a.y*Math.sin(d);d=a.x*Math.sin(d)+a.y*Math.cos(d);a.jx(b+c.x,d+c.y)}D1d.prototype={vO:null,zd:null,jrc:null};
function E4d(a,b,c){if(!b)throw Error.argumentNull("commentMarkerViewElement");if(!c)throw Error.argumentNull("comment");if(!B7(a.jrc,c.commentId))return u(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",c.commentId),new pJ(0,Number.MIN_VALUE);var d=b.Hz();b=b.epc();var e=window.$$as(OM,B7(a.jrc,c.commentId));if(!e)throw u(595203538,805,10,"There is no graph node for comment {0}",c.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");if(!wSd(e)||!c.pos.X&&
!c.pos.Y){if(d)return a=new pJ(d.sc()-d.zc()-F4d.ld-G4d.ld,G4d.Ld),C4d(a,d,b),a;if(a.zd.ie()&&XU(a.zd.ie()))return new pJ(XU(a.zd.ie()).clientWidth-F4d.ld,0);u(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new pJ(0,0)}a=new pJ(kA(a.vO,c.pos.X,0),kA(a.vO,c.pos.Y,1));a=new pJ(a.x-Z7.x,a.y-Z7.y);d&&(a.x=Math.max(0,a.x),a.y=Math.max(0,a.y),a.x=Math.min(a.x,d.sc()-d.zc()-F4d.ld),a.y=Math.min(a.y,d.rc()-d.Bc()-
F4d.Ld),C4d(a,d,b));return a}function R3d(a,b){this.Vab=a;this.qXc=b}R3d.prototype={Vab:null,qXc:null};function B3d(){}B3d.prototype={type:"SharedCommentsTaskPaneProps",focusCallback:null};function M2d(){}function u3d(a,b,c,d,e){this.lia=[];if(!a)throw Error.argumentNull("parentElement");if(!b)throw Error.argumentNull("frame");this.WNa=c;this.Gk=a;this.Xa=b;this.Dsc=d;this.Iud=e}
u3d.prototype={ha:function(){E3d(this);this.Xa=this.Gk=null},g4:function(a){if(!this.Sga())return!0;if(!a||!a.length)return!1;a=kU(a,function(a){return!a.status});return!!a&&0<a.length},GB:function(a,b){if(!(!a&&!this.XY||this.XY&&H4d(a,this.XY.wt))&&(this.XY&&this.XY.Mbc(!1),this.XY=null,a))for(var c=this.lia,d=c.length,e=0;e<d;++e){var f=c[e];if(H4d(f.wt,a)){this.XY=f;f.Mbc(!0);break}if(b&&f.wt.Children)for(var g=f.wt.Children,h=g.length,k=0;k<h;++k)if(H4d(g[k],a)){this.XY=f;f.Mbc(!0);return}}},
k8a:function(a,b){if(!(!a&&!this.Cza||this.Cza&&H4d(a,this.Cza.wt))&&(this.Cza&&this.Cza.bda(!1),this.Cza=null,a))for(var c=this.lia,d=c.length,e=0;e<d;++e){var f=c[e];if(H4d(f.wt,a)){this.Cza=f;f.bda(!0);break}if(b&&f.wt.Children)for(var g=f.wt.Children,h=g.length,k=0;k<h;++k)if(H4d(g[k],a)){this.Cza=f;f.bda(!0);return}}},Azb:function(a,b){b=D3d(this.Xa,b.x,b.y);a.pos.X+=b.x;a.pos.Y+=b.y;b=new pJ(a.pos.X,a.pos.Y);this.Xa.GB(a,null,!0,!1,0,1,!1);this.Xa.Bn.Azb(a.commentId,b)},Gf:function(a){this.Iud=
a;for(var b=this.lia,c=b.length,d=0;d<c;++d){var e=b[d];e.Gf(!(this.Gy()&&x7(e.wt))&&a)}},XY:null,Cza:null,WNa:null,Gk:null,Xa:null,Dsc:!1,Iud:!1,Gy:function(){return!!L&&L.ia("CommentTextAnchoringUIEnabled")},Sga:function(){return!!L&&L.ia("SlideResizePerfImprovementEnabled")}};function R2d(a){for(var b=a.lia,c=b.length,d=0;d<c;++d){var e=b[d];e.WVa(S0d(a.Xa,e.wt.pos.X,e.wt.pos.Y))}}function v3d(a,b){a=a.lia;for(var c=a.length,d=0;d<c;++d)a[d].jle(b)}
function Q2d(a,b){E3d(a);if(b&&a.Gk){for(var c=a.Xa.r6()?null:a.Xa.Jo,d=b.length,e=0;e<d;++e){var f=b[e],g=a.Gy()&&x7(f)||!a.Iud;a.lia.push(a.WNa.nc(f,a.Gk,a,c,a.Xa.r6(),g))}a.g4(b)&&R2d(a)}}function E3d(a){a.XY=null;a.Cza=null;if(a.lia&&0<a.lia.length){for(var b=a.lia,c=b.length,d=0;d<c;++d){var e=b[d];e&&e.ha()}Array.clear(a.lia)}}function I4d(a,b){this.Cjb=a;this.H7=b}
I4d.prototype={KC:function(){return!0},ex:function(a){if(!a)return!1;this.VBa=this.Cjb.lh().style;this.hzd=new pJ(a.get_clientPoint().x,a.get_clientPoint().y);this.jBa=new pJ(window.parseInt(this.VBa.left),window.parseInt(this.VBa.top));this.pz(a);return!0},pz:function(a){if(!a)return!1;a=J4d(new pJ(a.get_clientPoint().x,a.get_clientPoint().y),this.hzd);this.VBa.left=FL(this.jBa.x+a.x);this.VBa.top=FL(this.jBa.y+a.y);return!0},op:function(a){if(a){a=J4d(new pJ(a.get_clientPoint().x,a.get_clientPoint().y),
this.hzd);var b=this.jBa.x+a.x,c=this.jBa.y+a.y,d=this.Cjb.Hz();d&&(b=Math.max(d.zc(),b),b=Math.min(d.sc()-this.Cjb.lh().clientWidth,b),c=Math.max(d.Bc(),c),c=Math.min(d.rc()-this.Cjb.lh().clientHeight,c),a.x=b-this.jBa.x,a.y=c-this.jBa.y);this.VBa.left=FL(b);this.VBa.top=FL(c);this.Cjb.lge(a)}},uw:function(){this.VBa.left=FL(this.jBa.x);this.VBa.top=FL(this.jBa.y)},hzd:null,jBa:null,Cjb:null,H7:null,VBa:null};function J4d(a,b){a=OJ(a,b);return new pJ(a.x,a.y)}
function K4d(a,b,c,d,e,f,g,h){this.Vpb=Function.createDelegate(this,this.e1c);this.Sob=Function.createDelegate(this,this.eXc);this.Tob=Function.createDelegate(this,this.tGa);this.S7=Function.createDelegate(this,this.FK);if(!b)throw Error.argumentNull("parentElement");this.VMa=h;this.wt=a;this.Tl=c;this.F6=d;this.Ny=e;this.nkb=g;this.Rl=document.createElement("div");this.Rl.className=L4d(a)?this.Ny.uIc:this.Ny.tIc;this.Rl.title=ResourceStrings.L_CommentMarkerTooltip;this.Rl.style.display=this.nkb||
this.VMa?"none":"block";this.Rl.setAttribute("data-pptcommentid",String.format("{0}",a.commentId));this.Lx=document.createElement("img");this.Lx.alt=ResourceStrings.L_CommentMarkerTooltip;this.Lx.src=c.Xa.Lk("per.png");this.Lx.setAttribute("role","button");this.Rl.appendChild(this.Lx);this.bIa();this.Tl.Xa.Yc.Wa("click",this.Rl,this.S7);Xf()||(hh(this.Rl,"mouseover",this.Tob),hh(this.Rl,"mouseout",this.Sob));(gi()||Ok())&&hh(this.Lx,"mousedown",this.Vpb);b.appendChild(this.Rl);f||this.gQc()}
K4d.prototype={Rl:null,Lx:null,wt:null,Tl:null,W1:null,F6:null,Ny:null,ZMa:!1,YMa:!1,nkb:!1,VMa:!1,ha:function(){this.Lx&&((gi()||Ok())&&oi(this.Lx,"mousedown",this.Vpb),this.Tl.Xa.Yc.Sb("click",this.Rl,this.S7),this.Lx.parentNode&&this.Lx.parentNode.removeChild(this.Lx),this.Lx=null);if(this.Rl){Xf()||(oi(this.Rl,"mouseover",this.Tob),oi(this.Rl,"mouseout",this.Sob));if(this.F6){var a=this.F6;a.it&&rl(a,!0);this.F6.WC(this.Rl,this.W1)}this.Rl.parentNode&&this.Rl.parentNode.removeChild(this.Rl)}this.Tl=
this.wt=null},lh:function(){return this.Rl},gQc:function(){this.F6&&(this.W1=new I4d(this,B().H(vL,null)),this.F6.xH(this.Rl,this.W1,!1))},WVa:function(a){this.Rl.style.left=FL(a.x-(this.Tl.Dsc?this.Ny.M0b:0));this.Rl.style.top=FL(a.y)},lge:function(a){this.Tl.Azb(this.wt,a)},Mbc:function(a){this.ZMa=a;this.bIa()},bda:function(a){this.YMa=a;this.bIa()},jle:function(){},Gf:function(a){this.Rl.style.display=a&&!this.VMa?"block":"none"},bIa:function(){this.VMa||(this.Lx.className=L4d(this.wt)?this.ZMa?
ck("per",this.Ny.L0b):this.YMa?ck("per",this.Ny.vIc):ck("per",this.Ny.wIc):this.ZMa?ck("per",this.Ny.K0b):this.YMa?ck("per",this.Ny.J0b):ck("per",this.Ny.H6a))},Hz:function(){return null},epc:function(){return 0},FK:function(a){if(a.Jr)return!1;this.Tl.Xa.GB(this.wt,null,!1,!0,a.ye,1,!1);a=a.xb;a.preventDefault();a.stopPropagation();return!0},tGa:function(){this.Tl.Xa.k8a(this.wt,1)},eXc:function(){this.Tl.Xa.k8a(null,1)},e1c:function(a){a.preventDefault()}};
function F1d(a,b,c,d,e,f){this.dispose=this.ha;this.Laa=a;this.Djb=b;this.Ny=c;this.k1a=e;this.VMa=f;var g=this;C0d(d).then(function(a){a||g.c4c(!1)})}
F1d.prototype={Laa:null,Djb:null,Ny:null,k1a:!1,VMa:!1,ha:function(){this.Ny=null},nc:function(a,b,c,d,e,f){if(this.k1a){var g;a:{g=this.Laa;if(null===a)throw Error.argumentNull("comment");var h=q0d(g,a);if(h&&(g=g.hl(h))){g=g.Zc().Ja;break a}g=null}return new M4d(a,g||b,c,d,this.Ny,this.Laa,this.Djb,e,f)}return new K4d(a,b,c,d,this.Ny,e,f,this.VMa)},c4c:function(a){this.VMa=this.k1a=a;this.Ny.c4c(a)}};function H4d(a,b){return a||b?a&&b?a.commentId===b.commentId:!1:!0}
function L4d(a){return!!a.Children&&0<a.Children.length}function x7(a){return!!a&&!!a.textAnchoringInfo&&a.textAnchoringInfo.EndPos>a.textAnchoringInfo.StartPos&&0<a.textAnchoringInfo.TextBodyLength}
function o0d(a,b){if(!x7(a))return null;if(!b||1>dP(b).length)return R(574179520,805,b?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!b),null;var c=null,d=null,e=null;a.textAnchoringInfo.AnchoringShape&&(a.textAnchoringInfo.AnchoringShape.TableCell?(c=Qm(a.textAnchoringInfo.AnchoringShape.TableCell.RowId),d=Qm(a.textAnchoringInfo.AnchoringShape.TableCell.ColId)):a.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&
(e=a.textAnchoringInfo.AnchoringShape.SmartArtNodeId,e.startsWith("{")||(e="{"+e),e.endsWith("}")||(e+="}")));var f=a.textAnchoringInfo.StartPos;a=a.textAnchoringInfo.EndPos;var g=0,h=0,k=new b2d;b=dP(b);for(var l=0;l<b.length;l++){var m=b[l],n=Hy(window.$$as(SD,m));if(c&&d){var r=KU(m);if(!r||!c.Sa(iV(r))||!d.Sa(r.faa()))continue}else if(e&&(!m.get_smartArtModelId()||e!==m.get_smartArtModelId()))continue;if(!k.Vf()&&(n>f||k.OQ)){if(!k.OQ){var r=k,t=window.$$as(SD,m);r.OQ=t;r.rJ=[];r.rJ.push(r.OQ);
k.URa=f;if(!k.OQ)return null}!(r=l===b.length-1)&&(r=!!e)&&(r=e,t=b[l+1],r=t.get_smartArtModelId()&&t.get_smartArtModelId()===r?!1:!0);if(!r&&(r=!!c&&!!d))var r=c,t=d,v=KU(b[l+1]),r=v&&r.Sa(iV(v))&&t.Sa(v.faa())?!1:!0;r=n<a&&0<n&&r;if((n>=a||r)&&!k.z$){if(r&&(a=n),r=k,t=window.$$as(SD,m),r.z$=t,r.rJ&&j2d(r)&&r.rJ.push(r.z$),k.IQa=a,!k.z$)return null}else m.Sa(k.OQ)||(r=window.$$as(SD,m),k.rJ&&r&&k.rJ.push(r))}g+=n+1;m=m.fe+"\r";for(r=0;r<m.length;r++)t=m.charCodeAt(r),160===t&&(t=32),h=(h<<5>>>0)+
h+t;k.OQ||(f-=n+1);a-=n+1}k.Ttb=g;k.Stb=h;return k}
function M3d(a,b,c,d){c.val=d.val=-1;if(!a)return R(554574735,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),null;var e=window.$$as(KN,b.hb().na),f=window.$$as(KN,b.Hf().na);if(!e||!f)return R(554574736,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",!e,!f),null;var g=XB(b.hb(),!0),h=XB(b.Hf(),!1),k=Hy(b.hb().na);b=Hy(b.Hf().na);if(0>g||0>=h||g===h&&e===f||g>k||h>b)return R(554574737,
805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",g,h,k,b),null;a=dP(a);if(!a)return R(554574738,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),null;k=0;b=a.length;for(var l=0;l<b;++l){var m=a[l];if(f.get_smartArtModelId()){if(m.get_smartArtModelId()!==f.get_smartArtModelId())continue;e.get_smartArtModelId()!==f.get_smartArtModelId()&&
(e=m)}if(f.SI()){if(KU(m)!==KU(f))continue;KU(e)!==KU(f)&&(e=m)}e===m&&(c.val=g+k);f===m&&(d.val=h+k);if(0<=c.val&&0<=d.val)return e;k+=m.fe.length+1}0<=c.val&&-1===d.val&&(e.get_smartArtModelId()||e.SI())&&(d.val=k-1);return e}
function G1d(a){this.M0b=27;var b;this.M0b=20;b=a?a="SharedCommentBubble":a="SharedCommentBubbleSelected";this.H6a=$7(this,"SharedCommentBubble");this.J0b=$7(this,"SharedCommentBubbleHover");this.K0b=$7(this,a);this.wIc=$7(this,"SharedCommentBubble");this.vIc=$7(this,"SharedCommentBubbleHover");this.L0b=$7(this,b);this.tIc="ModernCommentMarkerElementSingle cui-img-cont-float";this.uIc="ModernCommentMarkerElementWithReplies cui-img-cont-float"}
G1d.prototype={tIc:null,uIc:null,M0b:0,H6a:null,J0b:null,K0b:null,wIc:null,vIc:null,L0b:null,c4c:function(a){var b=a?this.H6a:"SharedCommentBubbleSelected";a=a?this.H6a:b;this.K0b=$7(this,b);this.L0b=$7(this,a)}};function $7(a,b){return String.format("{0}_{1}x{2}x32",b,a.M0b,a.M0b)}
function M4d(a,b,c,d,e,f,g,h,k){this.Vpb=Function.createDelegate(this,this.e1c);this.Sob=Function.createDelegate(this,this.eXc);this.Tob=Function.createDelegate(this,this.tGa);this.S7=Function.createDelegate(this,this.FK);if(!b)throw Error.argumentNull("parentElement");this.wt=a;this.Tl=c;this.F6=d;this.Ny=e;this.Laa=f;this.Djb=g;this.nkb=k;this.Rl=document.createElement("div");this.Rl.className=L4d(a)?this.Ny.uIc:this.Ny.tIc;Sys.UI.DomElement.addCssClass(this.Rl,"CommentMarker");this.Rl.title=ResourceStrings.L_CommentMarkerTooltip;
this.Rl.style.display="none";this.Rl.setAttribute("data-pptcommentid",String.format("{0}",a.commentId));this.Lx=document.createElement("img");this.Lx.alt=ResourceStrings.L_CommentMarkerTooltip;this.Lx.src=c.Xa.Lk("per.png");this.Lx.setAttribute("role","button");this.Rl.appendChild(this.Lx);this.bIa();this.Tl.Xa.Yc.Wa("click",this.Rl,this.S7);Xf()||(hh(this.Rl,"mouseover",this.Tob),hh(this.Rl,"mouseout",this.Sob));(gi()||Ok())&&hh(this.Lx,"mousedown",this.Vpb);b.appendChild(this.Rl);h||this.gQc()}
M4d.prototype={Rl:null,Lx:null,wt:null,Tl:null,W1:null,F6:null,Ny:null,Laa:null,Djb:null,ZMa:!1,YMa:!1,nkb:!1,TLe:!1,ha:function(){this.Lx&&((gi()||Ok())&&oi(this.Lx,"mousedown",this.Vpb),this.Tl.Xa.Yc.Sb("click",this.Rl,this.S7),this.Lx.parentNode&&this.Lx.parentNode.removeChild(this.Lx),this.Lx=null);if(this.Rl){Xf()||(oi(this.Rl,"mouseover",this.Tob),oi(this.Rl,"mouseout",this.Sob));if(this.F6){var a=this.F6;a.it&&rl(a,!0);this.F6.WC(this.Rl,this.W1)}this.Rl.parentNode&&this.Rl.parentNode.removeChild(this.Rl)}this.Tl=
this.wt=null},lh:function(){return this.Rl},gQc:function(){this.F6&&(this.W1=new I4d(this,B().H(vL,null)),this.F6.xH(this.Rl,this.W1,!1))},WVa:function(){var a=E4d(this.Djb,this,this.wt);this.Rl.style.left=a.x+"px";this.Rl.style.top=a.y+"px"},lge:function(){var a=this.Djb,b=this.wt,c=new pJ(this.lh().offsetLeft,this.lh().offsetTop),c=new pJ(c.x+Z7.x,c.y+Z7.y),d=this.Hz();d&&this.epc()%360&&D4d(c,0-this.epc(),d.Hg());b.pos.X=hD(a.vO,c.x,0);b.pos.Y=hD(a.vO,c.y,1);a.jrc.Azb(b.commentId,new pJ(b.pos.X,
b.pos.Y))},Mbc:function(a){this.ZMa=a;this.bIa();this.Pla()},bda:function(a){this.YMa=a;this.bIa();this.Pla()},jle:function(a){this.TLe=a;this.bIa();this.Pla()},Gf:function(a){this.nkb=!a;this.Pla()},Pla:function(){!this.nkb&&(this.ZMa||this.YMa||this.TLe)?(this.WVa(S0d(this.Tl.Xa,this.wt.pos.X,this.wt.pos.Y)),this.Rl.style.display="block",Od(this.Rl,"CommentsHighlightAnimation")):(this.Rl.style.display="none",L0b(this.Rl,"CommentsHighlightAnimation"))},Hz:function(){return v1d(this.Laa,this.wt)},
epc:function(){var a;a:{a=this.Laa;var b=this.wt;if(null===b)throw Error.argumentNull("comment");if(b.anchorShape&&(b=q0d(a,b))&&(a=a.hl(b))){a=a.jK;break a}a=0}return a},bIa:function(){this.Lx.className=L4d(this.wt)?this.ZMa?ck("per",this.Ny.L0b):this.YMa?ck("per",this.Ny.vIc):ck("per",this.Ny.wIc):this.ZMa?ck("per",this.Ny.K0b):this.YMa?ck("per",this.Ny.J0b):ck("per",this.Ny.H6a)},FK:function(a){if(a.Jr)return!1;this.Tl.Xa.GB(this.wt,null,!1,!0,a.ye,1,!1);a=a.xb;a.preventDefault();a.stopPropagation();
return!0},tGa:function(){this.Lx.className=ck("per",this.Ny.J0b)},eXc:function(){this.Lx.className=ck("per",this.Ny.H6a)},e1c:function(a){a.preventDefault()}};Type.registerNamespace("FloatingContainerManager");(function(){}).registerInterface("FloatingContainerManager.IFloatingContainerManager");function Q3d(){}Q3d.prototype={paneClosedCallback:null,paneOpenedCallback:null,positionsUpdatedCallback:null,positionsUpdatedScrollHeightCallback:null,allContainersVisibleCallback:null};Type.registerNamespace("FloatingContainer");
function F7(){}F7.prototype={contentId:null,containerContentType:0,anchorTop:0,anchorLeft:null,anchorRight:null,anchorBottom:null};function P3d(){}P3d.prototype={width:0,height:0,x:0,y:0};Type.registerNamespace("RichContentEditAPI");(function(){}).registerInterface("RichContentEditAPI.IRichContentEditAPIConsumer");k0d.registerClass("PowerPointWebEditor.CommentAnchoringHighlightsHelper");A7.registerClass("PowerPointWebEditor.CommentAPI",null,h_d);
c1d.registerClass("PowerPointWebEditor.CommentContextDetailsUpdateHelper",null,e_d);g1d.registerClass("PowerPointWebEditor.CommentKeyboardMoveController");h1d.registerClass("PowerPointWebEditor.CommentManager",null,z1d,dWb,Sys.IDisposable);u1d.registerClass("PowerPointWebEditor.CommentMarkerAnchorHelper",null,B1d);H_d.registerClass("PowerPointWebEditor.CommentsPackage",null,yo,ec);Kzc.registerClass("PowerPointWebEditor.CommentTelemetryManager",null,Lzc);
Q1d.registerClass("PowerPointWebEditor.CommentPropertyTracker",Fob);x1d.registerClass("PowerPointWebEditor.CommentEditor",null,f_d);a2d.registerClass("PowerPointWebEditor.CommentSelectContext");P1d.registerClass("PowerPointWebEditor.CommentsChangeListener",null,Sys.IDisposable);T0d.registerClass("PowerPointWebEditor.CommentSmartReplyHelpers");S1d.registerClass("PowerPointWebEditor.CommentSmartReplyProvider");H1d.registerClass("PowerPointWebEditor.CommentTextAnchorHighlightActor",Frb);b2d.registerClass("PowerPointWebEditor.TextAnchorParagraphInfo");
p0d.registerClass("PowerPointWebEditor.CommentTextAnchorToHighlight");n2d.registerClass("PowerPointWebEditor.CommentCalloutDialogManager");M1d.registerClass("PowerPointWebEditor.FindCommentLogic",null,g_d,Sys.IDisposable);v2d.registerClass("PowerPointWebEditor.FindCommentLogic.FindCommentContext");O1d.registerClass("PowerPointWebEditor.FindCommentLogicDecorator",null,g_d,Sys.IDisposable);C2d.registerClass("PowerPointWebEditor.FindCommentLogicDecorator.Entry");
E2d.registerClass("PowerPointWebEditor.FindCommentRequest",aq);F2d.registerClass("PowerPointWebEditor.FindCommentResponse",window.PowerPointWebEditor.APPTServerResponse);N1d.registerClass("PowerPointWebEditor.FindCommentReplicator",aD,Sys.IDisposable);H2d.registerClass("PowerPointWebEditor.ResolvedCommentsCalloutParams");A1d.registerClass("PowerPointWebEditor.ShapeCommentsAnchoredSelectionView",null,tGb,sQ,YK,Sys.IDisposable);
$1d.registerClass("PowerPointWebEditor.PPTSharedCommentAppCapabilities",EFa);L1d.registerClass("PowerPointWebEditor.SharedCommentFrame",null,SS,Sys.IDisposable,GS,ed);J1d.registerClass("PowerPointWebEditor.SharedCommentModelTranslator",null,K1d);I1d.registerClass("PowerPointWebEditor.SharedCommentsRTEFocusActionHelper",null,i_d);J7.registerClass("PowerPointWebEditor.ViewContainerAPI",null,eWb);R1d.registerClass("PowerPointWebEditor.CommentsPane",null,IR,rL,Sys.IDisposable,zxb);
D1d.registerClass("PowerPointWeb.Comments.CommentMarkerPositionHelper",null,C1d);R3d.registerClass("PowerPointWeb.Comments.TextTranslationResult");B3d.registerClass("PowerPointWeb.Comments.SharedCommentsTaskPaneProps");M2d.registerClass("PowerPointWeb.Comments.CommentPaneHelper");u3d.registerClass("PowerPointWeb.Comments.CommentMarkerView");I4d.registerClass("PowerPointWeb.Comments.CommentMarkerDragAdapter",null,yd);K4d.registerClass("PowerPointWeb.Comments.LegacyCommentMarkerViewElement",null,B4d);
F1d.registerClass("PowerPointWeb.Comments.CommentMarkerViewElementFactory",null,E1d,Sys.IDisposable);(function(){}).registerClass("PowerPointWeb.Comments.CommentUtilities");G1d.registerClass("PowerPointWeb.Comments.CommentViewHelper");M4d.registerClass("PowerPointWeb.Comments.ModernCommentMarkerViewElement",null,B4d);Q3d.registerClass("FloatingContainerManager.FloatingContainerManagerCreationParams");F7.registerClass("FloatingContainer.IContentAnchorPosition");P3d.registerClass("FloatingContainer.IViewportInfo");
var t1d=!0,h2d="#F5E7F6",f2d="#503355",g2d="#F2E1F4",e2d="#4C3050",m2d=new ($b.$$(Number)),F4d=new rK(20,20),G4d=new rK(4,4),Z7=new pJ(4,20);M2d.IFg="CommentPaneLTR";M2d.JFg="CommentPaneRTL";M2d.KFg=300;ve().ed("CommentPackageLoaded",(new Date).getTime());zo(gj(),new H_d,0,!1);
