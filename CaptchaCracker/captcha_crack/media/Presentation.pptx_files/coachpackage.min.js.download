!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CoachPackage=t():e.CoachPackage=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=147)}([function(e,t,n){var r=n(3),i=n(10),o=n(22),a=n(18),s=n(25),c=function(e,t,n){var u,l,h,f,m=e&c.F,d=e&c.G,p=e&c.S,g=e&c.P,v=e&c.B,y=d?r:p?r[t]||(r[t]={}):(r[t]||{}).prototype,S=d?i:i[t]||(i[t]={}),C=S.prototype||(S.prototype={});for(u in d&&(n=t),n)h=((l=!m&&y&&void 0!==y[u])?y:n)[u],f=v&&l?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,y&&a(y,u,h,e&c.U),S[u]!=h&&o(S,u,f),g&&C[u]!=h&&(C[u]=h)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=n(104)},function(e,t,n){var r=n(62)("wks"),i=n(37),o=n(3).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(27),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(157),i=n(158),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){e.exports=!n(4)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(5),i=n(109),o=n(34),a=Object.defineProperty;t.f=n(12)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,c,"next",e)}function c(e){n(a,i,o,s,c,"throw",e)}s(void 0)}))}}},function(e,t,n){var r=n(32);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(149),i=n(150),o=n(151),a=n(153);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,a,s;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,l=g(c,u);for(n=0;n<u;++n)o(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,m(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,m(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return d(this,e,!0)},s.prototype.rawListeners=function(e){return d(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){var r=n(3),i=n(22),o=n(21),a=n(37)("src"),s=n(171),c=(""+s).split("toString");n(10).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(0),i=n(4),o=n(32),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(13),i=n(36);e.exports=n(12)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(56),i=n(32);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(26);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(57),i=n(36),o=n(23),a=n(34),s=n(21),c=n(109),u=Object.getOwnPropertyDescriptor;t.f=n(12)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(0),i=n(10),o=n(4);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var r=n(25),i=n(56),o=n(15),a=n(9),s=n(125);e.exports=function(e,t){var n=1==e,c=2==e,u=3==e,l=4==e,h=6==e,f=5==e||h,m=t||s;return function(t,s,d){for(var p,g,v=o(t),y=i(v),S=r(s,d,3),C=a(y.length),_=0,T=n?m(t,C):c?m(t,0):void 0;C>_;_++)if((f||_ in y)&&(g=S(p=y[_],_,v),e))if(n)T[_]=g;else if(g)switch(e){case 3:return!0;case 5:return p;case 6:return _;case 2:T.push(p)}else if(l)return!1;return h?-1:u||l?l:T}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";if(n(12)){var r=n(38),i=n(3),o=n(4),a=n(0),s=n(73),c=n(98),u=n(25),l=n(52),h=n(36),f=n(22),m=n(53),d=n(27),p=n(9),g=n(136),v=n(40),y=n(34),S=n(21),C=n(58),_=n(6),T=n(15),b=n(90),M=n(41),I=n(43),w=n(42).f,E=n(92),F=n(37),R=n(8),P=n(30),D=n(63),L=n(59),x=n(94),k=n(50),O=n(66),A=n(51),W=n(93),N=n(127),j=n(13),U=n(28),q=j.f,V=U.f,H=i.RangeError,B=i.TypeError,G=i.Uint8Array,z=Array.prototype,J=c.ArrayBuffer,Q=c.DataView,X=P(0),Y=P(2),$=P(3),K=P(4),Z=P(5),ee=P(6),te=D(!0),ne=D(!1),re=x.values,ie=x.keys,oe=x.entries,ae=z.lastIndexOf,se=z.reduce,ce=z.reduceRight,ue=z.join,le=z.sort,he=z.slice,fe=z.toString,me=z.toLocaleString,de=R("iterator"),pe=R("toStringTag"),ge=F("typed_constructor"),ve=F("def_constructor"),ye=s.CONSTR,Se=s.TYPED,Ce=s.VIEW,_e=P(1,(function(e,t){return we(L(e,e[ve]),t)})),Te=o((function(){return 1===new G(new Uint16Array([1]).buffer)[0]})),be=!!G&&!!G.prototype.set&&o((function(){new G(1).set({})})),Me=function(e,t){var n=d(e);if(n<0||n%t)throw H("Wrong offset!");return n},Ie=function(e){if(_(e)&&Se in e)return e;throw B(e+" is not a typed array!")},we=function(e,t){if(!_(e)||!(ge in e))throw B("It is not a typed array constructor!");return new e(t)},Ee=function(e,t){return Fe(L(e,e[ve]),t)},Fe=function(e,t){for(var n=0,r=t.length,i=we(e,r);r>n;)i[n]=t[n++];return i},Re=function(e,t,n){q(e,t,{get:function(){return this._d[n]}})},Pe=function(e){var t,n,r,i,o,a,s=T(e),c=arguments.length,l=c>1?arguments[1]:void 0,h=void 0!==l,f=E(s);if(null!=f&&!b(f)){for(a=f.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(h&&c>2&&(l=u(l,arguments[2],2)),t=0,n=p(s.length),i=we(this,n);n>t;t++)i[t]=h?l(s[t],t):s[t];return i},De=function(){for(var e=0,t=arguments.length,n=we(this,t);t>e;)n[e]=arguments[e++];return n},Le=!!G&&o((function(){me.call(new G(1))})),xe=function(){return me.apply(Le?he.call(Ie(this)):Ie(this),arguments)},ke={copyWithin:function(e,t){return N.call(Ie(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return K(Ie(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return W.apply(Ie(this),arguments)},filter:function(e){return Ee(this,Y(Ie(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Z(Ie(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Ie(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){X(Ie(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Ie(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Ie(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ue.apply(Ie(this),arguments)},lastIndexOf:function(e){return ae.apply(Ie(this),arguments)},map:function(e){return _e(Ie(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Ie(this),arguments)},reduceRight:function(e){return ce.apply(Ie(this),arguments)},reverse:function(){for(var e,t=Ie(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return $(Ie(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return le.call(Ie(this),e)},subarray:function(e,t){var n=Ie(this),r=n.length,i=v(e,r);return new(L(n,n[ve]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,p((void 0===t?r:v(t,r))-i))}},Oe=function(e,t){return Ee(this,he.call(Ie(this),e,t))},Ae=function(e){Ie(this);var t=Me(arguments[1],1),n=this.length,r=T(e),i=p(r.length),o=0;if(i+t>n)throw H("Wrong length!");for(;o<i;)this[t+o]=r[o++]},We={entries:function(){return oe.call(Ie(this))},keys:function(){return ie.call(Ie(this))},values:function(){return re.call(Ie(this))}},Ne=function(e,t){return _(e)&&e[Se]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},je=function(e,t){return Ne(e,t=y(t,!0))?h(2,e[t]):V(e,t)},Ue=function(e,t,n){return!(Ne(e,t=y(t,!0))&&_(n)&&S(n,"value"))||S(n,"get")||S(n,"set")||n.configurable||S(n,"writable")&&!n.writable||S(n,"enumerable")&&!n.enumerable?q(e,t,n):(e[t]=n.value,e)};ye||(U.f=je,j.f=Ue),a(a.S+a.F*!ye,"Object",{getOwnPropertyDescriptor:je,defineProperty:Ue}),o((function(){fe.call({})}))&&(fe=me=function(){return ue.call(this)});var qe=m({},ke);m(qe,We),f(qe,de,We.values),m(qe,{slice:Oe,set:Ae,constructor:function(){},toString:fe,toLocaleString:xe}),Re(qe,"buffer","b"),Re(qe,"byteOffset","o"),Re(qe,"byteLength","l"),Re(qe,"length","e"),q(qe,pe,{get:function(){return this[Se]}}),e.exports=function(e,t,n,c){var u=e+((c=!!c)?"Clamped":"")+"Array",h="get"+e,m="set"+e,d=i[u],v=d||{},y=d&&I(d),S=!d||!s.ABV,T={},b=d&&d.prototype,E=function(e,n){q(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[h](n*t+r.o,Te)}(this,n)},set:function(e){return function(e,n,r){var i=e._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[m](n*t+i.o,r,Te)}(this,n,e)},enumerable:!0})};S?(d=n((function(e,n,r,i){l(e,d,u,"_d");var o,a,s,c,h=0,m=0;if(_(n)){if(!(n instanceof J||"ArrayBuffer"==(c=C(n))||"SharedArrayBuffer"==c))return Se in n?Fe(d,n):Pe.call(d,n);o=n,m=Me(r,t);var v=n.byteLength;if(void 0===i){if(v%t)throw H("Wrong length!");if((a=v-m)<0)throw H("Wrong length!")}else if((a=p(i)*t)+m>v)throw H("Wrong length!");s=a/t}else s=g(n),o=new J(a=s*t);for(f(e,"_d",{b:o,o:m,l:a,e:s,v:new Q(o)});h<s;)E(e,h++)})),b=d.prototype=M(qe),f(b,"constructor",d)):o((function(){d(1)}))&&o((function(){new d(-1)}))&&O((function(e){new d,new d(null),new d(1.5),new d(e)}),!0)||(d=n((function(e,n,r,i){var o;return l(e,d,u),_(n)?n instanceof J||"ArrayBuffer"==(o=C(n))||"SharedArrayBuffer"==o?void 0!==i?new v(n,Me(r,t),i):void 0!==r?new v(n,Me(r,t)):new v(n):Se in n?Fe(d,n):Pe.call(d,n):new v(g(n))})),X(y!==Function.prototype?w(v).concat(w(y)):w(v),(function(e){e in d||f(d,e,v[e])})),d.prototype=b,r||(b.constructor=d));var F=b[de],R=!!F&&("values"==F.name||null==F.name),P=We.values;f(d,ge,!0),f(b,Se,u),f(b,Ce,!0),f(b,ve,d),(c?new d(1)[pe]==u:pe in b)||q(b,pe,{get:function(){return u}}),T[u]=d,a(a.G+a.W+a.F*(d!=v),T),a(a.S,u,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){v.of.call(d,1)})),u,{from:Pe,of:De}),"BYTES_PER_ELEMENT"in b||f(b,"BYTES_PER_ELEMENT",t),a(a.P,u,ke),A(u),a(a.P+a.F*be,u,{set:Ae}),a(a.P+a.F*!R,u,We),r||b.toString==fe||(b.toString=fe),a(a.P+a.F*o((function(){new d(1).slice()})),u,{slice:Oe}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!o((function(){b.toLocaleString.call([1,2])}))),u,{toLocaleString:xe}),k[u]=R?F:P,r||R||f(b,de,P)}}else e.exports=function(){}},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(37)("meta"),i=n(6),o=n(21),a=n(13).f,s=0,c=Object.isExtensible||function(){return!0},u=!n(4)((function(){return c(Object.preventExtensions({}))})),l=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return u&&h.NEED&&c(e)&&!o(e,r)&&l(e),e}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(111),i=n(77);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(27),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(5),i=n(112),o=n(77),a=n(76)("IE_PROTO"),s=function(){},c=function(){var e,t=n(74)("iframe"),r=o.length;for(t.style.display="none",n(78).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[o[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(111),i=n(77).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(21),i=n(15),o=n(76)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(8)("unscopables"),i=Array.prototype;null==i[r]&&n(22)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";n.r(t),n.d(t,"ClientWebSocket",(function(){return C})),n.d(t,"ClientWebSocketFactory",(function(){return _})),n.d(t,"requestCustomEndpointHandler",(function(){return Ie})),n.d(t,"LogCategory",(function(){return r})),n.d(t,"ISpeechMode",(function(){return i})),n.d(t,"ClientApp",(function(){return o})),n.d(t,"ClientType",(function(){return a})),n.d(t,"ISpeechError",(function(){return s})),n.d(t,"ISpeechRecognitionStoppedReason",(function(){return c})),n.d(t,"IEventName",(function(){return u})),n.d(t,"IMediaEventStatus",(function(){return l})),n.d(t,"QualityStatusCode",(function(){return h})),n.d(t,"AudioCaptureImplementation",(function(){return f})),n.d(t,"WebSocketState",(function(){return m})),n.d(t,"ISessionTimerState",(function(){return d})),n.d(t,"SpeechClientFactory",(function(){return we})),n.d(t,"TraceLevel",(function(){return S})),n.d(t,"MediaCaptureSource",(function(){return J})),n.d(t,"RealTimeFactorHandler",(function(){return ce})),n.d(t,"SpeechStatus",(function(){return he})),n.d(t,"SpeechClient",(function(){return pe})),n.d(t,"NetworkQualityStatus",(function(){return ae})),n.d(t,"SpeechHealthManager",(function(){return fe})),n.d(t,"TranscriptResultJson",(function(){return N})),n.d(t,"RehearsalResultJson",(function(){return j})),n.d(t,"QualityStatusJson",(function(){return U})),n.d(t,"SpeechSessionStartedJson",(function(){return q})),n.d(t,"ClientAudioMessage",(function(){return V})),n.d(t,"ClientRequestMessage",(function(){return H})),n.d(t,"deserializeSpeechResponseMessage",(function(){return B})),n.d(t,"TelemetryManager",(function(){return X})),n.d(t,"TelemetryFieldNames",(function(){return Ce})),n.d(t,"TelemetryErrorFieldNames",(function(){return _e})),n.d(t,"TranscriberSettings",(function(){return be})),n.d(t,"FdConnectionState",(function(){return Te})),n.d(t,"Transcriber",(function(){return Me})),n.d(t,"WebcamClient",(function(){return te}));var r,i,o,a,s,c,u,l,h,f,m,d,p=n(1),g=n.n(p),v=n(2),y=n.n(v);!function(e){e[e.PptSession=817]="PptSession"}(r||(r={})),function(e){e.Subtitles="Subtitles",e.Rehearsal="Rehearsal",e.Dictation="Dictation",e.Live="Live",e.ReadAlong="ReadAlong",e.ConversationTranscription="ConversationTranscription"}(i||(i={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(o||(o={})),function(e){e.web="web",e.win32="win32",e.mac="mac",e.ios="ios",e.android="android"}(a||(a={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(s||(s={})),function(e){e.Normal="Normal",e.WaitForSpeechEndTimeout="WaitForSpeechEndTimeout"}(c||(c={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(u||(u={})),function(e){e.AudioDeviceConnected="AudioDeviceConnected",e.VideoSetupCompleted="VideoSetupCompleted"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(h||(h={})),function(e){e.AudioWorklet="AudioWorklet",e.ScriptProcessor="ScriptProcessor"}(f||(f={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(m||(m={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped"}(d||(d={}));var S,C=function(){function e(t){var n=this;g()(this,e),this.closeHandler=null,this.messageHandler=null,this.openHandler=null,this.webSocket=new WebSocket(t),this.webSocket.binaryType="arraybuffer",this.webSocket.onclose=function(e){n.closeHandler&&n.closeHandler(e.code)},this.webSocket.onmessage=function(e){n.messageHandler&&n.messageHandler(e.data)},this.webSocket.onopen=function(){n.openHandler&&n.openHandler()}}return y()(e,[{key:"close",value:function(){this.webSocket.close()}},{key:"send",value:function(e){this.webSocket.send(e)}},{key:"onclose",get:function(){return this.closeHandler},set:function(e){this.closeHandler=e}},{key:"onmessage",get:function(){return this.messageHandler},set:function(e){this.messageHandler=e}},{key:"onopen",get:function(){return this.openHandler},set:function(e){this.openHandler=e}},{key:"readyState",get:function(){switch(this.webSocket.readyState){case WebSocket.OPEN:return m.Open;case WebSocket.CONNECTING:return m.Connecting;case WebSocket.CLOSING:return m.Closing;case WebSocket.CLOSED:default:return m.Closed}}}]),e}(),_=function(){function e(){g()(this,e)}return y()(e,[{key:"createWebSocket",value:function(e){return new C(e)}}]),e}(),T=n(7),b=n.n(T),M=n(14),I=n.n(M);!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(S||(S={}));var w=n(16),E=n.n(w),F=n(54),R=n.n(F),P=n(55),D=n.n(P),L=n(20),x=n.n(L),k=n(17);function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){var t,n=Object.create(null),r=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),o=i[0],a=i[1];n[o]=a}}catch(e){r.e(e)}finally{r.f()}return n}function W(e){var t=new Map;if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.set(i,e[i])}return t}n(142);var N=function(){function e(t){g()(this,e),this.speechResultJson=JSON.parse(t),this.transcriptsMap=W(this.speechResultJson.transcripts),this.propertiesMap=W(this.speechResultJson.properties)}return y()(e,[{key:"correlationId",get:function(){return this.speechResultJson.correlationId}},{key:"status",get:function(){return this.speechResultJson.status}},{key:"sourceLanguage",get:function(){return this.speechResultJson.sourceLanguage}},{key:"transcripts",get:function(){return this.transcriptsMap}},{key:"properties",get:function(){return this.propertiesMap}},{key:"isAdapted",get:function(){return this.speechResultJson.isAdapted}},{key:"isFinal",get:function(){return this.speechResultJson.isFinal}},{key:"isPong",get:function(){return this.speechResultJson.isPongMessage}},{key:"transcriptErrorCode",get:function(){return this.speechResultJson.transcriptErrorCode}},{key:"messageErrorCode",get:function(){return this.speechResultJson.messageErrorCode}}]),e}(),j=function(){function e(t){g()(this,e),this.rehearsalResultJson=JSON.parse(t),this.featuresMap=function e(t){for(var n=new Map,r=0,i=Object.keys(t);r<i.length;r++){var o=i[r];t[o]instanceof Object?n.set(o,e(t[o])):n.set(o,t[o])}return n}(this.rehearsalResultJson.features)}return y()(e,[{key:"correlationId",get:function(){return this.rehearsalResultJson.correlationId}},{key:"status",get:function(){return this.rehearsalResultJson.status}},{key:"sourceLanguage",get:function(){return this.rehearsalResultJson.sourceLanguage}},{key:"isFinal",get:function(){return this.rehearsalResultJson.isFinal}},{key:"currentSlideIndex",get:function(){return this.rehearsalResultJson.currentSlideIndex}},{key:"features",get:function(){return this.featuresMap}}]),e}(),U=function(){function e(t){g()(this,e),this.qualityStatusJson=JSON.parse(t)}return y()(e,[{key:"severity",get:function(){return this.qualityStatusJson.severity}},{key:"priority",get:function(){return this.qualityStatusJson.priority}},{key:"shortCode",get:function(){return this.qualityStatusJson.shortCode}},{key:"longCode",get:function(){return this.qualityStatusJson.longCode}},{key:"shortString",get:function(){return this.qualityStatusJson.shortString}},{key:"longString",get:function(){return this.qualityStatusJson.longString}}]),e}(),q=function(){function e(t){g()(this,e),this.speechSessionStartedJson=JSON.parse(t)}return y()(e,[{key:"speechSessionId",get:function(){return this.speechSessionStartedJson.speechSessionId}},{key:"transcriptionSignature",get:function(){return this.speechSessionStartedJson.transcriptionSignature}},{key:"speechSessionHostDataCenter",get:function(){return this.speechSessionStartedJson.speechSessionHostDataCenter}}]),e}(),V=function(){function e(){g()(this,e),this.settings=new Map}return y()(e,[{key:"setProperties",value:function(e){this.settings.set("properties",JSON.stringify(A(e)))}},{key:"setOperationMetadata",value:function(e,t){var n={clientSentTimeMS:e,clientSessionSentTimeMS:t};this.settings.set("operationMetadata",JSON.stringify(n))}},{key:"setClientMetaData",value:function(e){this.settings.set("clientMetadata",JSON.stringify(e))}},{key:"serializeBinary",value:function(){var e,t,n=(new TextEncoder).encode(JSON.stringify({correlationId:this.correlationId,sourceLanguage:this.sourceLanguage,settings:A(this.settings)})),r=new Uint8Array(4+n.byteLength+(null==this.audio?0:this.audio.byteLength));return r.set((e=n.byteLength,t=new ArrayBuffer(4),new DataView(t).setInt32(0,e,!1),new Uint8Array(t))),r.set(n,4),null!=this.audio&&r.set(this.audio,4+n.byteLength),r}}]),e}(),H=function(){function e(t,n){g()(this,e),this.type=t,this.message=n}return y()(e,[{key:"serializeBinary",value:function(){var e=(new TextEncoder).encode(JSON.stringify({type:this.type,message:this.message})),t=new Uint8Array(4+e.byteLength);return t.set(e,4),t}}],[{key:"fromMap",value:function(t){return new e("DictionaryMessage",JSON.stringify(A(t)))}}]),e}();function B(e,t){var n=JSON.parse((new TextDecoder).decode(e));"speechresultmixmessage"===n.messageType&&t.handleSpeechResultMessage(new N(n.message)),"rehearsalresultmixmessage"===n.messageType&&t.handleRehearsalResultMessage(new j(n.message)),"qualitystatusmixmessage"===n.messageType&&t.handleQualityStatusMessage(new U(n.message)),"speechsessionstartedmixmessage"===n.messageType&&t.handleSpeechSessionStartedMessage(new q(n.message))}var G,z=n(11),J=function(){function e(t,n){g()(this,e),this.mediaStream=null,this.messageLen=0,this.MAX_BUFFER_SIZE=4096,this.message=new Float32Array(4096),this.m_audioCaptureInProgress=!1,this.m_audioImplementation=f.ScriptProcessor,this.audioHandler=null,this.c_maxBufferSize=16384,this.speechProcessorScript=t,this.m_microphoneDeviceId=n}var t;return y()(e,[{key:"startAudioCapture",value:(t=I()(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null,t=!this.m_microphoneDeviceId||{deviceId:{exact:this.m_microphoneDeviceId}},this.m_audioCaptureInProgress=!0,e.next=5,navigator.mediaDevices.getUserMedia({audio:t,video:!1});case 5:if(this.mediaStream=e.sent,this.m_audioCaptureInProgress){e.next=9;break}return this.stopAudioCapture(),e.abrupt("return",s.ErrorAudioCaptureStalePermission);case 9:return e.abrupt("return",this.initializeAudioSession());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopAudioCapture",value:function(){this.m_audioCaptureInProgress=!1,this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.streamSource&&(this.scriptNode&&this.streamSource.disconnect(this.scriptNode),this.streamSource=null),this.scriptNode&&(this.scriptNode.onaudioprocess=null,this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode=null),this.speechProcessorScript&&this.m_workletNode&&(this.m_workletNode.disconnect(this.audioCtx.destination),this.m_workletNode.port.onmessage=null,this.m_workletNode=null)}},{key:"pauseAudioCapture",value:function(){this.setAudioEnabled(!1)}},{key:"resumeAudioCapture",value:function(){this.setAudioEnabled(!0)}},{key:"getTelemetry",value:function(){return{audioImplementation:this.m_audioImplementation}}},{key:"setAudioEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e}))}},{key:"initializeAudioSession",value:function(){var t=this;return this.audioCtx=e.createAudioContext(),this.audioCtx?(this.speechProcessorScript&&this.audioCtx.audioWorklet?this.audioCtx.audioWorklet.addModule(this.speechProcessorScript).then((function(){t.connectToMediaWithAudioWorklet()})).catch((function(){t.connectToMediaWithScriptProcessor()})):this.connectToMediaWithScriptProcessor(),s.ErrorNone):s.ErrorAudioSetupFailure}},{key:"connectToMediaWithAudioWorklet",value:function(){var t=this;this.m_audioImplementation=f.AudioWorklet;var n=new AudioWorkletNode(this.audioCtx,"speech-processor");n.port.onmessage=function(n){var r=n.data;if(t.messageLen===t.MAX_BUFFER_SIZE){if(t.audioHandler){var i=e.encodeWAVWithoutHeader(t.message);t.audioHandler(i,Object(z.v4)())}t.messageLen=0}t.message.set(r,t.messageLen),t.messageLen+=r.length};var r=this.audioCtx.createMediaStreamSource(this.mediaStream);r.connect(n),n.connect(this.audioCtx.destination),this.m_workletNode=n,this.streamSource=r}},{key:"connectToMediaWithScriptProcessor",value:function(){var t=this;this.m_audioImplementation=f.ScriptProcessor,this.streamSource=this.audioCtx.createMediaStreamSource(this.mediaStream);var n=Math.pow(2,Math.floor(Math.log(.2*this.audioCtx.sampleRate)/Math.log(2))),r=n<=this.c_maxBufferSize?n:this.c_maxBufferSize;this.scriptNode=this.audioCtx.createScriptProcessor(r,1,1),this.scriptNode.onaudioprocess=function(n){if(t.audioHandler){var r=e.encodeWAVWithoutHeader(n.inputBuffer.getChannelData(0));t.audioHandler(r,Object(z.v4)())}},this.streamSource.connect(this.scriptNode),this.scriptNode.connect(this.audioCtx.destination)}},{key:"sampleRate",get:function(){return this.audioCtx?this.audioCtx.sampleRate:null}},{key:"onaudioprocess",get:function(){return this.audioHandler},set:function(e){this.audioHandler=e}}],[{key:"createAudioContext",value:function(){var e;try{e=new AudioContext}catch(e){}if(!e)try{e=new window.webkitAudioContext}catch(e){}return e}},{key:"encodeWAVWithoutHeader",value:function(t){var n=new ArrayBuffer(2*t.length),r=new DataView(n);return e.floatTo16BitPCM(r,0,t),r}},{key:"floatTo16BitPCM",value:function(e,t,n){for(var r=t,i=0;i<n.length;i+=1,r+=2){var o=Math.max(-1,Math.min(1,n[i]));e.setInt16(r,o<0?32768*o:32767*o,!0)}}}]),e}();function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=function(){function e(t){g()(this,e),this.m_sessionTelemetry=new Map,this.m_fatalErrors=new Array,this.m_nonFatalErrors=new Array,G=t,this.recordSpeechSettings()}return y()(e,[{key:"publishSessionTelemetry",value:function(){G.sendTraceTag(595686043,r.PptSession,S.Info,JSON.stringify(function(e){var t,n=Object.create(null),r=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),o=i[0],a=i[1];n[o]=a}}catch(e){r.e(e)}finally{r.f()}return n}(this.m_sessionTelemetry)))}},{key:"recordMediaCaptureSourceTelemetry",value:function(e){var t="";e&&e.getTelemetry&&(t=e.getTelemetry()),this.m_sessionTelemetry.set(Ce.MediaCaptureSourceTelemetry,t)}},{key:"recordSpeechSettings",value:function(){this.m_sessionTelemetry.set(Ce.DataLoggingTimeInterval,be.DataLoggingIntervalMS),this.m_sessionTelemetry.set(Ce.FEnableContentlogging,be.IsContentLoggingEnabled),this.m_sessionTelemetry.set(Ce.RealTimeFactorLowerThreshold,be.RealTimeFactorLowerThreshold),this.m_sessionTelemetry.set(Ce.RealTimeFactorUpperThreshold,be.RealTimeFactorUpperThreshold)}},{key:"recordSpeechClientConnectionStart",value:function(e){this.initialize(),this.m_sessionTelemetry.set(Ce.TranscriptionStartTime,Date.now()),this.m_sessionTelemetry.set(Ce.SpeechLanguage,e.sourceLanguage),this.m_sessionTelemetry.set(Ce.TranslationLanguage,e.targetLanguages),this.m_sessionTelemetry.set(Ce.SpeechMode,e.speechMode)}},{key:"recordSpeechRecognitionStart",value:function(){this.m_sessionTelemetry.set(Ce.SpeechClientRecognitionStartTime,Date.now())}},{key:"recordSpeechClientConnectionEnd",value:function(e){this.m_sessionTelemetry.set(Ce.TranscriptionEndTime,Date.now()),this.m_sessionTelemetry.has(Ce.WebSocketOpenedTimestamp)||G.sendTraceTag(593253271,r.PptSession,S.Warning,"recordSpeechClientConnectionEnd: WebSocketOpenedTimestamp is null. TranscriberID:  ".concat(e));var t=Date.now(),n=t-this.m_sessionTelemetry.get(Ce.WebSocketOpenedTimestamp);this.m_sessionTelemetry.set(Ce.WebSocketClosedTimestamp,t),this.m_sessionTelemetry.set(Ce.WebSocketConnectionDurationMS,n),this.m_sessionTelemetry.set(Ce.FatalErrors,this.m_fatalErrors),this.m_sessionTelemetry.set(Ce.NonFatalErrors,this.m_nonFatalErrors)}},{key:"recordWebSocketConnectionStart",value:function(e,t){var n;n=-1!==e.toLowerCase().indexOf(".edog")?"EDog":-1!==e.toLowerCase().indexOf(".live-int.")?"Int":"Production",this.m_sessionTelemetry.set(Ce.TranscriberID,t),this.m_sessionTelemetry.set(Ce.Endpoint,n),this.m_sessionTelemetry.set(Ce.InitializeWebSocketStartTimeMS,Date.now())}},{key:"recordWebSocketCreation",value:function(){this.m_sessionTelemetry.set(Ce.WebSocketCreateTimestamp,Date.now())}},{key:"recordWebSocketRetryCounts",value:function(e){this.m_sessionTelemetry.set(Ce.WebSocketRetryAttempts,e)}},{key:"recordWebSocketConnectionOpen",value:function(){this.m_sessionTelemetry.set(Ce.WebSocketOpenedTimestamp,Date.now())}},{key:"recordWebSocketConnectionEnd",value:function(){this.m_sessionTelemetry.set(Ce.InitializeWebSocketEndTimeMS,Date.now())}},{key:"recordCustomEndpointStart",value:function(e){this.m_sessionTelemetry.set(Ce.CustomEndpointRequestCorrelationID,e),this.m_sessionTelemetry.set(Ce.RequestCustomEndpointStartTimeMS,Date.now())}},{key:"recordCustomEndpointEnd",value:function(e){this.m_sessionTelemetry.set(Ce.WebSocketCustomEndpoint,e),this.m_sessionTelemetry.set(Ce.RequestCustomEndpointEndTimeMS,Date.now())}},{key:"recordCustomEndpointError",value:function(){this.m_sessionTelemetry.set(Ce.RequestCustomEndpointFailedEndTimeMS,Date.now())}},{key:"recordCustomEndpointTimeout",value:function(){this.m_sessionTelemetry.set(Ce.RequestCustomEndpointTimedOutEndTimeMS,Date.now())}},{key:"recordFrontdoorRoundTripLatency",value:function(e){this.m_sessionTelemetry.set(Ce.AverageFrontDoorRoundTripLatencyCount,e)}},{key:"recordNetworkQuality",value:function(e,t){this.m_sessionTelemetry.set(Ce.TotalNetworkErrorMessageCount,e),this.m_sessionTelemetry.set(Ce.TotalNetworkWarningMessageCount,t)}},{key:"recordInitialAudioMessage",value:function(){this.m_sessionTelemetry.has(Ce.SendFirstMessageTime)||this.m_sessionTelemetry.set(Ce.SendFirstMessageTime,Date.now())}},{key:"recordAudioStatistics",value:function(e,t){this.m_sessionTelemetry.set(Ce.AudioFactorCalculationDurationMS,e),this.m_sessionTelemetry.set(Ce.TotalAudioFactorOutsideOfThresholdCount,t)}},{key:"recordInitialMessageLatency",value:function(){if(!this.m_sessionTelemetry.has(Ce.FirstMessageLatencyMS)&&this.m_sessionTelemetry.get(Ce.SendFirstMessageTime)){var e=Date.now()-this.m_sessionTelemetry.get(Ce.SendFirstMessageTime);this.m_sessionTelemetry.set(Ce.FirstMessageLatencyMS,e)}}},{key:"recordPartialMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(Ce.MaxPartialMessageLatencyMS,e),this.m_sessionTelemetry.set(Ce.MinPartialMessageLatencyMS,t),this.m_sessionTelemetry.set(Ce.TotalPartialMessagesCount,n),this.m_sessionTelemetry.set(Ce.TotalHighLatencyPartialMessagesCount,r),this.m_sessionTelemetry.set(Ce.TotalPartialMessageLatency,i)}},{key:"recordFinalMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(Ce.MaxFinalMessageLatencyMS,e),this.m_sessionTelemetry.set(Ce.MinFinalMessageLatencyMS,t),this.m_sessionTelemetry.set(Ce.TotalFinalMessagesCount,n),this.m_sessionTelemetry.set(Ce.TotalHighLatencyFinalMessagesCount,r),this.m_sessionTelemetry.set(Ce.TotalFinalMessageLatency,i)}},{key:"recordMessageLatencyStats",value:function(e,t,n){this.m_sessionTelemetry.set(Ce.TotalMessageCorrelationIDNotFoundCount,e),this.m_sessionTelemetry.set(Ce.LatencyTableDeletedCount,t),this.m_sessionTelemetry.set(Ce.TotalEntriesInLatencyTable,n)}},{key:"recordRealTimeReceiveFactorStats",value:function(e,t){this.m_sessionTelemetry.set(Ce.TotalTranscriptOutsideOfThresholdCount,e),this.m_sessionTelemetry.set(Ce.MessageLatencyCalculationTimeMS,t)}},{key:"recordSpeechClientError",value:function(e,t,n,i){var o={};o.ErrorName=e||"ErrorEmpty",o.ErrorReason=t,o.ClientTimestampMS=n;var a=i?this.m_fatalErrors:this.m_nonFatalErrors;a.length<10?a.push(o):G.sendTraceTag(593253272,r.PptSession,S.Warning,"Transcriber::recordSpeechClientError Will not append error to error list because the list contains too many errors ".concat(JSON.stringify(o)))}},{key:"recordWebsocketCloseError",value:function(e){this.m_sessionTelemetry.set(_e.WebSocketErrorCode,e)}},{key:"initialize",value:function(){this.m_fatalErrors=[],this.m_nonFatalErrors=[],this.m_sessionTelemetry.clear()}}]),e}(),Y=n(61),$=n.n(Y),K=function(){function e(){g()(this,e),this.mediaStream=null,this.__isCapturing=!1}var t;return y()(e,[{key:"startMediaCapture",value:(t=I()(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:{width:t,height:n,facingMode:"user"}});case 2:return this.mediaStream=e.sent,e.abrupt("return",this.initializeWebcamCapture());case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.isCapturing=!1}},{key:"pauseMediaCapture",value:function(){this.setMediaEnabled(!1)}},{key:"resumeMediaCapture",value:function(){this.setMediaEnabled(!0)}},{key:"setMediaEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e})),this.isCapturing=e}},{key:"initializeWebcamCapture",value:function(){if(!this.mediaStream)return s.ErrorWebcamSetupFailure;var e=this.mediaStream.getVideoTracks();return 0===e.length?s.ErrorWebcamNotFoundError:e.length>1?s.ErrorMultipleWebcamsFound:(this.isCapturing=!0,s.ErrorNone)}},{key:"isCapturing",set:function(e){e!==this.__isCapturing&&this.onCapturingContentChanged(e),this.__isCapturing=e}},{key:"stream",get:function(){return this.mediaStream}}]),e}();function Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ee=function e(){g()(this,e)};ee.defaultRequestedVideoHeight=322,ee.defaultRequestedVideoWidth=572;var te=function(e){R()(i,e);var t,n,r=(t=i,function(){var e,n=x()(t);if(Z()){var r=x()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return D()(this,e)});function i(e,t){var n;return g()(this,i),(n=r.call(this)).lastVideoWidth=-1,n.lastVideoHeight=-1,n.requestedVideoHeight=ee.defaultRequestedVideoHeight,n.requestedVideoWidth=ee.defaultRequestedVideoWidth,n.onWebcamFrame=null,n.processFeedHandler=null,e.requestedVideoWidth&&(n.requestedVideoWidth=e.requestedVideoWidth),e.requestedVideoHeight&&(n.requestedVideoHeight=e.requestedVideoHeight),n.videoView=e.videoView,n.workingCanvas=e.workingCanvas,n.webcamFrameWidth=e.webcamFrameWidth?e.webcamFrameWidth:500,n.delayBetweenCapturesMS=1e3/e.numFramesPerSecond,n.onWebcamFrame=t,n.workingCanvas&&(n.workingCanvas.width=n.webcamFrameWidth),n}return y()(i,[{key:"startMediaCapture",value:(n=I()(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$()(x()(i.prototype),"startMediaCapture",this).call(this,this.requestedVideoWidth,this.requestedVideoHeight);case 2:if((t=e.sent)===s.ErrorNone){e.next=5;break}return e.abrupt("return",t);case 5:return this.videoView.srcObject=this.stream,e.next=8,this.videoView.play();case 8:return e.abrupt("return",s.ErrorNone);case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.videoView.pause(),this.videoView.srcObject=null,$()(x()(i.prototype),"stopMediaCapture",this).call(this)}},{key:"tryCaptureFrame",value:function(){if(!this.videoView||!this.workingCanvas)return null;var e=this.workingCanvas.getContext("2d");if(!e)return null;if((this.videoView.videoHeight!==this.lastVideoHeight||this.videoView.videoWidth!==this.lastVideoWidth)&&this.videoView.videoWidth){var t=this.webcamFrameWidth/this.videoView.videoWidth;this.workingCanvas.height=t*this.videoView.videoHeight,this.lastVideoHeight=this.videoView.videoHeight,this.lastVideoWidth=this.videoView.videoWidth}return e.drawImage(this.videoView,0,0,this.workingCanvas.width,this.workingCanvas.height),this.workingCanvas.toDataURL("image/jpeg")}},{key:"tryProcessFeed",value:function(){if(this.onWebcamFrame){var e=this.tryCaptureFrame();e&&this.onWebcamFrame(e,Object(z.v4)())}}},{key:"onCapturingContentChanged",value:function(e){var t=this;this.onWebcamFrame&&(e?this.processFeedHandler=setInterval((function(){return t.tryProcessFeed()}),this.delayBetweenCapturesMS):this.processFeedHandler&&clearInterval(this.processFeedHandler))}}]),i}(K);function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function re(e,t,n){for(var r=0;r<n.length;r+=1)e.setUint8(t+r,n.charCodeAt(r))}var ie,oe,ae,se=function(){function e(){g()(this,e),this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted,this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted}return y()(e,[{key:"restart",value:function(e){this.timerState=e?d.Started:d.Paused,this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0}},{key:"resume",value:function(){this.timerState===d.Paused&&(this.timerState=d.Started,this.lastStartTimeInMS=Date.now())}},{key:"pause",value:function(){this.timerState===d.Started&&(this.timerState=d.Paused,this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS)}},{key:"stop",value:function(){this.timerState===d.Started&&(this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS),this.timerState=d.Stopped}},{key:"getElapsedSessionTimeInMS",value:function(){return this.timerState===d.Started?this.elapsedSessionTimeInMS+(Date.now()-this.lastStartTimeInMS):this.elapsedSessionTimeInMS}}]),e}(),ce=function(){function e(t,n){g()(this,e),this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_transcriberId="",this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_startTime=0,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0,this.m_intervalTranscript=be.DataLoggingIntervalMS,this.m_intervalAudio=be.DataLoggingIntervalMS,this.m_lastAudioLogUTC=Date.now(),this.m_lastTranscriptLogUTC=Date.now(),ie=t,this.telemetryManager=n}return y()(e,[{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_startTime=Date.now()}},{key:"calculatePreAudioMetrics",value:function(e){this.m_currentSentAudioTimeUTC=Date.now();var t=Date.now()-e;this.m_prepAudioCount+=1,this.m_prepAudioSum+=t,this.m_minPrepAudio=Math.min(this.m_minPrepAudio,t),this.m_maxPrepAudio=Math.max(this.m_maxPrepAudio,t)}},{key:"calculateAndLogRealTimeSendFactorStats",value:function(e){try{var t=Date.now();if(this.m_totalAudioMessageCountInCurrentTimeInterval+=1,this.m_totalAudioMessageCountInPreviousTimeInterval>0&&this.m_lastSentAudioTimeUTC<Number.MAX_VALUE){var n=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval,i=Date.now()-this.m_lastSentAudioTimeUTC,o=n/(i>0?i:1);o>0&&this.calculateRealTimeSendFactorStats(e,o,i,n)}Date.now()-this.m_lastAudioLogUTC>be.DataLoggingIntervalMS&&this.logRealTimeSendStatsForEachInterval(),this.m_lastSentAudioTimeUTC=this.m_currentSentAudioTimeUTC;var a=Date.now()-t;this.m_audioFactorCalculationDuration+=a}catch(e){ie.sendTraceTag(595716178,r.PptSession,S.Warning,"calculateAndLogRealTimeSendFactorStats: Calculating audio sending metrics threw an exception: ".concat(e,"\n             TranscriberID: ").concat(this.m_transcriberId))}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_startTime=0,this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0}},{key:"calculateRealTimeSendFactorStats",value:function(e,t,n,i){if(this.m_realTimeSendDataFactorCount+=1,this.m_realTimeSendDataFactorSum+=t,this.m_minRealTimeSendDataFactor=Math.min(this.m_minRealTimeSendDataFactor,t),this.m_maxRealTimeSendDataFactor=Math.max(this.m_maxRealTimeSendDataFactor,t),this.m_realTimeSendDataFactorCountInTimeInterval+=1,this.m_realTimeSendDataFactorSumInTimeInterval+=t,this.m_minRealTimeSendDataFactorInTimeInterval=Math.min(this.m_minRealTimeSendDataFactorInTimeInterval,t),this.m_maxRealTimeSendDataFactorInTimeInterval=Math.max(this.m_maxRealTimeSendDataFactorInTimeInterval,t),t<be.RealTimeFactorLowerThreshold||t>be.RealTimeFactorUpperThreshold){this.m_totalAudioFactorOutsideOfThresholdCount+=1;var o=0,a=0,s=0;this.m_realTimeSendDataFactorCount>0&&(o=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,a=this.m_minRealTimeSendDataFactor,s=this.m_maxRealTimeSendDataFactor),ie.sendTraceTag(595716176,r.PptSession,S.Warning,JSON.stringify({MessageCorrelationID:e,SessionDurationInMS:Date.now()-this.m_startTime,RealTimeSendingDataFactor:t,AvgRealTimeSendingDataFactor:o,MinRealTimeSendingDataFactor:a,MaxRealTimeSendingDataFactor:s,AvgSendingDataDurationForInterval:i,RealTimeDurationForCurrentMessage:n,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeSendStatsForEachInterval",value:function(){var e=0,t=0,n=0;this.m_realTimeSendDataFactorCount>0&&(e=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,t=this.m_minRealTimeSendDataFactor,n=this.m_maxRealTimeSendDataFactor);var i=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(i=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval);var o=0,a=0,s=0;this.m_realTimeSendDataFactorCountInTimeInterval>0&&(o=1*this.m_realTimeSendDataFactorSumInTimeInterval/this.m_realTimeSendDataFactorCountInTimeInterval,a=this.m_minRealTimeSendDataFactorInTimeInterval,s=this.m_maxRealTimeSendDataFactorInTimeInterval);var c=0,u=0,l=0;this.m_prepAudioCount>0&&(c=this.m_prepAudioSum/this.m_prepAudioCount,u=this.m_minPrepAudio,l=this.m_maxPrepAudio),ie.sendTraceTag(595716177,r.PptSession,S.Info,JSON.stringify({SessionDurationInMS:Date.now()-this.m_startTime,AvgRealTimeSendingDataFactor:e,MinRealTimeSendingDataFactor:t,MaxRealTimeSendingDataFactor:n,AvgRealTimeSendingDataFactorForInterval:o,MinRealTimeSendingDataFactorForInterval:a,MaxRealTimeSendingDataFactorForInterval:s,AvgPrepAudioForInterval:c,MinPrepAudioForInterval:u,MaxPrepAudioForInterval:l,AvgSendingDataDurationForInterval:i,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId})),this.m_totalAudioMessageCountInPreviousTimeInterval=this.m_totalAudioMessageCountInCurrentTimeInterval,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_lastAudioLogUTC=Date.now(),this.resetAudioIntervalStats()}},{key:"resetAudioIntervalStats",value:function(){this.m_startLogIntervalAudio<Number.MAX_VALUE&&(this.m_intervalAudio=Date.now()-this.m_startLogIntervalAudio),this.m_startLogIntervalAudio=Date.now()}},{key:"calculateAndLogRealTimeReceiveFactorStats",value:function(e,t,n,r,i){var o=Date.now()-e;this.m_messageLatencyCalculationTime+=o;var a=0,s=0,c=0;this.m_totalTranscriptMessageCountInCurrentTimeInterval+=1,this.m_totalTranscriptMessageCountInPreviousTimeInterval>0&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(a=(c=this.m_intervalTranscript/this.m_totalTranscriptMessageCountInPreviousTimeInterval)/((s=Date.now()-this.m_lastReceivedTranscriptTimeUTC)>0?s:1))>0&&this.calculateRealTimeReceiveFactorStats(t,n,r,i,a,c,s),be.IsLogEachTranscriptMessage||this.logRealTimeReceiveStatsForEachTranscript(t,n,r,i,c,a),Date.now()-this.m_lastTranscriptLogUTC>be.DataLoggingIntervalMS&&this.logRealTimeReceiveStatsForEachInterval(t,n,r,i),this.m_lastReceivedTranscriptTimeUTC=Date.now()}},{key:"calculateRealTimeReceiveFactorStats",value:function(e,t,n,i,o,a,s){if(this.m_realTimeReceiveDataFactorCount+=1,this.m_realTimeReceiveDataFactorSum+=o,this.m_minRealTimeReceiveDataFactor=Math.min(this.m_minRealTimeReceiveDataFactor,o),this.m_maxRealTimeReceiveDataFactor=Math.max(this.m_maxRealTimeReceiveDataFactor,o),this.m_realTimeReceiveDataFactorCountInTimeInterval+=1,this.m_realTimeReceiveDataFactorSumInTimeInterval+=o,this.m_minRealTimeReceiveDataFactorInTimeInterval=Math.min(this.m_minRealTimeReceiveDataFactorInTimeInterval,o),this.m_maxRealTimeReceiveDataFactorInTimeInterval=Math.max(this.m_maxRealTimeReceiveDataFactorInTimeInterval,o),!be.IsLogEachTranscriptMessage&&(o<be.RealTimeFactorLowerThreshold||o>be.RealTimeFactorUpperThreshold)){this.m_totalTranscriptFactorOutsideOfThresholdCount+=1;var c=0,u=0,l=0;this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,u=this.m_minRealTimeReceiveDataFactor,l=this.m_maxRealTimeReceiveDataFactor),ie.sendTraceTag(595716104,r.PptSession,S.Warning,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:o,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:u,MaxRealTimeReceivingDataFactor:l,AvgReceivingDataDurationForInterval:a,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeReceiveStatsForEachTranscript",value:function(e,t,n,i,o,a){var s=0,c=0,u=0,l=0,h=0,f=0,m=0;0===this.m_totalTranscriptMessageCountInPreviousTimeInterval&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(s=Date.now()-this.m_lastReceivedTranscriptTimeUTC),this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,u=this.m_minRealTimeReceiveDataFactor,l=this.m_maxRealTimeReceiveDataFactor),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(h=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,f=this.m_minRealTimeReceiveDataFactorInTimeInterval,m=this.m_maxRealTimeReceiveDataFactorInTimeInterval),ie.sendTraceTag(595716105,r.PptSession,S.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:a,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:u,MaxRealTimeReceivingDataFactor:l,AvgRealTimeReceivingDataFactorForInterval:h,MinRealTimeReceivingDataFactorForInterval:f,MaxRealTimeReceivingDataFactorForInterval:m,AvgReceivingDataDurationForInterval:o,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}},{key:"logRealTimeReceiveStatsForEachInterval",value:function(e,t,n,i){var o=0,a=0,s=0,c=0,u=0,l=0;if(!be.IsLogEachTranscriptMessage){this.m_realTimeReceiveDataFactorCount>0&&(o=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,a=this.m_minRealTimeReceiveDataFactor,s=this.m_maxRealTimeReceiveDataFactor);var h=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(h=this.m_intervalTranscript/this.m_totalAudioMessageCountInPreviousTimeInterval),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(c=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,u=this.m_minRealTimeReceiveDataFactorInTimeInterval,l=this.m_maxRealTimeReceiveDataFactorInTimeInterval),ie.sendTraceTag(595716106,r.PptSession,S.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,AvgRealTimeReceivingDataFactor:o,MinRealTimeReceivingDataFactor:a,MaxRealTimeReceivingDataFactor:s,AvgRealTimeReceivingDataFactorForInterval:c,MinRealTimeReceivingDataFactorForInterval:u,MaxRealTimeReceivingDataFactorForInterval:l,AvgReceivingDataDurationForInterval:h,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}this.m_totalTranscriptMessageCountInPreviousTimeInterval=this.m_totalTranscriptMessageCountInCurrentTimeInterval,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_lastTranscriptLogUTC=Date.now(),this.resetTranscriptInterval()}},{key:"resetTranscriptInterval",value:function(){this.m_startLogIntervalTranscript<Number.MAX_VALUE&&(this.m_intervalTranscript=Date.now()-this.m_startLogIntervalTranscript),this.m_startLogIntervalTranscript=Date.now()}},{key:"onSessionEnd",value:function(){this.telemetryManager.recordAudioStatistics(this.m_audioFactorCalculationDuration,this.m_totalAudioFactorOutsideOfThresholdCount),this.telemetryManager.recordRealTimeReceiveFactorStats(this.m_totalTranscriptFactorOutsideOfThresholdCount,this.m_messageLatencyCalculationTime)}}]),e}(),ue=function e(){g()(this,e)};ue.HeartbeatInterval=5e3,ue.RoundtripLatencyWarnThreshold=500,ue.PongMessageReceieveMaxTimeout=ue.HeartbeatInterval+1e4,ue.NetworkPingPongWarningThresholdInMs=500,ue.NetworkPingPongErrorThresholdInMs=2e3,ue.NetworkPingPongMaxWarningCount=6,ue.NetworkPingPongMaxErrorCount=3,ue.NetworkQualityWarningPriority=10,ue.NetworkQualityErrorPriority=100,function(e){e[e.Normal=0]="Normal",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(ae||(ae={}));var le,he,fe=function(){function e(t,n){g()(this,e),this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.c_maxEntriesInLatencyTable=1200,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_pongMessageTimerId=0,this.m_isWaitingForPongResponse=!1,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0,this.events=new k.EventEmitter,oe=t,this.telemetryManager=n,this.m_realTimeFactorHandler=new ce(t,this.telemetryManager)}return y()(e,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_realTimeFactorHandler.startSession(e),this.m_pongMessageTimerId=setInterval(this.checkForPongResponse.bind(this),ue.PongMessageReceieveMaxTimeout)}},{key:"resetMessageLatency",value:function(){this.m_messageLatencyTable={}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0}},{key:"logRoundTripLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,RoundtripLatencyMS:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};oe.sendTraceTag(595716097,r.PptSession,S.Warning,JSON.stringify(n))}},{key:"logMessageLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,PartialMessageLatency:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};oe.sendTraceTag(595716097,r.PptSession,S.Warning,JSON.stringify(n))}},{key:"calculateMessageLatencyStats",value:function(e,t){t>=be.FragmentLatencyWarnThreshold?(this.m_countFragmentLatencyInWarnWindow=Math.min(be.FragmentLatencyWarnWindow,this.m_countFragmentLatencyInWarnWindow+1),t>=be.FragmentLatencyErrorThreshold?this.m_countFragmentLatencyInErrorWindow=Math.min(be.FragmentLatencyErrorWindow,this.m_countFragmentLatencyInErrorWindow+1):this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)):(this.m_countFragmentLatencyInWarnWindow=Math.max(0,this.m_countFragmentLatencyInWarnWindow-1),this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)),t>=be.FragmentLatencyWarnThreshold&&this.logMessageLatencyInfo(e,t)}},{key:"calculateRoundTripLatencyStats",value:function(e,t){t>=be.RoundtripLatencyWarnThreshold?(this.m_countRoundtripLatencyInWarnWindow=Math.min(be.FragmentLatencyWarnWindow,this.m_countRoundtripLatencyInWarnWindow+1),t>=be.RoundtripLatencyErrorThreshold?this.m_countRoundtripLatencyInErrorWindow=Math.min(be.FragmentLatencyErrorWindow,this.m_countRoundtripLatencyInErrorWindow+1):this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)):(this.m_countRoundtripLatencyInWarnWindow=Math.max(0,this.m_countRoundtripLatencyInWarnWindow-1),this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)),t>=be.RoundtripLatencyWarnThreshold&&this.logRoundTripLatencyInfo(e,t)}},{key:"calculateNetworkQualityStats",value:function(e,t,n){var i=this.m_currentHeartbeatSendInterval>=be.HeartbeatInterval+be.RoundtripLatencyWarnThreshold,o=this.m_currentHeartbeatLatency>=be.RoundtripLatencyWarnThreshold,a=!i&&o;this.m_countFragmentLatencyInErrorWindow>=be.FragmentLatencyErrorWindow||this.m_countRoundtripLatencyInErrorWindow>=be.FragmentLatencyErrorWindow?(this.m_inFragmentLatencyErrorStatus=!0,this.m_totalNetworkErrorMessageCount+=1):0===this.m_countFragmentLatencyInErrorWindow&&0===this.m_countRoundtripLatencyInErrorWindow&&(this.m_inFragmentLatencyErrorStatus=!1,this.m_gapNumberBetweenPingPongMessage=0),this.m_countFragmentLatencyInWarnWindow>=be.FragmentLatencyWarnWindow||this.m_countRoundtripLatencyInWarnWindow>=be.FragmentLatencyWarnWindow?(this.m_inFragmentLatencyWarnStatus=!0,this.m_totalNetworkWarningMessageCount+=1):0===this.m_countFragmentLatencyInWarnWindow&&0===this.m_countRoundtripLatencyInWarnWindow&&(this.m_inFragmentLatencyWarnStatus=!1);var s={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,PartialMessageLatency:t,RoundtripLatencyMS:n,MessageCorrelationID:e,TranscriberID:this.m_transcriberId,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,IsHighHeartbeatLatency:o,IsBrowserFreeze:i,IsNetworkIssue:a};this.m_inFragmentLatencyErrorStatus?oe.sendTraceTag(595716098,r.PptSession,S.Error,JSON.stringify(s)):this.m_inFragmentLatencyWarnStatus&&oe.sendTraceTag(595716099,r.PptSession,S.Error,JSON.stringify(s))}},{key:"onPingMessageSent",value:function(e){this.m_isWaitingForPongResponse=!0;var t=0!==this.m_heartbeatSendTime?this.m_heartbeatSendTime:Date.now(),n=Date.now(),i=n-t;this.m_heartbeatSendTime=n,this.m_currentHeartbeatSendInterval=i;var o={RealHeartbeatSendInterval:i,PreHeartbeatSendTime:t,CurHeartbeatSendTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};if(i>ue.HeartbeatInterval+ue.RoundtripLatencyWarnThreshold?oe.sendTraceTag(595716173,r.PptSession,S.Warning,JSON.stringify(o)):oe.sendTraceTag(595716174,r.PptSession,S.Info,JSON.stringify(o)),this.m_gapNumberBetweenPingPongMessage>=2){var a=be.NoInternetConnectionInMs;this.calculateRoundTripLatencyStats(e,a),this.calculateNetworkQualityStats(e,-1,a),oe.sendTraceTag(595716175,r.PptSession,S.Error,"Transcriber::startSpeechConnection Probably loss network connection: TranscriberID: ".concat(this.m_transcriberId," CorrelationID: ").concat(e)),this.telemetryManager.recordSpeechClientError(_e.LossInternetConnection,"gapNumberBetweenPingPongMessage :".concat(this.m_gapNumberBetweenPingPongMessage),Date.now(),!1)}this.m_gapNumberBetweenPingPongMessage+=1}},{key:"checkForPongResponse",value:function(){this.m_isWaitingForPongResponse&&this.updateNetworkQuality(ae.Error)}},{key:"detectNetworkQuality",value:function(e){switch(e>=ue.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount<ue.NetworkPingPongMaxWarningCount?this.m_networkQualityWarningCount+=1:e<ue.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount>0&&(this.m_networkQualityWarningCount-=1),e>=ue.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount<ue.NetworkPingPongMaxErrorCount?this.m_networkQualityErrorCount+=1:e<ue.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount>0&&(this.m_networkQualityErrorCount-=1),this.m_currentNetworkQualityStatus){case ae.Normal:this.m_networkQualityErrorCount===ue.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(ae.Error):this.m_networkQualityWarningCount===ue.NetworkPingPongMaxWarningCount&&this.updateNetworkQuality(ae.Warning);break;case ae.Warning:this.m_networkQualityErrorCount===ue.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(ae.Error):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(ae.Normal);break;case ae.Error:0===this.m_networkQualityErrorCount&&this.m_networkQualityWarningCount>0?this.updateNetworkQuality(ae.Warning):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(ae.Normal)}}},{key:"updateNetworkQuality",value:function(e){if(this.m_currentNetworkQualityStatus!==e){this.m_currentNetworkQualityStatus=e;var t=0,n=0;switch(e){case ae.Normal:t=0,n=h.None;break;case ae.Warning:t=ue.NetworkQualityWarningPriority,n=h.Warning_SlowConnection;break;case ae.Error:t=ue.NetworkQualityErrorPriority,n=h.Error_SlowConnection}var r={severity:0,priority:t,shortCode:n,longCode:0,shortString:"",longString:""};this.events.emit("qualityStatusUpdate",r)}}},{key:"onPongMessageReceived",value:function(e){var t;this.m_isWaitingForPongResponse=!1,this.m_gapNumberBetweenPingPongMessage-=1;var n=Date.now();t=n-this.m_heartbeatSendTime,this.calculateFrontDoorRoundTripLatency(e),this.m_currentHeartbeatLatency=t;var i={RoundtripLatency:t,HeartbeatSendTime:this.m_heartbeatSendTime,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};t>be.RoundtripLatencyWarnThreshold?oe.sendTraceTag(595716113,r.PptSession,S.Warning,JSON.stringify(i)):oe.sendTraceTag(595716114,r.PptSession,S.Info,JSON.stringify(i)),this.calculateRoundTripLatencyStats(e,this.m_currentHeartbeatLatency),this.calculateNetworkQualityStats(e,-1,this.m_currentHeartbeatLatency)}},{key:"calculatePreMessageLatency",value:function(e){try{var t=Date.now();if(this.m_messageLatencyTable[e]=t,this.m_totalEntriesInLatencyTable+=1,this.m_totalEntriesInLatencyTable>this.c_maxEntriesInLatencyTable){for(var n in this.m_latencyTableDeletedCount+=1,this.m_messageLatencyTable)this.m_messageLatencyTable[n]<t-6e4&&(delete this.m_messageLatencyTable[n],this.m_totalEntriesInLatencyTable-=1);oe.sendTraceTag(595716171,r.PptSession,S.Info,"Transcriber::calculatePreMessageLatency Deleted all entries in the latency table older than 1 minute. Number of times entries in the latency table have surpassed allowed max: \n                ".concat(this.m_latencyTableDeletedCount," TranscriberID: ").concat(this.m_transcriberId))}}catch(e){oe.sendTraceTag(595716172,r.PptSession,S.Warning,"Transcriber::calculatePreMessageLatency Exception while calculating message latency ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePartialMessageLatency",value:function(e,t,n,i){var o=Date.now();if(this.m_totalPartialMessagesCount+=1,this.m_totalPartialMessageLatency+=n,this.m_maxPartialMessageLatency=Math.max(this.m_maxPartialMessageLatency,n),this.m_minPartialMessageLatency=Math.min(this.m_minPartialMessageLatency,n),n>be.MaxAllowedFragmentLatencyMS&&(this.m_totalHighLatencyPartialMessagesCount+=1,!be.IsLogEachTranscriptMessage)){var a=this.m_totalPartialMessageLatency/this.m_totalPartialMessagesCount;oe.sendTraceTag(595716101,r.PptSession,S.Warning,JSON.stringify({PartialMessageCount:this.m_totalPartialMessagesCount,PartialMessageLatency:n,MaxPartialMessageLatency:this.m_maxPartialMessageLatency,MinPartialMessageLatency:this.m_minPartialMessageLatency,AvePartialMessageLatency:a,TotalPartialMessageLatency:this.m_totalPartialMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:o,TotalHighLatencyPartialMessagesCount:this.m_totalHighLatencyPartialMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}this.calculateMessageLatencyStats(e,n),this.calculateRoundTripLatencyStats(e,t),this.calculateNetworkQualityStats(e,n,t)}},{key:"calculateFinalMessageLatency",value:function(e,t,n,i){var o=Date.now();if(this.m_totalFinalMessagesCount+=1,this.m_totalFinalMessageLatency+=n,this.m_maxFinalMessageLatency=Math.max(this.m_maxFinalMessageLatency,n),this.m_minFinalMessageLatency=Math.min(this.m_minFinalMessageLatency,n),n>be.MaxAllowedFinalFragmentLatencyMS&&(this.m_totalHighLatencyFinalMessagesCount+=1,!be.IsLogEachTranscriptMessage)){var a=this.m_totalFinalMessageLatency/this.m_totalFinalMessagesCount;oe.sendTraceTag(595716102,r.PptSession,S.Warning,JSON.stringify({FinalMessageCount:this.m_totalFinalMessagesCount,FinalMessageLatency:n,MaxFinalMessageLatency:this.m_maxFinalMessageLatency,MinFinalMessageLatency:this.m_minFinalMessageLatency,AveFinalMessageLatency:a,TotalFinalMessageLatency:this.m_totalFinalMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:o,TotalHighLatencyFinalMessagesCount:this.m_totalHighLatencyFinalMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}for(var s in this.m_messageLatencyTable)this.m_messageLatencyTable[s]<=i&&(delete this.m_messageLatencyTable[s],this.m_totalEntriesInLatencyTable-=1)}},{key:"calculatePostMessageLatency",value:function(e,t,n){try{var i=Date.now(),o=0,a=this.m_messageLatencyTable[t];a?(o=Date.now()-a,e?this.calculateFinalMessageLatency(t,n,o,a):this.calculatePartialMessageLatency(t,n,o,a)):(this.m_totalMessageCorrelationIDNotFoundCount+=1,oe.sendTraceTag(595716103,r.PptSession,S.Warning,"calculatePostMessageLatency: correlationID: ".concat(t," was not present in the correlationID table. Total messages with the correlation id not found ").concat(this.m_totalMessageCorrelationIDNotFoundCount,"\n          TranscriberID: ").concat(this.m_transcriberId," isFinalMessage: ").concat(e))),this.m_realTimeFactorHandler.calculateAndLogRealTimeReceiveFactorStats(i,t,o,n,e)}catch(e){oe.sendTraceTag(595716107,r.PptSession,S.Warning,"calculatePostMessageLatency:Calculating the message latency threw an exception: ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePreAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculatePreAudioMetrics(e)}},{key:"calculatePostAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculateAndLogRealTimeSendFactorStats(e)}},{key:"isNetworkError",value:function(){return!!this.m_inFragmentLatencyErrorStatus&&(oe.sendTraceTag(595716115,r.PptSession,S.Warning,"SpeechHealthManager: Temporary network error"),this.telemetryManager.recordSpeechClientError(_e.TemporaryDisableSubtitleDueNetworkError,"Network error with error windows : ".concat(this.m_countFragmentLatencyInErrorWindow),Date.now(),!1),!0)}},{key:"stopSession",value:function(){this.m_pongMessageTimerId&&(clearInterval(this.m_pongMessageTimerId),this.m_pongMessageTimerId=0),this.m_realTimeFactorHandler.onSessionEnd();var e=this.m_frontdoorTotalRoundTripLatency/this.m_frontdoorRoundTripLatencyCount;this.telemetryManager.recordFrontdoorRoundTripLatency(e),this.telemetryManager.recordNetworkQuality(this.m_totalNetworkErrorMessageCount,this.m_totalNetworkWarningMessageCount),this.telemetryManager.recordMessageLatencyStats(this.m_totalMessageCorrelationIDNotFoundCount,this.m_latencyTableDeletedCount,this.m_totalEntriesInLatencyTable),this.telemetryManager.recordPartialMessageLatency(this.m_maxPartialMessageLatency,this.m_minPartialMessageLatency,this.m_totalPartialMessagesCount,this.m_totalHighLatencyPartialMessagesCount,this.m_totalPartialMessageLatency),this.telemetryManager.recordFinalMessageLatency(this.m_maxFinalMessageLatency,this.m_minFinalMessageLatency,this.m_totalFinalMessagesCount,this.m_totalHighLatencyFinalMessagesCount,this.m_totalFinalMessageLatency)}},{key:"calculateFrontDoorRoundTripLatency",value:function(e){var t=this.m_messageLatencyTable[e];if(t){var n=Date.now(),i=n-t,o={RoundtripLatency:i,HeartbeatSendTime:t,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};oe.sendTraceTag(594032288,r.PptSession,S.Info,JSON.stringify(o)),this.m_frontdoorRoundTripLatencyCount+=1,this.m_frontdoorTotalRoundTripLatency+=i,this.detectNetworkQuality(i)}else oe.sendTraceTag(594346950,r.PptSession,S.Warning,"onPongMessageReceived: correlationID: ".concat(e," was not present in the correlationID table, TranscriberID: ").concat(this.m_transcriberId))}}]),e}();!function(e){e[e.SpeechRecognitionStarted=0]="SpeechRecognitionStarted",e[e.SpeechEnd=1]="SpeechEnd"}(he||(he={}));var me=function e(){g()(this,e)};me.ProcessVisionDataCommand="processVisionData",me.HandleClientMetaData="handleClientMetaData",me.DefaultSpeechProcessorScriptPath="https://cdn.hubblecontent.osi.office.net/getty/publish/speechclientassets/audioworklet-speech-processor.js";var de,pe=function(){function e(t,n,r,i,o,a){var s=this;g()(this,e),this.speechRecognitionPaused=!1,this.telemetryManager={},this.webcamClient=null,this.speechHealthManager={},this.events=new k.EventEmitter,this.recordingBuffer=[],this.onText=function(e){if(s.speechClientObserver){var t=function(e){var t,n={},r=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),o=i[0],a=i[1];n[o]=a}}catch(e){r.e(e)}finally{r.f()}return n}(e.transcripts),n=s.getRecognitionResultMetadata(e.properties);e.isFinal?(s.speechClientObserver.onFinalText(e.transcripts,e.properties),s.speechClientObserver.onFinalRecognitionText&&s.speechClientObserver.onFinalRecognitionText(t,n),s.events.emit("FinalReceived")):(s.speechClientObserver.onFragmentText(e.transcripts,e.properties),s.speechClientObserver.onPartialRecognitionText&&s.speechClientObserver.onPartialRecognitionText(t,n))}},this.onErr=function(e){s.speechClientObserver&&s.speechClientObserver.onError(e)},this.onSpeechStatus=function(e,t){if(s.speechClientObserver)switch(e){case he.SpeechRecognitionStarted:!s.speechRecognitionPaused&&s.speechClientObserver&&s.speechClientObserver.onSpeechRecognitionStarted&&(s.speechClientObserver.onSpeechRecognitionStarted(t),s.speechClientConfig.sendClientMetaDataOnSessionStart&&s.sendClientMetaData(t));break;case he.SpeechEnd:s.speechClientObserver&&s.speechClientObserver.onSpeechEnd&&s.speechClientObserver.onSpeechEnd(),s.events.emit("SpeechEnd")}},this.onSpeechSessionStarted=function(e){s.speechClientObserver&&s.speechClientObserver.onSpeechSessionStarted&&s.speechClientObserver.onSpeechSessionStarted(e)},this.onAudioData=function(e){s.speechClientConfig.enableDebugAudioRecording&&s.recordingBuffer.push(e),s.speechClientObserver&&s.speechClientObserver.onAudioData&&s.speechClientObserver.onAudioData(e)},this.onRehearsalUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:u.RehearsalDashboardUpdate,currentSlideIndex:e.currentSlideIndex,features:e.features};s.speechClientObserver.onEventUpdate(t)}e.isFinal&&s.events.emit("FinalReceived")},this.onQualityStatusUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:u.QualityStatusUpdate,severity:e.severity,priority:e.priority,shortCode:e.shortCode,longCode:e.longCode,shortString:e.shortString,longString:e.longString};s.speechClientObserver.onEventUpdate(t)}},this.onFrontDoorConnectionRetry=function(){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var e={eventName:u.ConnectionRetry};s.speechClientObserver.onEventUpdate(e)}},this.speechClientObserver=n,le=o,this.speechClientConfig=t,this.mediaSource=i||new J(this.getSpeechProcessorScript(),t.microphoneDeviceId),this.telemetryManager=new X(le),this.speechHealthManager=new fe(le,this.telemetryManager),this.speechFrontDoorProxy=new Me(this.speechClientConfig,r,a||new _,le,this.telemetryManager,this.speechHealthManager),this.startWebcamCapture(),this.registerSpeechFrontDoorEvents()}var t,n;return y()(e,[{key:"getSpeechProcessorScript",value:function(){return this.speechClientConfig.speechProcessorScript&&this.speechClientConfig.useDefaultSpeechProcessorScript&&le.sendTraceTag(562128599,r.PptSession,S.Warning,"SpeechClient::getSpeechProcessorScript speechProcessorScript and useDefaultSpeechProcessorScript are both enabled. Defaulting to using the passed speechProcessorScript path."),this.speechClientConfig.speechProcessorScript?this.speechClientConfig.speechProcessorScript:this.speechClientConfig.useDefaultSpeechProcessorScript?me.DefaultSpeechProcessorScriptPath:void 0}},{key:"startSpeechRecognition",value:(n=I()(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryManager.recordSpeechClientConnectionStart(this.speechClientConfig),this.recordingBuffer=[],this.speechRecognitionPaused=!1,e.next=5,this.tryInitializeUserMedia();case 5:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:this.speechFrontDoorProxy.startConnection(this.mediaSource,t||!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"startWebcamCapture",value:function(){this.speechClientConfig.webcamConfig&&(this.webcamClient?le.sendTraceTag(593019980,r.PptSession,S.Warning,"SpeechClient::startWebcamCapture webcam already exists"):this.webcamClient=new te(this.speechClientConfig.webcamConfig,this.onWebcamFrame.bind(this)))}},{key:"stopWebcamCapture",value:function(){this.webcamClient&&(this.webcamClient.stopMediaCapture(),this.webcamClient=null)}},{key:"resumeWebcamCapture",value:function(){if(this.webcamClient)if(this.speechClientConfig.captureAudioPauseResumeRecordingState){this.webcamClient.startMediaCapture();var e={eventName:u.MediaEvent,mediaStatus:l.VideoSetupCompleted};this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(e)}else this.webcamClient.resumeMediaCapture()}},{key:"pauseWebcamCapture",value:function(){this.webcamClient&&(this.speechClientConfig.captureAudioPauseResumeRecordingState?this.webcamClient.stopMediaCapture():this.webcamClient.pauseMediaCapture())}},{key:"stopSpeechRecognition",value:function(){var e=this;if(this.speechClientConfig.handleEndOfAudioInSpeechClientStopRecognition){this.sendEndOfAudio();var t=new Promise((function(t,n){var r=e.speechClientConfig.handleEndOfAudioTimeoutInMS?e.speechClientConfig.handleEndOfAudioTimeoutInMS:1e4;setTimeout(t,r,c.WaitForSpeechEndTimeout)})),n=new Promise((function(t,n){e.events.on("SpeechEnd",t)}));Promise.race([t,n]).then((function(t){e.closeConnectionInternal(),e.speechClientObserver&&e.speechClientObserver.onSpeechRecognitionStopped&&(t?e.speechClientObserver.onSpeechRecognitionStopped(String(t)):e.speechClientObserver.onSpeechRecognitionStopped(c.Normal))}))}else this.mediaSource.stopAudioCapture(),this.closeConnectionInternal(),this.speechClientObserver&&this.speechClientObserver.onSpeechRecognitionStopped&&this.speechClientObserver.onSpeechRecognitionStopped(c.Normal)}},{key:"closeConnectionInternal",value:function(){this.speechFrontDoorProxy.stopConnection(),this.logEndOfSessionTelemetry(),this.speechRecognitionPaused=!1,this.finishRecordingDebugAudio()}},{key:"logEndOfSessionTelemetry",value:function(){this.telemetryManager.recordMediaCaptureSourceTelemetry(this.mediaSource),this.telemetryManager.publishSessionTelemetry()}},{key:"sendEndOfAudio",value:function(){this.speechFrontDoorProxy.onSendEndOfAudio(),this.mediaSource.stopAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","endOfAudio"]]))}},{key:"pauseSpeechRecognition",value:function(){this.speechRecognitionPaused=!0,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.stopAudioCapture():this.mediaSource.pauseAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","pause"]])),this.speechFrontDoorProxy.pauseSpeechRecognition()}},{key:"resumeSpeechRecognition",value:function(){this.speechRecognitionPaused=!1,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.startAudioCapture():this.mediaSource.resumeAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","resume"]])),this.speechFrontDoorProxy.resumeSpeechRecognition()}},{key:"setCustomSetting",value:function(e,t){this.speechFrontDoorProxy.setCustomSetting(e,t)}},{key:"getCustomSetting",value:function(e){return this.speechFrontDoorProxy.getCustomSetting(e)}},{key:"enableVoiceStreaming",value:function(){this.speechFrontDoorProxy.enableVoiceStreaming()}},{key:"disableVoiceStreaming",value:function(){this.speechFrontDoorProxy.disableVoiceStreaming()}},{key:"sendDictionaryRequestMessage",value:function(e){this.sendClientRequestMessage(H.fromMap(e))}},{key:"sendGenericRequestMessage",value:function(e,t){this.sendClientRequestMessage(new H(e,t))}},{key:"sendClientRequestMessage",value:function(e){this.speechFrontDoorProxy.sendClientRequestMessage(e)}},{key:"getRecognitionResultMetadata",value:function(e){var t={};return e.size>0&&e.forEach((function(e,n){if(e)if("JsonResult"===n){var i=JSON.parse(e);t.id=i.Id,t.duration=i.Duration,t.offset=i.Offset,t.properties=JSON.parse(e)}else null===t.properties||void 0===t.properties?t.properties={key:e}:t.properties[n]=e;else le.sendTraceTag(592229530,r.PptSession,S.Info,"SpeechClient::getRecognitionResultMetadata value is null for key: ".concat(n," }"))})),t}},{key:"tryInitializeUserMedia",value:(t=I()(b.a.mark((function e(){var t,n,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mediaSource.startAudioCapture();case 3:if((t=e.sent)!==s.ErrorNone){e.next=9;break}n={eventName:u.MediaEvent,mediaStatus:l.AudioDeviceConnected},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(n),e.next=12;break;case 9:return this.telemetryManager.recordSpeechClientError(_e.GetUserMediaFailed,t,Date.now(),!1),this.onErr(t),e.abrupt("return",!1);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(0),this.telemetryManager.recordSpeechClientError(_e.GetUserMediaFailed,"ErrorAudio".concat(e.t0.name),Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorAudio".concat(e.t0.name)),e.abrupt("return",!1);case 19:if(!this.webcamClient){e.next=39;break}return e.prev=20,e.next=23,this.webcamClient.startMediaCapture();case 23:if((r=e.sent)!==s.ErrorNone){e.next=29;break}i={eventName:u.MediaEvent,mediaStatus:l.VideoSetupCompleted},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(i),e.next=32;break;case 29:return this.telemetryManager.recordSpeechClientError(_e.GetUserMediaFailed,r,Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(r)),e.abrupt("return",!1);case 32:e.next=39;break;case 34:return e.prev=34,e.t1=e.catch(20),this.telemetryManager.recordSpeechClientError(_e.GetUserMediaFailed,"ErrorVideo".concat(e.t1.name),Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(e.t1.name)),e.abrupt("return",!1);case 39:return e.abrupt("return",!0);case 40:case"end":return e.stop()}}),e,this,[[0,14],[20,34]])}))),function(){return t.apply(this,arguments)})},{key:"finishRecordingDebugAudio",value:function(){if(this.speechClientConfig.enableDebugAudioRecording)if(this.recordingBuffer&&0!==this.recordingBuffer.length)if(this.mediaSource.sampleRate){le.sendTraceTag(570954313,r.PptSession,S.Info,"SpeechClient::finishRecordingDebugAudio: Constructing WAV file for download...");var e,t,n,i,o=this.getFlattenedRecordingBuffer(),a=(e=this.mediaSource.sampleRate,t=o,n=new ArrayBuffer(44+2*t.length),re(i=new DataView(n),0,"RIFF"),i.setUint32(4,44+2*t.length,!0),re(i,8,"WAVE"),re(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,1,!0),i.setUint32(24,e,!0),i.setUint32(28,2*e,!0),i.setUint16(32,2,!0),i.setUint16(34,16,!0),re(i,36,"data"),i.setUint32(40,2*t.length,!0),function(e,t,n){for(var r=44,i=0;i<n.length;i+=1,r+=2){var o=n[i];e.setInt16(r,o,!0)}}(i,0,t),i),s=new Blob([a],{type:"audio/wav"}),c=URL.createObjectURL(s),u="debug_recording_".concat(Date.now(),".wav"),l=document.createElement("a");document.body.appendChild(l),l.href=c,l.download=u,l.click(),window.URL.revokeObjectURL(c),le.sendTraceTag(570954314,r.PptSession,S.Info,"SpeechClient::finishRecordingDebugAudio: Successfully created WAV file for download.")}else le.sendTraceTag(570954312,r.PptSession,S.Error,"SpeechClient::finishRecordingDebugAudio sample rate not found - unable to fetch debug audio recording.");else le.sendTraceTag(570954311,r.PptSession,S.Error,"SpeechClient::finishRecordingDebugAudio recording buffer is empty when trying to fetch debug audio recording.")}},{key:"getFlattenedRecordingBuffer",value:function(){var e=0;this.recordingBuffer.forEach((function(t){e+=t.length}));for(var t=new Int16Array(e),n=0,r=0;r<this.recordingBuffer.length;r+=1)t.set(this.recordingBuffer[r],n),n+=this.recordingBuffer[r].length;return t}},{key:"registerSpeechFrontDoorEvents",value:function(){var e=this;this.speechFrontDoorProxy.on("text",(function(t){e.onText(t)})),this.speechFrontDoorProxy.on("error",(function(t){e.onErr(t)})),this.speechFrontDoorProxy.on("speechStatus",(function(t,n){e.onSpeechStatus(t,n)})),this.speechFrontDoorProxy.on("speechSessionStarted",(function(t){e.onSpeechSessionStarted(t)})),this.speechFrontDoorProxy.on("audioData",(function(t){e.onAudioData(t)})),this.speechFrontDoorProxy.on("rehearsalUpdate",(function(t){e.onRehearsalUpdate(t)})),this.speechFrontDoorProxy.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)})),this.speechFrontDoorProxy.on("webSocketConnectionRetry",(function(){e.onFrontDoorConnectionRetry()})),this.speechHealthManager.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)}))}},{key:"sendClientMetaData",value:function(e){var t=new Map;t.set("command",me.HandleClientMetaData),t.set("data",JSON.stringify(this.speechFrontDoorProxy.getClientMetaDataMap())),t.set("speechMode",this.speechClientConfig.speechMode),t.set("SessionId",e),this.sendDictionaryRequestMessage(t)}},{key:"onWebcamFrame",value:function(e,t){var n={clientSentTimeMS:Date.now(),clientSessionSentTimeMS:this.speechFrontDoorProxy.getElapsedSessionTimeInMS()},r=new Map;r.set("command",me.ProcessVisionDataCommand),r.set("data",e),r.set("correlation",t||""),r.set("operationMetadata",JSON.stringify(n)),this.sendDictionaryRequestMessage(r)}}]),e}(),ge=n(47);function ve(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Se(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ce=function e(){g()(this,e)};Ce.AudioFactorCalculationDurationMS="AudioFactorCalculationDurationMS",Ce.BufferSize="BufferSize",Ce.CustomEndpointEnabled="CustomEndpointEnabled",Ce.CustomEndpointRequestCorrelationID="CustomEndpointRequestCorrelationID",Ce.CurrentTimestampMS="CurrentTimestampMS",Ce.DataLoggingTimeInterval="DataLoggingTimeInterval",Ce.Endpoint="Endpoint",Ce.FatalErrors="FatalErrors",Ce.FirstMessageLatencyMS="FirstMessageLatencyMS",Ce.InitializeWebSocketEndTimeMS="InitializeWebSocketEndTimeMS",Ce.InitializeWebSocketStartTimeMS="InitializeWebSocketStartTimeMS",Ce.LatencyTableDeletedCount="LatencyTableDeletedCount",Ce.MaxFinalMessageLatencyMS="MaxFinalMessageLatencyMS",Ce.MaxPartialMessageLatencyMS="MaxPartialMessageLatencyMS",Ce.MediaCaptureSourceTelemetry="MediaCaptureSourceTelemetry",Ce.MessageLatencyCalculationTimeMS="MessageLatencyCalculationTimeMS",Ce.MinFinalMessageLatencyMS="MinFinalMessageLatencyMS",Ce.MinPartialMessageLatencyMS="MinPartialMessageLatencyMS",Ce.NonFatalErrors="NonFatalErrors",Ce.OnGetUserMediaSuccessEntryPoint="OnGetUserMediaSuccessEntryPoint",Ce.RealTimeFactorLowerThreshold="RealTimeFactorLowerThreshold",Ce.RealTimeFactorUpperThreshold="RealTimeFactorUpperThreshold",Ce.RequestCustomEndpointEndTimeMS="RequestCustomEndpointEndTimeMS",Ce.RequestCustomEndpointFailedEndTimeMS="RequestCustomEndpointFailedEndTimeMS",Ce.RequestCustomEndpointStartTimeMS="RequestCustomEndpointStartTimeMS",Ce.RequestCustomEndpointTimedOutEndTimeMS="RequestCustomEndpointTimedOutEndTimeMS",Ce.SendFirstMessageTime="SendFirstMessageTime",Ce.SpeechLanguage="SpeechLanguage",Ce.TotalAudioFactorOutsideOfThresholdCount="TotalAudioFactorOutsideOfThresholdCount",Ce.TotalEntriesInLatencyTable="TotalEntriesInLatencyTable",Ce.TotalFinalMessagesCount="TotalFinalMessagesCount",Ce.TotalFinalMessageLatency="TotalFinalMessageLatency",Ce.TotalHighLatencyPartialMessagesCount="TotalHighLatencyPartialMessagesCount",Ce.TotalHighLatencyFinalMessagesCount="TotalHighLatencyFinalMessagesCount",Ce.TotalMessageCorrelationIDNotFoundCount="TotalMessageCorrelationIDNotFoundCount",Ce.TotalNetworkErrorMessageCount="TotalNetworkErrorMessageCount",Ce.TotalNetworkWarningMessageCount="TotalNetworkWarningMessageCount",Ce.AverageFrontDoorRoundTripLatencyCount="AverageFrontDoorRoundTripLatencyCount",Ce.TotalPartialMessageLatency="TotalPartialMessageLatency",Ce.TotalPartialMessagesCount="TotalPartialMessagesCount",Ce.TotalTranscriptOutsideOfThresholdCount="TotalTranscriptOutsideOfThresholdCount",Ce.TranscriberID="TranscriberID",Ce.TranscriptionEntryPointCalled="TranscriptionEntryPointCalled",Ce.TranscriptionStartTime="TranscriptionStartTime",Ce.TranscriptionEndTime="TranscriptionEndTime",Ce.TranslationLanguage="TranslationLanguage",Ce.WebSocketClosedTimestamp="WebSocketClosedTimestamp",Ce.WebSocketConnectionDurationMS="WebSocketConnectionDurationMS",Ce.WebSocketCreateTimestamp="WebSocketCreateTimestamp",Ce.WebSocketCustomEndpoint="WebSocketCustomEndpoint",Ce.WebSocketOpenedTimestamp="WebSocketOpenedTimestamp",Ce.WebSocketRetryAttempts="WebSocketRetryAttempts",Ce.WebSocketRetryReason="WebSocketRetryReason",Ce.FEnableContentlogging="FEnableContentlogging",Ce.SpeechMode="SpeechMode",Ce.SpeechClientRecognitionStartTime="SpeechClientConnectionStartTime";var _e=function e(){g()(this,e)};_e.CustomEndpointClientError="CustomEndpointClientError",_e.CustomEndpointClientFailureReason="CustomEndpointClientFailureReason",_e.CustomEndpointServerError="CustomEndpointServerError",_e.CustomEndpointServerErrorCode="CustomEndpointServerErrorCode",_e.CustomEndpointServerFailureReason="CustomEndpointServerFailureReason",_e.ErrorStatus="ErrorStatus",_e.InvalidDocId="InvalidDocId",_e.MessageErrorCode="MessageErrorCode",_e.TranscriptErrorCode="TranscriptErrorCode",_e.WebSocketDisconnected="WebSocketDisconnected",_e.WebSocketErrorCode="WebSocketErrorCode",_e.WebSocketRetryConnectionFailed="WebSocketRetryConnectionFailed",_e.WebsocketConnectionFailure="WebsocketConnectionFailure",_e.InitializeAudioContextFailed="InitializeAudioContextFailed",_e.InitializeTranscriberSessionFailed="InitializeTranscriberSessionFailed",_e.GetUserMediaFailed="GetUserMediaFailed",_e.ReadSettingsFailed="ReadSettingsFailed",_e.DisplayQualityStatusException="DisplayQualityStatusException",_e.TemporaryDisableSubtitleDueNetworkError="TemporaryDisableSubtitleDueNetworkError",_e.LossInternetConnection="LossInternetConnection";var Te,be=function e(){g()(this,e)};be.MaxAllowedFragmentLatencyMS=5e3,be.MaxAllowedFinalFragmentLatencyMS=2e4,be.DefaultBufferSize=8192,be.DataLoggingIntervalMS=3e4,be.RealTimeFactorLowerThreshold=0,be.RealTimeFactorUpperThreshold=999,be.IsLogEachTranscriptMessage=!0,be.IsContentLoggingEnabled=!1,be.CustomEndpointRequestTimeoutInMs=5e3,be.HeartbeatInterval=5e3,be.RoundtripLatencyWarnThreshold=500,be.RoundtripLatencyErrorThreshold=2500,be.FragmentLatencyWarnThreshold=2e4,be.FragmentLatencyErrorThreshold=3e4,be.MaxAllowedRetryCountPerSession=15,be.FragmentLatencyWarnWindow=6,be.FragmentLatencyErrorWindow=3,be.NoInternetConnectionInMs=12e4,be.MessageType="mix",be.SpeechFDBase="wss://pptservicescast.officeapps.live.com/",function(e){e.NotStarted="NotStarted",e.InitialConnecting="InitialConnecting",e.InitialConnectionRetrying="InitialConnectionRetrying",e.InitialConnectionRetryingFailed="InitialConnectionRetryingFailed",e.ConnectionSuccessful="ConnectionSuccessful",e.ConnectionDropRetrying="ConnectionDropRetrying",e.ConnectionDropRetryingFailed="ConnectionDropRetryingFailed"}(Te||(Te={}));var Me=function(e){R()(i,e);var t,n=(t=i,function(){var e,n=x()(t);if(Se()){var r=x()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return D()(this,e)});function i(e,t,r,o,a,s){var c;return g()(this,i),(c=n.call(this)).m_wsUri="",c.m_webSocketConnectionRetryAttempts=-1,c.m_webSocketTotalRetryCountInSession=-1,c.c_maxWebSocketRetryAttempts=5,c.c_websocketRetryInterval=5e3,c.m_wsTimer=0,c.m_sessionTimer=new se,c.m_transcriberId="",c.m_isFirstWebSocketConnection=!0,c.m_roundLatencyTimerId=0,c.m_sendPingMessageFlag=!1,c.m_fSendClientMetadata=!0,c.m_endpointId=null,c.telemetryManager={},c.speechHealthManager={},c.webSocket=null,c.customSettingsMap=new Map,c.disableStreaming=!1,c.events=new k.EventEmitter,c.generatedUserSessionId=Object(z.v4)(),c.m_fSessionPaused=!1,c.m_fEndOfAudioSent=!1,c.m_fdConnectionState=Te.NotStarted,de=o,c.speechConfig=e,c.authProvider=t,c.webSocketFactory=r,c.telemetryManager=a,c.speechHealthManager=s,c}return y()(i,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"onSendEndOfAudio",value:function(){this.m_fEndOfAudioSent=!0}},{key:"setCustomSetting",value:function(e,t){this.customSettingsMap.set(e,t)}},{key:"getCustomSetting",value:function(e){return this.customSettingsMap.get(e)}},{key:"enableVoiceStreaming",value:function(){this.disableStreaming=!1,this.m_sessionTimer.resume(),de.sendTraceTag(595632129,r.PptSession,S.Info,"Voice streaming is enabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"disableVoiceStreaming",value:function(){this.disableStreaming=!0,this.m_sessionTimer.pause(),de.sendTraceTag(595632130,r.PptSession,S.Info,"Voice streaming is disabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"pauseSpeechRecognition",value:function(){this.speechHealthManager.resetMessageLatency(),this.m_fSessionPaused=!0,this.m_sessionTimer.pause()}},{key:"resumeSpeechRecognition",value:function(){this.m_fSessionPaused=!1,this.m_sessionTimer.resume()}},{key:"getElapsedSessionTimeInMS",value:function(){return this.m_sessionTimer.getElapsedSessionTimeInMS()}},{key:"startConnection",value:function(e,t){this.m_fdConnectionState=Te.InitialConnecting,this.telemetryManager.recordSpeechRecognitionStart(),this.initialize();var n=Object(z.v4)();de.sendTraceTag(595126293,r.PptSession,S.Info,"Start speech connection: TranscriberID: ".concat(n)),this.disableStreaming=t,this.disableStreaming&&de.sendTraceTag(595632131,r.PptSession,S.Info,"Voice streaming is disabled: TranscriberID: ".concat(n));var i=be.DefaultBufferSize;isNaN(i)||(be.DefaultBufferSize=i),this.speechConfig.documentDownloadConfig&&!this.speechConfig.requestServiceCustomEndpoint?(de.sendTraceTag(595716118,r.PptSession,S.Info,JSON.stringify({EnableCustomEndpoint:this.speechConfig.documentDownloadConfig||!1,TranscriberID:n})),this.configureCustomEndpointRequest(e,n)):this.startSpeechConnection(e,n),this.speechHealthManager.startSession(n),this.m_sessionTimer.restart(!this.disableStreaming)}},{key:"initialize",value:function(){this.m_webSocketConnectionRetryAttempts=-1,this.m_webSocketTotalRetryCountInSession=-1,clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_transcriberId="",this.m_isFirstWebSocketConnection=!0,this.m_sendPingMessageFlag=!1,this.m_endpointId=""}},{key:"stopConnection",value:function(){try{this.speechHealthManager.stopSession(),this.telemetryManager.recordSpeechClientConnectionEnd(this.m_transcriberId),this.telemetryManager.recordWebSocketRetryCounts(this.m_webSocketTotalRetryCountInSession),this.m_fdConnectionState!==Te.NotStarted&&this.m_fdConnectionState!==Te.ConnectionSuccessful&&this.telemetryManager.recordSpeechClientError(_e.WebsocketConnectionFailure,this.m_fdConnectionState,Date.now(),!0),this.m_sessionTimer.stop(),this.m_fdConnectionState=Te.NotStarted}catch(e){de.sendTraceTag(595716045,r.PptSession,S.Info,"Transcriber::stopFrontdoorConnection threw an exception:".concat(e,"TranscriberID: ").concat(this.m_transcriberId))}this.closeWebSocket(),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.removeAllListeners()}},{key:"sendClientRequestMessage",value:function(e){if(this.webSocket)if(this.webSocket.readyState===m.Open)try{this.webSocket.send(e.serializeBinary())}catch(e){de.sendTraceTag(595711878,r.PptSession,S.Error,"sendClientRequestMessage threw an exception:".concat(e,". TranscriberID: ").concat(this.m_transcriberId))}else de.sendTraceTag(595711877,r.PptSession,S.Info,"Cannot send client request message because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else de.sendTraceTag(595711876,r.PptSession,S.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"logTranscriberErrorTelemetry",value:function(e){e[Ce.TranscriberID]=this.m_transcriberId,e[Ce.CurrentTimestampMS]=Date.now(),de.sendTraceTag(595716049,r.PptSession,S.Error,JSON.stringify(e))}},{key:"setTranscriptionResult",value:function(e){this.events.emit("text",e)}},{key:"setTranscriptionErrorText",value:function(e){this.events.emit("error",e)}},{key:"triggerSpeechStatusEvent",value:function(e){this.events.emit("speechStatus",e,this.m_transcriberId)}},{key:"triggerAudioDataEvent",value:function(e){this.events.emit("audioData",e)}},{key:"triggerRehearsalUpdate",value:function(e){var t=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(t,e.correlationId,-1),this.events.emit("rehearsalUpdate",e)}},{key:"triggerQualityStatusUpdate",value:function(e){this.events.emit("qualityStatusUpdate",e)}},{key:"triggerFrontdoorConnectionRetryEvent",value:function(){this.events.emit("webSocketConnectionRetry")}},{key:"triggerSpeechSessionStarted",value:function(e){this.events.emit("speechSessionStarted",e)}},{key:"processAudioChunk",value:function(e,t){if(!this.disableStreaming&&!this.m_fSessionPaused)if(this.webSocket)if(this.webSocket.readyState===m.Open){var n=Date.now(),i=new V;i.correlationId=t||Object(z.v4)(),this.speechHealthManager.calculatePreMessageLatency(i.correlationId),this.triggerAudioDataEvent(new Int16Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/2)));var o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);i.audio=o,i.sourceLanguage=this.speechConfig.sourceLanguage,i.settings.set("targetLanguageList",this.speechConfig.targetLanguages);var a,s=ve(this.customSettingsMap);try{for(s.s();!(a=s.n()).done;){var c=E()(a.value,2),u=c[0],l=c[1];"clientMetadata"===u&&(this.m_fSendClientMetadata=!0),i.settings.set(u,l)}}catch(e){s.e(e)}finally{s.f()}this.speechConfig.documentDownloadConfig&&this.m_endpointId&&i.settings.set("endpointId",this.m_endpointId),this.m_fSendClientMetadata&&(this.m_fSendClientMetadata=!1,i.setClientMetaData(this.getClientMetaDataMap())),this.m_sendPingMessageFlag&&(i.settings.set("isPingMessage","true"),this.m_sendPingMessageFlag=!1,this.speechHealthManager.onPingMessageSent(i.correlationId)),this.speechConfig.properties&&i.setProperties(this.speechConfig.properties),i.setOperationMetadata(Date.now(),this.m_sessionTimer.getElapsedSessionTimeInMS());var h=i.serializeBinary();this.telemetryManager.recordInitialAudioMessage(),this.speechHealthManager.calculatePreAudioMessageStats(n),this.webSocket.send(h),this.speechHealthManager.calculatePostAudioMessageStats(i.correlationId)}else de.sendTraceTag(595716170,r.PptSession,S.Info,"Cannot send audio data because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else de.sendTraceTag(595716169,r.PptSession,S.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"enablePingMessage",value:function(){this.m_sendPingMessageFlag||(this.m_sendPingMessageFlag=!0)}},{key:"startSpeechConnection",value:function(e,t){this.m_transcriberId=t;var n=Object(z.v4)(),r=this.speechConfig.speechFDBase||be.SpeechFDBase,i=this.speechConfig.clientType||a.web,s="".concat(r,"SpeechHandler.ashx?action=Transcribe&client=").concat(i,"&session=").concat(this.m_transcriberId,"&message=").concat(be.MessageType,"&speechMode=").concat(this.speechConfig.speechMode,"&sampleRate=").concat(e.sampleRate,"&app=").concat(this.speechConfig.clientApp||o.PowerPoint,"&locale=").concat(this.speechConfig.sourceLanguage,"&contenttype=url&requestcorrelationid=").concat(n);if(this.speechConfig.scenarioName&&(s+="&scenarioName=".concat(this.speechConfig.scenarioName)),this.speechConfig.requestServiceCustomEndpoint&&(s+="&fCreateCustomEndpoint=".concat(this.speechConfig.requestServiceCustomEndpoint)),this.speechConfig.documentDownloadConfig){var c=this.sanitizeDocID(this.speechConfig.documentDownloadConfig.docId,t);s+="&PodSID=".concat(this.speechConfig.documentDownloadConfig.podsSessionId)+"&podurl=".concat(this.speechConfig.documentDownloadConfig.webServiceBase)+"&wacuserdatacluster=".concat(this.speechConfig.documentDownloadConfig.userDataCenterClusterId)+"&docid=".concat(c)}this.telemetryManager.recordWebSocketConnectionStart(r,t),this.m_wsUri=s,e.onaudioprocess=this.processAudioChunk.bind(this),this.openWebSocketConnection(),this.m_roundLatencyTimerId=0,this.m_sendPingMessageFlag=!1,this.telemetryManager.recordWebSocketConnectionEnd()}},{key:"sanitizeDocID",value:function(e,t){var n="";if(0===e.length)return n;var i=e.indexOf("access_token");return-1===i?de.sendTraceTag(573309463,r.PptSession,S.Warning,"Transcriber::startSpeechConnection access_token was not found in docID. TranscriberID: ".concat(t)):n=e.substring(0,i),n}},{key:"handleWebSocketOpenEvent",value:function(){this.m_fdConnectionState=Te.ConnectionSuccessful,this.m_roundLatencyTimerId=setInterval(this.enablePingMessage.bind(this),be.HeartbeatInterval),this.m_isFirstWebSocketConnection&&(this.telemetryManager.recordWebSocketConnectionOpen(),this.m_isFirstWebSocketConnection=!1),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_webSocketConnectionRetryAttempts=0,this.m_fSendClientMetadata=!0,this.triggerSpeechStatusEvent(he.SpeechRecognitionStarted)}},{key:"handleRehearsalUpdate",value:function(e){this.triggerRehearsalUpdate(e)}},{key:"handleQualityStatusUpdate",value:function(e){this.triggerQualityStatusUpdate(e)}},{key:"handleTranscriptResultMessage",value:function(e){if(this.telemetryManager.recordInitialMessageLatency(),"success"===e.status){if(e.isPong)return void this.speechHealthManager.onPongMessageReceived(e.correlationId);var t=e.correlationId;this.setTranscriptionResult(e);var n=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(n,t,-1)}else if("speechEnd"===e.status)this.triggerSpeechStatusEvent(he.SpeechEnd);else if("nomatch"===e.status||"notranslation"===e.status){var r=e.messageErrorCode;switch(null!=r&&""!==r||(r="ErrorUnknown"),e.transcriptErrorCode){case"NoMatchReason:NotRecognized":break;case"NoMatchReason:InitialBabbleTimeout":this.setTranscriptionErrorText("ErrorInitialBabbleTimeout");break;case"NoMatchReason:InitialSilenceTimeout":this.setTranscriptionErrorText("ErrorInitialSilenceTimeout");break;case"NoMatchReason:KeywordNotRecognized":break;default:this.handleOnMessageTranscriptionError(e)}}else this.handleOnMessageTranscriptionError(e)}},{key:"handleOnMessageTranscriptionError",value:function(e){try{null==e&&de.sendTraceTag(595716051,r.PptSession,S.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"\n           Response received from speech service was null."));var t=e.messageErrorCode;null!=t&&""!==t||(t="Unknown");var n=e.transcriptErrorCode;-1===["ErrorProtobufDeserializationFailure","ErrorInvalidSubscriptionFromConfig","ErrorInvalidRegionFromConfig","ErrorAddSessionFailure","ErrorInvalidMessage","ErrorCreateSpeechSessionBadRequest","ErrorWaitAudioTimeout","ErrorSpeechHandlerWebSocketFailure","ErrorSpeechRecognitionFailure","ErrorTranslationFailure","ErrorFailedToGetSupportedTextLanguages","ErrorCustomEndpointTimeout"].indexOf(t)?this.telemetryManager.recordSpeechClientError(t,"".concat(n,"_").concat(e.status),Date.now(),!1):this.telemetryManager.recordSpeechClientError(t,"",Date.now(),!0),this.setTranscriptionErrorText(t);var i={};i[_e.MessageErrorCode]=t,i[_e.TranscriptErrorCode]=n,i[_e.ErrorStatus]=e.status,this.logTranscriberErrorTelemetry(i)}catch(e){de.sendTraceTag(595716052,r.PptSession,S.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"Exception thrown: ").concat(e))}}},{key:"handleSpeechResultMessage",value:function(e){this.handleTranscriptResultMessage(e)}},{key:"handleSpeechSessionStartedMessage",value:function(e){this.triggerSpeechSessionStarted(e)}},{key:"handleRehearsalResultMessage",value:function(e){this.handleRehearsalUpdate(e)}},{key:"handleQualityStatusMessage",value:function(e){this.handleQualityStatusUpdate(e)}},{key:"handleWebSocketMessage",value:function(e){B(e,this)}},{key:"handleWebSocketCloseEvent",value:function(e){if(this.closeIntervalTimer(),1e3!==e){var t={};t[_e.WebSocketErrorCode]=e,t[Ce.WebSocketRetryReason]="WebSocketDisconnected",this.logTranscriberErrorTelemetry(t),this.telemetryManager.recordWebsocketCloseError(e),this.retryWebSocketConnectionWrapper()}}},{key:"openWebSocketConnection",value:function(){this.m_webSocketTotalRetryCountInSession+=1,this.m_webSocketConnectionRetryAttempts+=1,this.m_isFirstWebSocketConnection&&0===this.m_webSocketTotalRetryCountInSession&&this.telemetryManager.recordWebSocketCreation(),this.webSocket&&(de.sendTraceTag(595716109,r.PptSession,S.Warning,"Transcriber::OpenWebSocketConnection Found existing web socket connection. Closing it and will open a new one. TranscriberID: ".concat(this.m_transcriberId)),this.closeWebSocket()),this.webSocket=this.webSocketFactory.createWebSocket(this.m_wsUri),{}[Ce.WebSocketRetryReason]="WebSocketConnectionTimeout",this.retryWebSocketConnectionWrapper(),this.webSocket.onopen=this.handleWebSocketOpenEvent.bind(this),this.webSocket.onmessage=this.handleWebSocketMessage.bind(this),this.webSocket.onclose=this.handleWebSocketCloseEvent.bind(this)}},{key:"retryWebSocketConnection",value:function(){if(clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.speechHealthManager.resetMessageLatency(),!this.m_fEndOfAudioSent){if(!this.shouldRetryConnection())return clearTimeout(this.m_wsTimer),this.m_wsTimer=0,void this.closeWebSocket();de.sendTraceTag(595716056,r.PptSession,S.Info,"Transcriber::RetryWebSocketConnection - WebSocket retry attempt: ".concat(this.m_webSocketConnectionRetryAttempts,"\n        TranscriberID: ").concat(this.m_transcriberId)),this.closeWebSocket(),this.m_fdConnectionState=this.m_isFirstWebSocketConnection?Te.InitialConnectionRetrying:this.m_fdConnectionState=Te.ConnectionDropRetrying,this.triggerFrontdoorConnectionRetryEvent(),this.openWebSocketConnection()}}},{key:"retryWebSocketConnectionWrapper",value:function(){0===this.m_wsTimer&&(this.m_wsTimer=setTimeout(this.retryWebSocketConnection.bind(this),this.c_websocketRetryInterval))}},{key:"configureCustomEndpointRequest",value:function(e,t){var n=this;this.speechConfig.documentDownloadConfig&&Ie({docId:this.speechConfig.documentDownloadConfig.docId,speechFrontDoorBase:this.speechConfig.speechFDBase||be.SpeechFDBase,podUrl:this.speechConfig.documentDownloadConfig.webServiceBase,podSessionId:this.speechConfig.documentDownloadConfig.podsSessionId,speechLanguage:this.speechConfig.sourceLanguage,isContentLoggingEnabled:be.IsContentLoggingEnabled,CustomEndpointRequestTimeoutInMs:be.CustomEndpointRequestTimeoutInMs,transcriberID:t,logger:de,telemetryManager:this.telemetryManager,userDataCenterClusterId:this.speechConfig.documentDownloadConfig.userDataCenterClusterId,userSessionId:this.speechConfig.userSessionId||this.generatedUserSessionId,speechMode:this.speechConfig.speechMode,clientApp:this.speechConfig.clientApp||o.PowerPoint}).then((function(r){n.m_endpointId=r.customEndpointID,""===n.m_transcriberId&&n.startSpeechConnection(e,t)})).catch((function(r){n.telemetryManager.recordSpeechClientError(r.recordErrorCode,r.recordErrorReason,Date.now(),!1),n.logTranscriberErrorTelemetry(r.errorInfo),""===n.m_transcriberId&&n.startSpeechConnection(e,t)}))}},{key:"getClientMetaDataMap",value:function(){var e,t=ve(this.customSettingsMap);try{for(t.s();!(e=t.n()).done;){var n=E()(e.value,2),r=n[0],i=n[1];if("clientMetadata"===r){Object(ge.isNullOrUndefined)(this.speechConfig.clientMetaData)&&(this.speechConfig.clientMetaData=new Map);for(var a=JSON.parse(i),s=0,c=Object.keys(a);s<c.length;s++){var u=c[s];this.speechConfig.clientMetaData.set(u,a[u])}}}}catch(e){t.e(e)}finally{t.f()}var l=this.speechConfig.clientApp||o.PowerPoint,h={supportedResponseTypes:"speechresultmixmessage,qualitystatusmixmessage,rehearsalresultmixMessage,speechSessionStartedMixMessage",authorization:this.authProvider.accessToken};if(Object(ge.isNullOrUndefined)(l)||(h.app=l),!Object(ge.isNullOrUndefined)(this.speechConfig.clientMetaData)){var f,m=ve(this.speechConfig.clientMetaData);try{for(m.s();!(f=m.n()).done;){var d=E()(f.value,2),p=d[0],g=d[1];h[p]=g}}catch(e){m.e(e)}finally{m.f()}}return h}},{key:"closeIntervalTimer",value:function(){0!==this.m_roundLatencyTimerId&&(clearInterval(this.m_roundLatencyTimerId),this.m_roundLatencyTimerId=0)}},{key:"closeWebSocket",value:function(){this.webSocket&&(this.closeIntervalTimer(),this.webSocket.onclose=function(){},this.webSocket.close(),this.webSocket=null)}},{key:"shouldRetryConnection",value:function(){var e=!0,t="",n="";if(this.speechConfig.maxRetryCountsInSession&&this.m_webSocketTotalRetryCountInSession>=this.speechConfig.maxRetryCountsInSession?(t=s.ErrorMaxConnectionRetryFailureInSession,n="Client specified maximum retry counts in session reached",e=!1):this.m_webSocketConnectionRetryAttempts>=this.c_maxWebSocketRetryAttempts&&(t=s.ErrorConnectionRetryFailure,n="Maximum retry count reached in current window",e=!1),de.sendTraceTag(571770508,r.PptSession,S.Info,"WebSocket connection retry failed with error: ".concat(n," TranscriberID: ").concat(this.m_transcriberId)),!e){this.setTranscriptionErrorText(t),this.m_fdConnectionState=this.m_isFirstWebSocketConnection?Te.InitialConnectionRetryingFailed:this.m_fdConnectionState=Te.ConnectionDropRetryingFailed;var i={};return i[_e.WebSocketRetryConnectionFailed]="WebSocketRetryConnectionFailed",this.logTranscriberErrorTelemetry(i),!1}return!0}}]),i}(k.EventEmitter);function Ie(e){var t={},n={};return new Promise(function(){var i=I()(b.a.mark((function i(o,a){var s,c,u,l,h,f,m;return b.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=e.logger,0!==e.docId.length){i.next=8;break}return n.recordErrorCode=_e.InvalidDocId,n.recordErrorReason="",t[_e.CustomEndpointClientFailureReason]="InvalidDocId",n.errorInfo=t,a(n),i.abrupt("return");case 8:c=e.docId,-1===(u=e.docId.indexOf("access_token"))?s.sendTraceTag(595716120,r.PptSession,S.Warning,"Transcriber::RequestCustomEndpoint access_token was not found in docID. TranscriberID: ".concat(e.transcriberID)):c=e.docId.substring(0,u),l=Object(z.v4)(),s.sendTraceTag(595716121,r.PptSession,S.Info,"Transcriber::RequestCustomEndpoint CorrelationID: ".concat(l," TranscriberID: ").concat(e.transcriberID)),h=(h=e.speechFrontDoorBase.replace("wss","https")).replace("ws","http"),f="".concat(h,"CustomEndpointHandler.ashx?action=GetOrCreateCustomEndpoint&podurl=").concat(e.podUrl,"&PODSID=").concat(e.podSessionId,"&docid=").concat(c,"&locale=").concat(e.speechLanguage,"&client=web&contenttype=url&fenablecontentlogging=").concat(e.isContentLoggingEnabled,"&correlationid=").concat(l,"&wacusersessionid=").concat(e.userSessionId,"&wacuserdatacluster=").concat(e.userDataCenterClusterId,"\n    &speechMode=").concat(e.speechMode,"&app=").concat(e.clientApp),m=new XMLHttpRequest,e.telemetryManager.recordCustomEndpointStart(l),m.open("POST",f,!0),m.timeout=e.CustomEndpointRequestTimeoutInMs,m.send(),m.onload=function(){s.sendTraceTag(595716160,r.PptSession,S.Info,"requestCustomEndpointHandler: OnLoad Transcriber ID: ".concat(e.transcriberID)),n.customEndpointID=m.getResponseHeader("X-EndpointID"),e.telemetryManager.recordCustomEndpointEnd(n.customEndpointID),o(n)},m.onerror=function(){s.sendTraceTag(595716161,r.PptSession,S.Info,"requestCustomEndpointHandler: OnError Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=_e.CustomEndpointServerError,n.recordErrorReason="".concat(m.getResponseHeader("X-ErrorCode")," ").concat(m.getResponseHeader("X-FailureReason")," ").concat(m.status),e.telemetryManager.recordCustomEndpointError();var t={};t[_e.CustomEndpointServerErrorCode]=m.getResponseHeader("X-ErrorCode"),t[_e.CustomEndpointServerFailureReason]=m.getResponseHeader("X-FailureReason"),n.errorInfo=t,a(n)},m.ontimeout=function(){s.sendTraceTag(595716162,r.PptSession,S.Info,"requestCustomEndpointHandler: OnTimeout Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=_e.CustomEndpointClientError,n.recordErrorReason="CustomEndpointRequestTimeout";var t={};t[_e.CustomEndpointClientFailureReason]="CustomEndpointRequestTimeout",n.errorInfo=t,e.telemetryManager.recordCustomEndpointTimeout(),a(n)};case 24:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}var we=function(){function e(){g()(this,e)}return y()(e,[{key:"createSpeechClient",value:function(e,t,n,r,i,o){if(t)return new pe(e,t,n,r,i,o)}}]),e}()},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<o;c=r[++n])p(c)||!C(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function u(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&b(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return v(i)||(i=l(e,i,r)),i}var o=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):d(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(b(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(S(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return h(n)}var u,C="",M=!1,I=["{","}"];return m(n)&&(M=!0,I=["[","]"]),b(n)&&(C=" [Function"+(n.name?": "+n.name:"")+"]"),S(n)&&(C=" "+RegExp.prototype.toString.call(n)),_(n)&&(C=" "+Date.prototype.toUTCString.call(n)),T(n)&&(C=" "+h(n)),0!==a.length||M&&0!=n.length?r<0?S(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=M?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)F(t,String(a))?o.push(f(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return f(e,n,r,s,t,M)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(u,C,I)):I[0]+C+I[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),F(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=p(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function m(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function p(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function S(e){return C(e)&&"[object RegExp]"===M(e)}function C(e){return"object"==typeof e&&null!==e}function _(e){return C(e)&&"[object Date]"===M(e)}function T(e){return C(e)&&("[object Error]"===M(e)||e instanceof Error)}function b(e){return"function"==typeof e}function M(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(y(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=d,t.isNull=p,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=S,t.isObject=C,t.isDate=_,t.isError=T,t.isFunction=b,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(160);var w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),w[e.getMonth()],t].join(" ")}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(161),t._extend=function(e,t){if(!t||!C(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(R&&e[R]){var t;if("function"!=typeof(t=e[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),R&&Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=R,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(P,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(143))},function(e,t,n){var r=n(13).f,i=n(21),o=n(8)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(0),i=n(32),o=n(4),a=n(80),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),c=i[e]=s?t(h):a[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},h=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(3),i=n(13),o=n(12),a=n(8)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(18);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){var r=n(154);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(155),i=n(156);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){var r=n(31);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(31),i=n(8)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(5),i=n(26),o=n(8)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PptSession=817]="PptSession"}(t.LogCategory||(t.LogCategory={})),function(e){e.Web="Web",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac"}(t.ClientType||(t.ClientType={})),function(e){e.Default="Rehearsal",e.ReadAlong="ReadAlong"}(t.CoachMode||(t.CoachMode={})),function(e){e.FillerWords="fillerWords",e.Originality="originality",e.WordsPerMinute="wordsPerMinute",e.SensitivePhrases="sensitivePhrases",e.CorrectedSensitivePhrases="correctedSensitivePhrases",e.Positivity="positivity",e.Monotone="monotone",e.Grammar="grammar",e.Occlusion="visionOcclusion",e.OcclusionGood="visionOcclusionGood",e.Gaze="visionGaze",e.GazeGood="visionGazeGood",e.DistanceGood="visionDistanceGood",e.DistanceTooClose="visionDistanceTooClose",e.DistanceTooFar="visionDistanceTooFar",e.Pronunciation="pronunciation",e.CrutchWords="crutchWords"}(t.CoachFeatures||(t.CoachFeatures={}));t.CoachSessionError=function(){};t.CoachSessionTranscriptRequestInfo=function(){};t.CorrectedISensitivePhrasesData=function(){this.phraseData={},this.correction=""};t.CorrectedSensitivePhraseData=function(){this.Phrase="",this.Count=0,this.Correction=""};t.CoachSessionTelemetry=function(){this.CreateDashboardTimeInMS=0,this.FDidSeeSuggestions=!1,this.FRehearsalDidStart=!1,this.NumberOfOptoutCritiques=0,this.NumberOfPauses=0,this.NumberOfSlidesWithOriginalitySuggestion=0,this.NumberOfSlidesRehearsed=0,this.RehearsalDurationInSeconds=0,this.AverageWPM=0,this.RehearsalEndTime=0,this.RehearsalId="",this.RehearsalStartTime=0,this.SuggestionCountsByName={},this.CrutchWordUsageCounts=[],this.PronunciationWordTriggerCounts=[],this.CritiqueLatencyTelemetry={},this.FSpeechRecognitionStarted=!1,this.EntryPoint="",this.SourceLanguage="",this.FVisionEnabled=!1,this.AudioInputDeviceCount=0};var r=function(){function e(){}return e.DetectedValueWithMessage="detectedvaluewithmessage",e.GaugeWithMessage="gaugewithmessage",e.SingleMessage="singlemessage",e.IconWithMessage="iconwithmessage",e.TemperaturePillWithMessage="temperaturepillwithmessage",e.FontIconWithMessage="fonticonwithmessage",e}();t.RehearsalTemplateName=r},function(e,t,n){var r=n(159);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t,n){var r=n(10),i=n(3),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(38)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(23),i=n(9),o=n(40);e.exports=function(e){return function(t,n,a){var s,c=r(t),u=i(c.length),l=o(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(31);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(8)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(5);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(58),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(129);var r=n(18),i=n(22),o=n(4),a=n(32),s=n(8),c=n(95),u=s("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),h=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var f=s(e),m=!o((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),d=m?!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[u]=function(){return n}),n[f](""),!t})):void 0;if(!m||!d||"replace"===e&&!l||"split"===e&&!h){var p=/./[f],g=n(a,f,""[e],(function(e,t,n,r,i){return t.exec===c?m&&!i?{done:!0,value:p.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),v=g[0],y=g[1];r(String.prototype,e,v),i(RegExp.prototype,f,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},function(e,t,n){var r=n(25),i=n(124),o=n(90),a=n(5),s=n(9),c=n(92),u={},l={};(t=e.exports=function(e,t,n,h,f){var m,d,p,g,v=f?function(){return e}:c(e),y=r(n,h,t?2:1),S=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(m=s(e.length);m>S;S++)if((g=t?y(a(d=e[S])[0],d[1]):y(e[S]))===u||g===l)return g}else for(p=v.call(e);!(d=p.next()).done;)if((g=i(p,y,d.value,t))===u||g===l)return g}).BREAK=u,t.RETURN=l},function(e,t,n){var r=n(3).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(3),i=n(0),o=n(18),a=n(53),s=n(35),c=n(70),u=n(52),l=n(6),h=n(4),f=n(66),m=n(48),d=n(81);e.exports=function(e,t,n,p,g,v){var y=r[e],S=y,C=g?"set":"add",_=S&&S.prototype,T={},b=function(e){var t=_[e];o(_,e,"delete"==e||"has"==e?function(e){return!(v&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof S&&(v||_.forEach&&!h((function(){(new S).entries().next()})))){var M=new S,I=M[C](v?{}:-0,1)!=M,w=h((function(){M.has(1)})),E=f((function(e){new S(e)})),F=!v&&h((function(){for(var e=new S,t=5;t--;)e[C](t,t);return!e.has(-0)}));E||((S=t((function(t,n){u(t,S,e);var r=d(new y,t,S);return null!=n&&c(n,g,r[C],r),r}))).prototype=_,_.constructor=S),(w||F)&&(b("delete"),b("has"),g&&b("get")),(F||I)&&b(C),v&&_.clear&&delete _.clear}else S=p.getConstructor(t,e,g,C),a(S.prototype,n),s.NEED=!0;return m(S,e),T[e]=S,i(i.G+i.W+i.F*(S!=y),T),v||p.setStrong(S,e,g),S}},function(e,t,n){for(var r,i=n(3),o=n(22),a=n(37),s=a("typed_array"),c=a("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[f[h++]])?(o(r.prototype,s,!0),o(r.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},function(e,t,n){var r=n(6),i=n(3).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){t.f=n(8)},function(e,t,n){var r=n(62)("keys"),i=n(37);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(3).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(6),i=n(5),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(25)(Function.call,n(28).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(6),i=n(79).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(27),i=n(32);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(27),i=n(32);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(38),i=n(0),o=n(18),a=n(22),s=n(50),c=n(123),u=n(48),l=n(43),h=n(8)("iterator"),f=!([].keys&&"next"in[].keys()),m=function(){return this};e.exports=function(e,t,n,d,p,g,v){c(n,t,d);var y,S,C,_=function(e){if(!f&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",b="values"==p,M=!1,I=e.prototype,w=I[h]||I["@@iterator"]||p&&I[p],E=w||_(p),F=p?b?_("entries"):E:void 0,R="Array"==t&&I.entries||w;if(R&&(C=l(R.call(new e)))!==Object.prototype&&C.next&&(u(C,T,!0),r||"function"==typeof C[h]||a(C,h,m)),b&&w&&"values"!==w.name&&(M=!0,E=function(){return w.call(this)}),r&&!v||!f&&!M&&I[h]||a(I,h,E),s[t]=E,s[T]=m,p)if(y={values:b?E:_("values"),keys:g?E:_("keys"),entries:F},v)for(S in y)S in I||o(I,S,y[S]);else i(i.P+i.F*(f||M),t,y);return y}},function(e,t,n){var r=n(88),i=n(32);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(6),i=n(31),o=n(8)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(8)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(50),i=n(8)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(13),i=n(36);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(58),i=n(8)("iterator"),o=n(50);e.exports=n(10).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(15),i=n(40),o=n(9);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(44),i=n(128),o=n(50),a=n(23);e.exports=n(86)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,i,o=n(67),a=RegExp.prototype.exec,s=String.prototype.replace,c=a,u=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(u||l)&&(c=function(e){var t,n,r,i,c=this;return l&&(n=new RegExp("^"+c.source+"$(?!\\s)",o.call(c))),u&&(t=c.lastIndex),r=a.call(c,e),u&&r&&(c.lastIndex=c.global?r.index+r[0].length:t),l&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";var r=n(85)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,i,o,a=n(25),s=n(117),c=n(78),u=n(74),l=n(3),h=l.process,f=l.setImmediate,m=l.clearImmediate,d=l.MessageChannel,p=l.Dispatch,g=0,v={},y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},S=function(e){y.call(e.data)};f&&m||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},m=function(e){delete v[e]},"process"==n(31)(h)?r=function(e){h.nextTick(a(y,e,1))}:p&&p.now?r=function(e){p.now(a(y,e,1))}:d?(o=(i=new d).port2,i.port1.onmessage=S,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",S,!1)):r="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:f,clear:m}},function(e,t,n){"use strict";var r=n(3),i=n(12),o=n(38),a=n(73),s=n(22),c=n(53),u=n(4),l=n(52),h=n(27),f=n(9),m=n(136),d=n(42).f,p=n(13).f,g=n(93),v=n(48),y=r.ArrayBuffer,S=r.DataView,C=r.Math,_=r.RangeError,T=r.Infinity,b=y,M=C.abs,I=C.pow,w=C.floor,E=C.log,F=C.LN2,R=i?"_b":"buffer",P=i?"_l":"byteLength",D=i?"_o":"byteOffset";function L(e,t,n){var r,i,o,a=new Array(n),s=8*n-t-1,c=(1<<s)-1,u=c>>1,l=23===t?I(2,-24)-I(2,-77):0,h=0,f=e<0||0===e&&1/e<0?1:0;for((e=M(e))!=e||e===T?(i=e!=e?1:0,r=c):(r=w(E(e)/F),e*(o=I(2,-r))<1&&(r--,o*=2),(e+=r+u>=1?l/o:l*I(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(e*o-1)*I(2,t),r+=u):(i=e*I(2,u-1)*I(2,t),r=0));t>=8;a[h++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function x(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=n-1,u=e[c--],l=127&u;for(u>>=7;s>0;l=256*l+e[c],c--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:u?-T:T;r+=I(2,t),l-=a}return(u?-1:1)*r*I(2,l-t)}function k(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function O(e){return[255&e]}function A(e){return[255&e,e>>8&255]}function W(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function N(e){return L(e,52,8)}function j(e){return L(e,23,4)}function U(e,t,n){p(e.prototype,t,{get:function(){return this[n]}})}function q(e,t,n,r){var i=m(+n);if(i+t>e[P])throw _("Wrong index!");var o=e[R]._b,a=i+e[D],s=o.slice(a,a+t);return r?s:s.reverse()}function V(e,t,n,r,i,o){var a=m(+n);if(a+t>e[P])throw _("Wrong index!");for(var s=e[R]._b,c=a+e[D],u=r(+i),l=0;l<t;l++)s[c+l]=u[o?l:t-l-1]}if(a.ABV){if(!u((function(){y(1)}))||!u((function(){new y(-1)}))||u((function(){return new y,new y(1.5),new y(NaN),"ArrayBuffer"!=y.name}))){for(var H,B=(y=function(e){return l(this,y),new b(m(e))}).prototype=b.prototype,G=d(b),z=0;G.length>z;)(H=G[z++])in y||s(y,H,b[H]);o||(B.constructor=y)}var J=new S(new y(2)),Q=S.prototype.setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||c(S.prototype,{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else y=function(e){l(this,y,"ArrayBuffer");var t=m(e);this._b=g.call(new Array(t),0),this[P]=t},S=function(e,t,n){l(this,S,"DataView"),l(e,y,"DataView");var r=e[P],i=h(t);if(i<0||i>r)throw _("Wrong offset!");if(i+(n=void 0===n?r-i:f(n))>r)throw _("Wrong length!");this[R]=e,this[D]=i,this[P]=n},i&&(U(y,"byteLength","_l"),U(S,"buffer","_b"),U(S,"byteLength","_l"),U(S,"byteOffset","_o")),c(S.prototype,{getInt8:function(e){return q(this,1,e)[0]<<24>>24},getUint8:function(e){return q(this,1,e)[0]},getInt16:function(e){var t=q(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=q(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return k(q(this,4,e,arguments[1]))},getUint32:function(e){return k(q(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return x(q(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return x(q(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){V(this,1,e,O,t)},setUint8:function(e,t){V(this,1,e,O,t)},setInt16:function(e,t){V(this,2,e,A,t,arguments[2])},setUint16:function(e,t){V(this,2,e,A,t,arguments[2])},setInt32:function(e,t){V(this,4,e,W,t,arguments[2])},setUint32:function(e,t){V(this,4,e,W,t,arguments[2])},setFloat32:function(e,t){V(this,4,e,j,t,arguments[2])},setFloat64:function(e,t){V(this,8,e,N,t,arguments[2])}});v(y,"ArrayBuffer"),v(S,"DataView"),s(S.prototype,a.VIEW,!0),t.ArrayBuffer=y,t.DataView=S},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(141)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof l?t:l,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function l(){}function h(){}function f(){}var m={};m[i]=function(){return this};var d=Object.getPrototypeOf,p=d&&d(d(b([])));p&&p!==t&&n.call(p,i)&&(m=p);var g=f.prototype=l.prototype=Object.create(m);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function b(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:M}}function M(){return{value:void 0,done:!0}}return h.prototype=g.constructor=f,f.constructor=h,f[a]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[o]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new y(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(g),g[a]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=b,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(108),i=function(){function e(){this.m_sessionId="",this.m_startTime=-1,this.m_stopTime=-1,this.m_totalSessionTimeInMS=-1,this.m_paceOverTime=[],this.m_fillers={},this.m_sensitivePhrases={},this.m_originalityScores={},this.m_slidesRehearsed={},this.m_timestampedCritiques=[],this.m_monotoneOverTime=[],this.m_grammarCritiques=[],this.m_visionCritiqueFrames={},this.m_visionGazeCritiques=[],this.m_visionOcclusionCritiques=[],this.m_visionDistanceCritiques=[],this.m_sessionErrors=[]}return e.prototype.reset=function(){this.m_startTime=this.m_stopTime=this.m_totalSessionTimeInMS=-1,this.m_paceOverTime=[],this.m_fillers={},this.m_sensitivePhrases={},this.m_slidesRehearsed={},this.m_monotoneOverTime=[]},e.prototype.ensureIsStarted=function(){-1===this.m_startTime&&this.startCoachSummary()},e.prototype.startCoachSummary=function(){-1!==this.m_stopTime&&this.reset(),this.m_startTime=Date.now().valueOf()},e.prototype.stopCoachSummary=function(e){-1===this.m_stopTime&&(this.m_stopTime=Date.now().valueOf()),this.m_totalSessionTimeInMS=e},e.prototype.setSessionId=function(e){this.ensureIsStarted(),this.m_sessionId=e},e.prototype.addVisionCritiqueFrame=function(e,t,n,r){n&&t&&(void 0!==this.m_visionCritiqueFrames[t]?this.m_visionCritiqueFrames[t].confidenceScore<r&&(this.m_visionCritiqueFrames[t]={critiqueTime:e,critiqueFrame:n,confidenceScore:r}):this.m_visionCritiqueFrames[t]={critiqueTime:e,critiqueFrame:n,confidenceScore:r})},e.prototype.addTimestampedCritique=function(e,t,n){this.m_timestampedCritiques.push({triggerTimestampMS:t,featureInfo:r.mapToObjectHelper(n),featureName:e})},e.prototype.addError=function(e){this.m_sessionErrors.push({error:e,timestamp:Date.now().valueOf()})},e.prototype.getTimeSpent=function(){if(this.m_totalSessionTimeInMS>=0)return Math.round(this.m_totalSessionTimeInMS/1e3);var e=Date.now().valueOf(),t=-1===this.m_startTime?e:this.m_startTime,n=-1===this.m_stopTime?e:this.m_stopTime;return t>n&&(t=n),Math.round((n-t)/1e3)},e.prototype.getNumSlidesRehearsed=function(){return Object.keys(this.m_slidesRehearsed).length},e.prototype.getPaceOverTime=function(){var e=[];return this.m_paceOverTime.forEach((function(t){e.push({pace:Math.round(t.pace),timePoint:Math.round(t.timePoint/1e3)})})),e},e.prototype.getFillers=function(){var e=this,t=[];return Object.keys(this.m_fillers).forEach((function(n){t.push({word:n,count:Number(e.m_fillers[n])})})),t.sort((function(e,t){return t.count-e.count})),t},e.prototype.getSortedSensitivePhrases=function(e){var t=this;void 0===e&&(e=!1);var n=[];return Object.keys(this.m_sensitivePhrases).forEach((function(r){n.push({phraseData:{phrase:r,count:Number(t.m_sensitivePhrases[r].count)},correction:e&&t.m_sensitivePhrases[r].correction||""})})),n.sort((function(e,t){return t.phraseData.count-e.phraseData.count})),n},e.prototype.getOriginalityProblemSlides=function(){var e=[];return Object.keys(this.m_originalityScores).forEach((function(t){return e.push(Number(t))})),e},e.prototype.getTimestampedCritiques=function(){return this.m_timestampedCritiques},e.prototype.getTraceRequestMetadata=function(){var e={};return e.ClientSessionId=this.m_sessionId,e},e.prototype.getEndOfSessionWarnings=function(e){var t=[];return 0===this.getAveragePace()&&t.push("ZeroWPMDetected"),this.getTimeSpent()<=10&&t.push("ShortSession"),e.FRehearsalDidStart||t.push("SessionDidNotConnect"),t},e.prototype.getSessionDiagnostics=function(e){return{endOfSessionWarnings:this.getEndOfSessionWarnings(e),sessionErrors:this.m_sessionErrors}},e.prototype.getThumbIndicesForSummary=function(){var e=[],t={};return Object.keys(this.m_originalityScores).forEach((function(e){return t[Number(e)]=!0})),this.m_grammarCritiques.forEach((function(e){return t[e.slideIndex]=!0})),Object.keys(t).forEach((function(t){return e.push(Number(t))})),e},e.prototype.getGrammar=function(){return this.m_grammarCritiques},e.MaxPaceTimePoints=64,e.MaxMonotoneTimePoints=1e4,e}();t.BaseCoachSummaryCollector=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToObjectHelper=function e(t){var n={};return t.forEach((function(t,r){t instanceof Map?n[r]=e(t):n[r]=t})),n},t.convertTimestampedCritiqueToLoggableValue=function(e,t){var n={};return e.forEach((function(e){var r=(e.triggerTimestampMS-t).toString();n[r]=e.featureName})),n}},function(e,t,n){e.exports=!n(12)&&!n(4)((function(){return 7!=Object.defineProperty(n(74)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(3),i=n(10),o=n(38),a=n(75),s=n(13).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(21),i=n(23),o=n(63)(!1),a=n(76)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(13),i=n(5),o=n(39);e.exports=n(12)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,c=0;s>c;)r.f(e,n=a[c++],t[n]);return e}},function(e,t,n){var r=n(23),i=n(42).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";var r=n(12),i=n(39),o=n(64),a=n(57),s=n(15),c=n(56),u=Object.assign;e.exports=!u||n(4)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,l=1,h=o.f,f=a.f;u>l;)for(var m,d=c(arguments[l++]),p=h?i(d).concat(h(d)):i(d),g=p.length,v=0;g>v;)m=p[v++],r&&!f.call(d,m)||(n[m]=d[m]);return n}:u},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(26),i=n(6),o=n(117),a=[].slice,s={},c=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?c(t,r.length,r):o(t,r,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(3).parseInt,i=n(49).trim,o=n(80),a=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},function(e,t,n){var r=n(3).parseFloat,i=n(49).trim;e.exports=1/r(n(80)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(31);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(6),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){"use strict";var r=n(41),i=n(36),o=n(48),a={};n(22)(a,n(8)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(5);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(261);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(26),i=n(15),o=n(56),a=n(9);e.exports=function(e,t,n,s,c){r(t);var u=i(e),l=o(u),h=a(u.length),f=c?h-1:0,m=c?-1:1;if(n<2)for(;;){if(f in l){s=l[f],f+=m;break}if(f+=m,c?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;c?f>=0:h>f;f+=m)f in l&&(s=t(s,l[f],f,u));return s}},function(e,t,n){"use strict";var r=n(15),i=n(40),o=n(9);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),h=1;for(c<s&&s<c+l&&(h=-1,c+=l-1,s+=l-1);l-- >0;)c in n?n[s]=n[c]:delete n[s],s+=h,c+=h;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(95);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(12)&&"g"!=/./g.flags&&n(13).f(RegExp.prototype,"flags",{configurable:!0,get:n(67)})},function(e,t,n){"use strict";var r,i,o,a,s=n(38),c=n(3),u=n(25),l=n(58),h=n(0),f=n(6),m=n(26),d=n(52),p=n(70),g=n(59),v=n(97).set,y=n(281)(),S=n(132),C=n(282),_=n(71),T=n(133),b=c.TypeError,M=c.process,I=M&&M.versions,w=I&&I.v8||"",E=c.Promise,F="process"==l(M),R=function(){},P=i=S.f,D=!!function(){try{var e=E.resolve(1),t=(e.constructor={})[n(8)("species")]=function(e){e(R,R)};return(F||"function"==typeof PromiseRejectionEvent)&&e.then(R)instanceof t&&0!==w.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),L=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},x=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&A(e),e._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===t.promise?u(b("Promise-chain cycle")):(o=L(n))?o.call(n,c,u):c(n)):u(r)}catch(e){l&&!a&&l.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&k(e)}))}},k=function(e){v.call(c,(function(){var t,n,r,i=e._v,o=O(e);if(o&&(t=C((function(){F?M.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=F||O(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},A=function(e){v.call(c,(function(){var t;F?M.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},W=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},N=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw b("Promise can't be resolved itself");(t=L(e))?y((function(){var r={_w:n,_d:!1};try{t.call(e,u(N,r,1),u(W,r,1))}catch(e){W.call(r,e)}})):(n._v=e,n._s=1,x(n,!1))}catch(e){W.call({_w:n,_d:!1},e)}}};D||(E=function(e){d(this,E,"Promise","_h"),m(e),r.call(this);try{e(u(N,this,1),u(W,this,1))}catch(e){W.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(53)(E.prototype,{then:function(e,t){var n=P(g(this,E));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=F?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&x(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(N,e,1),this.reject=u(W,e,1)},S.f=P=function(e){return e===E||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!D,{Promise:E}),n(48)(E,"Promise"),n(51)("Promise"),a=n(10).Promise,h(h.S+h.F*!D,"Promise",{reject:function(e){var t=P(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!D),"Promise",{resolve:function(e){return T(s&&this===a?E:this,e)}}),h(h.S+h.F*!(D&&n(66)((function(e){E.all(e).catch(R)}))),"Promise",{all:function(e){var t=this,n=P(t),r=n.resolve,i=n.reject,o=C((function(){var n=[],o=0,a=1;p(e,!1,(function(e){var s=o++,c=!1;n.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=P(t),r=n.reject,i=C((function(){p(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(26);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(5),i=n(6),o=n(132);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(13).f,i=n(41),o=n(53),a=n(25),s=n(52),c=n(70),u=n(86),l=n(128),h=n(51),f=n(12),m=n(35).fastKey,d=n(45),p=f?"_s":"size",g=function(e,t){var n,r=m(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,r){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[p]=0,null!=r&&c(r,n,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=d(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=d(this,t),r=g(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[p]--}return!!r},forEach:function(e){d(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(d(this,t),e)}}),f&&r(l.prototype,"size",{get:function(){return d(this,t)[p]}}),l},def:function(e,t,n){var r,i,o=g(e,t);return o?o.v=n:(e._l=o={i:i=m(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[p]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=d(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))}),n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){"use strict";var r=n(53),i=n(35).getWeak,o=n(5),a=n(6),s=n(52),c=n(70),u=n(30),l=n(21),h=n(45),f=u(5),m=u(6),d=0,p=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},v=function(e,t){return f(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=m(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=d++,e._l=void 0,null!=r&&c(r,n,e[o],e)}));return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?p(h(this,t)).delete(e):n&&l(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?p(h(this,t)).has(e):n&&l(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?p(e).set(t,n):r[e._i]=n,e},ufstore:p}},function(e,t,n){var r=n(27),i=n(9);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(42),i=n(64),o=n(5),a=n(3).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(9),i=n(82),o=n(32);e.exports=function(e,t,n,a){var s=String(o(e)),c=s.length,u=void 0===n?" ":String(n),l=r(t);if(l<=c||""==u)return s;var h=l-c,f=i.call(u,Math.ceil(h/u.length));return f.length>h&&(f=f.slice(0,h)),a?f+s:s+f}},function(e,t,n){var r=n(12),i=n(39),o=n(23),a=n(57).f;e.exports=function(e){return function(t){for(var n,s=o(t),c=i(s),u=c.length,l=0,h=[];u>l;)n=c[l++],r&&!a.call(s,n)||h.push(e?[n,s[n]]:s[n]);return h}}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){(function(e){!function(e){function t(){}function n(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1==r.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}if(e.TextEncoder&&e.TextDecoder)return!1;var r=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var n=e.length,r=0,i=Math.max(32,n+(n>>1)+7),o=new Uint8Array(i>>3<<3);t<n;){var a=e.charCodeAt(t++);if(55296<=a&&56319>=a){if(t<n){var s=e.charCodeAt(t);56320==(64512&s)&&(++t,a=((1023&a)<<10)+(1023&s)+65536)}if(55296<=a&&56319>=a)continue}if(r+4>o.length&&(i+=8,i=(i*=1+t/e.length*2)>>3<<3,(s=new Uint8Array(i)).set(o),o=s),0==(4294967168&a))o[r++]=a;else{if(0==(4294965248&a))o[r++]=a>>6&31|192;else if(0==(4294901760&a))o[r++]=a>>12&15|224,o[r++]=a>>6&63|128;else{if(0!=(4292870144&a))continue;o[r++]=a>>18&7|240,o[r++]=a>>12&63|128,o[r++]=a>>6&63|128}o[r++]=63&a|128}}return o.slice?o.slice(0,r):o.subarray(0,r)},Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(n.prototype,"fatal",{value:!1}),Object.defineProperty(n.prototype,"ignoreBOM",{value:!1}),n.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");e.buffer instanceof ArrayBuffer&&(e=e.buffer),e=new Uint8Array(e),t=0;for(var n=[],r=[];;){var i=t<e.length;if(!i||65536&t){if(r.push(String.fromCharCode.apply(null,n)),!i)return r.join("");n=[],e=e.subarray(t),t=0}if(0===(i=e[t++]))n.push(0);else if(0==(128&i))n.push(i);else if(192==(224&i)){var o=63&e[t++];n.push((31&i)<<6|o)}else if(224==(240&i)){o=63&e[t++];var a=63&e[t++];n.push((31&i)<<12|o<<6|a)}else 240==(248&i)&&(65535<(i=(7&i)<<18|(o=63&e[t++])<<12|(a=63&e[t++])<<6|63&e[t++])&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i))}},e.TextEncoder=t,e.TextDecoder=n}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,n(103))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&m())}function m(){if(!l){var e=s(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||s(m)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){function r(){return e._babelPolyfill||"undefined"!=typeof window&&window._babelPolyfill?null:n(167)}Object.defineProperty(t,"__esModule",{value:!0}),t.idempotentBabelPolyfill=r,t.default=void 0;var i=r();t.default=i}).call(this,n(103))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(148),i=function(){function e(){}return e.prototype.createCoachManager=function(e){return new r.CoachManager(e)},e}();t.CoachSessionFactory=i,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(60))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=n(46),o=n(162),a=n(17),s=n(11);n(144);var c,u=n(108),l=function(){function e(){}return e.getSupportedRehearsalTemplates=function(){var e="";for(var t in r.RehearsalTemplateName)null!=t&&t.length>0&&(e+=0===e.length?t:","+t);return e},e.getDefaultRequestedRehearsalFeatures=function(){return r.CoachFeatures.WordsPerMinute+",\n          "+r.CoachFeatures.FillerWords+",\n          "+r.CoachFeatures.SensitivePhrases+",\n          "+r.CoachFeatures.CorrectedSensitivePhrases+",\n          "+r.CoachFeatures.Originality+",\n          "+r.CoachFeatures.Positivity},e.getRehearsalMetadataJSON=function(t,n){var r;r=t.supportedRehearsalTemplates?t.supportedRehearsalTemplates:this.getSupportedRehearsalTemplates();var i={requestedRehearsalFeatures:null===t.requestedCoachFeatures||void 0===t.requestedCoachFeatures?e.getDefaultRequestedRehearsalFeatures():t.requestedCoachFeatures,supportedRehearsalTemplates:r,iscoachresultsummaryaggregationrequested:t.fEnableServiceSideAggregationForCoach,requestedRehearsalOptOutFeatures:null===t.requestedRehearsalOptOutFeatures||void 0===t.requestedRehearsalOptOutFeatures?"":t.requestedRehearsalOptOutFeatures,pronunciationScenarioId:t.pronunciationScenarioId};return t.fEnableServiceSideAggregationForCoach&&n&&(i[this.UserToken]=n),JSON.stringify(i)},e.UserToken="userToken",e}();t.RehearsalManagerSettings=l;var h=function(){function e(e){this.m_disabledRealtimeFeatures={},this.m_sessionTelemetry=new r.CoachSessionTelemetry,this.m_events=new a.EventEmitter,this.m_sessionPaused=!0,this.m_presentationTimeInSeconds=0,this.m_sessionTranscriptRequestInfo=new r.CoachSessionTranscriptRequestInfo,this.m_rehearsalId="",this.m_sourceLanguage="",this.m_userToken="",this.fValidateSessionConfig(e),this.m_sessionConfig=e,c=this.m_sessionConfig.logger,this.m_sourceLanguage=this.checkOrGetDefaultSourceLanguage(this.m_sessionConfig.sourceLanguage,this.m_sessionConfig.userSessionId),this.m_userToken=s.v4(),this.m_sessionConfig.sessionTranscriptionRequested||(this.m_sessionConfig.sessionTranscriptionRequested=!1),this.setDisabledRealtimeFeatureSet(),this.setUpSpeechClient(),this.m_coachSummaryCollector=o.CoachSummaryCollectorFactory.createCoachSummaryCollector(this.m_sessionConfig,this.m_userToken)}return e.prototype.fValidateSessionConfig=function(e){e.coachMode&&e.coachMode===r.CoachMode.ReadAlong&&this.fValidateReadAlongSessionConfig(e)},e.prototype.fValidateReadAlongSessionConfig=function(e){if(!e.referenceText||0===e.referenceText.length||!e.requestedCoachFeatures||!e.requestedCoachFeatures.toLowerCase().includes("pronunciationraw"))throw new Error("ReadAlong mode requires non-empty reference text and pronunciationRaw in requestedCoachFeatures")},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.startSession=function(e){if(this.m_sessionTelemetry=new r.CoachSessionTelemetry,this.initializeCoachSessionTelemetry(),this.m_coachSummaryCollector.startCoachSummary(),this.m_speechClient.startSpeechRecognition(e),e?this.disableVoiceStreaming():this.enableVoiceStreaming(),this.m_sessionConfig.customSettings){for(var t=0,n=Object.keys(this.m_sessionConfig.customSettings);t<n.length;t++){var i=n[t],o=this.m_sessionConfig.customSettings[i];this.m_speechClient.setCustomSetting(i,o)}"currentSlideIndex"in this.m_sessionConfig.customSettings&&this.m_sessionConfig.customSettings.currentSlideIndex&&this.m_coachSummaryCollector.addSlideRehearsed(Number(this.m_sessionConfig.customSettings.currentSlideIndex))}0!==this.m_timerId&&clearInterval(this.m_timerId),this.m_presentationTimeInSeconds=0,this.m_timerId=setInterval(this.updateTimer.bind(this),1e3)},e.prototype.getSessionDurationInMs=function(){return 1e3*this.m_presentationTimeInSeconds},e.prototype.sendEndOfAudio=function(){this.m_speechClient.sendEndOfAudio()},e.prototype.stopSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.stopWebcamCapture(),this.m_speechClient.stopSpeechRecognition();var e=this.getSessionDurationInMs();this.m_coachSummaryCollector.stopCoachSummary(e),this.logEndOfCoachSessionTelemetry(),this.m_sessionPaused=!1,0!==this.m_timerId&&clearInterval(this.m_timerId),this.m_presentationTimeInSeconds=0},e.prototype.pauseSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.pauseWebcamCapture(),this.m_sessionPaused=!0,this.m_speechClient.pauseSpeechRecognition(),this.m_sessionTelemetry.NumberOfPauses+=1},e.prototype.resumeSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.resumeWebcamCapture(),this.m_speechClient.resumeSpeechRecognition(),this.m_sessionPaused=!1},e.prototype.enableVoiceStreaming=function(){this.m_speechClient.enableVoiceStreaming(),this.m_sessionTelemetry.RehearsalStartTime=Date.now(),this.m_sessionTelemetry.FRehearsalDidStart=!0,this.m_sessionPaused=!1},e.prototype.disableVoiceStreaming=function(){this.m_speechClient.disableVoiceStreaming(),this.m_sessionPaused=!0},e.prototype.updateSessionConfiguration=function(e){if(this.m_sessionConfig.fEnableVision&&!e.fEnableVision&&this.m_speechClient.stopWebcamCapture(),this.m_sessionConfig=e,this.m_sessionConfig.customSettings){for(var t=0,n=Object.keys(this.m_sessionConfig.customSettings);t<n.length;t++){var r=n[t],i=this.m_sessionConfig.customSettings[r];this.m_speechClient.setCustomSetting(r,i)}"currentSlideIndex"in this.m_sessionConfig.customSettings&&this.m_sessionConfig.customSettings.currentSlideIndex&&this.m_coachSummaryCollector.addSlideRehearsed(Number(this.m_sessionConfig.customSettings.currentSlideIndex))}},e.prototype.getSessionSummary=function(e){return null==e?this.m_coachSummaryCollector.getRehearsalSummary():this.m_coachSummaryCollector.getRehearsalSummary((function(t){e(t)}))},e.prototype.getSessionTranscriptRequestInfo=function(){return this.m_sessionTranscriptRequestInfo},e.prototype.getSessionDiagnostics=function(){return this.m_coachSummaryCollector.getSessionDiagnostics(this.m_sessionTelemetry)},e.prototype.getTraceRequestMetadata=function(){var e=this.m_coachSummaryCollector.getTraceRequestMetadata();return e.SessionTelemetry=JSON.stringify(this.m_sessionTelemetry),this.m_sessionConfig.enableTimeStampedCritiqueTelemetry&&(e.RehearsalCritiqueShownWithTimestamps=JSON.stringify(u.convertTimestampedCritiqueToLoggableValue(this.m_coachSummaryCollector.getTimestampedCritiques(),this.m_sessionTelemetry.RehearsalStartTime))),e},e.prototype.getSessionSummaryData=function(){return this.m_coachSummaryCollector.getRehearsalSummary()},e.prototype.onFinalText=function(e,t){},e.prototype.onFragmentText=function(e,t){},e.prototype.onError=function(e){c.sendTraceTag(595633888,i.LogCategory.PptSession,i.TraceLevel.Info,"Error from speech client: "+e),this.m_rehearsalId||(this.m_rehearsalId=s.v4(),this.m_sessionTelemetry.RehearsalId=this.m_rehearsalId),e?this.m_coachSummaryCollector.addError(e):this.m_coachSummaryCollector.addError("UnknownSpeechError"),this.m_events.emit("Error",e)},e.prototype.onSpeechEnd=function(){},e.prototype.onSpeechRecognitionStarted=function(e){this.m_rehearsalId=e,this.m_sessionTelemetry.RehearsalId=e,this.m_sessionTelemetry.FSpeechRecognitionStarted=!0,this.m_coachSummaryCollector&&this.m_coachSummaryCollector.setSessionId(this.m_rehearsalId),c.sendTraceTag(595633889,i.LogCategory.PptSession,i.TraceLevel.Info,"CoachManager: onSpeechRecognitionStarted Speech client Session id: "+e+" Coach Session id: "+this.m_rehearsalId),this.m_events.emit("SpeechRecognitionStarted",e)},e.prototype.onSpeechSessionStarted=function(e){this.m_sessionTranscriptRequestInfo={transcriptionSignature:e.transcriptionSignature,speechSessionHostDataCenter:e.speechSessionHostDataCenter},c.sendTraceTag(574406924,i.LogCategory.PptSession,i.TraceLevel.Info,"CoachManager: onSpeechSessionStarted Speech session host datacenter "+e.speechSessionHostDataCenter+", speech session id: "+e.speechSessionId),this.m_events.emit("SpeechSessionStarted",e)},e.prototype.onSpeechRecognitionStopped=function(e){c.sendTraceTag(574195550,i.LogCategory.PptSession,i.TraceLevel.Info,"CoachManager: onSpeechRecognitionStopped called with reason "+e),this.m_events.emit("SpeechRecognitionStopped",e)},e.prototype.onEventUpdate=function(e){if(e.eventName===i.IEventName.RehearsalDashboardUpdate){var t=e;this.updateRehearsalSummary(t.currentSlideIndex,t.features);var n={features:t.features,currentSlideIndex:t.currentSlideIndex};this.m_events.emit("PPTCoachRealtimeNotification",n),this.m_events.emit("CoachRealtimeNotification",t.features)}if(e.eventName===i.IEventName.MediaEvent){var r=e;if(r.mediaStatus===i.IMediaEventStatus.AudioDeviceConnected||r.mediaStatus===i.IMediaEventStatus.VideoSetupCompleted){var o={mediaStatus:r.mediaStatus};this.m_events.emit("MediaStatusChanged",o)}}if(e.eventName===i.IEventName.QualityStatusUpdate){var a=e,s={severity:a.severity,priority:a.priority,shortCode:a.shortCode,longCode:a.longCode,shortString:a.shortString,longString:a.longString};this.m_events.emit("QualityStatusChanged",s)}e.eventName===i.IEventName.ConnectionRetry&&(this.m_coachSummaryCollector.addError("ConnectionRetry"),this.m_events.emit("ConnectionRetry"))},e.prototype.setDisabledRealtimeFeatureSet=function(){var e=this,t=this.m_sessionConfig.disabledCoachRealtimeFeatures||"";this.m_disabledRealtimeFeatures={},t.split(",").forEach((function(t){t.length>0&&(e.m_disabledRealtimeFeatures[t.toLowerCase()]=!0)}))},e.prototype.fValidTemplate=function(e){return!(e in this.m_disabledRealtimeFeatures&&this.m_disabledRealtimeFeatures[e])},e.prototype.getClientSentTimeMS=function(e,t){var n=Date.now();if(t.has("operationMetadata")&&t.get("operationMetadata").length>0){var r=JSON.parse(t.get("operationMetadata"));r.clientSentTimeMS&&(n=Number(r.clientSentTimeMS),this.updateCritiqueLatencyInTelemetry(e,n))}else c.sendTraceTag(594616412,i.LogCategory.PptSession,i.TraceLevel.Info,"CoachManager: updateRehearsalSummary no Operation Metadata for critique name: "+e);return n},e.prototype.updateRehearsalSummary=function(e,t){var n=this,i="",o=-1;if(t.forEach((function(e,t){var r=t.toLowerCase();if(n.fValidTemplate(r)){var a=e.get("templateInfo"),s=n.getClientSentTimeMS(t,a);a.has("priority")&&Number(a.get("priority"))>o&&(o=Number(a.get("priority")),i=t,o>=0&&n.m_coachSummaryCollector.addTimestampedCritique(t,s,e))}})),o>=0&&this.updateSuggestionShownCountInTelemetry(i),t.has(r.CoachFeatures.FillerWords)){var a=[];(c=t.get(r.CoachFeatures.FillerWords)).has("featureValue")&&(a.push(String(c.get("featureValue"))),this.m_coachSummaryCollector.addFillers(a))}var s=this.getSessionDurationInMs();if(t.has(r.CoachFeatures.WordsPerMinute)&&(c=t.get(r.CoachFeatures.WordsPerMinute)).has("featureValue")&&this.m_coachSummaryCollector.addPace(Number(c.get("featureValue")),s),t.has(r.CoachFeatures.SensitivePhrases)){var c,u=[];(c=t.get(r.CoachFeatures.SensitivePhrases)).has("featureValue")&&u.push(String(c.get("featureValue")));var l=[];if(t.has(r.CoachFeatures.CorrectedSensitivePhrases)){var h=t.get(r.CoachFeatures.CorrectedSensitivePhrases);h&&l.push(String(h.get("featureValue")))}this.m_coachSummaryCollector.addSensitivePhrases(u,l)}if(t.has(r.CoachFeatures.Originality)&&this.m_coachSummaryCollector.addProblematicOriginalitySlide(e),t.has(r.CoachFeatures.Monotone)&&(c=t.get(r.CoachFeatures.Monotone))&&c.has("featureValue")&&this.m_coachSummaryCollector.addMonotone(Number(c.get("featureValue")),e,s),t.has(r.CoachFeatures.Grammar)&&(c=t.get(r.CoachFeatures.Grammar))&&(m=c.get("templateInfo"))&&this.m_coachSummaryCollector.addGrammarCritique(e,m.get("GrammarExplanation"),m.get("GrammarCategoryTitle"),m.get("GrammarContext"),m.get("GrammarCharStartInContext"),m.get("GrammarCharErrorLength"),m.get("GrammarSuggestion")),t.has(r.CoachFeatures.CrutchWords)&&(c=t.get(r.CoachFeatures.CrutchWords))&&c.has("templateInfo")){var f=(m=c.get("templateInfo")).get("CrutchWordSynonyms");m&&this.m_coachSummaryCollector.addCrutchWords(JSON.parse(m.get("GenericCrutchWords")),JSON.parse(m.get("SentenceStartCrutchWord")),JSON.parse(m.get("SentenceEndCrutchWord")),Number(m.get("TotalWordsCount")),f?JSON.parse(f):{})}if(t.has(r.CoachFeatures.Pronunciation)&&(c=t.get(r.CoachFeatures.Pronunciation))&&c.has("templateInfo"))for(var m=c.get("templateInfo"),d=JSON.parse(m.get("MispronouncedWordsKey")),p=0;p<d.length;p+=1){for(var g=[],v=d[p.toString()].Phonemes,y=0;y<v.length;y+=1)g.push(v[y.toString()].Phoneme);this.m_coachSummaryCollector.addMispronouncedWords(d[p.toString()].Word,parseInt(d[p.toString()].WordSlideNo,10),parseInt(d[p.toString()].LowestPhonemeScoreIndex,10),g.join("."),d[p.toString()].Syllables)}if(t.has(r.CoachFeatures.Gaze)){this.m_coachSummaryCollector.addVisionGaze(this.getSessionDurationInMs());var S=this.getVisionFrameData(t,r.CoachFeatures.Gaze);this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.Gaze,S.visionFrame,S.visionConfidenceScore)}t.has(r.CoachFeatures.GazeGood)&&(this.m_coachSummaryCollector.addVisionGaze(this.getSessionDurationInMs()),S=this.getVisionFrameData(t,r.CoachFeatures.GazeGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.GazeGood,S.visionFrame,S.visionConfidenceScore)),t.has(r.CoachFeatures.Occlusion)&&(this.m_coachSummaryCollector.addVisionOcclusion(this.getSessionDurationInMs()),S=this.getVisionFrameData(t,r.CoachFeatures.Occlusion),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.Occlusion,S.visionFrame,S.visionConfidenceScore)),t.has(r.CoachFeatures.OcclusionGood)&&(this.m_coachSummaryCollector.addVisionOcclusion(this.getSessionDurationInMs()),S=this.getVisionFrameData(t,r.CoachFeatures.OcclusionGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.OcclusionGood,S.visionFrame,S.visionConfidenceScore)),t.has(r.CoachFeatures.DistanceGood)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),r.CoachFeatures.DistanceGood),S=this.getVisionFrameData(t,r.CoachFeatures.DistanceGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.DistanceGood,S.visionFrame,S.visionConfidenceScore)),t.has(r.CoachFeatures.DistanceTooClose)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),r.CoachFeatures.DistanceTooClose),S=this.getVisionFrameData(t,r.CoachFeatures.DistanceTooClose),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.DistanceTooClose,S.visionFrame,S.visionConfidenceScore)),t.has(r.CoachFeatures.DistanceTooFar)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),r.CoachFeatures.DistanceTooFar),S=this.getVisionFrameData(t,r.CoachFeatures.DistanceTooFar),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),r.CoachFeatures.DistanceTooFar,S.visionFrame,S.visionConfidenceScore))},e.prototype.getVisionFrameData=function(e,t){var n,r=e.get(t),i=0;if(r&&r.has("templateInfo")){var o=r.get("templateInfo");n=o.get("visionFrame"),i=o.has("confidenceScore")?Number(JSON.parse(o.get("confidenceScore"))):i}return{visionFrame:n,visionConfidenceScore:i}},e.prototype.setUpSpeechClient=function(){var e={clientApp:this.m_sessionConfig.clientApp,clientMetaData:new Map([["rehearsalMetadata",l.getRehearsalMetadataJSON(this.m_sessionConfig,this.m_userToken)],["userID",this.m_sessionConfig.userId||""],["tenantId",this.m_sessionConfig.tenantId||""],["identityProvider",this.m_sessionConfig.identityProvider||""],["audienceChannel",this.m_sessionConfig.audienceChannel||""],["audienceGroup",this.m_sessionConfig.audienceGroup||""],["buildVersion",this.m_sessionConfig.buildVersion||""],["locale",this.m_sessionConfig.locale||""],["wacHost",this.m_sessionConfig.wacHost||""],["wacDatacenter",this.m_sessionConfig.wacDatacenter||""],["sessionTranscriptionRequested",String(this.m_sessionConfig.sessionTranscriptionRequested)||"false"],["referenceText",this.m_sessionConfig.referenceText||""]]),properties:null,sourceLanguage:this.m_sourceLanguage,speechFDBase:this.m_sessionConfig.speechFDBase,speechMode:this.m_sessionConfig.coachMode?i.ISpeechMode[this.m_sessionConfig.coachMode]:i.ISpeechMode.Rehearsal,targetLanguages:this.getTargetLanguagesFromSourceLanguage(this.m_sourceLanguage),handleEndOfAudioInSpeechClientStopRecognition:this.m_sessionConfig.fSendEndOfAudioOnSessionStop,sendClientMetaDataOnSessionStart:this.m_sessionConfig.fSendClientMetaDataOnSessionStart,handleEndOfAudioTimeoutInMS:this.m_sessionConfig.handleEndOfAudioTimeoutInMS,enableDebugAudioRecording:this.m_sessionConfig.enableDebugAudioRecording};this.m_sessionConfig.enableAudioWorkletNode&&(this.m_sessionConfig.speechProcessorScriptPath?e.speechProcessorScript=this.m_sessionConfig.speechProcessorScriptPath:e.useDefaultSpeechProcessorScript=!0),this.m_sessionConfig.fEnableVision&&this.m_sessionConfig.webcamConfig&&(e.webcamConfig=this.m_sessionConfig.webcamConfig),this.m_sessionConfig.documentDownloadConfig&&(e.documentDownloadConfig=this.m_sessionConfig.documentDownloadConfig),this.m_speechClient=this.m_speechClient||(new i.SpeechClientFactory).createSpeechClient(e,this,{accessToken:"RehearsalAccessToken"},this.getMediaCaptureSource(e),c,new i.ClientWebSocketFactory)},e.prototype.getMediaCaptureSource=function(e){if(!e.useDefaultSpeechProcessorScript)return new i.MediaCaptureSource(e.speechProcessorScript,e.microphoneDeviceId)},e.prototype.checkOrGetDefaultSourceLanguage=function(e,t){return e&&null!=e&&0!==e.trim().length?e:(c.sendTraceTag(591995141,i.LogCategory.PptSession,i.TraceLevel.Error,"CoachManager: setUpSpeechClient source language is undefined/null/Empty/invalid for UserSessionId: "+t+", will default to english"),"en-US")},e.prototype.getTargetLanguagesFromSourceLanguage=function(e){return e.split("-")[0]},e.prototype.initializeCoachSessionTelemetry=function(){this.m_sessionTelemetry.FRehearsalDidStart=!1,this.m_sessionTelemetry.SuggestionCountsByName={},this.m_sessionTelemetry.CritiqueLatencyTelemetry={},this.m_sessionTelemetry.NumberOfPauses=0,this.m_sessionTelemetry.RehearsalStartTime=0,this.m_sessionTelemetry.RehearsalEndTime=0,this.m_sessionTelemetry.FDidSeeSuggestions=!1,this.m_sessionTelemetry.NumberOfSlidesWithOriginalitySuggestion=0,this.m_sessionTelemetry.NumberOfSlidesRehearsed=0,this.m_sessionTelemetry.RehearsalDurationInSeconds=0,this.m_sessionTelemetry.RehearsalId="",this.m_sessionTelemetry.FSpeechRecognitionStarted=!1,this.m_sessionTelemetry.AverageWPM=0},e.prototype.logEndOfCoachSessionTelemetry=function(){var e;this.m_sessionTelemetry.NumberOfSlidesRehearsed=this.m_coachSummaryCollector.getNumSlidesRehearsed(),this.m_sessionTelemetry.RehearsalDurationInSeconds=this.m_coachSummaryCollector.getTimeSpent(),this.m_sessionTelemetry.NumberOfSlidesWithOriginalitySuggestion=this.m_coachSummaryCollector.getOriginalityProblemSlides().length,this.m_sessionTelemetry.AverageWPM=this.m_coachSummaryCollector.getAveragePace(),this.m_sessionTelemetry.RehearsalEndTime=Date.now(),this.m_sessionTelemetry.FDidSeeSuggestions=Object.keys(this.m_sessionTelemetry.SuggestionCountsByName).length>0,this.m_sessionTelemetry.EntryPoint=this.m_sessionConfig.entryPoint||"",this.m_sessionTelemetry.SourceLanguage=this.m_sourceLanguage,this.m_sessionTelemetry.FVisionEnabled=null!==(e=this.m_sessionConfig.fEnableVision)&&void 0!==e&&e,void 0===this.m_sessionConfig.audioInputDeviceCount||null===this.m_sessionConfig.audioInputDeviceCount?this.m_sessionTelemetry.AudioInputDeviceCount=-1:this.m_sessionTelemetry.AudioInputDeviceCount=this.m_sessionConfig.audioInputDeviceCount;var t=this.m_coachSummaryCollector.getCrutchWords();this.m_sessionTelemetry.SuggestionCountsByName.crutchwords=t.length,this.m_sessionTelemetry.CrutchWordUsageCounts=t.map((function(e){return e.count}));var n=this.m_coachSummaryCollector.getMispronouncedWords();this.m_sessionTelemetry.SuggestionCountsByName.pronunciation=n.length,this.m_sessionTelemetry.PronunciationWordTriggerCounts=n.map((function(e){return e.count})),this.m_sessionConfig.requestedRehearsalOptOutFeatures&&(this.m_sessionTelemetry.NumberOfOptoutCritiques=this.m_sessionConfig.requestedRehearsalOptOutFeatures.split(",").length),c.sendTraceTag(595641246,i.LogCategory.PptSession,i.TraceLevel.Info,JSON.stringify(this.m_sessionTelemetry))},e.prototype.updateSuggestionShownCountInTelemetry=function(e){e.toLowerCase()in this.m_sessionTelemetry.SuggestionCountsByName?this.m_sessionTelemetry.SuggestionCountsByName[e.toLowerCase()]+=1:this.m_sessionTelemetry.SuggestionCountsByName[e.toLowerCase()]=1},e.prototype.addFeatureToCritiqueLatencyTelemetry=function(e){this.m_sessionTelemetry.CritiqueLatencyTelemetry[e]={MaxCoachCritiqueLatencyInMS:0,TotalCoachCritiqueLatencyInMS:0,TotalCoachCritiqueLatencyCount:0}},e.prototype.updateCritiqueLatencyInTelemetry=function(e,t){var n=Date.now()-t;if(n<=0)c.sendTraceTag(593248641,i.LogCategory.PptSession,i.TraceLevel.Error,"updateCritiqueLatencyInTelemetry has negative or 0 latency. RehearsalId: "+this.m_rehearsalId);else{var r=e.toLowerCase();r in this.m_sessionTelemetry.CritiqueLatencyTelemetry||this.addFeatureToCritiqueLatencyTelemetry(r),n>this.m_sessionTelemetry.CritiqueLatencyTelemetry[r].MaxCoachCritiqueLatencyInMS&&(this.m_sessionTelemetry.CritiqueLatencyTelemetry[r].MaxCoachCritiqueLatencyInMS=n),this.m_sessionTelemetry.CritiqueLatencyTelemetry[r].TotalCoachCritiqueLatencyInMS+=n,this.m_sessionTelemetry.CritiqueLatencyTelemetry[r].TotalCoachCritiqueLatencyCount+=1}},e.prototype.updateTimer=function(){this.m_sessionPaused||(this.m_presentationTimeInSeconds+=1)},e}();t.CoachManager=h},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t,n){var r=n(152);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r,i,o=n(105),a=n(106),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],h=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==h||null==f){var m=o();null==h&&(h=r=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==f&&(f=i=16383&(m[6]<<8|m[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,g=d-s+(p-c)/1e4;if(g<0&&void 0===e.clockseq&&(f=f+1&16383),(g<0||d>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=d,c=p,i=f;var v=(1e4*(268435455&(d+=122192928e5))+p)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var y=d/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=f>>>8|128,l[u++]=255&f;for(var S=0;S<6;++S)l[u+S]=h[S];return t||a(l)}},function(e,t,n){var r=n(105),i=n(106);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){var r=n(20);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(163),i=n(166),o=n(46),a=function(){function e(){}return e.createCoachSummaryCollector=function(e,t){var n=e.logger,a=!(null===e.fEnableServiceSideAggregationForCoach||!e.fEnableServiceSideAggregationForCoach)&&e.fEnableServiceSideAggregationForCoach,s=null!==e.speechFDBase&&void 0!==e.speechFDBase?e.speechFDBase.replace("wss","https"):this.SpeechFDBase;s=s.replace("ws","http");var c=null!==e.clientApp&&void 0!==e.clientApp&&e.clientApp in o.ClientApp?o.ClientApp[e.clientApp]:o.ClientApp[o.ClientApp.PowerPoint],u=new Map([["audienceChannel",e.audienceChannel||""],["audienceGroup",e.audienceGroup||""],["clientVersion",e.buildVersion||""],["clientApp",c]]);return a?new r.CoachSummaryCollectorServiceEnd(n,s,t,e.httpTimeoutForCoachSummaryData,u):new i.CoachSummaryCollectorClientEnd(n)},e.SpeechFDBase="wss://pptservicescast.officeapps.live.com/",e}();t.CoachSummaryCollectorFactory=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(60),s=n(107),c=n(46),u=n(164),l={fillers:[],sensitivePhrases:[],sensitivePhrasesCorrected:[],originalityProblemSlides:[],timeSpent:0,averagePace:0,paceOverTime:[],slidesRehearsed:0,timestampedCritiques:[],monotoneOverTime:[],grammarInfos:[],pronunciationInfo:[],thumbIndices:[],visionGazeInfos:[],visionOcclusionInfos:[],visionDistanceInfos:[],visionCritiqueFrames:{},crutchWords:[]},h=function(e){function t(t,n,r,i,a){var s=e.call(this)||this;return s.m_averagePace=0,s.m_totalSessionTimeInSec=-1,s.m_crutchWordsData=[],s.m_mispronouncedWordsData=[],o=t,s.m_serviceUrl=n,s.m_userToken=r,s.m_httpTimeout=i,s.m_clientMetadataForSummaryRequest=a,s}return i(t,e),t.prototype.reset=function(){this.m_averagePace=0,this.m_totalSessionTimeInSec=-1,this.m_crutchWordsData=[],this.m_mispronouncedWordsData=[],e.prototype.reset.call(this)},t.prototype.addPace=function(e,t){},t.prototype.addFillers=function(e){},t.prototype.addSensitivePhrases=function(e,t){},t.prototype.addProblematicOriginalitySlide=function(e){},t.prototype.addSlideRehearsed=function(e){},t.prototype.addMonotone=function(e,t,n){},t.prototype.addGrammarCritique=function(e,t,n,r,i,o,a){},t.prototype.addCrutchWords=function(e,t,n,r,i){},t.prototype.addMispronouncedWords=function(e,t,n,r,i){},t.prototype.addVisionGaze=function(e){},t.prototype.addVisionOcclusion=function(e){},t.prototype.addVisionDistance=function(e,t){},t.prototype.getAveragePace=function(){return Math.round(this.m_averagePace)},t.prototype.getCrutchWords=function(){var e=this.m_crutchWordsData?this.m_crutchWordsData:[];return e.sort((function(e,t){return t.count-e.count})),e},t.prototype.getMispronouncedWords=function(){var e=this.m_mispronouncedWordsData?this.m_mispronouncedWordsData:[];return e.sort((function(e,t){return t.count-e.count})),e},t.prototype.getMonotoneOverTime=function(){return this.m_monotoneOverTime},t.prototype.addFillerWords=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){0!==e.count&&(t.m_fillers[e.word]=e.count)}))},t.prototype.addProblematicOriginalitySlideIndexes=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){t.m_originalityScores[e]=!0}))},t.prototype.addSensitivePhraseData=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){void 0===t.m_sensitivePhrases[e.Phrase]&&(t.m_sensitivePhrases[e.Phrase]={count:0,correction:""}),t.m_sensitivePhrases[e.Phrase].count+=e.Count,t.m_sensitivePhrases[e.Phrase].correction=e.Correction}))},t.prototype.addSlideRehearsedIndexes=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){t.m_slidesRehearsed[e]=!0}))},t.prototype.prepareSummaryData=function(e){if(null==e||""===e)return l;try{var t=JSON.parse(e);null!=t&&(this.m_averagePace=t.AveragePace?t.AveragePace:0,this.m_totalSessionTimeInSec=t.TimeSpentSeconds?t.TimeSpentSeconds:0,this.m_crutchWordsData=t.CrutchWords?t.CrutchWords:[],this.m_grammarCritiques=t.GrammarSuggestions?t.GrammarSuggestions:[],this.m_mispronouncedWordsData=t.MispronouncedWordsData?t.MispronouncedWordsData:[],this.m_monotoneOverTime=t.MonotoneOverTime?t.MonotoneOverTime:[],this.m_paceOverTime=t.PaceOverTime?t.PaceOverTime:[],this.m_paceOverTime.forEach((function(e){e.timePoint=1e3*e.timePoint})),this.m_visionCritiqueFrames=t.VisionCritiqueFrames?t.VisionCritiqueFrames:this.m_visionCritiqueFrames,this.addFillerWords(t.Fillers?t.Fillers:[]),this.addProblematicOriginalitySlideIndexes(t.OriginalityProblemSlidesIndex?t.OriginalityProblemSlidesIndex:[]),this.addSensitivePhraseData(t.CorrectedSensitivePhraseData?t.CorrectedSensitivePhraseData:[]),this.addSlideRehearsedIndexes(t.SlidesRehearsedIndexes?t.SlidesRehearsedIndexes:[]));var n=this.getSortedSensitivePhrases(!0);return{fillers:this.getFillers(),sensitivePhrases:n.map((function(e){return e.phraseData})),sensitivePhrasesCorrected:n.map((function(e){return e.correction})),originalityProblemSlides:this.getOriginalityProblemSlides(),timeSpent:this.getTimeSpent(),averagePace:this.getAveragePace(),paceOverTime:this.getPaceOverTime(),slidesRehearsed:this.getNumSlidesRehearsed(),timestampedCritiques:this.getTimestampedCritiques(),monotoneOverTime:this.getMonotoneOverTime(),grammarInfos:this.getGrammar(),pronunciationInfo:this.getMispronouncedWords(),thumbIndices:this.getThumbIndicesForSummary(),visionGazeInfos:this.m_visionGazeCritiques,visionOcclusionInfos:this.m_visionOcclusionCritiques,visionDistanceInfos:this.m_visionDistanceCritiques,visionCritiqueFrames:this.m_visionCritiqueFrames,crutchWords:this.getCrutchWords()}}catch(e){return o.sendTraceTag(572627034,a.LogCategory.PptSession,c.TraceLevel.Error,"CoachSummaryCollectorServiceEnd::prepareSummaryData failed with exception: "+e),l}},t.prototype.getRehearsalSummary=function(e){var t=this,n=this.m_serviceUrl+"CoachResultSummaryHandler.ashx?Client=web&usersessionid="+this.m_sessionId+"&action=GetCoachSummaryDataJSON";return this.m_clientMetadataForSummaryRequest&&this.m_clientMetadataForSummaryRequest.size>0&&this.m_clientMetadataForSummaryRequest.forEach((function(e,t){e&&(n=n+"&"+t+"="+e)})),u.makeCoachResultSummaryRequest(n,(function(n){var r=t.prepareSummaryData(n);e(r)}),this.m_userToken,this.m_httpTimeout).then((function(){o.sendTraceTag(572665887,a.LogCategory.PptSession,c.TraceLevel.Info,"CoachSummaryCollectorServiceEnd::SummaryData fetched from cast and send successfully.")})).catch((function(t){o.sendTraceTag(572665888,a.LogCategory.PptSession,c.TraceLevel.Error,"CoachSummaryCollectorServiceEnd::SummaryData fetch failed with error: "+t),e(l)})),l},t}(s.BaseCoachSummaryCollector);t.CoachSummaryCollectorServiceEnd=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(165),o=function(){function e(){}return e.ContentType="Content-Type",e.Authorization="Authorization",e}();t.CoachSummaryRequestHeaderFieldNames=o,function(e){e.GET="get",e.POST="post"}(r=t.RequestMethod||(t.RequestMethod={}));var a=function(){function e(){}return e.CONTENT_TYPE="application/json",e.MAX_RETRIES=1,e}();t.CoachSummaryRequestSettings=a,t.makeCoachResultSummaryRequest=function(e,t,n,s){var c=null!=n?n:"",u={};return u[o.ContentType]=a.CONTENT_TYPE,u[o.Authorization]=c,i.makeHttpRequest(r.GET,e,"",null,u,(function(e,n,r){200!==e.status?r(new Error("Non-200 response with status code: "+e.status+", status text: "+e.statusText)):(n(e),t(e.responseText))}),a.MAX_RETRIES,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHttpRequest=function(e,t,n,r,i,o,a,s){void 0===n&&(n={}),void 0===r&&(r=null),void 0===i&&(i={}),void 0===a&&(a=2),void 0===s&&(s=5e3);var c=function(a){return new Promise((function(u,l){var h=function(e,t){e>0?c(e-1).then(u,l):l(new Error(t))},f=new XMLHttpRequest,m=function(e,t){void 0===t&&(t={});var n=function(e){return void 0===e&&(e={}),Object.keys(e).map((function(t){return encodeURIComponent(t)+" = "+encodeURIComponent(e[t])})).join("&")}(t);return n?e+(-1===e.indexOf("?")?"?":"&")+n:e}(t,n);f.open(e,m,!0),i&&Object.keys(i).forEach((function(e){return f.setRequestHeader(e,i[e])})),f.timeout=s,f.onload=function(){o(f,u,l)},f.ontimeout=function(){h(a,a>0?"":"Request to '"+t+"' timed out. timeout: 5000")},f.onerror=function(){var e=a>0?"":"Request to '"+t+"' errored. "+f.status+": "+f.responseText;h(a,e)},"post"===e&&r?(f.setRequestHeader("Content-Type","application/json"),f.send(JSON.stringify(r))):f.send()}))};return c(a)}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(60),s=n(107),c=n(46),u=function(e){function t(t){var n=e.call(this)||this;return n.m_paceSamplingInverseRate=1,n.m_paceSamplingPortion=0,n.m_genericCrutchWordCounts={},n.m_sentenceStartCrutchWordCounts={},n.m_sentenceEndCrutchWordCounts={},n.m_crutchWordSynonyms={},n.m_totalWordCount=0,n.m_finalCrutchWords=[],n.m_mispronouncedWordsMap={},o=t,n}return i(t,e),t.prototype.reset=function(){this.m_paceSamplingInverseRate=1,this.m_paceSamplingPortion=0,this.m_mispronouncedWordsMap={},this.m_genericCrutchWordCounts={},this.m_sentenceStartCrutchWordCounts={},this.m_sentenceEndCrutchWordCounts={},this.m_totalWordCount=0,this.m_crutchWordSynonyms={},this.m_finalCrutchWords=[],e.prototype.reset.call(this)},t.prototype.stopCoachSummary=function(t){this.calculateCrutchWords(),e.prototype.stopCoachSummary.call(this,t)},t.prototype.addPace=function(e,t){if(this.ensureIsStarted(),this.m_paceSamplingPortion%this.m_paceSamplingInverseRate==0&&this.m_paceOverTime.push({pace:e,timePoint:t}),this.m_paceSamplingPortion+=1,this.m_paceOverTime.length>=s.BaseCoachSummaryCollector.MaxPaceTimePoints){for(var n=[],r=0;r<this.m_paceOverTime.length;r+=1)r%2==0&&n.push(this.m_paceOverTime[r]);this.m_paceOverTime=n,this.m_paceSamplingInverseRate*=2,this.m_paceSamplingPortion=0}},t.addCountsToHashMap=function(e,t){0!==t.length&&t.forEach((function(t){0!==t.length&&(void 0===e[t]&&(e[t]=0),e[t]+=1)}))},t.prototype.addFillers=function(e){this.ensureIsStarted(),t.addCountsToHashMap(this.m_fillers,e)},t.prototype.addSensitivePhrases=function(e,t){var n=this;this.ensureIsStarted();var r=void 0!==t&&t.length>0;r&&t.length!==e.length&&(r=!1,o.sendTraceTag(576583395,a.LogCategory.PptSession,c.TraceLevel.Error,"CoachSummaryCollectorClientEnd::AddSensitivePhrases Length of corrected phrases does not match length of phrases")),e.forEach((function(e,i){0!==e.length&&(void 0===n.m_sensitivePhrases[e]&&(n.m_sensitivePhrases[e]={count:0,correction:""}),n.m_sensitivePhrases[e].count+=1,n.m_sensitivePhrases[e].correction=r?t[i]:"")}))},t.prototype.addProblematicOriginalitySlide=function(e){this.ensureIsStarted(),this.m_originalityScores[e]=!0},t.prototype.addSlideRehearsed=function(e){this.ensureIsStarted(),this.m_slidesRehearsed[e]=!0},t.prototype.addMonotone=function(e,t,n){this.ensureIsStarted(),this.m_monotoneOverTime.length<s.BaseCoachSummaryCollector.MaxMonotoneTimePoints&&this.m_monotoneOverTime.push({pvq:e,slide:t,timePoint:n})},t.prototype.addGrammarCritique=function(e,t,n,r,i,o,a){this.m_grammarCritiques.push({slideIndex:e,helpText:t,category:n,originalText:r,triggerStart:i,triggerLength:o,suggestionText:a})},t.prototype.addCrutchWords=function(e,t,n,r,i){this.ensureIsStarted();for(var o=0,a=e;o<a.length;o++)(h=a[o])in this.m_genericCrutchWordCounts?this.m_genericCrutchWordCounts[h]+=1:this.m_genericCrutchWordCounts[h]=1;for(var s=0,c=t;s<c.length;s++)(h=c[s])in this.m_sentenceStartCrutchWordCounts?this.m_sentenceStartCrutchWordCounts[h]+=1:this.m_sentenceStartCrutchWordCounts[h]=1;for(var u=0,l=n;u<l.length;u++){var h;(h=l[u])in this.m_sentenceEndCrutchWordCounts?this.m_sentenceEndCrutchWordCounts[h]+=1:this.m_sentenceEndCrutchWordCounts[h]=1}for(var f in i)f in this.m_crutchWordSynonyms||(this.m_crutchWordSynonyms[f]=i[f]);this.m_totalWordCount+=r},t.prototype.calculateModeForLowestPhonemeIndex=function(e){var t={};if(0===e.length)return 0;e.forEach((function(e){void 0===t[e]&&(t[e]=0),t[e]+=1}));var n=0,r=-1;for(var i in t)t[i]>=r&&(r=t[i],n=Number(i));return n},t.prototype.addMispronouncedWords=function(e,t,n,r,i){this.ensureIsStarted(),void 0===this.m_mispronouncedWordsMap[e]&&(this.m_mispronouncedWordsMap[e]={count:0,slideNumber:new Set,lowestPhonemeIndex:[],phonemeSequence:"",syllables:""}),this.m_mispronouncedWordsMap[e].count+=1,this.m_mispronouncedWordsMap[e].slideNumber.add(t),this.m_mispronouncedWordsMap[e].lowestPhonemeIndex.push(n),this.m_mispronouncedWordsMap[e].phonemeSequence=r,this.m_mispronouncedWordsMap[e].syllables=i},t.prototype.addVisionGaze=function(e){this.m_visionGazeCritiques.push(e)},t.prototype.addVisionOcclusion=function(e){this.m_visionOcclusionCritiques.push(e)},t.prototype.addVisionDistance=function(e,t){this.m_visionDistanceCritiques.push({critiqueTime:e,distanceCritiqueName:t})},t.prototype.getAveragePace=function(){if(this.m_paceOverTime.length>0){var e=0;return this.m_paceOverTime.forEach((function(t){e+=t.pace})),Math.round(e/this.m_paceOverTime.length)}return 0},t.prototype.calculateCrutchWords=function(){var e=this,t={},n=this.m_totalWordCount<200?2:Math.min(this.m_totalWordCount/100,20);Object.entries(this.m_genericCrutchWordCounts).forEach((function(e){var r=e[0],i=e[1];i>n&&(t[r]=i)})),Object.entries(this.m_sentenceStartCrutchWordCounts).forEach((function(e){var n=e[0],r=e[1];r>2&&(n in t?t[n]+=r:t[n]=r)})),Object.entries(this.m_sentenceEndCrutchWordCounts).forEach((function(e){var n=e[0],r=e[1];r>2&&(n in t?t[n]+=r:t[n]=r)}));var r=[];Object.entries(t).forEach((function(t){var n=t[0],i=t[1];r.push({word:n,count:i,synonyms:e.m_crutchWordSynonyms[n]||[]})})),r.sort((function(e,t){return t.count-e.count})),this.m_finalCrutchWords=r},t.prototype.getCrutchWords=function(){return this.m_finalCrutchWords},t.prototype.getMispronouncedWords=function(){var e=this,t=[];return Object.keys(this.m_mispronouncedWordsMap).forEach((function(n){t.push({word:n,count:e.m_mispronouncedWordsMap[n].count,slideNumber:Array.from(e.m_mispronouncedWordsMap[n].slideNumber.values()),lowestPhonemeIndex:e.calculateModeForLowestPhonemeIndex(e.m_mispronouncedWordsMap[n].lowestPhonemeIndex),phonemeSequence:e.m_mispronouncedWordsMap[n].phonemeSequence,syllables:e.m_mispronouncedWordsMap[n].syllables})})),t.sort((function(e,t){return t.count-e.count})),t},t.prototype.getMonotoneOverTime=function(){var e=[];return this.m_monotoneOverTime.forEach((function(t){e.push({pvq:Math.round(1e3*t.pvq),timePoint:Math.round(t.timePoint/1e3),slide:t.slide})})),e},t.prototype.getRehearsalSummary=function(e){var t=this.getSortedSensitivePhrases(!0),n={fillers:this.getFillers(),sensitivePhrases:t.map((function(e){return e.phraseData})),sensitivePhrasesCorrected:t.map((function(e){return e.correction})),originalityProblemSlides:this.getOriginalityProblemSlides(),timeSpent:this.getTimeSpent(),averagePace:this.getAveragePace(),paceOverTime:this.getPaceOverTime(),slidesRehearsed:this.getNumSlidesRehearsed(),timestampedCritiques:this.getTimestampedCritiques(),monotoneOverTime:this.getMonotoneOverTime(),grammarInfos:this.getGrammar(),pronunciationInfo:this.getMispronouncedWords(),thumbIndices:this.getThumbIndicesForSummary(),visionGazeInfos:this.m_visionGazeCritiques,visionOcclusionInfos:this.m_visionOcclusionCritiques,visionDistanceInfos:this.m_visionDistanceCritiques,visionCritiqueFrames:this.m_visionCritiqueFrames,crutchWords:this.getCrutchWords()};return null!=e&&e(n),n},t}(s.BaseCoachSummaryCollector);t.CoachSummaryCollectorClientEnd=u},function(e,t,n){"use strict";n(168);var r,i=(r=n(339))&&r.__esModule?r:{default:r};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},function(e,t,n){"use strict";n(169),n(312),n(314),n(317),n(319),n(321),n(323),n(325),n(327),n(329),n(331),n(333),n(335),n(104)},function(e,t,n){n(170),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(251),n(252),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(94),n(275),n(129),n(276),n(130),n(277),n(278),n(279),n(280),n(131),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),e.exports=n(10)},function(e,t,n){"use strict";var r=n(3),i=n(21),o=n(12),a=n(0),s=n(18),c=n(35).KEY,u=n(4),l=n(62),h=n(48),f=n(37),m=n(8),d=n(75),p=n(110),g=n(172),v=n(65),y=n(5),S=n(6),C=n(15),_=n(23),T=n(34),b=n(36),M=n(41),I=n(113),w=n(28),E=n(64),F=n(13),R=n(39),P=w.f,D=F.f,L=I.f,x=r.Symbol,k=r.JSON,O=k&&k.stringify,A=m("_hidden"),W=m("toPrimitive"),N={}.propertyIsEnumerable,j=l("symbol-registry"),U=l("symbols"),q=l("op-symbols"),V=Object.prototype,H="function"==typeof x&&!!E.f,B=r.QObject,G=!B||!B.prototype||!B.prototype.findChild,z=o&&u((function(){return 7!=M(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=P(V,t);r&&delete V[t],D(e,t,n),r&&e!==V&&D(V,t,r)}:D,J=function(e){var t=U[e]=M(x.prototype);return t._k=e,t},Q=H&&"symbol"==typeof x.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof x},X=function(e,t,n){return e===V&&X(q,t,n),y(e),t=T(t,!0),y(n),i(U,t)?(n.enumerable?(i(e,A)&&e[A][t]&&(e[A][t]=!1),n=M(n,{enumerable:b(0,!1)})):(i(e,A)||D(e,A,b(1,{})),e[A][t]=!0),z(e,t,n)):D(e,t,n)},Y=function(e,t){y(e);for(var n,r=g(t=_(t)),i=0,o=r.length;o>i;)X(e,n=r[i++],t[n]);return e},$=function(e){var t=N.call(this,e=T(e,!0));return!(this===V&&i(U,e)&&!i(q,e))&&(!(t||!i(this,e)||!i(U,e)||i(this,A)&&this[A][e])||t)},K=function(e,t){if(e=_(e),t=T(t,!0),e!==V||!i(U,t)||i(q,t)){var n=P(e,t);return!n||!i(U,t)||i(e,A)&&e[A][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=L(_(e)),r=[],o=0;n.length>o;)i(U,t=n[o++])||t==A||t==c||r.push(t);return r},ee=function(e){for(var t,n=e===V,r=L(n?q:_(e)),o=[],a=0;r.length>a;)!i(U,t=r[a++])||n&&!i(V,t)||o.push(U[t]);return o};H||(s((x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===V&&t.call(q,n),i(this,A)&&i(this[A],e)&&(this[A][e]=!1),z(this,e,b(1,n))};return o&&G&&z(V,e,{configurable:!0,set:t}),J(e)}).prototype,"toString",(function(){return this._k})),w.f=K,F.f=X,n(42).f=I.f=Z,n(57).f=$,E.f=ee,o&&!n(38)&&s(V,"propertyIsEnumerable",$,!0),d.f=function(e){return J(m(e))}),a(a.G+a.W+a.F*!H,{Symbol:x});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)m(te[ne++]);for(var re=R(m.store),ie=0;re.length>ie;)p(re[ie++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=x(e)},keyFor:function(e){if(!Q(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!H,"Object",{create:function(e,t){return void 0===t?M(e):Y(M(e),t)},defineProperty:X,defineProperties:Y,getOwnPropertyDescriptor:K,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var oe=u((function(){E.f(1)}));a(a.S+a.F*oe,"Object",{getOwnPropertySymbols:function(e){return E.f(C(e))}}),k&&a(a.S+a.F*(!H||u((function(){var e=x();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(S(t)||void 0!==e)&&!Q(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Q(t))return t}),r[1]=t,O.apply(k,r)}}),x.prototype[W]||n(22)(x.prototype,W,x.prototype.valueOf),h(x,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(e,t,n){e.exports=n(62)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(39),i=n(64),o=n(57);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(41)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(12),"Object",{defineProperty:n(13).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(12),"Object",{defineProperties:n(112)})},function(e,t,n){var r=n(23),i=n(28).f;n(29)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},function(e,t,n){var r=n(15),i=n(43);n(29)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(15),i=n(39);n(29)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(29)("getOwnPropertyNames",(function(){return n(113).f}))},function(e,t,n){var r=n(6),i=n(35).onFreeze;n(29)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(6),i=n(35).onFreeze;n(29)("seal",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(6),i=n(35).onFreeze;n(29)("preventExtensions",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(6);n(29)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(6);n(29)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(6);n(29)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(114)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(115)})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(79).set})},function(e,t,n){"use strict";var r=n(58),i={};i[n(8)("toStringTag")]="z",i+""!="[object z]"&&n(18)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(116)})},function(e,t,n){var r=n(13).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(12)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(6),i=n(43),o=n(8)("hasInstance"),a=Function.prototype;o in a||n(13).f(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(0),i=n(118);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(0),i=n(119);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(3),i=n(21),o=n(31),a=n(81),s=n(34),c=n(4),u=n(42).f,l=n(28).f,h=n(13).f,f=n(49).trim,m=r.Number,d=m,p=m.prototype,g="Number"==o(n(41)(p)),v="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=v?t.trim():f(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,c=t.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||a>i)return NaN;return parseInt(c,r)}}return+t};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof m&&(g?c((function(){p.valueOf.call(n)})):"Number"!=o(n))?a(new d(y(t)),n,m):y(t)};for(var S,C=n(12)?u(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;C.length>_;_++)i(d,S=C[_])&&!i(m,S)&&h(m,S,l(d,S));m.prototype=p,p.constructor=m,n(18)(r,"Number",m)}},function(e,t,n){"use strict";var r=n(0),i=n(27),o=n(120),a=n(82),s=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*u[n],u[n]=r%1e7,r=c(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)n+=u[t],u[t]=c(n/e),n=n%e*1e7},m=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var n=String(u[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t},d=function(e,t,n){return 0===t?n:t%2==1?d(e,t-1,n*e):d(e*e,t/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,n,r,s,c=o(this,l),u=i(e),p="",g="0";if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(c*d(2,69,1))-69)<0?c*d(2,-t,1):c/d(2,t,1),n*=4503599627370496,(t=52-t)>0){for(h(0,n),r=u;r>=7;)h(1e7,0),r-=7;for(h(d(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),h(1,1),f(2),g=m()}else h(0,n),h(1<<-t,0),g=m()+a.call("0",u);return u>0?p+((s=g.length)<=u?"0."+a.call("0",u-s)+g:g.slice(0,s-u)+"."+g.slice(s-u)):p+g}})},function(e,t,n){"use strict";var r=n(0),i=n(4),o=n(120),a=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),i=n(3).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(121)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),i=n(121),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),i=n(119);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(0),i=n(118);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(0),i=n(122),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),i=n(83);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(0),i=n(84);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(215)})},function(e,t,n){var r=n(83),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),c=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),u=r(e);return i<c?u*(i/c/a+1/o-1/o)*c*a:(n=(t=(1+a/o)*i)-(t-i))>s||n!=n?u*(1/0):u*n}},function(e,t,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,a=0,s=arguments.length,c=0;a<s;)c<(n=i(arguments[a++]))?(o=o*(r=c/n)*r+1,c=n):o+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(e,t,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(4)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(122)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(83)})},function(e,t,n){var r=n(0),i=n(84),o=Math.exp;r(r.S+r.F*n(4)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),i=n(84),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(0),i=n(40),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),i=n(23),o=n(9);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";n(49)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,n){"use strict";var r=n(85)(!0);n(86)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(0),i=n(85)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(87),a="".endsWith;r(r.P+r.F*n(89)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),c=String(e);return a?a.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,n){"use strict";var r=n(0),i=n(87);r(r.P+r.F*n(89)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(82)})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(87),a="".startsWith;r(r.P+r.F*n(89)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(19)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){"use strict";n(19)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,n){"use strict";n(19)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,n){"use strict";n(19)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,n){"use strict";n(19)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,n){"use strict";n(19)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";n(19)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";n(19)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,n){"use strict";n(19)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,n){"use strict";n(19)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,n){"use strict";n(19)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,n){"use strict";n(19)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";n(19)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(15),o=n(34);r(r.P+r.F*n(4)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),i=n(250);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(4),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!r((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(e,t,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(18)(r,"toString",(function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"}))},function(e,t,n){var r=n(8)("toPrimitive"),i=Date.prototype;r in i||n(22)(i,r,n(253))},function(e,t,n){"use strict";var r=n(5),i=n(34);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(65)})},function(e,t,n){"use strict";var r=n(25),i=n(0),o=n(15),a=n(124),s=n(90),c=n(9),u=n(91),l=n(92);i(i.S+i.F*!n(66)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),m="function"==typeof this?this:Array,d=arguments.length,p=d>1?arguments[1]:void 0,g=void 0!==p,v=0,y=l(f);if(g&&(p=r(p,d>2?arguments[2]:void 0,2)),null==y||m==Array&&s(y))for(n=new m(t=c(f.length));t>v;v++)u(n,v,g?p(f[v],v):f[v]);else for(h=y.call(f),n=new m;!(i=h.next()).done;v++)u(n,v,g?a(h,p,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){"use strict";var r=n(0),i=n(91);r(r.S+r.F*n(4)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(23),o=[].join;r(r.P+r.F*(n(56)!=Object||!n(24)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(78),o=n(31),a=n(40),s=n(9),c=[].slice;r(r.P+r.F*n(4)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=a(e,n),u=a(t,n),l=s(u-i),h=new Array(l),f=0;f<l;f++)h[f]="String"==r?this.charAt(i+f):this[i+f];return h}})},function(e,t,n){"use strict";var r=n(0),i=n(26),o=n(15),a=n(4),s=[].sort,c=[1,2,3];r(r.P+r.F*(a((function(){c.sort(void 0)}))||!a((function(){c.sort(null)}))||!n(24)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(0),i=n(30)(0),o=n(24)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(6),i=n(65),o=n(8)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),i=n(30)(1);r(r.P+r.F*!n(24)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(30)(2);r(r.P+r.F*!n(24)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(30)(3);r(r.P+r.F*!n(24)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(30)(4);r(r.P+r.F*!n(24)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(126);r(r.P+r.F*!n(24)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(126);r(r.P+r.F*!n(24)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(63)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(24)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(23),o=n(27),a=n(9),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(24)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(127)}),n(44)("copyWithin")},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(93)}),n(44)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(30)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(44)("find")},function(e,t,n){"use strict";var r=n(0),i=n(30)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(44)(o)},function(e,t,n){n(51)("Array")},function(e,t,n){var r=n(3),i=n(81),o=n(13).f,a=n(42).f,s=n(88),c=n(67),u=r.RegExp,l=u,h=u.prototype,f=/a/g,m=/a/g,d=new u(f)!==f;if(n(12)&&(!d||n(4)((function(){return m[n(8)("match")]=!1,u(f)!=f||u(m)==m||"/a/i"!=u(f,"i")})))){u=function(e,t){var n=this instanceof u,r=s(e),o=void 0===t;return!n&&r&&e.constructor===u&&o?e:i(d?new l(r&&!o?e.source:e,t):l((r=e instanceof u)?e.source:e,r&&o?c.call(e):t),n?this:h,u)};for(var p=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},g=a(l),v=0;g.length>v;)p(g[v++]);h.constructor=u,u.prototype=h,n(18)(r,"RegExp",u)}n(51)("RegExp")},function(e,t,n){"use strict";n(130);var r=n(5),i=n(67),o=n(12),a=/./.toString,s=function(e){n(18)(RegExp.prototype,"toString",e,!0)};n(4)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(e,t,n){"use strict";var r=n(5),i=n(9),o=n(96),a=n(68);n(69)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var c=r(e),u=String(this);if(!c.global)return a(c,u);var l=c.unicode;c.lastIndex=0;for(var h,f=[],m=0;null!==(h=a(c,u));){var d=String(h[0]);f[m]=d,""===d&&(c.lastIndex=o(u,i(c.lastIndex),l)),m++}return 0===m?null:f}]}))},function(e,t,n){"use strict";var r=n(5),i=n(15),o=n(9),a=n(27),s=n(96),c=n(68),u=Math.max,l=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g;n(69)("replace",2,(function(e,t,n,d){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=d(n,e,this,t);if(i.done)return i.value;var h=r(e),f=String(this),m="function"==typeof t;m||(t=String(t));var g=h.global;if(g){var v=h.unicode;h.lastIndex=0}for(var y=[];;){var S=c(h,f);if(null===S)break;if(y.push(S),!g)break;""===String(S[0])&&(h.lastIndex=s(f,o(h.lastIndex),v))}for(var C,_="",T=0,b=0;b<y.length;b++){S=y[b];for(var M=String(S[0]),I=u(l(a(S.index),f.length),0),w=[],E=1;E<S.length;E++)w.push(void 0===(C=S[E])?C:String(C));var F=S.groups;if(m){var R=[M].concat(w,I,f);void 0!==F&&R.push(F);var P=String(t.apply(void 0,R))}else P=p(M,f,I,w,F,t);I>=T&&(_+=f.slice(T,I)+P,T=I+M.length)}return _+f.slice(T)}];function p(e,t,r,o,a,s){var c=r+e.length,u=o.length,l=m;return void 0!==a&&(a=i(a),l=f),n.call(s,l,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return n;if(l>u){var f=h(l/10);return 0===f?n:f<=u?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[l-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";var r=n(5),i=n(115),o=n(68);n(69)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),c=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var l=o(s,c);return i(s.lastIndex,u)||(s.lastIndex=u),null===l?-1:l.index}]}))},function(e,t,n){"use strict";var r=n(88),i=n(5),o=n(59),a=n(96),s=n(9),c=n(68),u=n(95),l=n(4),h=Math.min,f=[].push,m="length",d=!l((function(){RegExp(4294967295,"y")}));n(69)("split",2,(function(e,t,n,l){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[m]||2!="ab".split(/(?:ab)*/)[m]||4!=".".split(/(.?)(.?)/)[m]||".".split(/()()/)[m]>1||"".split(/.?/)[m]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?4294967295:t>>>0,p=new RegExp(e.source,l+"g");(o=u.call(p,i))&&!((a=p.lastIndex)>h&&(c.push(i.slice(h,o.index)),o[m]>1&&o.index<i[m]&&f.apply(c,o.slice(1)),s=o[0][m],h=a,c[m]>=d));)p.lastIndex===o.index&&p.lastIndex++;return h===i[m]?!s&&p.test("")||c.push(""):c.push(i.slice(h)),c[m]>d?c.slice(0,d):c}:"0".split(void 0,0)[m]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):p.call(String(i),n,r)},function(e,t){var r=l(p,e,this,t,p!==n);if(r.done)return r.value;var u=i(e),f=String(this),m=o(u,RegExp),g=u.unicode,v=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(d?"y":"g"),y=new m(d?u:"^(?:"+u.source+")",v),S=void 0===t?4294967295:t>>>0;if(0===S)return[];if(0===f.length)return null===c(y,f)?[f]:[];for(var C=0,_=0,T=[];_<f.length;){y.lastIndex=d?_:0;var b,M=c(y,d?f:f.slice(_));if(null===M||(b=h(s(y.lastIndex+(d?0:_)),f.length))===C)_=a(f,_,g);else{if(T.push(f.slice(C,_)),T.length===S)return T;for(var I=1;I<=M.length-1;I++)if(T.push(M[I]),T.length===S)return T;_=C=b}}return T.push(f.slice(C)),T}]}))},function(e,t,n){var r=n(3),i=n(97).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==n(31)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(c&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(u)}}else n=function(){i.call(r,u)};else{var h=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(134),i=n(45);e.exports=n(72)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(134),i=n(45);e.exports=n(72)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(3),o=n(30)(0),a=n(18),s=n(35),c=n(114),u=n(135),l=n(6),h=n(45),f=n(45),m=!i.ActiveXObject&&"ActiveXObject"in i,d=s.getWeak,p=Object.isExtensible,g=u.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(l(e)){var t=d(e);return!0===t?g(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(h(this,"WeakMap"),e,t)}},S=e.exports=n(72)("WeakMap",v,y,u,!0,!0);f&&m&&(c((r=u.getConstructor(v,"WeakMap")).prototype,y),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=S.prototype,n=t[e];a(t,e,(function(t,i){if(l(t)&&!p(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(135),i=n(45);n(72)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),i=n(73),o=n(98),a=n(5),s=n(40),c=n(9),u=n(6),l=n(3).ArrayBuffer,h=n(59),f=o.ArrayBuffer,m=o.DataView,d=i.ABV&&l.isView,p=f.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(l!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return d&&d(e)||u(e)&&g in e}}),r(r.P+r.U+r.F*n(4)((function(){return!new f(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==p&&void 0===t)return p.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(h(this,f))(c(i-r)),u=new m(this),l=new m(o),d=0;r<i;)l.setUint8(d++,u.getUint8(r++));return o}}),n(51)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(73).ABV,{DataView:n(98).DataView})},function(e,t,n){n(33)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(33)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(33)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(0),i=n(26),o=n(5),a=(n(3).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(4)((function(){a((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=o(n);return a?a(r,t,c):s.call(r,t,c)}})},function(e,t,n){var r=n(0),i=n(41),o=n(26),a=n(5),s=n(6),c=n(4),u=n(116),l=(n(3).Reflect||{}).construct,h=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),f=!c((function(){l((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return l(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var c=n.prototype,m=i(s(c)?c:Object.prototype),d=Function.apply.call(e,m,t);return s(d)?d:m}})},function(e,t,n){var r=n(13),i=n(0),o=n(5),a=n(34);i(i.S+i.F*n(4)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(0),i=n(28).f,o=n(5);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),i=n(5),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(123)(o,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){var r=n(28),i=n(43),o=n(21),a=n(0),s=n(6),c=n(5);a(a.S,"Reflect",{get:function e(t,n){var a,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[n]:(a=r.f(t,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(u=i(t))?e(u,n,l):void 0}})},function(e,t,n){var r=n(28),i=n(0),o=n(5);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){var r=n(0),i=n(43),o=n(5);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(0),i=n(5),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(137)})},function(e,t,n){var r=n(0),i=n(5),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(13),i=n(28),o=n(43),a=n(21),s=n(0),c=n(36),u=n(5),l=n(6);s(s.S,"Reflect",{set:function e(t,n,s){var h,f,m=arguments.length<4?t:arguments[3],d=i.f(u(t),n);if(!d){if(l(f=o(t)))return e(f,n,s,m);d=c(0)}if(a(d,"value")){if(!1===d.writable||!l(m))return!1;if(h=i.f(m,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(m,n,h)}else r.f(m,n,c(0,s));return!0}return void 0!==d.set&&(d.set.call(m,s),!0)}})},function(e,t,n){var r=n(0),i=n(79);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){n(313),e.exports=n(10).Array.includes},function(e,t,n){"use strict";var r=n(0),i=n(63)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(44)("includes")},function(e,t,n){n(315),e.exports=n(10).Array.flatMap},function(e,t,n){"use strict";var r=n(0),i=n(316),o=n(15),a=n(9),s=n(26),c=n(125);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(44)("flatMap")},function(e,t,n){"use strict";var r=n(65),i=n(6),o=n(9),a=n(25),s=n(8)("isConcatSpreadable");e.exports=function e(t,n,c,u,l,h,f,m){for(var d,p,g=l,v=0,y=!!f&&a(f,m,3);v<u;){if(v in c){if(d=y?y(c[v],v,n):c[v],p=!1,i(d)&&(p=void 0!==(p=d[s])?!!p:r(d)),p&&h>0)g=e(t,n,d,o(d.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=d}g++}v++}return g}},function(e,t,n){n(318),e.exports=n(10).String.padStart},function(e,t,n){"use strict";var r=n(0),i=n(138),o=n(71),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){n(320),e.exports=n(10).String.padEnd},function(e,t,n){"use strict";var r=n(0),i=n(138),o=n(71),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){n(322),e.exports=n(10).String.trimLeft},function(e,t,n){"use strict";n(49)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,n){n(324),e.exports=n(10).String.trimRight},function(e,t,n){"use strict";n(49)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){n(326),e.exports=n(75).f("asyncIterator")},function(e,t,n){n(110)("asyncIterator")},function(e,t,n){n(328),e.exports=n(10).Object.getOwnPropertyDescriptors},function(e,t,n){var r=n(0),i=n(137),o=n(23),a=n(28),s=n(91);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),c=a.f,u=i(r),l={},h=0;u.length>h;)void 0!==(n=c(r,t=u[h++]))&&s(l,t,n);return l}})},function(e,t,n){n(330),e.exports=n(10).Object.values},function(e,t,n){var r=n(0),i=n(139)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){n(332),e.exports=n(10).Object.entries},function(e,t,n){var r=n(0),i=n(139)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";n(131),n(334),e.exports=n(10).Promise.finally},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(3),a=n(59),s=n(133);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){n(336),n(337),n(338),e.exports=n(10)},function(e,t,n){var r=n(3),i=n(0),o=n(71),a=[].slice,s=/MSIE .\./.test(o),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(0),i=n(97);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(94),i=n(39),o=n(18),a=n(3),s=n(22),c=n(50),u=n(8),l=u("iterator"),h=u("toStringTag"),f=c.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(m),p=0;p<d.length;p++){var g,v=d[p],y=m[v],S=a[v],C=S&&S.prototype;if(C&&(C[l]||s(C,l,f),C[h]||s(C,h,v),c[v]=f,y))for(g in r)C[g]||o(C,g,r[g],!0)}},function(e,t,n){n(340),e.exports=n(140).global},function(e,t,n){var r=n(341);r(r.G,{global:n(99)})},function(e,t,n){var r=n(99),i=n(140),o=n(342),a=n(344),s=n(351),c=function(e,t,n){var u,l,h,f=e&c.F,m=e&c.G,d=e&c.S,p=e&c.P,g=e&c.B,v=e&c.W,y=m?i:i[t]||(i[t]={}),S=y.prototype,C=m?r:d?r[t]:(r[t]||{}).prototype;for(u in m&&(n=t),n)(l=!f&&C&&void 0!==C[u])&&s(y,u)||(h=l?C[u]:n[u],y[u]=m&&"function"!=typeof C[u]?n[u]:g&&l?o(h,r):v&&C[u]==h?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):p&&"function"==typeof h?o(Function.call,h):h,p&&((y.virtual||(y.virtual={}))[u]=h,e&c.R&&S&&!S[u]&&a(S,u,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(343);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(345),i=n(350);e.exports=n(101)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(346),i=n(347),o=n(349),a=Object.defineProperty;t.f=n(101)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(100);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(101)&&!n(141)((function(){return 7!=Object.defineProperty(n(348)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(100),i=n(99).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(100);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}}])}));
//# sourceMappingURL=CoachPackage.js.map