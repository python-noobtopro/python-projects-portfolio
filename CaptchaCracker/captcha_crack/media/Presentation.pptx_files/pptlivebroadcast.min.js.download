!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PPTLiveBroadcast=t():e.PPTLiveBroadcast=t()}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=18)}([function(e,t,i){"use strict";var n=i(7),s=Object.prototype.toString;function r(e){return"[object Array]"===s.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function i(i,n){c(t[n])&&c(i)?t[n]=e(t[n],i):c(i)?t[n]=e({},i):r(i)?t[n]=i.slice():t[n]=i}for(var n=0,s=arguments.length;n<s;n++)u(arguments[n],i);return t},extend:function(e,t,i){return u(t,(function(t,s){e[s]=i&&"function"==typeof t?n(t,i):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,i){"use strict";var n,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,i,n){var s,r,o,a;if(l(i),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),r=e._events),o=r[t]),void 0===o)o=r[t]=i,++e._eventsCount;else if("function"==typeof o?o=r[t]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(s=u(e))>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},s=f.bind(n);return s.listener=i,n.wrapFn=s,s}function p(e,t,i){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?i?[s.listener||s]:[s]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(s):g(s,s.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(i=0;i<l;++i)r(u[i],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,n,s,r,o;if(l(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(s=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){o=i[r].listener,s=r;break}if(s<0)return this;0===s?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,s),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var s,r=Object.keys(i);for(n=0;n<r.length;++n)"removeListener"!==(s=r[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,i){var n=i(19),s=i(20),r=s;r.v1=n,r.v4=s,e.exports=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionState=void 0,function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting"}(t.ConnectionState||(t.ConnectionState={}))},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,s=i;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info"}(t.TraceLevel||(t.TraceLevel={}))},function(e,t,i){"use strict";e.exports=function(e,t){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return e.apply(t,i)}}},function(e,t,i){"use strict";var n=i(0);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,i){if(!t)return e;var r;if(i)r=i(t);else if(n.isURLSearchParams(t))r=t.toString();else{var o=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),r=o.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}},function(e,t,i){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,i){"use strict";(function(t){var n=i(0),s=i(30),r={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=i(11)),a),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){c.headers[e]=n.merge(r)})),e.exports=c}).call(this,i(29))},function(e,t,i){"use strict";var n=i(0),s=i(31),r=i(33),o=i(8),a=i(34),c=i(37),l=i(38),u=i(12);e.exports=function(e){return new Promise((function(t,i){var h=e.data,f=e.headers;n.isFormData(h)&&delete f["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(p+":"+m)}var g=a(e.baseURL,e.url);if(d.open(e.method.toUpperCase(),o(g,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?c(d.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:n,config:e,request:d};s(t,i,r),d=null}},d.onabort=function(){d&&(i(u("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){i(u("Network Error",e,null,d)),d=null},d.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),i(u(t,e,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var v=(e.withCredentials||l(g))&&e.xsrfCookieName?r.read(e.xsrfCookieName):void 0;v&&(f[e.xsrfHeaderName]=v)}if("setRequestHeader"in d&&n.forEach(f,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete f[t]:d.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),i(e),d=null)})),h||(h=null),d.send(h)}))}},function(e,t,i){"use strict";var n=i(32);e.exports=function(e,t,i,s,r){var o=new Error(e);return n(o,t,i,s,r)}},function(e,t,i){"use strict";var n=i(0);e.exports=function(e,t){t=t||{};var i={},s=["url","method","data"],r=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function l(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(i[s]=c(void 0,e[s])):i[s]=c(e[s],t[s])}n.forEach(s,(function(e){n.isUndefined(t[e])||(i[e]=c(void 0,t[e]))})),n.forEach(r,l),n.forEach(o,(function(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(i[s]=c(void 0,e[s])):i[s]=c(void 0,t[s])})),n.forEach(a,(function(n){n in t?i[n]=c(e[n],t[n]):n in e&&(i[n]=c(void 0,e[n]))}));var u=s.concat(r).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return n.forEach(h,l),i}},function(e,t,i){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t){},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n,s,r,o=i(1),a=i(2),c=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard"}(s||(s={})),function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,i,n){return"tag_"+e.tagIntToString(t)+" ["+s[i]+"] "+n},e.prototype.sendTraceTag=function(t,i,s,r){var o=console.log;switch(s){case n.Error:o=console.error;break;case n.Warning:o=console.warn;break;case n.Info:o=console.info;break;case n.Verbose:o=console.debug;break;case n.Spam:default:o=console.log}try{o(e.getLogMessage(t,i,r))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,i,n,s){console.assert(n,e.getLogMessage(t,i,s))},e.prototype.debugAssertTag=function(e,t,i,n){this.shipAssertTag(e,t,i,n)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}(),new(function(){function e(){this.externalLogger=new c}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,i,n){this.externalLogger.sendTraceTag(e,t,i,n)},e.prototype.debugAssertTag=function(e,t,i,n){this.externalLogger.debugAssertTag(e,t,i,n)},e.prototype.shipAssertTag=function(e,t,i,n){this.externalLogger.shipAssertTag(e,t,i,n)},e}()),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={})),function(){function e(t,i){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,i){window.clearTimeout(n.timeoutId),n.logCache.length>0&&(n.uploadId+=1,function(e,t,i){if(""!==t){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}}(function(e,t,i,n){var s=e.map((function(e){return function(e,t){var i={};i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category;var n=1e3*e.type+e.level;return i.D=n,i}(e,n)})),r=function(e,t,i,n){var s={};return s.T=e,s.L=t,s.S=i,s.I=n,s.V=1,s}(n,s,t,i);return JSON.stringify(r)}(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,i),n.logCache=[],n.timestampBase=Date.now()),t&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=i+"?usid="+t,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===n.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}(),n.Info;var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};!function(e){!function(e,t){function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(c);var u=i(17);class h{constructor(e){this.m_logger=e}sendTraceTag(e,t,i){this.m_logger.sendTraceTag(e,s.msoulscat_Wac_PptLive,t,i)}}class f{constructor(){this.events=new o.EventEmitter,this.clientId=Object(a.v4)()}on(e,t){return this.events.on(e,t),this}off(e,t){return this.events.off(e,t),this}removeAllListeners(e){return this.events.removeAllListeners(e),this}async init(e){this.m_logger=e.logger||new c;const t=e.pragueDocID,i=e.timeoutDurationInMs;if(!t)throw this.m_logger.sendTraceTag(595630088,s.msoulscat_Wac_PptLive,n.Error,"PPTLiveBroadcast::init - Empty prague docID"),new Error("Empty prague docID");let r=[new Promise((t,i)=>{t(this.initImpl(e))})];if(i){this.m_logger.sendTraceTag(595630089,s.msoulscat_Wac_PptLive,n.Info,`PPTLiveBroadcast::init - Creating competing promise with timeout of ${i}ms`);const e=new Promise((e,t)=>{setTimeout(()=>{t(`reached timeout of ${i} ms`)},i)});r.push(e)}return this.m_logger.sendTraceTag(595630090,s.msoulscat_Wac_PptLive,n.Info,"PPTLiveBroadcast::init - start init tasks"),await Promise.race(r).catch(e=>{const t=new Error("PPTLiveBroadcast::Init - issues due to: "+e);throw t.stack=e.stack,t})}async initImpl(e){this.m_logger.sendTraceTag(595630091,s.msoulscat_Wac_PptLive,n.Info,"PPTLiveBroadcast::initImpl - Start creating prague proxy");let t=Date.now();const i=e.isPresenter?"presenter":"participant";this.stateServiceProxy=await Object(u.createStateServiceProxyAsync)(e.pragueDocID,i,e.routerlicious,new h(this.m_logger),e);let r=Date.now();this.m_logger.sendTraceTag(595630092,s.msoulscat_Wac_PptLive,n.Info,`PPTLiveBroadcast::initImpl - Completed creating prague proxy in ${r-t}ms`),this.clientId=this.stateServiceProxy.clientId(),this.stateServiceProxy.on("activeClientCountChanged",()=>{if(this.clientId!==this.stateServiceProxy.clientId()){const e=this.preferredSubtitleLanguage;this.clientId=this.stateServiceProxy.clientId(),this.preferredSubtitleLanguage=e}else this.clientId=this.stateServiceProxy.clientId();this.events.emit("activeParticipantCountChanged",this.activeParticipantCount)}),this.connectionState=this.stateServiceProxy.getConnectionState(),this.stateServiceProxy.on("connectionStateChanged",()=>{this.connectionState=this.stateServiceProxy.getConnectionState(),this.events.emit("connectionStateChanged",this.connectionState)}),this.stateServiceProxy.on("messageRoundTripped",t=>{this.m_logger.sendTraceTag(594916566,s.msoulscat_Wac_PptLive,n.Info,`IStateServiceProxy::messageRoundTripped: {isPresenter:${e.isPresenter}, details:${JSON.stringify(t)}}`)}),this.m_logger.sendTraceTag(595630093,s.msoulscat_Wac_PptLive,n.Info,"PPTLiveBroadcast::initImpl - Init presenter cell"),t=Date.now(),await this.initPresenterCell(e.isPresenter),r=Date.now(),this.m_logger.sendTraceTag(595630094,s.msoulscat_Wac_PptLive,n.Info,`PPTLiveBroadcast::initImpl - Finished init presenter cell in ${r-t}ms`),t=Date.now(),await Promise.all([this.initSessionStateCell(),this.initPresenterStateCell(),this.initWelcomeScreenStateCell(),this.initPollInfoStateCell(),this.initNavigationStateCell(),this.initFileInfoCell(),this.initParticipantsMap(e.preferredSubtitleLanguage),this.initFinalSubtitlesMap(),this.initPartialSubtitlesMap(),this.initSubtitlesEnabledCell(),this.initLastTriggeredSurveyInfoCell(),this.initReactionsMap(),this.initDefaultSubtitleLanguageCell(),this.initAudienceFeedbackInfoCell(),this.initSlideInfoMap(),this.initAggregatedReactions(),this.initHolographURLCell()]),r=Date.now(),this.m_logger.sendTraceTag(595630095,s.msoulscat_Wac_PptLive,n.Info,`PPTLiveBroadcast::initImpl - Finished init remaining cells in ${r-t}ms`)}close(){this.stateServiceProxy?(this.m_logger.sendTraceTag(594883807,s.msoulscat_Wac_PptLive,n.Info,"PPTLiveBroadcast::close - "+JSON.stringify(this.stateServiceProxy.getServiceTelemetry())),this.stateServiceProxy.close()):this.m_logger.sendTraceTag(589641427,s.msoulscat_Wac_PptLive,n.Warning,"PPTLiveBroadcast::close - stateServiceProxy is not set.")}onFocusChanged(e){this.stateServiceProxy.onFocusChanged(e)}throwIfDocNotInitialized(){if(!this.stateServiceProxy)throw new Error("Tried to initialize without Prague doc")}throwIfObjectNotInitialized(e,t){if(!e)throw new Error(`Attempted to access ${t} before initialized`)}async initCell(e,t){let i;i=this.isPresenter()?await this.stateServiceProxy.createCellAsync(e):await this.stateServiceProxy.waitCellAsync(e);const n=await i.getAsync();return n&&t(n),i}async initMap(e,t){let i;i=this.isPresenter()?await this.stateServiceProxy.createMapAsync(e):await this.stateServiceProxy.waitMapAsync(e);const n=new Map;return i.forEach((e,t)=>{n.set(t,e)}),t(n),i}async initSessionStateCell(){this.throwIfDocNotInitialized(),this.sessionStateCell=await this.initCell("sessionState",e=>this._sessionState=e),this.sessionStateCell.on("valueChanged",e=>{this._sessionState=e,this.events.emit("sessionStateChanged",this.sessionState)})}set sessionState(e){this.throwIfObjectNotInitialized(this.sessionStateCell,"session state"),this._sessionState!==e&&(this._sessionState=e,this.sessionStateCell.setAsync(this._sessionState))}get sessionState(){return this.throwIfObjectNotInitialized(this.sessionStateCell,"session state"),this._sessionState}async initPresenterStateCell(){this.throwIfDocNotInitialized(),this.presenterStateCell=await this.initCell("presenterState",e=>this._presenterState=e),this.presenterStateCell.on("valueChanged",e=>{this._presenterState=e,this.events.emit("presenterStateChanged",this.presenterState)})}set presenterState(e){this.throwIfObjectNotInitialized(this.presenterStateCell,"presenter state"),this._presenterState!==e&&(this._presenterState=e,this.presenterStateCell.setAsync(this._presenterState))}get presenterState(){return this.throwIfObjectNotInitialized(this.presenterStateCell,"presenter state"),this._presenterState}async initWelcomeScreenStateCell(){this.throwIfDocNotInitialized(),this.welcomeScreenStateCell=await this.initCell("welcomeScreenState",e=>this._welcomeScreenState=e),this.welcomeScreenStateCell.on("valueChanged",e=>{this._welcomeScreenState=e,this.events.emit("welcomeScreenStateChanged",this.welcomeScreenState)})}set welcomeScreenState(e){this.throwIfObjectNotInitialized(this.welcomeScreenStateCell,"welcome screen state"),this._welcomeScreenState!==e&&(this._welcomeScreenState=e,this.welcomeScreenStateCell.setAsync(this._welcomeScreenState))}get welcomeScreenState(){return this.throwIfObjectNotInitialized(this.welcomeScreenStateCell,"welcome screen state"),this._welcomeScreenState}async initPollInfoStateCell(){this.throwIfDocNotInitialized(),this.pollInfoStateCell=await this.initCell("pollInfoState",e=>this._pollInfoState=e),this.pollInfoStateCell.on("valueChanged",e=>{this._pollInfoState=e,this.events.emit("pollInfoStateChanged",this.pollInfoState)})}set pollInfoState(e){this.throwIfObjectNotInitialized(this.pollInfoStateCell,"pollInfo state"),this._pollInfoState!==e&&(this._pollInfoState=e,this.pollInfoStateCell.setAsync(this._pollInfoState))}get pollInfoState(){return this.throwIfObjectNotInitialized(this.pollInfoStateCell,"pollInfo state"),this._pollInfoState}async initNavigationStateCell(){this.throwIfDocNotInitialized(),this.navigationStateCell=await this.initCell("navigationState",e=>this._navigationState=e),this.navigationStateCell.on("valueChanged",e=>{this._navigationState=e,this.events.emit("navigationStateChanged",this.navigationState)})}set navigationState(e){this.throwIfObjectNotInitialized(this.navigationStateCell,"navigation state"),this._navigationState!==e&&(this._navigationState=e,this.navigationStateCell.setAsync(this._navigationState))}get navigationState(){return this.throwIfObjectNotInitialized(this.navigationStateCell,"navigation state"),this._navigationState}async initFileInfoCell(){this.throwIfDocNotInitialized(),this.fileInfoCell=await this.initCell("fileInfo",e=>this._fileInfo=e),this.fileInfoCell.on("valueChanged",e=>{this._fileInfo=e,this.events.emit("fileInfoChanged",this._fileInfo)})}set fileInfo(e){this.throwIfObjectNotInitialized(this.fileInfoCell,"file info"),this._fileInfo!==e&&(this._fileInfo=e,this.fileInfoCell.setAsync(this._fileInfo))}get fileInfo(){return this.throwIfObjectNotInitialized(this.fileInfoCell,"file info"),this._fileInfo}async initAudienceFeedbackInfoCell(){this.throwIfDocNotInitialized(),this.audienceFeedbackInfoCell=await this.initCell("audienceFeedbackInfo",e=>this._audienceFeedbackInfo=e),this.audienceFeedbackInfoCell.on("valueChanged",e=>{this._audienceFeedbackInfo=e,this.events.emit("audienceFeedbackInfoChanged",this._audienceFeedbackInfo)})}set audienceFeedbackInfo(e){this.throwIfObjectNotInitialized(this.audienceFeedbackInfoCell,"audience feedback info"),this._audienceFeedbackInfo!==e&&(this._audienceFeedbackInfo=e,this.audienceFeedbackInfoCell.setAsync(this._audienceFeedbackInfo))}get audienceFeedbackInfo(){return this.throwIfObjectNotInitialized(this.audienceFeedbackInfoCell,"audience feedback info"),this._audienceFeedbackInfo}async initParticipantsMap(e){this.throwIfDocNotInitialized(),this.participantsMap=await this.initMap("participants",e=>this._participants=e),this.participantsMap.on("valueChanged",async e=>{let t=await this.participantsMap.get(e),i=this._participants.get(e);this._participants.set(e,t),i&&i.preferredSubtitleLanguage!==t.preferredSubtitleLanguage&&this.events.emit("preferredSubtitleLanguageChanged",t.preferredSubtitleLanguage,e),this.events.emit("participantsChanged",this._participants),this.events.emit("activeParticipantCountChanged",this.activeParticipantCount)}),this.preferredSubtitleLanguage=e}get participants(){return this.throwIfObjectNotInitialized(this.participantsMap,"participant preferences"),new Map(JSON.parse(JSON.stringify([...this._participants])))}get activeParticipants(){this.throwIfObjectNotInitialized(this.participantsMap,"participant preferences");let e=this.stateServiceProxy.activeClientIds(),t=[...this.participants.entries()].filter(([t,i])=>e.has(t)&&"participant"===i.type);return new Map(t)}get activeParticipantCount(){return this.activeParticipants.size}set preferredSubtitleLanguage(e){this.throwIfObjectNotInitialized(this.participantsMap,"subtitle preferences");let t=this._participants.get(this.clientId);if(t){if(e&&t.preferredSubtitleLanguage!==e){let i=t;i.preferredSubtitleLanguage=e,this._participants.set(this.clientId,i),this.participantsMap.set(this.clientId,i)}}else if(e){let t={preferredSubtitleLanguage:e,lastAccess:new Date,type:this.isPresenter()?"presenter":"participant"};this._participants.set(this.clientId,t),this.participantsMap.set(this.clientId,t)}}get preferredSubtitleLanguage(){this.throwIfObjectNotInitialized(this.participantsMap,"subtitle preferences");let e=this._participants.get(this.clientId);if(e)return e.preferredSubtitleLanguage}async initDefaultSubtitleLanguageCell(){this.throwIfDocNotInitialized(),this.defaultSubtitleLanguageCell=await this.initCell("defaultSubtitleLanguageCell",e=>this._defaultSubtitleLanguage=e),this.defaultSubtitleLanguageCell.on("valueChanged",e=>{this._defaultSubtitleLanguage=e,this.events.emit("defaultSubtitleLanguageChanged",this.defaultSubtitleLanguage)})}set defaultSubtitleLanguage(e){this.throwIfObjectNotInitialized(this.defaultSubtitleLanguageCell,"default subtitle language"),this._defaultSubtitleLanguage!==e&&(this._defaultSubtitleLanguage=e,this.defaultSubtitleLanguageCell.setAsync(this._defaultSubtitleLanguage))}get defaultSubtitleLanguage(){return this.throwIfObjectNotInitialized(this.defaultSubtitleLanguageCell,"default subtitle language"),this._defaultSubtitleLanguage}async initPresenterCell(e){this.throwIfDocNotInitialized(),e?(this.presenterCell=await this.stateServiceProxy.createCellAsync("presenter"),this._presenter=this.clientId,this.presenterCell.setAsync(this.clientId)):this.presenterCell=await this.stateServiceProxy.waitCellAsync("presenter"),this.presenterCell.on("valueChanged",e=>{this._presenter=e,this.events.emit("presenterChanged",this.presenter)});const t=await this.presenterCell.getAsync();t&&(this._presenter=t)}get presenter(){return this.throwIfObjectNotInitialized(this.presenterCell,"presenter"),this._presenter}set presenter(e){if(this.throwIfObjectNotInitialized(this.presenterCell,"presenter"),!this.isPresenter())throw new Error("Attempted to modify presenter without permission");if(!this._participants.has(this._presenter))throw new Error("Attempted to set presenter without being registered");if(!this._participants.has(e))throw new Error("Attempted to set presenter to an invalid client ID");if(this._presenter!==e){const t=this._participants.get(this._presenter);t.type="participant",this._participants.set(this._presenter,t),this.participantsMap.set(this._presenter,t);const i=this._participants.get(e);i.type="presenter",this._participants.set(e,i),this.participantsMap.set(e,i),this._presenter=e,this.presenterCell.setAsync(e)}}isPresenter(){return this._presenter===this.clientId}async initSubtitlesEnabledCell(){this.throwIfDocNotInitialized(),this.subtitlesEnabledCell=await this.initCell("subtitlesEnabled",e=>this._subtitlesEnabled=e),this.subtitlesEnabledCell.on("valueChanged",e=>{this._subtitlesEnabled=e,this.events.emit("subtitlesEnabledChanged",this.subtitlesEnabled)})}get subtitlesEnabled(){return this.throwIfObjectNotInitialized(this.subtitlesEnabledCell,"subtitles enabled state"),this._subtitlesEnabled}set subtitlesEnabled(e){this.throwIfObjectNotInitialized(this.subtitlesEnabledCell,"subtitles enabled state"),this._subtitlesEnabled!==e&&(this._subtitlesEnabled=e,this.subtitlesEnabledCell.setAsync(this._subtitlesEnabled))}async initFinalSubtitlesMap(){this.throwIfDocNotInitialized(),this.finalSubtitlesMap=await this.initMap("finalSubtitles",e=>this._finalSubtitles=e),this.finalSubtitlesMap.on("valueChanged",e=>{this._finalSubtitles.set(e,this.finalSubtitlesMap.get(e)),this.events.emit("finalSubtitlesChanged",this._finalSubtitles,e),this.preferredSubtitleLanguage&&e===this.preferredSubtitleLanguage&&this.events.emit("preferredFinalSubtitlesChanged",this._finalSubtitles.get(this.preferredSubtitleLanguage))})}set finalSubtitles(e){this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"final subtitles"),this._finalSubtitles=e,this._finalSubtitles.forEach((e,t)=>{e.timestamp||(e.timestamp=new Date),e.slideState||(e.slideState=this.navigationState.to),this.finalSubtitlesMap.set(t,e)})}get finalSubtitles(){return this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"final subtitles"),this._finalSubtitles}async getFinalSubtitlesHistory(){let e=new Map;const t=await this.stateServiceProxy.getHistoryAsync(this.finalSubtitlesMap.id());for(let i of t)void 0!==i.property&&(e.has(i.property)||e.set(i.property,[]),e.get(i.property).push(i.value));return e}get preferredFinalSubtitles(){if(this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"preferred final subtitles"),this.preferredSubtitleLanguage)return this._finalSubtitles.get(this.preferredSubtitleLanguage)}async getPreferredFinalSubtitlesHistory(e){let t=[];const i=await this.stateServiceProxy.getHistoryAsync(this.finalSubtitlesMap.id(),e||this.preferredSubtitleLanguage);for(let e of i)t.push(e.value);return t}async getPreferredFinalSubtitlesHistoryWithPagination(e,t){let i={cursor:"",finalSubtitles:[]};const n=await this.stateServiceProxy.getHistoryWithPaginationAsync(this.finalSubtitlesMap.id(),e||this.preferredSubtitleLanguage,t);i.cursor=n.cursor;const s=n.messages;for(let e of s)i.finalSubtitles.push(e.value);return i}getServiceTelemetry(){return this.stateServiceProxy?this.stateServiceProxy.getServiceTelemetry():(this.m_logger.sendTraceTag(589641428,s.msoulscat_Wac_PptLive,n.Warning,"PPTLiveBroadcast::getServiceTelemetry - stateServiceProxy is not set."),null)}async initPartialSubtitlesMap(){this.throwIfDocNotInitialized(),this._partialSubtitles=new Map,this.partialSubtitlesCell=await this.initCell("partialSubtitles",e=>{let t=new Map(JSON.parse(e));t&&(this._partialSubtitles=t)});let e=this._partialSubtitles.set;this._partialSubtitles.set=(t,i)=>(e.apply(this._partialSubtitles,[t,i]),this.partialSubtitles=this._partialSubtitles,this._partialSubtitles),this.partialSubtitlesCell.on("valueChanged",async e=>{if(e){let t=new Map(JSON.parse(e));t&&(this.preferredSubtitleLanguage&&t.has(this.preferredSubtitleLanguage)&&this._partialSubtitles.get(this.preferredSubtitleLanguage)!==t.get(this.preferredSubtitleLanguage)&&this.events.emit("preferredPartialSubtitlesChanged",t.get(this.preferredSubtitleLanguage)),this._partialSubtitles=t,this.events.emit("partialSubtitlesChanged",this._partialSubtitles))}})}set partialSubtitles(e){this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"partial subtitles"),this._partialSubtitles=e,this.partialSubtitlesCell.setAsync(JSON.stringify([...e]))}get partialSubtitles(){return this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"partial subtitles"),this._partialSubtitles}get preferredPartialSubtitles(){if(this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"preferred partial subtitles"),this.preferredSubtitleLanguage)return this._partialSubtitles.get(this.preferredSubtitleLanguage)}async initLastTriggeredSurveyInfoCell(){this.throwIfDocNotInitialized(),this.lastTriggeredSurveyInfoCell=await this.initCell("lastTriggeredSurveyInfo",e=>this._lastTriggeredSurveyInfo=e),this.lastTriggeredSurveyInfoCell.on("valueChanged",e=>{this._lastTriggeredSurveyInfo=e,this.events.emit("surveyTriggered",this.lastTriggeredSurveyInfo)})}get lastTriggeredSurveyInfo(){return this.throwIfObjectNotInitialized(this.lastTriggeredSurveyInfoCell,"last triggered survey"),this._lastTriggeredSurveyInfo}set lastTriggeredSurveyInfo(e){this.throwIfObjectNotInitialized(this.lastTriggeredSurveyInfoCell,"last triggered survey"),this._lastTriggeredSurveyInfo!==e&&(this._lastTriggeredSurveyInfo=e,this.lastTriggeredSurveyInfoCell.setAsync(this._lastTriggeredSurveyInfo))}async initReactionsMap(){this.throwIfDocNotInitialized(),this.reactionsMap=await this.initMap("reactions",e=>this._reactions=e),this.reactionsMap.on("valueChanged",async e=>{let t=await this.reactionsMap.get(e);this._reactions.set(e,t),this.events.emit("newReaction",t,e)})}get reactions(){return this.throwIfObjectNotInitialized(this.reactionsMap,"reactions"),new Map(JSON.parse(JSON.stringify([...this._reactions])))}set lastReaction(e){this.throwIfObjectNotInitialized(this.reactionsMap,"reactions");let t=this._reactions.get(this.clientId);e&&t!==e&&(e.slideId=e.slideId||this.navigationState.to.location.slideId,e.timestamp=e.timestamp||new Date,this._reactions.set(this.clientId,e),this.reactionsMap.set(this.clientId,e))}get lastReaction(){return this.throwIfObjectNotInitialized(this.reactionsMap,"reactions"),this._reactions.get(this.clientId)||void 0}async initAggregatedReactions(){this.throwIfDocNotInitialized(),this.aggregatedReactionsCell=await this.initCell("aggregated_reactions",e=>{this._aggregatedReactions=e}),this.aggregatedReactionsCell.on("valueChanged",async e=>{e&&(this._aggregatedReactions=e,this.events.emit("aggregatedReactionsSubmitted",e))})}set aggregatedReactions(e){this.throwIfObjectNotInitialized(this.aggregatedReactionsCell,"reactions Count"),this._aggregatedReactions=e,this.aggregatedReactionsCell.setAsync([...this._aggregatedReactions])}get aggregatedReactions(){return this.throwIfObjectNotInitialized(this.aggregatedReactionsCell,"reactions Count"),this._aggregatedReactions}async initHolographURLCell(){this.throwIfDocNotInitialized(),this.holographURLCell=await this.initCell("holographURL",e=>this._holographURL=e),this.holographURLCell.on("valueChanged",e=>{this._holographURL=e,this.events.emit("holographURLChanged",this.holographURL)})}set holographURL(e){this.throwIfObjectNotInitialized(this.holographURLCell,"holograph URL"),this._holographURL!==e&&(this._holographURL=e,this.holographURLCell.setAsync(this._holographURL))}get holographURL(){return this.throwIfObjectNotInitialized(this.holographURLCell,"holograph URL"),this._holographURL}async initSlideInfoMap(){this.throwIfDocNotInitialized(),this.slideInfoMap=await this.initMap("slideInfo",e=>this._slideInfo=e),this.slideInfoMap.on("valueChanged",async e=>{let t=await this.slideInfoMap.get(e);this._slideInfo.set(e,t),this.events.emit("slideInfoChanged",this._slideInfo)})}get slideInfo(){return this.throwIfObjectNotInitialized(this.slideInfoMap,"slide info"),new Map(JSON.parse(JSON.stringify([...this._slideInfo])))}}function d(){return new f}},function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),s(i(6),t),s(i(3),t),s(i(21),t)},function(e,t,i){"use strict";i.r(t);var n=i(16);i.d(t,"createPPTLiveBroadcast",(function(){return n.a}));var s=i(15);for(var r in s)["createPPTLiveBroadcast","default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(r)},function(e,t,i){var n,s,r=i(4),o=i(5),a=0,c=0;e.exports=function(e,t,i){var l=t&&i||0,u=t||[],h=(e=e||{}).node||n,f=void 0!==e.clockseq?e.clockseq:s;if(null==h||null==f){var d=r();null==h&&(h=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==f&&(f=s=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=p-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(f=f+1&16383),(g<0||p>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=m,s=f;var v=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var _=p/4294967296*1e4&268435455;u[l++]=_>>>8&255,u[l++]=255&_,u[l++]=_>>>24&15|16,u[l++]=_>>>16&255,u[l++]=f>>>8|128,u[l++]=255&f;for(var y=0;y<6;++y)u[l+y]=h[y];return t||o(u)}},function(e,t,i){var n=i(4),s=i(5);e.exports=function(e,t,i){var r=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createStateServiceProxyAsync=void 0;var r=i(22);t.createStateServiceProxyAsync=function(e,t,i,o,a,c){return n(this,void 0,void 0,(function(){var n;return s(this,(function(s){switch(s.label){case 0:return[4,(n=new r.SimpleStateServiceProxy(e,t,i,o,a,c)).connectAsync()];case 1:return s.sent(),[2,n]}}))}))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleStateServiceProxy=void 0;var a=i(3),c=i(1),l=i(2),u=o(i(23)),h=i(6),f=i(42),d=i(43),p=i(44),m=i(45),g=[2e3,2e3,3e3,3e3,5e3],v=function(){function e(e,t,i,n,s,r){var o=this;this.m_events=new c.EventEmitter,this.m_connectionState=a.ConnectionState.Disconnected,this.m_handlers=new Map,this.m_webSocket=null,this.m_clientIds=new Set,this.m_retryAttempts=0,this.m_maxSessionRetries=0,this.m_outboundMessageInfo=new Map,this.m_initPromise={promise:null,resolve:null,reject:null},this.m_messageBuffer=[],this.m_batchWaitTimeMS=20,this.m_batchMessageTypeName="list",this.m_closeWebSocketTimer=null,this.m_lastCloseCode=0,this.m_lastCloseReason="",this.m_offlineMessageCache=[],this.m_clientId=s.customClientId||l.v4(),this.m_sessionId=e,this.m_logger=n,this.m_websocketAliveTimeAfterLoseFocusInMS=s.websocketAliveTimeAfterLoseFocusInMS,this.m_wsUrl=i+"?docId="+this.m_sessionId+"&clientId="+this.m_clientId+"&clientType="+t,s.correlationId&&(this.m_wsUrl+="&cid="+s.correlationId),s.isAutomation&&(this.m_wsUrl+="&automation=true"),s.autoRoutingEnabled&&(this.m_wsUrl+="&routing=true"),this.m_deltasBaseUrl=i.replace("wss://","https://").replace("ws://","http://"),this.m_clientsCell=new f.SimpleSyncCell("systemClients",this),this.m_handlers.set(this.m_clientsCell.id(),this.m_clientsCell),this.m_clientsCell.on("valueChanged",(function(e){o.m_clientIds=new Set(e),o.m_events.emit("activeClientCountChanged")})),this.setUpSystemCommandsCell(),this.m_telemetry=new p.SimpleServiceTelemetry(this.m_clientId,this.m_sessionId,s.maxRoundtripRaw),this.m_verbose=s.verbose||!1,this.m_batchedRequestsEnabled=s.batchedRequestsEnabled,this.m_pingTimeoutInMs=s.pingTimeoutInMs,this.m_pongTimeoutInMs=s.pongTimeoutInMs,this.m_user=r,this.m_metadata=s.metadata,this.m_retryIntervalsInMs=s.retryIntervalsInMs||g,this.m_maxSessionRetries=s.maxSessionRetries,this.m_offlineMessageCacheEnabled=s.offlineMessageCacheEnabled,this.m_maxOfflineMessageCacheTimeinMs=s.maxOfflineMessageCacheTimeinMs,this.m_maxOfflineMessageCacheSize=s.maxOfflineMessageCacheTimeinMs}return Object.defineProperty(e.prototype,"lastCloseReason",{get:function(){return this.m_lastCloseReason},enumerable:!1,configurable:!0}),e.prototype.setConnectionState=function(e){this.m_connectionState!==e&&(this.m_connectionState=e,this.m_events.emit("connectionStateChanged"))},e.prototype.setUpSystemCommandsCell=function(){var e=this;this.m_systemCommandsCell=new f.SimpleSyncCell("systemCommands",this),this.m_handlers.set(this.m_systemCommandsCell.id(),this.m_systemCommandsCell),this.m_systemCommandsCell.on("valueChanged",(function(t){return n(e,void 0,void 0,(function(){var e,i,n;return s(this,(function(s){switch(s.label){case 0:switch(t){case"refreshToken":return[3,1]}return[3,6];case 1:if(!this.m_user||!this.m_user.getForceRefreshedTokenAsync)return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.m_user.getForceRefreshedTokenAsync()];case 3:return e=s.sent(),(i={}).authorization=e.token,i.authProvider=e.authProvider,i.mri=e.mri||"",i.huid=e.hashedUserEmail||"",this.sendConfigMessage(i),[3,5];case 4:return n=s.sent(),this.m_logger.sendTraceTag(574107847,h.TraceLevel.Error,"Error getting force refreshed auth token: "+m.errorToString(n)),[3,5];case 5:return[3,7];case 6:return this.m_logger.sendTraceTag(574107848,h.TraceLevel.Error,"Unknown system command cell value: "+t),[3,7];case 7:return[2]}}))}))}))},e.prototype.connectAsync=function(){return n(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.m_initPromise.promise=new Promise((function(t,i){e.m_initPromise.resolve=t,e.m_initPromise.reject=i})),this.setConnectionState(a.ConnectionState.Connecting),[2,new Promise((function(t,i){e.m_webSocket=new WebSocket(e.m_wsUrl),e.m_webSocket.onopen=function(){return n(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.handleWebSocketOpenAsync()];case 1:return e.sent(),t(),[2]}}))}))},e.m_webSocket.onerror=function(t){e.m_logger.sendTraceTag(590213388,h.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onerror. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Error: "+JSON.stringify(t)+"}"),e.retryConnection((function(t){var n="failed to reconnect after websocket error: "+m.errorToString(t);e.m_logger.sendTraceTag(579463185,h.TraceLevel.Error,n),i(n)}),!1)},e.m_webSocket.onclose=function(t){e.m_logger.sendTraceTag(590213389,h.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onclose. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Code: "+t.code+", Reason: "+t.reason+"}"),e.m_lastCloseCode=t.code,e.m_lastCloseReason=t.reason,4321!==t.code?e.retryConnection((function(t){var n="failed to reconnect after service side disconnect: "+m.errorToString(t);e.m_logger.sendTraceTag(579463186,h.TraceLevel.Error,n),i(n)}),!1):(e.setConnectionState(a.ConnectionState.Disconnected),e.m_logger.sendTraceTag(588009741,h.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onclose. Not retryable close code. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+"}"))},e.m_webSocket.onmessage=function(t){try{e.handleWebSocketMessage(t)}catch(t){e.m_logger.sendTraceTag(590213390,h.TraceLevel.Error,"SimpleStateServiceProxy::onmessage - websocket error. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Error: "+m.errorToString(t)+"}")}}}))]}))}))},e.prototype.canRetry=function(){return this.m_connectionState===a.ConnectionState.Disconnected&&4321!==this.m_lastCloseCode},e.prototype.handleWebSocketOpenAsync=function(){return n(this,void 0,void 0,(function(){var e,t,i;return s(this,(function(n){switch(n.label){case 0:if(this.m_logger.sendTraceTag(590213387,h.TraceLevel.Info,"SimpleStateServiceProxy::connect - websocket onopen. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryAttempts=0,this.setConnectionState(a.ConnectionState.Connected),this.startPingTimer(),!this.m_user||!this.m_user.getAuthTokenAsync)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.m_user.getAuthTokenAsync()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),this.m_logger.sendTraceTag(578102469,h.TraceLevel.Error,"Error getting auth token: "+m.errorToString(t)),[3,4];case 4:return(e||this.m_metadata)&&(i={},e&&(i.authorization=e.token,i.authProvider=e.authProvider,i.mri=e.mri||"",i.huid=e.hashedUserEmail||""),this.m_metadata&&(i.metadata=JSON.stringify(this.m_metadata)),this.sendConfigMessage(i)),this.processOfflineMessageCache(),this.clearOfflineMessageCacheTimer(),[2]}}))}))},e.prototype.onFocusChanged=function(e){var t=this;e?(window.clearTimeout(this.m_closeWebSocketTimer),this.m_webSocket||(this.m_logger.sendTraceTag(590213392,h.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - websocket retryConnection due to getting focus again. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.retryConnection((function(e){t.m_logger.sendTraceTag(579463187,h.TraceLevel.Error,"failed to reconnect after regaining focus: "+m.errorToString(e))}),!0))):this.m_closeWebSocketTimer=window.setTimeout((function(){t.m_webSocket&&(t.m_logger.sendTraceTag(590213391,h.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - websocket close due to losing focus. {sessionId: "+t.m_sessionId+", ClientId: "+t.m_clientId+"}"),t.m_webSocket.onclose=function(){},t.m_webSocket.close(),t.m_webSocket=null)}),this.m_websocketAliveTimeAfterLoseFocusInMS)},e.prototype.sendConfigMessage=function(e){var t={messageId:l.v4(),senderId:this.senderId(),objectId:"config",type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.sendSubscriptionsMessage=function(e){var t={messageId:l.v4(),senderId:this.senderId(),objectId:"ConfigStateSubscriptions",type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.retryConnection=function(e,t){var i=this;if(this.clearPingPongTimer(),this.m_retryAttempts>=this.m_retryIntervalsInMs.length||this.m_telemetry.wsReconnectCount>=this.m_maxSessionRetries)return this.setConnectionState(a.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213393,h.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection reached max retry attempts. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),void(e&&e(new Error("reached max retry attempts")));if(this.setConnectionState(a.ConnectionState.Connecting),t||this.m_webSocket&&!this.m_retryTimer){var r=this.m_retryIntervalsInMs[this.m_retryAttempts];if(this.m_retryAttempts+=1,this.m_telemetry.wsReconnectCount+=1,this.m_webSocket){if(this.m_webSocket.onclose=function(){},this.m_webSocket.readyState===WebSocket.OPEN)this.m_webSocket.close();else{var o=this.m_webSocket;o.onopen=function(){return o.close()}}this.m_webSocket=null}this.m_retryTimer=setTimeout((function(){return n(i,void 0,void 0,(function(){var t;return s(this,(function(i){switch(i.label){case 0:this.m_logger.sendTraceTag(590213395,h.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryTimer=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.connectAsync()];case 2:return i.sent(),[3,4];case 3:return t=i.sent(),this.setConnectionState(a.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213396,h.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection failed. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}, "+m.errorToString(t)),this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&e(t),[3,4];case 4:return[2]}}))}))}),r)}else this.m_logger.sendTraceTag(590213394,h.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection skipped. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", NullWebSocket: "+(null===this.m_webSocket)+", NullRetryTimer: "+(null===this.m_retryTimer)+"}")},e.prototype.startPingTimer=function(){var e=this;this.m_webSocket&&(this.m_pingTimeoutInMs<=0||this.m_pongTimeoutInMs<=0||(this.clearPingPongTimer(),this.m_pingTimer=setTimeout((function(){return n(e,void 0,void 0,(function(){return s(this,(function(e){return this.sendPingMessage(),this.m_pingTimer=null,[2]}))}))}),this.m_pingTimeoutInMs)))},e.prototype.sendPingMessage=function(){var e=this;this.m_webSocket&&(this.m_webSocket.readyState===WebSocket.OPEN?(this.m_webSocket.send("__ping__"),this.clearPongTimer(),this.m_pongTimer=setTimeout((function(){return n(e,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.retryConnection((function(t){e.m_logger.sendTraceTag(579463188,h.TraceLevel.Error,"failed to reconnect after missing ping: "+m.errorToString(t))}),!1),this.m_pongTimer=null,[2]}))}))}),this.m_pongTimeoutInMs)):(this.retryConnection((function(t){e.m_logger.sendTraceTag(579463189,h.TraceLevel.Error,"failed to reconnect after closed websocket: "+m.errorToString(t))}),!1),this.clearPongTimer()))},e.prototype.clearPingPongTimer=function(){this.clearPingTimer(),this.clearPongTimer()},e.prototype.clearPingTimer=function(){this.m_pingTimer&&(clearTimeout(this.m_pingTimer),this.m_pingTimer=null)},e.prototype.clearPongTimer=function(){this.m_pongTimer&&(clearTimeout(this.m_pongTimer),this.m_pongTimer=null)},e.prototype.handleWebSocketMessage=function(e){if("string"==typeof e.data){if(this.startPingTimer(),"__pong__"===e.data)return;var t=Date.now();try{var i=JSON.parse(e.data);Array.isArray(i)&&i.length>0?this.handleAggregatedStateMessages(i):this.handleStateMessage(i),this.m_telemetry.addMessageHandleLatency(Date.now()-t),"systemSessionState"===i.objectId&&this.m_initPromise.resolve()}catch(e){this.m_logger.sendTraceTag(578102302,h.TraceLevel.Error,"handleWebSocketMessage: "+m.errorToString(e))}}else this.m_logger.sendTraceTag(590213397,h.TraceLevel.Error,"SimpleStateServiceProxy::handleWebSocketMessage - Unknown data type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+typeof e.data+"}")},e.prototype.handleAggregatedStateMessages=function(e){var t,i;if(e&&0!==e.length){this.m_user&&this.m_user.beginAggregatedStateUpdating&&this.m_user.beginAggregatedStateUpdating();try{for(var n=r(e),s=n.next();!s.done;s=n.next()){var o=s.value;this.handleStateMessage(JSON.parse(o))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}this.m_user&&this.m_user.endAggregatedStateUpdating&&this.m_user.endAggregatedStateUpdating()}},e.prototype.handleStateMessage=function(e){var t=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213398,h.TraceLevel.Info,"SimpleStateServiceProxy::handleStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),"list"===e.type)JSON.parse(e.value).forEach((function(e){t.handleStateMessage(e)}));else{if(this.m_user&&this.m_user.validateMessage&&!this.m_user.validateMessage(e))return void this.m_logger.sendTraceTag(588009742,h.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage rejected message: {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}");this.measureMessageRoundTripLatency(e);var i=this.m_handlers.get(e.objectId);if(i)return void i.handleStateMessage(e);if("cell"===e.type?i=new f.SimpleSyncCell(e.objectId,this):"map"===e.type?i=new d.SimpleSyncMap(e.objectId,this):this.m_logger.sendTraceTag(590213399,h.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage - Unknown message type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+e.type+"}"),i)return this.m_handlers.set(e.objectId,i),void i.handleStateMessage(e)}},e.prototype.close=function(){this.m_logger.sendTraceTag(590213400,h.TraceLevel.Info,"SimpleStateServiceProxy::close. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_webSocket&&(this.m_webSocket.onclose=function(){},this.m_webSocket.close(),this.m_webSocket=null),this.m_retryTimer&&(clearTimeout(this.m_retryTimer),this.m_retryTimer=null),this.clearPingPongTimer(),this.clearOfflineMessageCacheTimer(),0!==this.countOfOutboundMessagesNotRoundTrippedYet()&&(this.m_events.emit("messageFailedToRoundTripOnClose",this.m_outboundMessageInfo.size),this.m_outboundMessageInfo.clear())},e.prototype.createMapAsync=function(e,t){return n(this,void 0,void 0,(function(){var i;return s(this,(function(n){return i=new d.SimpleSyncMap(e,this,t),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getMapAsync=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(i){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitMapAsync=function(e,t){return n(this,void 0,void 0,(function(){var i;return s(this,(function(n){switch(n.label){case 0:return[4,this.m_initPromise.promise];case 1:return n.sent(),[4,this.getMapAsync(e)];case 2:return(i=n.sent())?[3,4]:[4,this.createMapAsync(e,t)];case 3:i=n.sent(),n.label=4;case 4:return[2,i]}}))}))},e.prototype.createCellAsync=function(e,t){return n(this,void 0,void 0,(function(){var i;return s(this,(function(n){return i=new f.SimpleSyncCell(e,this,t),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getCellAsync=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(i){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitCellAsync=function(e,t){return n(this,void 0,void 0,(function(){var i;return s(this,(function(n){switch(n.label){case 0:return[4,this.m_initPromise.promise];case 1:return n.sent(),[4,this.getCellAsync(e)];case 2:return(i=n.sent())?[3,4]:[4,this.createCellAsync(e,t)];case 3:i=n.sent(),n.label=4;case 4:return[2,i]}}))}))},e.prototype.getHistoryAsync=function(e,t){return n(this,void 0,void 0,(function(){var i,n;return s(this,(function(s){switch(s.label){case 0:return(i=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),i.searchParams.append("docId",this.m_sessionId),i.searchParams.append("cid",this.m_clientId),i.searchParams.append("objectId",e),t&&i.searchParams.append("property",t),[4,u.default.get(i.toString())];case 1:return(n=s.sent().data).forEach((function(e){return e.value=JSON.parse(e.value)})),[2,n]}}))}))},e.prototype.getHistoryWithPaginationAsync=function(e,t,i){return n(this,void 0,void 0,(function(){var n,r;return s(this,(function(s){switch(s.label){case 0:return(n=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),n.searchParams.append("docId",this.m_sessionId),n.searchParams.append("cid",this.m_clientId),n.searchParams.append("objectId",e),n.searchParams.append("pagination","true"),i&&n.searchParams.append("cursor",i),t&&n.searchParams.append("property",t),[4,u.default.get(n.toString())];case 1:return(r=s.sent().data).messages.forEach((function(e){return e.value=JSON.parse(e.value)})),[2,r]}}))}))},e.prototype.getServiceTelemetry=function(){return this.m_telemetry.wsState=a.ConnectionState[this.getConnectionState()],this.m_telemetry.messagePendingAckCount=this.m_outboundMessageInfo.size,this.m_telemetry},e.prototype.activeClientCount=function(){return this.m_clientIds.size},e.prototype.activeClientIds=function(){return this.m_clientIds},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.clientId=function(){return this.m_clientId},e.prototype.getConnectionState=function(){return this.m_connectionState},e.prototype.sendStateMessage=function(e){this.m_verbose&&this.m_logger.sendTraceTag(590213403,h.TraceLevel.Info,"SimpleStateServiceProxy::sendStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),"ConfigStateSubscriptions"!==e.objectId&&"config"!==e.objectId&&this.m_outboundMessageInfo.set(e.messageId,Date.now()),this.m_user&&this.m_user.patchMessage&&this.m_user.patchMessage(e),this.sendStateMessageImpl(e)},e.prototype.sendStateMessageImpl=function(e){var t=this;this.m_batchedRequestsEnabled?(this.m_messageBuffer.push(e),this.m_processBufferTimer||(this.m_processBufferTimer=setTimeout((function(){t.processMessageBuffer()}),this.m_batchWaitTimeMS))):this.sendWebSocketMessage(e,!0)},e.prototype.processMessageBuffer=function(){var e=this.m_messageBuffer.length,t=this.m_messageBuffer.splice(0,e),i={value:JSON.stringify(t),type:this.m_batchMessageTypeName,operation:"",messageId:l.v4(),objectId:"batch",senderId:this.senderId()};this.m_processBufferTimer&&clearTimeout(this.m_processBufferTimer),this.m_processBufferTimer=null,this.sendWebSocketMessage(i,!0)},e.prototype.processOfflineMessageCache=function(){var e=this;this.m_offlineMessageCacheEnabled&&(this.m_offlineMessageCache.forEach((function(t){e.sendWebSocketMessage(t.message,!1),e.m_telemetry.offlineCacheTelemetry.resentCount+=1})),this.m_offlineMessageCache=[])},e.prototype.purgeOfflineMessageCache=function(){var e=this;if(this.m_offlineMessageCacheEnabled&&this.m_maxOfflineMessageCacheTimeinMs){var t=Date.now(),i=this.m_offlineMessageCache.filter((function(i){return e.m_maxOfflineMessageCacheTimeinMs&&i.timestamp+e.m_maxOfflineMessageCacheTimeinMs>=t}));this.m_telemetry.offlineCacheTelemetry.expiredCount+=this.m_offlineMessageCache.length-i.length,this.m_offlineMessageCache=i,0===this.m_offlineMessageCache.length&&this.clearOfflineMessageCacheTimer()}},e.prototype.clearOfflineMessageCacheTimer=function(){this.m_offlineMessageCacheEnabled&&this.m_offlineMessageCacheTimer&&(clearInterval(this.m_offlineMessageCacheTimer),this.m_offlineMessageCacheTimer=null)},e.prototype.sendWebSocketMessage=function(e,t){var i,n,s=this;if(this.m_offlineMessageCacheEnabled&&t){if(!this.m_webSocket||this.m_connectionState!==a.ConnectionState.Connected)return!this.m_maxOfflineMessageCacheSize||this.m_offlineMessageCache.length>=this.m_maxOfflineMessageCacheSize?(this.m_telemetry.offlineCacheTelemetry.rejectedCount+=1,void this.m_logger.sendTraceTag(570807006,h.TraceLevel.Error,"SimpleStateServiceProxy::sendWebSockerMessage - Dropping message because offline cache is full. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+(null===(i=this.m_webSocket)||void 0===i?void 0:i.readyState)+"}")):(!this.m_offlineMessageCacheTimer&&this.m_maxOfflineMessageCacheTimeinMs&&(this.m_offlineMessageCacheTimer=setTimeout((function(){s.purgeOfflineMessageCache()}),this.m_maxOfflineMessageCacheTimeinMs/2)),this.m_offlineMessageCache.push({message:e,timestamp:Date.now()}),void(this.m_telemetry.offlineCacheTelemetry.cachedCount+=1))}else{if(!this.m_webSocket)return void this.m_logger.sendTraceTag(590213401,h.TraceLevel.Error,"SimpleStateServiceProxy::sendWebSocketMessage - WebSocket is not set. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}");if(this.m_webSocket.readyState!==WebSocket.OPEN)return void this.m_logger.sendTraceTag(590213402,h.TraceLevel.Error,"SimpleStateServiceProxy::sendWebSocketMessage - WebSocket status is not open. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+this.m_webSocket.readyState+"}")}null===(n=this.m_webSocket)||void 0===n||n.send(JSON.stringify(e))},e.prototype.senderId=function(){return this.m_clientId},e.prototype.countOfOutboundMessagesNotRoundTrippedYet=function(){return this.m_outboundMessageInfo.size},e.prototype.measureMessageRoundTripLatency=function(e){if(e.senderId===this.senderId())try{var t=this.m_outboundMessageInfo.get(e.messageId);if(void 0!==t){this.m_outboundMessageInfo.delete(e.messageId);var i=Date.now()-t;this.m_events.emit("messageRoundTripped",{clientId:this.m_clientId,sessionId:this.m_sessionId,messageId:e.messageId,objectId:e.objectId,operation:e.operation,latencyInMs:i}),this.m_telemetry.addRoundtripLatency(i)}else this.m_verbose&&this.m_logger.sendTraceTag(590213404,h.TraceLevel.Info,"SimpleStateServiceProxy::measureMessageRoundTripLatency. Failed to find outbound message info for {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}")}catch(t){this.m_logger.sendTraceTag(590213405,h.TraceLevel.Error,"SimpleStateServiceProxy::measureMessageRoundTripLatency - Exception thrown error. {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", MessageId: "+e.messageId+", Error: "+t.message+"}")}},e}();t.SimpleStateServiceProxy=v},function(e,t,i){e.exports=i(24)},function(e,t,i){"use strict";var n=i(0),s=i(7),r=i(25),o=i(13);function a(e){var t=new r(e),i=s(r.prototype.request,t);return n.extend(i,r.prototype,t),n.extend(i,t),i}var c=a(i(10));c.Axios=r,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=i(14),c.CancelToken=i(39),c.isCancel=i(9),c.all=function(e){return Promise.all(e)},c.spread=i(40),c.isAxiosError=i(41),e.exports=c,e.exports.default=c},function(e,t,i){"use strict";var n=i(0),s=i(8),r=i(26),o=i(27),a=i(13);function c(e){this.defaults=e,this.interceptors={request:new r,response:new r}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[o,void 0],i=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)i=i.then(t.shift(),t.shift());return i},c.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,i){return this.request(a(i||{},{method:e,url:t,data:(i||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,i,n){return this.request(a(n||{},{method:e,url:t,data:i}))}})),e.exports=c},function(e,t,i){"use strict";var n=i(0);function s(){this.handlers=[]}s.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},function(e,t,i){"use strict";var n=i(0),s=i(28),r=i(9),o=i(10);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=s(t.data,t.headers,e.transformResponse),t}),(function(t){return r(t)||(a(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,i){"use strict";var n=i(0);e.exports=function(e,t,i){return n.forEach(i,(function(i){e=i(e,t)})),e}},function(e,t){var i,n,s=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=a(f);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new p(e,t)),1!==l.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,i){"use strict";var n=i(0);e.exports=function(e,t){n.forEach(e,(function(i,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[n])}))}},function(e,t,i){"use strict";var n=i(12);e.exports=function(e,t,i){var s=i.config.validateStatus;i.status&&s&&!s(i.status)?t(n("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}},function(e,t,i){"use strict";e.exports=function(e,t,i,n,s){return e.config=t,i&&(e.code=i),e.request=n,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,i){"use strict";var n=i(0);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,i,s,r,o){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(r)&&a.push("domain="+r),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,i){"use strict";var n=i(35),s=i(36);e.exports=function(e,t){return e&&!n(t)?s(e,t):t}},function(e,t,i){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,i){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,i){"use strict";var n=i(0),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,i,r,o={};return e?(n.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=n.trim(e.substr(0,r)).toLowerCase(),i=n.trim(e.substr(r+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([i]):o[t]?o[t]+", "+i:i}})),o):o}},function(e,t,i){"use strict";var n=i(0);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function s(e){var n=e;return t&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=s(window.location.href),function(t){var i=n.isString(t)?s(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}},function(e,t,i){"use strict";var n=i(14);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var i=this;e((function(e){i.reason||(i.reason=new n(e),t(i.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},function(e,t,i){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,i){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncCell=void 0;var r=i(1),o=i(2),a=function(){function e(e,t,i){this.m_events=new r.EventEmitter,this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=i}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.getAsync=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.m_value]}))}))},e.prototype.setAsync=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(i){return this.m_value=e,t={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"set",value:JSON.stringify(this.m_value)},this.m_sender.sendStateMessage(t),[2]}))}))},e.prototype.delete=function(){this.m_value=void 0;var e={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"delete",value:""};this.m_sender.sendStateMessage(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void((JSON.stringify(this.m_value)!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_value=JSON.parse(e.value),this.m_events.emit("valueChanged",this.m_value,e)));case"delete":return this.m_value=void 0,void this.m_events.emit("valueDeleted",this.m_value,e);default:return}},e}();t.SimpleSyncCell=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncMap=void 0;var n=i(1),s=i(2),r=function(){function e(e,t,i){this.m_events=new n.EventEmitter,this.m_map=new Map,this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=i}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.get=function(e){return this.m_map.get(e)},e.prototype.set=function(e,t){this.m_map.set(e,t);var i={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"set",property:e,value:JSON.stringify(t)};this.m_sender.sendStateMessage(i)},e.prototype.delete=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:""};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.deleteWithPrefix=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:"prefix"};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.forEach=function(e){this.m_map.forEach(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void this.handleSet(e);case"delete":return void this.handleDelete(e);default:return}},e.prototype.handleSet=function(e){if(!e.property)throw new Error("property is missing for a map.");(JSON.stringify(this.m_map.get(e.property))!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_map.set(e.property,JSON.parse(e.value)),this.m_events.emit("valueChanged",e.property,e))},e.prototype.handleDelete=function(e){var t=this,i=this.performLocalDelete(e);i?i.forEach((function(i){t.m_events.emit("valueDeleted",i,e)})):this.m_events.emit("valueDeleted","",e)},e.prototype.performLocalDelete=function(e){var t=this;if(e.property){var i=e.property;if("prefix"===e.value){var n=[];return this.m_map.forEach((function(e,s){s.startsWith(i)&&(t.m_map.delete(s),n.push(s))})),n}return this.m_map.delete(e.property),[e.property]}this.m_map.clear()},e}();t.SimpleSyncMap=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleServicePerformanceTelemetry=t.SimpleServiceTelemetry=void 0;var n=i(3),s=function(){function e(e,t,i){this.backendService="SimpleService",this.clientId=e,this.sessionId=t,this.wsReconnectCount=0,this.wsState=n.ConnectionState[n.ConnectionState.Disconnected],this.maxRoundtripRaw=i||0,this.roundtripTelemetry=new r,this.messageHandleTelemetry=new r,this.offlineCacheTelemetry={cachedCount:0,resentCount:0,expiredCount:0,rejectedCount:0},this.maxRoundtripRaw>0&&(this.roundtripRaw=[]),this.messagePendingAckCount=0}return e.prototype.addRoundtripLatency=function(e){this.roundtripRaw&&this.roundtripRaw.length<this.maxRoundtripRaw&&this.roundtripRaw.push(e),this.roundtripTelemetry.addLatency(e)},e.prototype.addMessageHandleLatency=function(e){this.messageHandleTelemetry.addLatency(e)},e}();t.SimpleServiceTelemetry=s;var r=function(){function e(){this.count=0,this.minValue=0,this.maxValue=0,this.avgValue=0}return e.prototype.addLatency=function(e){this.count+=1,this.avgValue=this.avgValue+(e-this.avgValue)/this.count,this.minValue=this.count>1?Math.min(e,this.minValue):e,this.maxValue=Math.max(this.maxValue,e)},e}();t.SimpleServicePerformanceTelemetry=r},function(e,t,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.errorToString=void 0,t.errorToString=function(e,t){if(void 0===t&&(t=!0),null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,r(s(t)))}catch(e){return"Stringifying error failed"}};var s=function(e){return void 0===e&&(e=!1),function(t,i){return i instanceof Error?n({name:i.name,message:i.message,stack:e?[]:("string"==typeof i.stack?i.stack:"").split("\n").map((function(e){return e.trim()})).filter((function(e){return!!e}))},i):i}},r=function(e){var t=new WeakSet;return function(i,n){if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return e(i,n)}}}])}));
//# sourceMappingURL=PPTLiveBroadcast.js.map