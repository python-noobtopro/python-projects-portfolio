var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[19],{1:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return a})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return i})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return c})),n.d(t,"__metadata",(function(){return d})),n.d(t,"__awaiter",(function(){return u})),n.d(t,"__generator",(function(){return l})),n.d(t,"__createBinding",(function(){return m})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return g})),n.d(t,"__spread",(function(){return C})),n.d(t,"__spreadArrays",(function(){return h})),n.d(t,"__spreadArray",(function(){return b})),n.d(t,"__await",(function(){return v})),n.d(t,"__asyncGenerator",(function(){return y})),n.d(t,"__asyncDelegator",(function(){return T})),n.d(t,"__asyncValues",(function(){return O})),n.d(t,"__makeTemplateObject",(function(){return I})),n.d(t,"__importStar",(function(){return _})),n.d(t,"__importDefault",(function(){return j})),n.d(t,"__classPrivateFieldGet",(function(){return D})),n.d(t,"__classPrivateFieldSet",(function(){return E})),n.d(t,"__classPrivateFieldIn",(function(){return A}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function s(e,t,n,r){var a,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,n,i):a(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}function c(e,t){return function(n,r){t(n,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var m=Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function h(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r}function b(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),o=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=a[e](t)).value instanceof v?Promise.resolve(n.value.v).then(c,d):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function c(e){s("next",e)}function d(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(n=!n)?{value:v(e[r](t)),done:"return"===r}:a?a(t):t}:a}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,a,(t=e[n](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var S=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return S(t,e),t}function j(e){return e&&e.__esModule?e:{default:e}}function D(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},101:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));var r,a=n(368);function o(e){return e===a.a.CheckEnabled}function i(e){return e===a.a.CheckToggled}function s(e){return e===a.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},102:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"}(r||(r={}))},106:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},11:function(e,t,n){"use strict";n.d(t,"o",(function(){return u})),n.d(t,"x",(function(){return l})),n.d(t,"r",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return C})),n.d(t,"k",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return T})),n.d(t,"s",(function(){return O})),n.d(t,"h",(function(){return I})),n.d(t,"v",(function(){return S})),n.d(t,"t",(function(){return _})),n.d(t,"j",(function(){return j})),n.d(t,"q",(function(){return D})),n.d(t,"u",(function(){return E})),n.d(t,"f",(function(){return A})),n.d(t,"i",(function(){return P})),n.d(t,"g",(function(){return x})),n.d(t,"y",(function(){return k})),n.d(t,"p",(function(){return w})),n.d(t,"w",(function(){return R})),n.d(t,"e",(function(){return F}));var r=n(26),a=n(81),o=n(82),i=n(15),s=n(40),c=n(80),d=n(257),u=function(e){return e.commentState.contextState.isReadOnly},l=function(e){return e.commentState.topVisibleThreadId},m=function(e){return e.commentState.personaIconPropertiesMap},f=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},g=function(e){return Object(s.e)(e.commentState)?e.commentState.postData:e.commentState.commentData},C=function(e){return Object(s.e)(e.commentState)?e.commentState.commentThreadIds:e.commentState.commentData},h=function(e){var t=c.g(e);if(t){if(c.a(e)){var n=c.d(e);return t.supportedContentTypes!==r.b.CommentThread&&(n=n.filter((function(e){return e.contentType===r.b.CommentThread}))),n.map((function(e){return e.contentId}))}return[]}return C(e)},b={},v=function(e){return Object(s.e)(e.commentState)?e.commentState.cardPostIds:b},y=function(e){return C(e).length>0},T=function(e){return h(e).length>0},O=function(e){return e.commentState.postViewState},I=function(e){return e.commentState.draftState},S=function(e){return Object(i.K)(I(e))},_=function(e){return e.commentState.selectedComment},j=function(e){return e.commentState.expandedComments},D=function(e){return e.commentState.pendingCommentLoad},E=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},A=function(e){return e.commentState.contextState},P=function(e,t,n){return Object(i.G)(I(e),t,n)},x=function(e,t,n){return e.commentState.createdCommentLie&&P(e,t,n)?e.commentState.createdCommentLie:void 0},k=function(){return Object(a.a)([C,c.d,v,g,x,I,d.b,c.g],(function(e,t,n,r,a,i,s,c){return c?o.k(t,n,r,s,a,i):o.m(e,n,r,s)}))},w=function(e){return e.commentState.modelCapabilities},R=function(e){return e.commentState.suggestionsDetails},F=function(e,t){return t?Object(s.b)(g(e),t):void 0}},113:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}));var r,a=n(19);function o(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function i(e,t,n,r,o){return Object(a.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:o},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},114:function(e,t,n){"use strict";var r,a,o;!function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(o||(o={}));var i,s=n(5),c=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){throw new s.c("Method not implemented.",s.d.reserveTag(523633811))},e.prototype.moveFocus=function(e){throw new s.c("Method not implemented.",s.d.reserveTag(523633812))},e.prototype.bringContentIntoView=function(e){throw new s.c("Method not implemented.",s.d.reserveTag(523633813))},e.prototype.isAPIEnabled=function(){return!1},e}(),d=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}();function u(e,t){i=e}function l(e){return void 0===i&&(i=new d),i}function m(e){return void 0!==i}function f(e){i=void 0}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return m})),n.d(t,"e",(function(){return f}))},1164:function(e,t,n){n(1165),e.exports=n(359).Array.includes},1165:function(e,t,n){"use strict";var r=n(503),a=n(925)(!0);r(r.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(724)("includes")},1166:function(e,t,n){var r=n(1167),a=n(1168),o=n(1170),i=Object.defineProperty;t.f=n(572)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),a)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},1167:function(e,t,n){var r=n(571);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},1168:function(e,t,n){e.exports=!n(572)&&!n(573)((function(){return 7!=Object.defineProperty(n(1169)("div"),"a",{get:function(){return 7}}).a}))},1169:function(e,t,n){var r=n(571),a=n(504).document,o=r(a)&&r(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},117:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"m",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"n",(function(){return g})),n.d(t,"a",(function(){return C}));var r="Selected comment not found",a="Selected thread index out of bounds",o="Invalid number of posts for display more replies string",i="Unrecognized post display mode",s="Method not implemented",c="StringId is invalid",d="LocalizationModule NativeModule not valid",u="Store state unexpected",l="Editor reference is invalid",m="Invalid arguments",f="Comment ID value is invalid in the current operation",p="Attempting to perform an operation on an inactive draft",g="Feature not running with the correct feature gates which expect view manager construction",C="CommentModel not found in a thread of RenderableItems"},1170:function(e,t,n){var r=n(571);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},1171:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1172:function(e,t,n){var r=n(504),a=n(719),o=n(923),i=n(720)("src"),s=n(1173),c=(""+s).split("toString");n(359).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(o(n,"name")||a(n,"name",t)),e[t]!==n&&(d&&(o(n,i)||a(n,i,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||s.call(this)}))},1173:function(e,t,n){e.exports=n(721)("native-function-to-string",Function.toString)},1174:function(e,t){e.exports=!1},1175:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1176:function(e,t,n){var r=n(929),a=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):o(e,t)}},1177:function(e,t,n){n(1178),e.exports=n(359).Array.find},1178:function(e,t,n){"use strict";var r=n(503),a=n(931)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(724)("find")},1179:function(e,t,n){var r=n(1180);e.exports=function(e,t){return new(r(e))(t)}},118:function(e,t,n){"use strict";var r=n(515),a=n(230);n.d(t,"j",(function(){return r.a})),n.d(t,"k",(function(){return r.c})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.d})),n.d(t,"e",(function(){return a.f})),n.d(t,"c",(function(){return a.c})),n.d(t,"h",(function(){return a.j})),n.d(t,"f",(function(){return a.g})),n.d(t,"g",(function(){return a.h})),n.d(t,"i",(function(){return a.k}))},1180:function(e,t,n){var r=n(571),a=n(1181),o=n(930)("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},1181:function(e,t,n){var r=n(927);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1182:function(e,t,n){n(1183),e.exports=n(359).String.trimRight},1183:function(e,t,n){"use strict";n(1184)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},1184:function(e,t,n){var r=n(503),a=n(723),o=n(573),i=n(1185),s="["+i+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,n){var a={},s=o((function(){return!!i[e]()||"​"!="​"[e]()})),c=a[e]=s?t(l):i[e];n&&(a[n]=c),r(r.P+r.F*s,"String",a)},l=u.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},1185:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1192:function(e,t,n){n(1193),e.exports=n(359).Array.findIndex},1193:function(e,t,n){"use strict";var r=n(503),a=n(931)(6),o="findIndex",i=!0;o in[]&&Array(1)[o]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(724)(o)},1194:function(e,t,n){n(1195),e.exports=n(359).Object.assign},1195:function(e,t,n){var r=n(503);r(r.S+r.F,"Object",{assign:n(1196)})},1196:function(e,t,n){"use strict";var r=n(572),a=n(1197),o=n(1201),i=n(1202),s=n(932),c=n(722),d=Object.assign;e.exports=!d||n(573)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=s(e),d=arguments.length,u=1,l=o.f,m=i.f;d>u;)for(var f,p=c(arguments[u++]),g=l?a(p).concat(l(p)):a(p),C=g.length,h=0;C>h;)f=g[h++],r&&!m.call(p,f)||(n[f]=p[f]);return n}:d},1197:function(e,t,n){var r=n(1198),a=n(1200);e.exports=Object.keys||function(e){return r(e,a)}},1198:function(e,t,n){var r=n(923),a=n(926),o=n(925)(!1),i=n(1199)("IE_PROTO");e.exports=function(e,t){var n,s=a(e),c=0,d=[];for(n in s)n!=i&&r(s,n)&&d.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(d,n)||d.push(n));return d}},1199:function(e,t,n){var r=n(721)("keys"),a=n(720);e.exports=function(e){return r[e]||(r[e]=a(e))}},1200:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1201:function(e,t){t.f=Object.getOwnPropertySymbols},1202:function(e,t){t.f={}.propertyIsEnumerable},1203:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1204:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),r.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}a.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1205:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1206:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1207:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}a.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1208:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}a.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1209:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}a.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1210:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}a.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1211:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}a.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1212:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}a.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1213:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}a.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1214:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#F9F9F9",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#3A3A38",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#ED3D3B",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}a.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=a,a.default=a},1215:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#FCFCFC",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#919190",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#FF9091",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}a.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=a,a.default=a},1216:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1217:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1218:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1219:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1220:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}a.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=a,a.default=a},1221:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}a.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1222:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166562 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579688 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874813 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z M1,12 L3.5,12 C3.9734466,12 4.4332293,12.0458255 4.87838685,12.1379271 C5.31513303,12.2282884 5.74859274,12.3602761 6.18851278,12.5375318 C6.93158683,12.8463999 7.69958736,13 8.5,13 L12.5,13 C12.5548236,13 12.602973,12.9923123 12.648616,12.977098 C12.7042395,12.9585568 12.7526835,12.9341041 12.7969807,12.9027269 C12.8337665,12.8766702 12.8664285,12.8443971 12.8972432,12.8024548 C12.9312256,12.7562009 12.9571761,12.7066171 12.9731917,12.6603347 L14.976502,6.65057182 C14.9920216,6.60556505 15,6.55689677 15,6.5 C15,6.42541757 14.9877526,6.36418032 14.9636675,6.3079818 C14.9365874,6.244795 14.9025618,6.19478151 14.8582531,6.15130876 C14.8093393,6.10331783 14.7532414,6.06591924 14.6842057,6.03633253 C14.6271661,6.01188698 14.5685237,6 14.5,6 L9.92167262,6 L10.0366316,4.89639392 C10.0695629,4.58025353 10.1325645,4.27353503 10.2257814,3.97723847 C10.311817,3.70376821 10.4161404,3.43528887 10.5459446,3.15655729 C10.6976958,2.8443835 10.8114223,2.53217213 10.8880777,2.21916252 C10.9624237,1.91558304 11,1.59305299 11,1.25 C11,1.21274116 10.9946165,1.18603901 10.9840197,1.16145435 C10.9688056,1.12615764 10.9504819,1.09907042 10.9257057,1.07429428 C10.9009296,1.04951814 10.8738424,1.03119444 10.8385457,1.01598034 C10.813961,1.0053835 10.7872588,1 10.75,1 C10.7324276,1 10.7311357,0.999063781 10.7416579,0.993076126 L10.7490693,0.989479263 C10.7056707,1.01597571 10.651885,1.05920353 10.5893502,1.12173792 L5.73054428,5.97273178 C5.3997463,6.30352976 5.02122029,6.55953769 4.60002886,6.73533933 C4.17716132,6.91184057 3.72718088,7 3.2578125,7 L1,7 L1,12 Z",fill:"#2B5C9C",fillRule:"nonzero"})))}a.defaultProps={width:"16px",height:"16px",viewBox:"0 0 16 16",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1223:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{d:"M1.08001 9.31998L1.28001 8.63998H4.28001C4.60001 8.13998 4.96001 7.59998 5.36001 7.03998C6.16001 5.91998 6.72001 5.21998 7.06001 4.93998C7.96001 4.23998 8.52001 3.77998 8.76001 3.57998C9.66001 2.77998 10.16 2.17998 10.24 1.75998C10.32 1.31998 10.46 0.999976 10.64 0.799976C10.76 0.659976 10.9 0.599976 11.04 0.599976C11.3 0.599976 11.56 0.779976 11.8 1.11998C12.16 1.59998 12.16 2.27998 11.82 3.11998C11.6 3.65998 11.38 4.09998 11.16 4.43998C10.86 4.87998 10.68 5.15998 10.62 5.29998C10.44 5.65998 10.36 6.05998 10.42 6.47998C11.08 6.51998 11.76 6.61998 12.42 6.79998C13.76 7.13998 14.42 7.67998 14.42 8.37998C14.42 8.59998 14.38 8.77998 14.32 8.97998C14.24 9.17998 14.14 9.25998 14.04 9.25998L14.34 9.47998C14.54 9.71998 14.64 10.04 14.64 10.44C14.64 10.66 14.54 10.84 14.34 11.02C14.24 11.1 14.14 11.18 14.04 11.22L14.2 11.52C14.3 11.78 14.3 12.08 14.22 12.42C14.18 12.62 14.06 12.8 13.86 12.98C13.68 13.14 13.54 13.2 13.42 13.2V13.94C13.36 14.46 13.16 14.82 12.82 14.98C12.1 15.34 11.7 15.52 11.62 15.56C11.06 15.72 10.26 15.76 9.22001 15.68C8.22001 15.6 7.12001 15.42 5.92001 15.16C5.32001 15.02 4.82001 14.9 4.42001 14.78H1.42001C1.32001 14.54 1.22001 14.24 1.12001 13.86C0.920014 13.12 0.820015 12.42 0.820015 11.76C0.880015 10.78 0.960014 9.97998 1.08001 9.31998Z",fill:"#FDCE4C",key:0}),r.createElement("path",{d:"M9.78002 9.59995C10.04 9.65995 10.2 10.0399 10.22 10.7599C10.24 11.3599 10.2 11.9799 10.06 12.5799C10.02 12.8199 10.02 13.2999 10.06 14.0199C10.08 14.4599 9.98002 14.6599 9.76002 14.6199C9.44002 14.5399 9.10002 14.2399 8.78002 13.6799C8.42002 13.0999 8.30002 12.5799 8.40002 12.0999C8.54002 11.4799 8.72002 10.9199 8.96002 10.4199C9.24002 9.83995 9.52002 9.55995 9.78002 9.59995Z",fill:"url(#paint0_linear)",key:1}),r.createElement("path",{d:"M10.34 8.84C10.5 8.58 10.4 8.86 10.06 9.72C9.69999 10.58 9.09999 11.08 8.23999 11.22C7.37999 11.38 6.71999 11.38 6.27999 11.22C7.43999 11 8.29999 10.56 8.79999 9.92C9.31999 9.28 9.59999 8.62 9.63999 7.94C9.93999 8.8 10.18 9.1 10.34 8.84Z",fill:"url(#paint1_linear)",key:2}),r.createElement("path",{d:"M11 8.89995C11.12 9.07995 11.28 9.21995 11.48 9.31995C10.98 9.69995 10.8 10.1599 10.94 10.6999C11 10.9599 11.12 11.1999 11.3 11.3799C10.76 11.7799 10.54 12.2199 10.66 12.6799C10.72 12.9199 10.82 13.0999 10.98 13.2599C10.68 13.5399 10.54 13.9799 10.54 14.5999C10.54 14.8999 10.58 15.1799 10.64 15.4199C10.08 15.2199 9.75998 14.7999 9.67998 14.1599L9.71998 13.2599C9.41998 12.8599 9.33998 12.3999 9.49998 11.8999L9.79998 11.2799C9.43998 10.9999 9.33998 10.5999 9.45998 10.0399L9.73998 9.29995C9.61998 8.85995 9.81998 8.47995 10.36 8.17995C10.64 8.01995 10.92 7.89995 11.22 7.81995C10.84 8.19995 10.76 8.55995 11 8.89995Z",fill:"#FDCE4C",key:3}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.619 13.18C13.619 13.0701 13.5299 12.981 13.42 12.981H9.82C9.71008 12.981 9.62098 13.0701 9.62098 13.18C9.62098 13.2899 9.71008 13.379 9.82 13.379H13.42C13.5299 13.379 13.619 13.2899 13.619 13.18Z",fill:"#AC8662",key:4}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 11.22C14.239 11.11 14.1499 11.0209 14.04 11.0209H9.83999C9.73008 11.0209 9.64097 11.11 9.64097 11.22C9.64097 11.3299 9.73008 11.419 9.83999 11.419H14.04C14.1499 11.419 14.239 11.3299 14.239 11.22Z",fill:"#AC8662",key:5}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 9.23997C14.239 9.13006 14.1499 9.04095 14.04 9.04095H9.83999C9.73008 9.04095 9.64097 9.13006 9.64097 9.23997C9.64097 9.34989 9.73008 9.43899 9.83999 9.43899H14.04C14.1499 9.43899 14.239 9.34989 14.239 9.23997Z",fill:"#AC8662",key:6}),r.createElement("defs",{key:7},[r.createElement("linearGradient",{x1:"8.14689",y1:"8.32298",x2:"11.0687",y2:"8.28505",gradientUnits:"userSpaceOnUse",key:0},[r.createElement("stop",{stopColor:"#B8895A",stopOpacity:"0.2",key:0}),r.createElement("stop",{offset:"1",stopColor:"#B57E4A",key:1})]),r.createElement("linearGradient",{x1:"4.86538",y1:"9.62116",x2:"7.60127",y2:"8.17258",gradientUnits:"userSpaceOnUse",key:1},[r.createElement("stop",{stopColor:"#F0C194",stopOpacity:"0.4",key:0}),r.createElement("stop",{offset:"1",stopColor:"#CBA37C",stopOpacity:"0.502",key:1})])])])}a.defaultProps={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e.exports=a,a.default=a},1224:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}a.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1225:function(e){e.exports=JSON.parse('{"SharedCommentsVersion":"3.54.9"}')},1239:function(e,t,n){"use strict";n.r(t);var r=n(1);n(1164),n(1177),n(1182);var a=n(159);n(440);var o=n(277),i=n(5),s=n(1611),c=n(76),d=n(4),u=n(121),l=n(26),m=(n(1192),n(1194),n(578)),f=n(395),p=n(793),g=n(517),C=n(17),h=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(t),!1))}))}},enumerable:!1,configurable:!0}),e}(),b=function(){function e(){var e=this;this.changedEvent=new h,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}(),v=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}(),y=n(260),T=n(0),O=n(39),I=n(93),S=n(54);function _(e,t){return"".concat(e,"-").concat(t)}var j,D=n(206),E=n(114),A=n(402);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(j||(j={}));var P={sendCodeMarker:function(e){},onStartEvent:new A.EventImpl((function(){})),onStopEvent:new A.EventImpl((function(){}))},x=function(e){this.onMockUIAction=new A.EventImpl((function(){}))},k=n(593),w=n(219),R=n(370),F=n(47),N=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,d.d.SystemMetadata)}};function M(e){return new N(L(e),e.correlationId)}var L=function(){throw new Error("ViewManagerFactory not set")};var V=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this;return this.instanceMap.get(e)||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,d.d.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPIMockSettings,a=e.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var o=this.instanceMap.get(t);return o?this.updateInstanceObject(o,n):(this.initializeContentNavigationAPI(t,r),this.initializeContentFilteredRangeAPI(t,a),o=M(e),this.instanceMap.set(t,o)),o.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new F.a("Instance is not initialized",i.d.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new F.a("Instance is not initialized",i.d.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;C.s()&&P.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeContentFilteredRangeAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),P.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(E.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var a=void 0;n&&C.o()&&(Object(d.i)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),d.a.None,d.b.FullEvent).successTag(592511450),a=new x(e)),this.instanceMap.set(e,M({apiContext:e,correlationId:t,initializationReason:R.a.PaneOpen,displayMode:w.b.FullPane,foldableLayoutState:k.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:a}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){if(!Object(E.g)(e)){if(!C.l())return void Object(E.h)((null==t?void 0:t.mock)||new E.b(e),e);if(t)return void(t.useMock&&Object(E.h)(t.mock,e));var n=new E.b(e);n.isAPIEnabled()&&Object(E.h)(n,e)}},e.prototype.initializeContentFilteredRangeAPI=function(e,t){if(C.L()&&!Object(D.e)(e)){if(t)return void(t.useMock&&Object(D.f)(e,t.mock));Object(D.f)(e,new D.b(e))}},e}()),B=n(106),U=n(261),H=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case B.a.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):Object(d.i)().assertConditionTag(!1,"View container base identifier expected",558401364),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch(Object(S.a)(i.d.reserveTag(558401365)));break;case B.a.Closed:r.viewContainerBase.identifier&&r.rootNode&&(Object(O.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case B.a.Hidden:Object(d.i)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:Object(i.m)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var a=_("SharedCommentPane",t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(y.c)().getComponent(a),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch(Object(S.a)(i.d.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(d.i)().createActivityObject("RenderPaneIntoView",V.getTelemetryVisitor(this.context),d.a.None,d.b.NecessaryServiceDataEvent);if(!n)return this.lastRenderFailed&&r.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);Object(O.render)(T.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(I.z());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===y.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(d.i)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===y.a.Unregistered&&Object(O.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case U.a.VisibilityChanged:this.processVisibilityEvent(e);break;case U.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case U.a.FoldableLayoutStateChanged:case U.a.FocusTriggered:break;default:Object(i.m)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),G=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.apiContext=t,n.registerForViewContainerEvents(r.fireEvent),r}return Object(r.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(C.P()?this.currentContainer=new v(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new H(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(b);var W=n(231),q=n(7),z=Object(q.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:0,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:0}}})),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(r.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=z();return T.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(T.PureComponent);function K(){var e=document.createElement("div");document.body.appendChild(e),O.render(T.createElement(Y,{ref:Q}),e),Object(W.c)({announceToScreenReader:function(e){var t=X;t&&!function(e){return null==e}(e)&&t.appendLiveRegionUpdate(e)}})}var X=void 0;function Q(e){X=e}var Z=n(396),J=(n(86),n(594)),$=n(3);var ee={name:"OfficeSharedComments",version:n(937).a},te=n(117);function ne(){if(!C.p())throw new F.a(te.n,i.d.reserveTag(589103628),-2130957516);return V.getViewManager(o.a)}function re(){ne().beginInitialization()}var ae,oe=n(89),ie=n(230),se=n(515),ce=function(){function e(e,t,n,r,a){var o=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=a,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===o.sessionConfiguration.draftId&&(e.anchorHintText&&(o._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(o._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===ie.e.CommentContextChanged&&Object(se.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return o.updateDraft(e)})):e===ie.e.UpdateDraftThread&&Object(se.d)(t)&&o.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(r.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new F.a(te.h,i.d.reserveTag(589103689),-2130957526);if(!this._active)throw new F.a(te.b,i.d.reserveTag(589103690),-2130957525);var t=C.b()||C.a(),n=t&&this.sessionConfiguration.sessionType===ie.i;if(void 0===e&&!n||n&&void 0!==e)throw new F.a(te.c,i.d.reserveTag(589103691),-2130957507);return t?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),de=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.getCommentReactionData&&(this.getCommentReactionData=e.getCommentReactionData.bind(e)),C.x()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),C.n()&&e.diagnosticHeartbeat&&setInterval((function(){var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)}),1e3)}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new F.a("Drafting APIs are undefined on Host Comment API",i.d.reserveTag(589103700),-2130957527);var n=Object(s.a)(),a=Object(r.__assign)(Object(r.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(a).then((function(e){return new ce(t.hostCommentAPI,Object(oe.e)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||a,e.insertIndex)}))},e}(),ue=n(41),le={themeId:1,palette:{ApplePaneTopBorder:ue.a.GRAY_C,ButtonBorder:ue.a.GRAY_B,CardAccent:ue.a.GRAY_B,CardBackground:ue.a.WHITE,CardHoveredBackground:ue.a.GRAY_20,CardDraftBoxBackgroundHovered:ue.a.WHITE,CardDraftBoxBorderHovered:ue.a.GRAY_160,CardDraftBoxBorder:ue.a.GRAY_110,CardDraftBoxBackground_HalfPane:ue.a.WHITE,CardDraftBoxBackground:ue.a.GRAY_A,CardExpandButtonBorder:ue.a.GRAY_B,CardHeroBarBackground_HalfPane:ue.a.GRAY_A,CardHeroBarBackground:ue.a.WHITE,CardReplyBackground_HalfPane:ue.a.GRAY_A,CardReplyBackground:ue.a.GRAY_A,CardReplyTopBorder:ue.a.GRAY_B,CardSelectionColor:ue.a.COMMENTS_PURPLE,CardShadowColor:ue.a.BLACK,CardBorder:ue.a.GRAY_B,CardBorderEmphasis:ue.a.COMMENTS_PURPLE,CommandBarBorder:ue.a.GRAY_B,CommandBarTopBorder:ue.a.GRAY_B,IconButtonDisabledTint:ue.a.GRAY_C,IconButtonFocusedTint:ue.a.GRAY_I,NavigationBarBackground:ue.a.WHITE,NavigationBarBorder:ue.a.GRAY_B,PaneBackground_HalfPane:ue.a.WHITE,PaneBackground:ue.a.GRAY_A,UnreadDotColor:ue.a.DOT_BLUE,UnreadDotBorderColor:ue.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:ue.a.GRAY_150,CardPlaceholderColor:ue.a.GRAY_130,ResolvedCardBackground:ue.a.GRAY_20}},me=function(){function e(){}return e.prototype.getTheme=function(){return Object(d.i)().assertConditionTag(!1,"Should not be called",592986821),le},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),fe=n(1293),pe=n(176),ge=n(195),Ce=n(229),he=n(24),be=n(48),ve=n(243),ye=n(447),Te=n(15),Oe=n(143),Ie=n(51),Se=n(44),_e=n(11),je=n(80),De=n(63),Ee=n(40),Ae=n(275),Pe=n(218);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(ae||(ae={}));var xe,ke=n(23),we=n(361),Re=n(84),Fe=n(129);function Ne(e,t){return{type:xe.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}function Me(e){return e.type===xe.FocusComponent&&void 0!==e.component}function Le(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),Object(r.__assign)({type:xe.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(xe||(xe={}));var Ve=n(43);function Be(e,t,n){return t?n?{type:xe.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function Ue(e,t,n,r){if(!e)return ae.NoCommand;var a=ae.Handled;if(Me(e)){var o=e.component;o.componentType===Ve.a.Card&&"ios"===Object(Re.a)()&&(Ce.a&&Object(i.i)("Switching focus command from Card to Post to workaround iOS platform difference with card container focus"),o.componentType=Ve.a.Post),a=function(e,t,n){return t?(Ce.a&&Object(i.i)("Calling focus for componentType: ".concat(e.component.componentType)),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),ae.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?ae.ShouldRetry:ae.ComponentNotFound}(e,Object(Ve.c)(o)?t.getComponentById(o):t.getComponent(o.componentType),r)}else if(function(e){return e.type===xe.DispatchAction&&void 0!==e.action}(e))n.dispatch(e.action);else if(function(e){return e.type===xe.Compound&&void 0!==e.first&&void 0!==e.then}(e)){var s=Ue(e.first,t,n,r),c=Ue(e.then,t,n,r);Object(d.i)().assertConditionTag(s!==ae.ShouldRetry&&c!==ae.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),a}var He=n(181);function Ge(e,t){return!!(Object(Ve.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}function We(e,t){if(n=e.componentTreeId.renderContextType,!("win32"===Object(Re.a)()||"ios"===Object(Re.a)()&&n===ke.a.FullPane||"web"===Object(Re.a)()&&C.P())&&Object(Fe.b)(n)){var n;if(e.getComponent(Ve.a.ClosePaneButton))return Le(void 0,{componentType:Ve.a.ClosePaneButton},{priorityArgs:t});Object(d.i)().assertConditionTag(!1,"cant find close button on platform where we should be able to find it",579086371)}}function qe(e,t,n){var r,a;if(void 0===n&&(n={priority:1}),Object(Fe.b)(e.componentTreeId.renderContextType)){var o=null!==(a=null!==(r=function(e,t,n){if(C.F()&&e.componentTreeId.renderContextType===ke.a.FullPane){var r=t.getState();if(_e.p(r).newThread){if(e.getComponent(Ve.a.NewCommentButton))return Le(void 0,{componentType:Ve.a.NewCommentButton},{priorityArgs:n});Object(d.i)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==r?r:We(e,n))&&void 0!==a?a:function(e){if("ios"!==Object(Re.a)()&&"web"!==Object(Re.a)())return Le(void 0,{componentType:Ve.a.CommentsList},{priorityArgs:e})}(n);if(o)return o;Object(d.i)().assertConditionTag("ios"===Object(Re.a)()&&e.componentTreeId.renderContextType===ke.a.FullPane,"Couldn't find a focus target",576337158)}else Object(d.i)().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157)}var ze=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,a=r.altKey,o=r.shiftKey,i=r.ctrlKey,s=r.metaKey,c=r.key;return n.altKey=a,n.shiftKey=o,n.ctrlKey=i,n.metaKey=s,n.key=Object(pe.f)(c),n}return Object(r.__extends)(t,e),t}(function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}());function Ye(e,t,n,a,o){var i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return a.apply(void 0,Object(r.__spreadArray)([e],Object(r.__read)(t),!1))},s=function(a){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];var d=i.apply(void 0,Object(r.__spreadArray)([a],Object(r.__read)(s),!1));o(d,a,e(),t,n)};return s.processCommand=i,s}function Ke(e,t,n,a,o){var i=function(t,n){var a,i=Object(r.__read)(n),c=i[0],d=i.slice(1),u=c();o(s.apply(void 0,Object(r.__spreadArray)([(a=t,new ze(a)),u],Object(r.__read)(d),!1)),u,e(),(function(){}),(function(){}))},s=function(e,o){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(n(o)){var c=Object(pe.d)(Object(pe.f)(e.key),t),d=a[pe.b[c]];return d?d.handler.apply(d,Object(r.__spreadArray)([e,o],Object(r.__read)(i),!1)):void 0}},c=Object.keys(a).map((function(e){return{key:e,eventPhase:a[e].phase}})),d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return i(t,e)},getKeyDownEvents:function(){return c}}};return d.processEvent=s,d}var Xe,Qe,Ze=n(199),Je=n(168),$e=n(73),et=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object($e.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&ie.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&ie.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),tt=n(279),nt=n(82),rt=n(193),at=n(160),ot=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=nt.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(at.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(at.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&rt.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&rt.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),it=function(){function e(e,t,n){this.commentStore=e,this.telemetryVisitor=t,this.useContentNavigationAPI=n}return e.prototype.isContentNavigationAPISupported=function(){return C.l()?this.useContentNavigationAPI:C.ib()},e.prototype.selectThreadInCurrentContext=function(e,t,n,r,a){return Ne(e,he.selectComment(t,n,void 0,r?he.SelectActionType.ExpandCard:he.SelectActionType.SelectCard,a))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return Ne(e,he.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,r,a){return Ne(e,he.selectComment(t,n,r,he.SelectActionType.SelectPost,a))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,a){if(!C.kb()&&C.lb()){var o=_e.g(this.commentStore.getState(),!0,r),s=Object(Te.G)(_e.h(this.commentStore.getState()),!0,r);if(s&&o&&0===o.flatIndex)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},s,!1,n)}var c=void 0,d=a?_e.a(this.commentStore.getState()):_e.k(this.commentStore.getState());if(Object(Ee.f)(d))c=a?new tt.b(d,_e.d(this.commentStore.getState()),-1).next().value:d[0];else{var u=void 0;if(a)u=new tt.a(d,-1,a).next().value;else u=d[0];c=null==u?void 0:u.commentId}if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},c,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,a){var o=_e.d(this.commentStore.getState());if(!Object(Ee.c)(o)&&C.lb()){var s=_e.g(this.commentStore.getState(),!0,r),c=Object(Te.G)(_e.h(this.commentStore.getState()),!0,r);if(c&&s&&s.flatIndex===o.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var u=a?_e.a(this.commentStore.getState()):_e.k(this.commentStore.getState());if(Object(Te.d)(u,o,a)){var l=void 0;if(Object(Ee.f)(u))l=a?new tt.b(u,o,u.length).previous().value:u[u.length-1];else{var m=new tt.a(u,u.length,a).previous().value;l=null==m?void 0:m.commentId}if(l)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},l,t,n);Object(d.i)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t){var n=_e.t(this.commentStore.getState());if(n){if(C.lb()&&Object(Te.G)(_e.h(this.commentStore.getState()))===n.selectedCardId)return;var r=_e.j(this.commentStore.getState());if(Object(we.a)(n.selectedCardId,r,t)===Ae.a.Expanded)return Be(e,Le(e,{componentType:Ve.a.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:i.d.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(e,t,n,r,a,o,s,c){var d,u=t.direction===E.d.Next?e.next():e.previous();if(C.lb()&&n&&r&&a.selectedCardId!==n&&(t.direction===E.d.Next?o<r.flatIndex&&(u.done||e.currentIndex()>=r.flatIndex):o>=r.flatIndex&&(u.done||e.currentIndex()<r.flatIndex)))return this.selectThreadInCurrentContext(s,{renderContextType:c,trackback:i.d.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,t.source);return u.done||(d=u.value.commentId),d},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,a){var o=this.commentStore.getState(),s=_e.t(o);if(this.isContentNavigationAPISupported()&&(!s||r===ke.a.DiscreteIntegrated||r===ke.a.None&&De.e(o)!==B.a.Visible)){if(void 0!==n)return Ne(e,he.selectContent({renderContextType:r,trackback:i.d.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,s?{contentId:s.selectedCardId,contentType:l.b.CommentThread}:void 0,n));Object(d.i)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var c=a?_e.a(this.commentStore.getState()):_e.k(this.commentStore.getState()),u=_e.f(o).nextPopulatedContextDetails,m=t.direction===E.d.Next;if(void 0!==s&&(a||Object(ve.b)(this.commentStore.getState(),s.selectedCardId))){var f=_e.g(o,!0,r),p=Object(Te.G)(_e.h(o),!0,r),g=void 0;g=!Object(Ee.f)(c)&&C.lb()&&f&&s.selectedCardId===p?f.flatIndex+(m?-1:0):this.getSelectedThreadIndex(c);var h=void 0;if(Object(Ee.f)(c))if(a){var b=new tt.b(c,_e.d(o),g);h=m?b.next().value:b.previous().value}else h=c[g+(m?1:-1)];else{b=new tt.a(c,g,a);var v=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(b,t,p,f,s,g,e,r);if(v&&"string"!=typeof v)return v;h=v}if(h)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},h,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,r,u,a)}else{if(Object(Te.d)(a?_e.a(this.commentStore.getState()):_e.k(this.commentStore.getState()),_e.d(o),a))return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,r,a);if(!t.restrictToCurrentContext&&u!==Je.a.NoComments)return this.selectAcrossContexts(e,t,r,u,a)}},e.prototype.selectAcrossContexts=function(e,t,n,r,a){return C.p()&&this.isContentNavigationAPISupported()&&!De.a(this.commentStore.getState())&&Object(d.i)().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),t.direction===E.d.Next?r===Je.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,a):Ne(e,he.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:i.d.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):r===Je.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,a):Ne(e,he.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:i.d.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(e,t,n){var r=_e.t(this.commentStore.getState());if(void 0!==r){if(!C.b()){var a=_e.d(this.commentStore.getState()),o=this.getSelectedIndex(),s=void 0,c=void 0;if(Object(Ee.c)(a)){var u=_e.b(this.commentStore.getState())[r.selectedCardId];u&&o<u.length-1&&(s=r.selectedCardId,c=u[o+1])}else{var l=new et(a,o).next(),m=a[o];!l.done&&l.value.parentId&&l.value.parentId===Object($e.b)(m)&&(s=l.value.parentId,c=l.value.commentId)}return s&&c?this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},s,c,be.a.SharedComments):void 0}if(n){var f=this.getSelectedIndexFromRenderableItems(n);if(!(f<0)){var p=new ot(n,f).next(),g=n[f],h=nt.i(g);return p.done||nt.i(p.value)!==h?void 0:this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},nt.i(p.value),nt.e(p.value),be.a.SharedComments)}Object(d.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else Object(d.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(d.i)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){var r=_e.t(this.commentStore.getState());if(void 0!==r){if(!C.b()){var a=_e.d(this.commentStore.getState()),o=this.getSelectedIndex(),s=void 0,c=void 0;if(Object(Ee.c)(a)){var u=_e.b(this.commentStore.getState())[r.selectedCardId];u&&o>0&&(s=r.selectedCardId,c=u[o-1])}else{var l=a[o];if(l.parentId)(f=new et(a,o).previous()).done||Object($e.b)(f.value)!==l.parentId||(s=Object($e.b)(f.value),c=f.value.commentId)}return s&&c?this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},s,c,be.a.SharedComments):void 0}if(n){var m=this.getSelectedIndexFromRenderableItems(n);if(m<0)Object(d.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var f,p=n[m],g=nt.g(p);if(g)if(!(f=new ot(n,m).previous()).done&&nt.i(f.value)===g)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},nt.i(f.value),nt.e(f.value),be.a.SharedComments)}}else Object(d.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278859)}else Object(d.i)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=_e.t(this.commentStore.getState());if(n&&!Object(Se.j)(n.selectionDetails))return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,be.a.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n=_e.k(this.commentStore.getState()),r=Object(Ee.f)(n)?n:n.filter((function(e){return!e.parentId}));if(0!==r.length&&(0!==t||1!==r.length)){var a;t>r.length?(Object(d.i)().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),a=r.length-1):a=t>=1?t-1:t+1;var o=Object(Ee.f)(r)?r[a]:r[a].commentId;return Be(void 0,Le(void 0,{componentType:Ve.a.Card,id:o,renderContextType:e}),Ne(void 0,he.selectComment({renderContextType:e,trackback:i.d.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},o,void 0,he.SelectActionType.SelectCard,be.a.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var e=this.commentStore.getState();return Object(Te.u)(_e.d(e),_e.b(e),_e.t(e))},e.prototype.getSelectedThreadIndex=function(e){return Object(Te.M)(e,_e.t(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=_e.t(this.commentStore.getState());if(!t)return-1;var n=Object(Se.b)(t);return C.jb()?e.findIndex((function(e){return nt.e(e)===n})):e.findIndex((function(e){return Object(at.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),st=function(){function e(e,t){var n,r,a,o=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=(n=50,r=[xe.FocusComponent],(a=function(e,t,o,s,c){if(!r||!e||-1===r.indexOf(e.type)||3===e.priorityArgs.priority)return e&&-1!==(null==r?void 0:r.indexOf(e.type))&&(Ce.a&&(null==e?void 0:e.type)===xe.FocusComponent&&Object(i.i)("Executing non-debounced focus command ".concat(JSON.stringify(e))),void 0!==a.pendingCommand&&clearTimeout(a.pendingCommand),a.pendingCommand=void 0),void s(e,Ue(e,t,o,c));void 0!==a.pendingCommand&&clearTimeout(a.pendingCommand),Ce.a&&e.type===xe.FocusComponent&&Object(i.i)("Caching debounced command ".concat(JSON.stringify(e))),a.pendingCommand=setTimeout((function(){Ce.a&&e.type===xe.FocusComponent&&Object(i.i)("Executing debounced command ".concat(JSON.stringify(e))),s(e,Ue(e,t,o,c)),a.pendingCommand=void 0}),n)}).pendingCommand=void 0,a),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(e){var t=e?Object(He.d)(e):"";!o.pendingOnComponentFocusedRequest||""!==t&&t===Object(He.d)(o.pendingOnComponentFocusedRequest.targetedComponent)||(Ce.a&&Object(i.i)("Pending component focused request cleared."),clearTimeout(o.pendingOnComponentFocusedRequest.token),o.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(e){o.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=function(e,t){e&&Me(e)&&(t===ae.ShouldRetry?o.focusToRetry={command:e,timestamp:Date.now()}:t===ae.Handled&&(o.focusToRetry=void 0))},this.commentContentsKeyDown=Ke((function(){return o.commentStore}),this.isRTL,(function(e){var t=_e.h(o.commentStore.getState());if(C.lb()){var n=Object(Te.I)(t);if(n&&e.isFocusOnOrWithin({componentType:Ve.a.CardEditor,id:n,renderContextType:t.drafts[t.cardIdToDraftIdMap[n]].renderContextType}))return!1;var r=Object(Te.J)(t);if(r&&e.isFocusOnOrWithin({componentType:Ve.a.PostEditor,id:r,renderContextType:t.drafts[t.postIdToDraftIdMap[r]].renderContextType}))return!1}else if(Object(Ie.c)(t))return!1;return!e.isFocusOn({componentType:Ve.a.GhostCard})&&!e.isFocusOn({componentType:Ve.a.NewCommentButton})}),{ArrowDown:{handler:function(e,t,n){var r=o.onDownKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:pe.a.Bubbling},ArrowUp:{handler:function(e,t,n){var r=o.onUpKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:pe.a.Bubbling},ArrowRight:{handler:function(e,t){if(t.componentTreeId.renderContextType!==ke.a.HalfPane){var n=o.onRightKey(e,t);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:pe.a.Bubbling},ArrowLeft:{handler:function(e,t){if(t.componentTreeId.renderContextType!==ke.a.HalfPane){var n=o.onLeftKey(e,t.componentTreeId.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:pe.a.Bubbling},Home:{handler:function(e,t){if(t.componentTreeId.renderContextType===ke.a.FullPane){var n=o.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,be.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:pe.a.Capturing},End:{handler:function(e,t){if(t.componentTreeId.renderContextType===ke.a.FullPane){var n=o.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,be.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:pe.a.Capturing},F12:{handler:function(e,t){var n=e.altKey?o.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:pe.a.None},Escape:{handler:function(e,t){var n="win32"===Object(Re.a)()?o.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:pe.a.None}},this.commandExecutor),this.focusCommentCardCommand=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n=_e.h(o.commentStore.getState()),r=Object(Te.K)(n),a=void 0;return(a=o.checkForRetryOfEditorFocus(e,n))||!C.lb()&&(null==r?void 0:r.threadId)===t&&(a=o.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n))?a:Le(void 0,{componentType:Object(He.c)(t,n),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===ke.a.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n=_e.h(o.commentStore.getState());if(!C.lb()&&n.postIdToDraftIdMap[t]){var r=o.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n);if(r)return r}return Le(void 0,{componentType:Ve.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e){if(Object(Fe.b)(e.componentTreeId.renderContextType)){var t=_e.h(o.commentStore.getState()),n=_e.t(o.commentStore.getState()),r=void 0;if(r=o.checkForRetryOfEditorFocus(e,t))return r;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:Ve.a.PaneRoot})){if(!C.lb()&&(r=o.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return r;if(r=o.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,n,t))return r;if(!C.F()&&!e.getComponent(Ve.a.ClosePaneButton)){var a=_e.k(o.commentStore.getState());return a.length>0?o.focusCommentCardCommand.processCommand(e,Object(Ee.f)(a)?a[0]:a[0].commentId):void Object(d.i)().assertConditionTag("win32"===Object(Re.a)()||"ios"===Object(Re.a)()&&e.componentTreeId.renderContextType===ke.a.FullPane,"Shouldn't be reached on current config",575239243)}return qe(e,o.commentStore)}}else Object(d.i)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.commentCardMounted=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n,r=_e.h(o.commentStore.getState()),a={componentType:Object(He.c)(t.id,r),id:t.id,renderContextType:e.componentTreeId.renderContextType};if(n=o.handleFocusRetry(e,a,r,1))return n;if(t.selected&&!e.isFocusWithin(a)){var i=Object(Fe.b)(e.componentTreeId.renderContextType);if((!i||e.isFocusWithinPane())&&(i||e.isFocusWithinAny(Ve.a.Card)||e.isFocusWithinAny(Ve.a.DraftCard)))return o.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return o.handleFocusRetry(e,{componentType:Ve.a.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},_e.h(o.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return o.handleFocusRetry(e,{componentType:Ve.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},_e.h(o.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return o.handleFocusRetry(e,{componentType:Ve.a.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},_e.h(o.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,n){var r=void 0;if(r=o.checkForRetryCommandOnPropsUpdated(e,n.draftState,!1))return r;var a=t.draftState,i=n.draftState,s=t.selectedComment,c=n.selectedComment;return(r=o.checkForDiscard(e,a,i,s,c))||(r=o.checkForHalfPaneFullTransition(e,t,n))?r:e.isFocusWithinPane()?(r=o.checkForLowFidelityWarning(e,s,c))||(r=o.checkForSelectionChange(e,i,s,c))||(r=o.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,i))||(r=o.checkForReplyFinished(e,c,t.draftState,n.draftState,c&&n.cardViewStates[c.selectedCardId]))?r:o.checkForLowFidelityWarning(e,s,c):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,n){var r=void 0;return(r=o.checkForRetryCommandOnDiscreteCardPropsUpdated(e,n))||(r=o.checkForDiscard(e,t.draftState,n.draftState,t.selectedState,n.selectedState))?r:e.isFocusWithinAny(Ve.a.Card)||e.isFocusWithinAny(Ve.a.DraftCard)?o.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?Le(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(He.b)(n.isDraftThread),id:n.threadId}):(r=o.checkForLowFidelityWarning(e,t.selectedState,n.selectedState))||(r=o.checkForSelectionChange(e,n.draftState,t.selectedState,n.selectedState))||(r=o.checkForReplyFinished(e,n.selectedState,t.draftState,n.draftState,n.cardState))?r:o.checkForLowFidelityWarning(e,t.selectedState,n.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=Ke((function(){return o.commentStore}),this.isRTL,(function(e){return!!Object(Fe.b)(e.componentTreeId.renderContextType)||(Object(d.i)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return Ne(e,he.requestClosePane({renderContextType:t.componentTreeId.renderContextType,trackback:i.d.reserveTag(575239245),telemetryVisitor:o.telemetryVisitor}))},phase:pe.a.Capturing},Tab:{handler:function(e,t){return o.paneContainerTabHandling(e,t)},phase:pe.a.None}},this.commandExecutor),this.commentEditorKeyDown=Ke((function(){return o.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var n=e.altKey?o.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:pe.a.None}},this.commandExecutor),this.onUserAction=Ye((function(){return o.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n;switch(t.userAction){case Ze.a.RequestNewCommentFromHost:if(!Object(Fe.b)(e.componentTreeId.renderContextType))return;return qe(e,o.commentStore);case Ze.a.CancelReplyDraft:return Le(void 0,{componentType:Ve.a.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case Ze.a.DeleteThread:case Ze.a.CancelNewThreadDraft:if(!Object(Fe.b)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===ke.a.HalfPane&&t.userAction===Ze.a.CancelNewThreadDraft)return;return null!==(n=qe(e,o.commentStore,{priority:3,phase:0}))&&void 0!==n?n:o.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case Ze.a.ResolveThread:if("android"!==Object(Re.a)()&&"ios"!==Object(Re.a)())return;return Le(void 0,{componentType:Ve.a.ReopenThreadButton,id:t.cardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Object(i.m)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e,t){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},Ce.a&&Object(i.i)("Pending component focused request added for ".concat(Object(He.d)(e),"."))},e.prototype.initialize=function(e,t,n){if(this._commentStore)throw new F.a("FocusManager already initialized",i.d.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=n?n:new it(e,this.telemetryVisitor,t)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new F.a("FocusManager not initialized",i.d.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,r){var a;if(a=this.checkForRetryOfEditorFocus(e,n))return a;if(this.focusToRetry&&t){var o=this.focusToRetry.command.component,i=Date.now()-this.focusToRetry.timestamp;if(i>15e3)return Object(d.i)().assertConditionTag(!1,"Took too long to mount component type ".concat(o.componentType," for focus retry: ").concat(i," ms"),575239241),void(this.focusToRetry=void 0);if(this.shouldRetryFocusForPhase(this.focusToRetry,r)&&Object(Ve.b)(o,t)){var s=this.focusToRetry.command;return this.focusToRetry=void 0,s}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){if(Object(we.a)(e.selectedCardId,t,n.componentTreeId.renderContextType)===Ae.a.Collapsed)return!1;if(e.selectedCardId===Object(Te.G)(_e.h(this.commentStore.getState())))return!1;if(C.cb())return n.isFocusWithinAny(Ve.a.Post);var r={componentType:Ve.a.Post,id:Object(Se.b)(e),renderContextType:n.componentTreeId.renderContextType};return n.isFocusOnOrWithin(r)},e.prototype.onDownKey=function(e,t,n){if(_e.m(this.commentStore.getState())){var r=C.o()&&!De.a(this.commentStore.getState()),a=_e.t(this.commentStore.getState()),o=_e.j(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,o,t)){if(t.componentTreeId.renderContextType===ke.a.DiscreteIsolated)return;var i={direction:E.d.Next,source:be.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,E.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==ke.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t.componentTreeId.renderContextType,r);Object(d.i)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)}},e.prototype.onUpKey=function(e,t,n){if(_e.m(this.commentStore.getState())){var r=C.o()&&!De.a(this.commentStore.getState()),a=_e.t(this.commentStore.getState()),o=_e.j(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,o,t)){if(t.componentTreeId.renderContextType===ke.a.DiscreteIsolated)return;var i={direction:E.d.Previous,source:be.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,E.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==ke.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t.componentTreeId.renderContextType,r);Object(d.i)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)}},e.prototype.onRightKey=function(e,t){if(_e.m(this.commentStore.getState())){var n=_e.t(this.commentStore.getState());if(!C.lb()||!n||n.selectedCardId!==Object(Te.G)(_e.h(this.commentStore.getState()))){var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&Object(Se.j)(n.selectionDetails)&&t.isFocusOn({componentType:Ve.a.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}}},e.prototype.onLeftKey=function(e,t){if(_e.m(this.commentStore.getState()))return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)},e.prototype.onTabKeyInPane=function(e,t){var n=_e.t(this.commentStore.getState());return void 0!==n&&Object(ve.b)(this.commentStore.getState(),n.selectedCardId)||!_e.m(this.commentStore.getState())?C.lb()?void 0:this.checkForActiveEditorFocus(e,t,_e.h(this.commentStore.getState())):this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t,!1)},e.prototype.isDraftInOtherContext=function(){var e=_e.v(this.commentStore.getState());return!!e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n,a){var o,i,s;null===(i=(o=Object(d.i)()).logDiagnosticTrace)||void 0===i||i.call(o,Object(fe.a)(Xe||(Xe=Object(r.__makeTemplateObject)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),a,d.h.Info,d.c.ProductServiceUsage,this.telemetryVisitor,Object(d.l)("RenderContextType",t.componentTreeId.renderContextType,d.d.SystemMetadata),Object(d.l)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,d.d.SystemMetadata),Object(d.l)("DraftRenderContextType",null!==(s=null==e?void 0:e.renderContextType)&&void 0!==s?s:ke.a.None,d.d.SystemMetadata),Object(d.l)("ComponentType",null!=n?n:0,d.d.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:xe.PreserveFocus,priorityArgs:{priority:1}};var a=t.drafts[this.draftToFocus.draftId],o=Date.now()-this.draftToFocus.timestamp;if(o>15e3)return Object(d.i)().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(o," ms, expected draft still exists: ").concat(!!a),575239251),this.draftToFocus=void 0,void this.logEditorRetryError(a,e,void 0,i.d.reserveTag(556607431));if(a&&a.renderContextType===e.componentTreeId.renderContextType){var s=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:2,phase:0});if(s&&Ge(e,s.component))return this.draftToFocus=Object(r.__assign)(Object(r.__assign)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),s;this.logEditorRetryError(a,e,null==s?void 0:s.component.componentType,i.d.reserveTag(556794947))}else this.logEditorRetryError(a,e,void 0,i.d.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(void 0===r&&(r={priority:1}),!this.isDraftInOtherContext()){var a=Object(Te.J)(n);if(a)return Le(e,{componentType:Ve.a.PostEditor,id:a,renderContextType:t},{priorityArgs:r});var o=Object(Te.I)(n);return o?Le(e,{componentType:Ve.a.CardEditor,id:o,renderContextType:t},{priorityArgs:r}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){var n=_e.t(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:l.b.CommentThread}:void 0;return Ne(e,he.moveFocusToCanvas({renderContextType:t.componentTreeId.renderContextType,trackback:i.d.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(C.lb()||!this.isDraftInOtherContext())return t&&t.selectedCardId?Le(void 0,{componentType:Object(He.c)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,a){if("web"!==Object(Re.a)()&&r&&a){var o=r.selectionDetails,i=a.selectionDetails;if(Object(Ie.j)(t)&&!Object(Ie.c)(n))return this.focusCommentCardCommand.processCommand(e,a.selectedCardId);if(Object(Se.j)(o)===Object(Se.j)(i)&&r.selectedCardId===a.selectedCardId&&Object(Ie.m)(t,n)){if(!Object(Se.j)(o)||!Object(Se.j)(i))return Le(void 0,{componentType:Ve.a.CardEditor,id:a.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(o.selectedPostId===i.selectedPostId)return Le(void 0,{componentType:Ve.a.PostEditor,id:i.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(Re.a)()){var n=this.commentStore.getState(),r=_e.p(n).virtualized;if(!Object(ye.a)(_e.q(n),r,!!je.g(n)))return(d=Le(e,{componentType:Ve.a.ClosePaneButton})).stopPropagation=!0,d.preventDefault=!0,d;var a=t.getComponent(Ve.a.ClosePaneButton),o=t.getComponent(Ve.a.NewCommentButton),i=(C.eb()?!_e.p(n).newThread:!C.o()&&Object(Ie.c)(_e.h(n)))||!o?a:o;if(C.k()){var s=_e.t(n),c=_e.h(n),d=void 0;return s&&Object(ve.b)(n,s.selectedCardId)?C.lb()||t.isFocusWithin({componentType:Object(He.c)(s.selectedCardId,c),id:s.selectedCardId,renderContextType:t.componentTreeId.renderContextType})||(d=this.checkForActiveEditorFocus(e,t.componentTreeId.renderContextType,c)):i&&e.isEventTarget(i)&&!e.shiftKey&&(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType)),d&&(d.stopPropagation=!0,d.preventDefault=!0),d}if(a&&e.isEventTarget(a)&&e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(Se.b)(n)!==Object(Se.b)(r)||Object(Se.j)(n.selectionDetails)!==Object(Se.j)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(C.lb()||!Object(Ie.d)(t))&&!e.isFocusOn({componentType:Ve.a.NextCommentButton})&&!e.isFocusOn({componentType:Ve.a.PreviousCommentButton})))){if(!Object(Se.j)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:r.selectedCardId!==(null==n?void 0:n.selectedCardId)?Object(He.c)(r.selectedCardId,t):Ve.a.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},!0))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:Ve.a.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r,a){var o=Object(Te.I)(n),i=Object(Te.I)(r);if(a&&a.pending!==Oe.a.Editor)return o&&!i&&(null==t?void 0:t.selectedCardId)===o&&e.isFocusWithin({componentType:Ve.a.Card,id:o,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,o):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.componentTreeId.renderContextType===ke.a.HalfPane&&Object(ge.b)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===ge.a.Normal&&(!Object(ge.b)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===ge.a.Variable))return Le(void 0,{componentType:Ve.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==Oe.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var a=this,o=Object.entries(n).find((function(e){var n=t[e[0]];return a.shouldFocusFromCardPendingStateChange(n,e[1])}));if(o)return Le(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(He.c)(o[0],r),id:o[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&Ge(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(Ve.c)(this.focusToRetry.command.component)||!Object(Ve.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===Pe.a.InCard||t.cardRelativeDraftingState===Pe.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(C.k()?Object(Se.h)(n):Object(Se.g)(n))){var r=t?Object(Se.b)(t):void 0,a=Object(Se.b)(n);if(a!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return Le(void 0,{componentType:Ve.a.Post,renderContextType:e.componentTreeId.renderContextType,id:a})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}(),ct=n(194),dt=n(631),ut=function(){return function(e){return function(t){return Object(O.unstable_batchedUpdates)((function(){return e(t)}))}}},lt=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=Object(i.k)(i.b.Redux,n),a=e(t);return null==r||r.end(),a}}},mt=n(328),ft=n(448),pt=n(118),gt=n(90),Ct=n(382),ht=n(142),bt=n(234);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=512]="ContentExtensionHostingDisabled"}(Qe||(Qe={}));var vt=n(276),yt=n(373),Tt=n(437),Ot=n(210);function It(e,t){var n=Object(ft.c)(e);if(n)return n;Object(d.i)().assertConditionTag(!1,"immerDraft does not have original state",t)}function St(e,t,n){var r,a=It(e,i.d.reserveTag(524031047));if(a&&Te.e(t,a.postData)){e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&(Object(Se.j)(e.selectedComment.selectionDetails)||void 0!==e.selectedComment.selectionDetails.lowFidelityWarningType)&&(e.selectedComment.selectionDetails=Te.m()),t.commentId===(null===(r=Te.K(a.draftState))||void 0===r?void 0:r.threadId)&&(!function(e,t,n){_t(e,n);var r=Te.J(e);if(r){var a=e.postIdToDraftIdMap[r],o=e.drafts[a];o&&o.threadId===n&&jt(e,r)}if(e.pendingDraft&&Object(ht.e)(e.pendingDraft)){var i=e.pendingDraft.commentId,s=t[i];s&&Object($e.b)(s)===n&&(e.pendingDraft=void 0)}}(e.draftState,e.postData,t.commentId),Object(Ot.b)(a.draftState,e.draftState,1,n,i.d.reserveTag(526242836)));var o=Te.U(t.commentId,e.expandedComments,e.draftState,e.selectedComment);o!==e.expandedComments&&(e.expandedComments=o)}}function _t(e,t){e.pendingDraft&&Object(ht.f)(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var n=e.cardIdToDraftIdMap[t];n&&(Dt(e,n),delete e.cardIdToDraftIdMap[t])}function jt(e,t){e.pendingDraft&&Object(ht.e)(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var n=e.postIdToDraftIdMap[t];n&&(Dt(e,n),delete e.postIdToDraftIdMap[t])}function Dt(e,t){e.drafts[t]?(Object(d.i)().assertConditionTag(1===Object.keys(e.drafts).length,"Invalid number of drafts",526131555),delete e.drafts[t]):Object(d.i)().assertConditionTag(0===Object.keys(e.drafts).length,"Invalid draftId",526131554)}var Et=n(102),At=n(212);var Pt=n(162);function xt(e,t,n,a){var o,i,s,c,d;if(C.b()&&n.tasks){var u=!1,l={},m={},f=new Set,p=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&f.add(e.commentId)}));try{for(var g=Object(r.__values)(p),h=g.next();!h.done;h=g.next()){var b=h.value;if(!f.has(b)){u=!0;break}}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}p.length!==(null===(d=n.tasks)||void 0===d?void 0:d.length)&&(u=!0);try{for(var v=Object(r.__values)(n.tasks),y=v.next();!y.done;y=v.next()){var T=y.value;u=wt(t,m,T,a)||u,l[T.commentId]=C.bb()?Ft(T):T}}catch(e){s={error:e}}finally{try{y&&!y.done&&(c=v.return)&&c.call(v)}finally{if(s)throw s.error}}if(u)return{updatedTasks:l,updatedHistoryRecordViewState:m}}}function kt(e,t,n,a){if(C.b()){var o=Object(r.__assign)({},e),i=Object(r.__assign)({},t),s=!1;if(n.changes.forEach((function(n){if(n.type!==pt.d.Unknown){var r=n.model.commentId;switch(n.type){case pt.d.Delete:if(delete o[r],void 0!==e[r])Object.keys(e).includes(r)&&(Rt(i,e[r],void 0),s=!0);break;case pt.d.Load:case pt.d.Insert:case pt.d.Modify:Object(d.i)().assertConditionTag(n.type===pt.d.Modify||!o[r],"Task should not already be populated on initial load",554836097);var c=n.task;if(c){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===Pt.a.Create}(c))return void Object(d.i)().assertConditionTag(!1,"Invalid task payload - dropping task data",554836098);s=wt(t,i,c,a)||s||!o[r]||(C.Q()?!function(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var n=0;n<e.assignees.length;n++)if(!Object(oe.l)(e.assignees[n],t.assignees[n]))return!1;return!0}(o[r].currentState,c.currentState):o[r].currentState.completion!==c.currentState.completion),o[r]=C.bb()?Ft(c):c}else if(""===n.model.parentId&&o[r]){var u=o[r];Rt(i,u,void 0),delete o[r],s=!0}}}else Object(d.i)().assertConditionTag(!1,"Unknown change type",554836096)})),s)return{updatedTasks:o,updatedHistoryRecordViewState:i}}}function wt(e,t,n,a){var o,i,s,c;if(0===n.history.length)return!0;var d=!1,u=e&&Object.keys(e).length>0,l=u?new Set:void 0;try{for(var m=Object(r.__values)(n.history),f=m.next();!f.done;f=m.next()){var p=f.value;try{for(var g=(s=void 0,Object(r.__values)(p.records)),C=g.next();!C.done;C=g.next()){var h=C.value;null==l||l.add(h.recordId);var b=nt.a(n.id,h.recordId);e[b]?t[b]=e[b]:(d=!0,t[b]=Object(Te.t)(Object(Te.o)(h.time,h.displayTime,a.dataCulture)))}}catch(e){s={error:e}}finally{try{C&&!C.done&&(c=g.return)&&c.call(g)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=m.return)&&i.call(m)}finally{if(o)throw o.error}}if(u){var v=Rt(t,n,l);d=d||v}return d}function Rt(e,t,n){var a,o,i,s,c=!1;try{for(var d=Object(r.__values)(t.history),u=d.next();!u.done;u=d.next()){var l=u.value;try{for(var m=(i=void 0,Object(r.__values)(l.records)),f=m.next();!f.done;f=m.next()){var p=f.value;n&&n.has(p.recordId)||(delete e[nt.a(t.id,p.recordId)],c=!0)}}catch(e){i={error:e}}finally{try{f&&!f.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}}}catch(e){a={error:e}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(a)throw a.error}}return c}function Ft(e){var t,n,a,o,i=Object(r.__assign)({},e),s=[];try{for(var c=Object(r.__values)(e.history),d=c.next();!d.done;d=c.next()){var u=d.value,l=Object(r.__assign)({},u);C.jb()&&!l.taskId&&(l.taskId=e.id);var m=[];try{for(var f=(a=void 0,Object(r.__values)(u.records)),p=f.next();!p.done;p=f.next()){var g=p.value;m.push(Object(r.__assign)({},g))}}catch(e){a={error:e}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}l.records=m,s.push(l)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return i.history=s,i}function Nt(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var Mt=n(330),Lt=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function Vt(e){return Ht(Object(Ve.c)(e)?Object(He.a)(e):Object(He.e)(e.componentType))}function Bt(e){var t=document.activeElement;return!!e&&t===e}function Ut(e,t,n){var r=document.activeElement,a=t!==Ve.a.CardEditor&&t!==Ve.a.PostEditor&&!n;return!!e&&(r&&e.contains(r)||a&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(r))}function Ht(e){var t=document.getElementById(e);return null!=t?t:void 0}var Gt=function(){function e(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return Ht(Object(He.e)(e))},e.prototype.getComponentById=function(e){return Ht(Object(He.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return Bt(Vt(e))},e.prototype.isFocusWithin=function(e){return Ut(Vt(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e,t){var n=Vt(e);return Bt(n)||Ut(n,e.componentType,t)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case Ve.a.Card:t=Lt(document.querySelectorAll("[id*='".concat(I.i({id:"",renderContextType:this.componentTreeId.renderContextType},!1),"']")));break;case Ve.a.DraftCard:t=Lt(document.querySelectorAll("[id*='".concat(I.i({id:"",renderContextType:this.componentTreeId.renderContextType},!0),"']")));break;case Ve.a.PostEditor:t=Lt(document.querySelectorAll("[id*='".concat(I.w(I.G({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case Ve.a.CardEditor:t=Lt(document.querySelectorAll("[id*='".concat(I.w(I.f({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case Ve.a.Post:t=Lt(document.querySelectorAll("[id*='".concat(I.I({id:"",renderContextType:this.componentTreeId.renderContextType}),"']")))}if(t)for(var n=0;n<t.length;++n){if(Ut(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return Ut(document.getElementById(I.z()),Ve.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Wt(e,t){switch(void 0===e&&(e={extensions:{},contentNavigationSupported:!1}),void 0===t&&(t=he.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(d.i)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var a=t.payload.extension;return Object(r.__assign)(Object(r.__assign)({},e),{extensions:Object(r.__assign)(Object(r.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:a,priority:a.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,a,o=Object(r.__assign)({},e.extensions);try{for(var i=Object(r.__values)(t.payload.renderModes),s=i.next();!s.done;s=i.next()){var c=s.value;delete o[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{extensions:o})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(r.__assign)({},e.extensions);for(var a in t.payload.updates)n[a]&&(n[a]=Object(r.__assign)(Object(r.__assign)({},n[a]),{priority:t.payload.updates[a]}));return Object(r.__assign)(Object(r.__assign)({},e),{extensions:n})}(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{contentNavigationSupported:t.payload.isEnabled})}(e,t);default:return e}}function qt(e,t){return void 0===e&&(e=zt()),void 0===t&&(t=he.EMPTY_ACTION),Object(ft.a)(e,(function(n){switch(t.type){case"VIEW_CONTAINER_VISIBILITY_CHANGED":return void function(e,t){void 0===e.defaultFilterId&&t.payload.visibilityState!==B.a.Closed&&(e.requestDefaultFilter=!0)}(n,t);case"LOAD_DEFAULT_FILTER":return void function(e,t){Yt(e,t.payload.filteredRange,!0)&&(e.defaultFilterId=t.payload.filteredRange.id);e.requestDefaultFilter=!1}(n,t);case"LOAD_FILTER":return void function(e,t){Object(d.i)().assertConditionTag(!!e.defaultFilterId,"Default filter should be loaded before new filters are loaded",528779299),Yt(e,t.payload.filteredRange,t.payload.shouldSetActive)}(n,t);case"SET_FILTERING_CAPABILITIES":return void function(e,t){e.filteringCapabilities=t.payload.capabilities}(n,t);case"UPDATE_FILTER_RANGE":return void function(e,t){if(Object(d.i)().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),0===t.payload.changes.length||!t.payload.filterId)return;var n=e.filteredRanges[t.payload.filterId];if(!n)return void Object(d.i)().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);t.payload.changes.forEach((function(a){switch(a.type){case"FilterUpdate":if(t.payload.filterId===e.defaultFilterId){Object(d.i)().assertConditionTag(!1,"Should not attempt to update the default filter",528532106);break}Object(d.i)().assertConditionTag(n.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),n.filter=a.updatedFilter;break;case"Insert":if(a.index<0||a.index>n.order.length){Object(d.i)().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}n.order=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(n.order.slice(0,a.index)),!1),[a.content],!1),Object(r.__read)(n.order.slice(a.index)),!1);break;case"Reload":n.order=a.fullContent;break;case"Remove":if(a.index<0||a.index>=n.order.length){Object(d.i)().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}n.order.splice(a.index,1);break;case"Teardown":t.payload.filterId===e.defaultFilterId&&(Object(d.i)().assertConditionTag(!1,"Is tearing down default filter expected?",528779328),e.defaultFilterId=void 0),t.payload.filterId===e.activeFilterId&&(Object(d.i)().assertConditionTag(!!e.defaultFilterId,"Active was removed, but no default to fallback on",528779329),e.activeFilterId=e.defaultFilterId),delete e.filteredRanges[t.payload.filterId]}}))}(n,t);default:return e}}))}function zt(){return{filteredRanges:{},filteringCapabilities:void 0,requestDefaultFilter:!1}}function Yt(e,t,n){return void 0!==e.filteredRanges[t.id]?(Object(d.i)().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(n&&(e.activeFilterId=t.id),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:e.defaultFilterId!==t.id&&t.canBeUpdated()},!0)}function Kt(e){return Object(r.__assign)(Object(r.__assign)({},C.kb()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Je.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(Ie.h)(),modelCapabilities:Object(Te.s)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function Xt(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new Gt(Object(vt.a)(e.containerType),r),visibilityState:t?B.a.Visible:B.a.Closed,initializationStatus:Mt.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{},contentNavigationSupported:!1},commentState:Kt(n),filterState:{filteredRanges:{},filteringCapabilities:void 0,requestDefaultFilter:!1}}}(e,t,n,r)}var Qt,Zt={isRightToLeft:!1,dataCulture:"",uiCulture:""};function Jt(e,t){void 0===e&&(e=Kt(Zt)),void 0===t&&(t=mt.a);var n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=Te.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return function(e,t){var n,a,o,s,c,u,l;if(Object(Ee.e)(e))return e;if(!t.payload.changes.length)return e;var m,f={commentData:Object(r.__spreadArray)([],Object(r.__read)(e.commentData),!1),cardViewState:Object(r.__assign)({},e.cardViewState),postViewState:Object(r.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},p=e.createdCommentLie,g=!!Te.G(e.draftState,!0),C=null==p?void 0:p.flatIndex,h=e.modelCapabilities.virtualized;try{for(var b=Object(r.__values)(t.payload.changes),v=b.next();!v.done;v=b.next())if((m=v.value).type===gt.b.Load&&(m=void 0!==f.postViewState[m.model.commentId]?Object(r.__assign)(Object(r.__assign)({},m),{type:gt.b.Modify}):Object(r.__assign)(Object(r.__assign)({},m),{type:gt.b.Insert})),m.type===gt.b.Insert){if((T=m.model.parentId)&&(f.cardViewState[T]?f.cardViewState[T]=Object(r.__assign)(Object(r.__assign)({},f.cardViewState[T]),{pending:Oe.a.None}):null===(c=null===(s=Object(d.i)())||void 0===s?void 0:s.logDiagnosticTrace)||void 0===c||c.call(s,Object(fe.a)(Qt||(Qt=Object(r.__makeTemplateObject)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),i.d.reserveTag(526960065),d.h.Warning,d.c.ProductServiceUsage,Object(d.j)(d.g.ReviewedAsNotNecessary))),f.commentData.splice(m.index,0,m.model),m.tempId){if(!T)(y={})[m.model.commentId]=Te.j(m.tempId),f.cardViewState=Object(r.__assign)(Object(r.__assign)({},Te.Z(f.cardViewState,m.tempId)),y);f.postViewState=Object(r.__assign)(Object(r.__assign)({},Te.Z(f.postViewState,m.tempId)),Te.y([m.model],f.expandedComments,e.localizationDetails)),f.draftState.committedLieId===m.tempId&&(f.draftState=Object(r.__assign)(Object(r.__assign)({},f.draftState),{committedLieId:void 0}),C=void 0),f.selectedComment&&f.selectedComment.selectedCardId===m.tempId&&(f.selectedComment=Te.n(Object($e.b)(m.model)),m.model.parentId||(f.expandedComments=Te.a(f.expandedComments,f.selectedComment,f.draftState)))}else{var y;if(Object(d.i)().assertConditionTag(!f.postViewState[m.model.commentId],"Received insert for existing comment ".concat(m.model.commentId),594122589),!T)(y={})[m.model.commentId]=Te.j(void 0),f.cardViewState=Object(r.__assign)(Object(r.__assign)({},f.cardViewState),y);f.postViewState=Object(r.__assign)(Object(r.__assign)({},f.postViewState),Te.y([m.model],f.expandedComments,e.localizationDetails))}g&&void 0!==C&&m.index<=C&&C++}else if(m.type===gt.b.Modify){if((_=f.commentData[m.index]).commentId===m.model.commentId){f.commentData[m.index]=m.model;var T=Object($e.b)(m.model),O=f.cardViewState[T];O?f.cardViewState[T]=Object(r.__assign)(Object(r.__assign)({},O),{pending:Oe.a.None,loadState:O.loadState.state!==Et.a.Loading&&h?O.loadState:{state:Et.a.Loaded}}):(Object(d.i)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default. CommentId: ".concat(m.model.commentId," | ParentId: ").concat(T),527962186),f.cardViewState[T]=Te.j(void 0,h?Et.a.Placeholder:void 0));var I=_.displayDate===m.model.displayDate&&_.date===m.model.date?f.postViewState[m.model.commentId].displayDate:Te.o(m.model.date,m.model.displayDate,e.localizationDetails.dataCulture);if(f.postViewState=Object(r.__assign)(Object(r.__assign)({},f.postViewState),((o={})[m.model.commentId]=Object(r.__assign)(Object(r.__assign)({},f.postViewState[m.model.commentId]),{pending:At.a.None,displayDate:I}),o)),m.model.commentFlags&rt.a.Resolved&&!(_.commentFlags&rt.a.Resolved)){var S=f.draftState;f.selectedComment&&f.selectedComment.selectedCardId===m.model.commentId&&(f.selectedComment=Te.n(f.selectedComment.selectedCardId)),f.draftState=Te.S(f.draftState,m.model.commentId,f.commentData),Object(Ot.b)(S,f.draftState,1,2,i.d.reserveTag(539297114)),f.expandedComments=Te.U(m.model.commentId,f.expandedComments,f.draftState,f.selectedComment)}}else Object(d.i)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(i.i)("changeIndex did not match comment for ".concat(m.model.commentId))}else if(m.type===gt.b.Delete){var _;if((_=f.commentData[m.index]).commentId===m.model.commentId&&f.commentData.splice(m.index,1),f.highlightedCommentId===m.model.commentId&&(f.highlightedCommentId=void 0),f.topVisibleThreadId===m.model.commentId&&(f.topVisibleThreadId=void 0),f.cardViewState=Te.Z(f.cardViewState,m.model.commentId),f.postViewState=Te.Z(f.postViewState,m.model.commentId),m.model.commentId===f.selectedThreadIdBeforeCommentSession){var j=m.index;f.commentData.length?(j>=f.commentData.length&&(j=f.commentData.length-1),f.selectedThreadIdBeforeCommentSession=Object($e.b)(f.commentData[j])):f.selectedThreadIdBeforeCommentSession=void 0}g&&void 0!==C&&m.index<C&&C--}}catch(e){n={error:e}}finally{try{v&&!v.done&&(a=b.return)&&a.call(b)}finally{if(n)throw n.error}}g&&(void 0===C?p=void 0:p&&C!==p.flatIndex&&(p=Object(r.__assign)(Object(r.__assign)({},p),{flatIndex:C})));f.draftState=Te.db(f.draftState,e.cardViewState,f.cardViewState,e.postViewState,f.postViewState,2),f.selectedComment&&!Object(Ie.l)(f.draftState)&&(f.cardViewState[f.selectedComment.selectedCardId]?Object(Se.j)(f.selectedComment.selectionDetails)&&!f.postViewState[f.selectedComment.selectionDetails.selectedPostId]&&(f.selectedComment=Te.n(f.selectedComment.selectedCardId)):f.selectedComment=void 0);var D=kt(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:p,draftState:f.draftState,selectedComment:f.selectedComment,expandedComments:Te.V(f.expandedComments,f.cardViewState,f.draftState),commentData:f.commentData,cardViewState:f.cardViewState,postViewState:f.postViewState,highlightedCommentId:f.highlightedCommentId,topVisibleThreadId:f.topVisibleThreadId,selectedThreadIdBeforeCommentSession:f.selectedThreadIdBeforeCommentSession,tasks:null!==(u=null==D?void 0:D.updatedTasks)&&void 0!==u?u:e.tasks,historyRecordViewState:null!==(l=null==D?void 0:D.updatedHistoryRecordViewState)&&void 0!==l?l:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,a,o,i=e.modelCapabilities.virtualized,s=Te.Q(e,t.payload.commentData,i,!!t.payload.filteringEnabled);o=Te.k(t.payload.commentData,i?Et.a.Placeholder:Et.a.Loaded);var c=function(e,t){var n,a;if(e&&C.b()){var o={},i={};try{for(var s=Object(r.__values)(e),c=s.next();!c.done;c=s.next()){var d=c.value;wt({},i,d,t),o[d.commentId]=C.bb()?Ft(d):d}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return{updatedTasks:o,updatedHistoryRecordViewState:i}}}(t.payload.tasks,e.localizationDetails);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),s),{cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),o),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),Te.y(t.payload.commentData,s.expandedComments,e.localizationDetails)),tasks:null!==(n=null==c?void 0:c.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(a=null==c?void 0:c.updatedHistoryRecordViewState)&&void 0!==a?a:e.historyRecordViewState})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){if(!e.modelCapabilities.virtualized)throw new F.a("virtualizeCommentsReducer requires virtualization",i.d.reserveTag(589103643),-2130957500);var n=Object(yt.c)(t.payload.threadInfo.map((function(e){return e.threadId}))),a=Te.Q(e,n,!0,!!t.payload.filteringEnabled);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),a),{cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),Te.N(t.payload.threadInfo)),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),Te.y(n,a.expandedComments,e.localizationDetails))})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!Object(Ie.c)(e.draftState))return e;var a,o=Te.G(e.draftState);if(!o)return e;var i=!1;(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==o?a=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(a={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},i=!0);var s=Te.T(e.draftState,o);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),Object(Ee.e)(e)?{commentThreadIds:Te.Y(e.commentThreadIds,o),cardPostIds:Te.Z(e.cardPostIds,o),postData:Te.Z(e.postData,o)}:{}),{createdCommentLie:void 0,selectedComment:a,expandedComments:a&&i?Te.a(e.expandedComments,a,s):Te.R(e.expandedComments,a,s),cardViewState:Te.Z(e.cardViewState,o),postViewState:Te.Z(e.postViewState,o),selectedThreadIdBeforeCommentSession:void 0,draftState:s})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=Te.A(e,t.payload.commentId),a=Te.ab(e.draftState,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:Te.R(e.expandedComments,n,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=Te.T(e.draftState,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{expandedComments:Te.R(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=Te.K(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var a=Te.D(t.payload.cardId,e.selectedComment,e.draftState);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:a,expandedComments:Te.U(t.payload.cardId,e.expandedComments,e.draftState,a)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n=e.selectedComment;if(!Te.bb(e.draftState,n,t))return e;if(!t.payload.selectedCard)throw new F.a(te.d,i.d.reserveTag(589103644),-2130957536);var a=Te.gb(e.selectedComment,t),o=Object(he.shouldSelectActionExpandCard)(t.payload.selectType)?Te.a(e.expandedComments,a,e.draftState):Te.R(e.expandedComments,a,e.draftState);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:a,expandedComments:o})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Oe.a.Card,loadState:{state:Et.a.Loaded}}),n)),selectedComment:Te.B(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return Object(Ee.e)(e)?Object(ft.a)((function(e){!function(e,t){var n=It(e,i.d.reserveTag(524031011));if(!n)return;var a=!1,o=!1,s=!1,c=!1,u=n.selectedComment&&Object(Se.j)(n.selectedComment.selectionDetails),l=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach((function(t){if(t.commentId===n.highlightedCommentId&&(a=!0),t.commentId===n.topVisibleThreadId&&(o=!0),n.selectedComment&&(t.commentId===n.selectedComment.selectedCardId&&(s=!0),n.selectedComment.selectedCardId===Object($e.b)(t)&&Object(Se.j)(n.selectedComment.selectionDetails)&&n.selectedComment.selectionDetails.selectedPostId===t.commentId&&(c=!0)),t.commentId in n.postData)Object($e.a)(t)&&function(e,t){var n=It(e,i.d.reserveTag(523604707));if(n){var a=n.cardViewState[t];Object(d.i)().assertConditionTag(!a||a.pending!==Oe.a.Delete,"Card pending delete remained after a reload.",523604736);var o=n.modelCapabilities.virtualized?Et.a.NeedsReload:Et.a.Loaded;if(a){var s=a.pending!==Oe.a.None,c=(s||n.modelCapabilities.virtualized)&&a.loadState.state!==Et.a.Placeholder&&a.loadState.state!==o;e.cardViewState[t]=s?Object(r.__assign)(Object(r.__assign)({},a),{pending:Oe.a.None}):a,c&&(e.cardViewState[t].loadState=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t].loadState),{state:o}))}else Object(d.i)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=Te.j(void 0,o)}}(e,t.commentId),function(e,t){var n=It(e,i.d.reserveTag(523604738));if(n){var a=n.postViewState[t];Object(d.i)().assertConditionTag(!a||a.pending!==At.a.Delete,"Post pending delete remained after a reload.",523604739),a?e.postViewState[t]=a.pending!==At.a.None?Object(r.__assign)(Object(r.__assign)({},a),{pending:At.a.None}):a:(Object(d.i)().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=Te.l(void 0))}}(e,t.commentId),St(e,t,1),n.selectedThreadIdBeforeCommentSession&&n.selectedThreadIdBeforeCommentSession===t.commentId&&(l=!0);else{if(Object($e.a)(t)){var u=t.commentId,m=n.modelCapabilities.virtualized?{state:Et.a.Placeholder,initialItemCount:1}:{state:Et.a.Loaded};e.cardViewState[t.commentId]=Te.v(u,m)}e.postViewState[t.commentId]=Te.l(t.displayDate)}!function(e,t){if(Object($e.a)(t))e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId];else{if(!e.cardPostIds[t.parentId])return void Object(d.i)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);e.cardPostIds[t.parentId].push(t.commentId)}e.postData[t.commentId]=t}(e,t)})),a||(e.highlightedCommentId=void 0);o||(e.topVisibleThreadId=void 0);!l&&n.selectedThreadIdBeforeCommentSession&&function(e){var t=It(e,i.d.reserveTag(523604741));if(null==t?void 0:t.selectedThreadIdBeforeCommentSession){var n=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);n<0&&(Object(d.i)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),n=0);var r=e.commentThreadIds.length-1;e.commentThreadIds.length?(n>=e.commentThreadIds.length&&(n=r),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[n]):e.selectedThreadIdBeforeCommentSession=void 0}}(e);(function(e){var t=It(e,i.d.reserveTag(523604706));if(t&&e.createdCommentLie){var n=Te.G(e.draftState,!0);if(n&&t.createdCommentLie&&t.cardViewState[n]&&t.cardViewState[n].pending===Oe.a.None){var r=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>r&&(e.createdCommentLie.flatIndex=r);var a=Te.L(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);a>=0?(e.commentThreadIds.splice(a,0,n),e.cardPostIds[n]=[n],e.postData[n]=t.postData[n],e.cardViewState[n]=t.cardViewState[n],e.postViewState[n]=t.postViewState[n]):Object(d.i)().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}else e.createdCommentLie=void 0}})(e),e.draftState.committedLieId=void 0;var m=Te.G(e.draftState);m&&e.selectedComment&&m===e.selectedComment.selectedCardId&&(s=!0);(function(e,t){var n=It(e,i.d.reserveTag(524031042));if(n){var r,a;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(r=e.draftState.pendingDraft.threadId,!n.cardViewState[r])return;break;case"EDIT":if(a=e.draftState.pendingDraft.commentId,!n.postViewState[a])return;break;default:return}else{var o=Te.K(e.draftState);if(!o||!o.isInCurrentContext)return;switch(o.commentDraft.sessionConfiguration.sessionType){case"REPLY":r=o.threadId;break;case"EDIT":a=o.commentDraft.sessionConfiguration.commentId;break;default:return}}r&&!e.cardViewState[r]?(_t(e.draftState,r),Object(Ot.b)(n.draftState,e.draftState,3,t,i.d.reserveTag(526242828))):a&&!e.postViewState[a]&&(jt(e.draftState,a),Object(Ot.b)(n.draftState,e.draftState,2,t,i.d.reserveTag(526242829)))}})(e,1),Object(Ie.l)(e.draftState)||(s?u&&!c&&e.selectedComment&&!n.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=Te.m()):e.selectedComment=void 0);e.pendingCommentLoad=void 0;var f=xt(n.tasks,n.historyRecordViewState,t.payload,n.localizationDetails);(null==f?void 0:f.updatedTasks)&&(e.tasks=f.updatedTasks);(null==f?void 0:f.updatedHistoryRecordViewState)&&(e.historyRecordViewState=f.updatedHistoryRecordViewState);var p=Te.V(e.expandedComments,e.cardViewState,e.draftState);p!==e.expandedComments&&(e.expandedComments=p)}(e,t)}))(e):function(e,t){var n,a,o,s,c={},u={},l=e.selectedComment,m=e.expandedComments,f=l&&Object(Se.j)(l.selectionDetails),p=!1,g=!1,C=!1,h=e.selectedThreadIdBeforeCommentSession,b=e.draftState,v=e.modelCapabilities.virtualized,y=null===(n=Te.K(b))||void 0===n?void 0:n.threadId,T={};e.commentData.forEach((function(e){T[e.commentId]=e}));var O=!1,I=!1;t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(O=!0),n.commentId===e.topVisibleThreadId&&(I=!0),l&&(n.commentId===l.selectedCardId&&(g=!0),l.selectedCardId===Object($e.b)(n)&&Object(Se.j)(l.selectionDetails)&&l.selectionDetails.selectedPostId===n.commentId&&(p=!0)),n.commentId in T){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(d.i)().assertConditionTag(e.cardViewState[n.commentId].pending!==Oe.a.Delete,"Card pending delete remained after a reload.",593762527);var a=e.cardViewState[n.commentId];if(a)if(a.pending!==Oe.a.None||v){var o=a.loadState;u[n.commentId]=Object(r.__assign)(Object(r.__assign)({},a),{pending:Oe.a.None,loadState:o.state===Et.a.Placeholder?o:{state:v?Et.a.NeedsReload:Et.a.Loaded}})}else u[n.commentId]=a;else Object(d.i)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default. Id: ".concat(n.commentId),527958879),u[n.commentId]=Te.j(void 0,v?Et.a.NeedsReload:Et.a.Loaded)}if(Object(d.i)().assertConditionTag(!e.postViewState[n.commentId]||e.postViewState[n.commentId].pending!==At.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]?e.postViewState[n.commentId].pending!==At.a.None?c[n.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[n.commentId]),{pending:At.a.None}):c[n.commentId]=e.postViewState[n.commentId]:c[n.commentId]=Te.l(void 0),n.commentFlags&rt.a.Resolved&&(!T[n.commentId]||!(T[n.commentId].commentFlags&rt.a.Resolved))){if(l&&l.selectedCardId===n.commentId&&(l=Te.n(l.selectedCardId)),n.commentId===y){var s=b;b=Te.S(b,n.commentId,t.payload.comments),Object(Ot.b)(s,b,1,1,i.d.reserveTag(539297115))}m=Te.U(n.commentId,m,b,l)}h&&h===n.commentId&&(C=!0)}else{if(""===n.parentId){var f=n.commentId,S=v?{state:Et.a.Placeholder,initialItemCount:1}:{state:Et.a.Loaded};u[n.commentId]=Te.v(f,S)}c[n.commentId]=Te.l(m.includes(Object($e.b)(n))?Te.o(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}})),s=Te.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),b=Object(r.__assign)(Object(r.__assign)({},b),{committedLieId:void 0});var S=Te.G(b);S&&(l&&S===l.selectedCardId&&(g=!0),u[S]=e.cardViewState[S],c[S]=e.postViewState[S]);b=Te.db(b,e.cardViewState,u,e.postViewState,c,1),Object(Ie.l)(b)||(g?f&&!p&&l&&!v&&(l={selectedCardId:l.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):l=void 0);if(!C&&h){var _=e.commentData.findIndex((function(e){return e.commentId===h}));if(_<0&&(Object(d.i)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),_=0),t.payload.comments.length){_>=t.payload.comments.length&&(_=t.payload.comments.length-1);var j=t.payload.comments[_];h=Object($e.b)(j)}else h=void 0}var D=xt(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(r.__assign)(Object(r.__assign)({},e),{draftState:b,commentData:Object(r.__spreadArray)([],Object(r.__read)(t.payload.comments),!1),cardViewState:u,postViewState:c,selectedComment:l,expandedComments:Te.V(m,u,b),pendingCommentLoad:void 0,highlightedCommentId:O?e.highlightedCommentId:void 0,topVisibleThreadId:I?e.topVisibleThreadId:void 0,createdCommentLie:s,selectedThreadIdBeforeCommentSession:h,tasks:null!==(a=null==D?void 0:D.updatedTasks)&&void 0!==a?a:e.tasks,historyRecordViewState:null!==(o=null==D?void 0:D.updatedHistoryRecordViewState)&&void 0!==o?o:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Oe.a.Card}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{pending:At.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Oe.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(r.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){if(n[e]){var t=n[e].loadState;n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{loadState:{state:Et.a.Loading,initialItemCount:Te.O(t)?t.initialItemCount:1}})}else Object(d.i)().assertConditionTag(!1,"Loading an unexpected thread? id: ".concat(e),528021317)})),Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,a,o,s,c,u,l;if(Te.H(e.draftState))throw new F.a("Draft already active!",i.d.reserveTag(589103640),-2130957551);var m=e.selectedThreadIdBeforeCommentSession,f=t.payload.draftDetails;switch(f.sessionConfiguration.sessionType){case"CREATE":var p=f.sessionConfiguration.draftId,g=Object(r.__assign)(Object(r.__assign)({},Te.f(p)),{author:f.author,anchorHintText:f.anchorHintText}),C=Te.C(Object(Ee.a)(e),f),h=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[p]={commentDraft:f,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:Ie.a.None,renderContextType:t.payload.draftRenderContextType,threadId:p},n)),cardIdToDraftIdMap:Object(r.__assign)(Object(r.__assign)({},e.draftState.cardIdToDraftIdMap),(a={},a[p]=p,a)),pendingDraft:void 0}),b={};if(Object(Ee.e)(e)){var v=Te.L(e.commentThreadIds,e.cardPostIds,f.insertIndex),y=e.commentThreadIds,T=e.cardPostIds;v>=0&&(y=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(y.slice(0,v)),!1),[p],!1),Object(r.__read)(y.slice(v)),!1),T=Object(r.__assign)(Object(r.__assign)({},e.cardPostIds),((o={})[p]=[p],o))),b={commentThreadIds:y,cardPostIds:T,postData:Object(r.__assign)(Object(r.__assign)({},e.postData),(s={},s[p]=g,s))}}return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),b),{createdCommentLie:{flatIndex:f.insertIndex,newComment_deprecated:g},cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),Te.p(g)),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),Te.q(g)),selectedComment:C,expandedComments:Te.a(e.expandedComments,C,h),selectedThreadIdBeforeCommentSession:m,draftState:h});case"EDIT":case"REPLY":if(!Object(bt.b)(f.sessionConfiguration)&&!Object(bt.c)(f.sessionConfiguration))throw Object(d.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new F.a(te.c,i.d.reserveTag(589103642),-2130957532);var O=void 0;O=!e.selectedComment||Object(bt.c)(f.sessionConfiguration)&&f.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||ht.e(f.sessionConfiguration)&&(!Object(Se.j)(e.selectedComment.selectionDetails)||f.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId)?Te.C(Object(Ee.a)(e),f):Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})});var I=e.draftState.cardIdToDraftIdMap,S=e.draftState.postIdToDraftIdMap,_="",j=!1,D=!1;if(ht.f(f.sessionConfiguration))I=Object(r.__assign)(Object(r.__assign)({},I),((c={})[f.sessionConfiguration.threadId]=f.sessionConfiguration.draftId,c)),_=f.sessionConfiguration.threadId,D=!0;else if(ht.e(f.sessionConfiguration)){var E=f.sessionConfiguration.commentId;if(S=Object(r.__assign)(Object(r.__assign)({},S),((u={})[E]=f.sessionConfiguration.draftId,u)),j=!0,Object(Ee.e)(e)){var A=e.postData[E],P=Object(Tt.e)(A.commentBody);D=0===P.length||"web"===Object(Re.a)()&&"\n"===P,_=Object($e.b)(A)}else e.commentData.some((function(e){if(e.commentId===E){var t=Object(Tt.e)(e.commentBody);return D=0===t.length||"web"===Object(Re.a)()&&"\n"===t,_=Object($e.b)(e),!0}return!1}))}else Object(i.m)(f.sessionConfiguration);var x=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(l={},l[f.sessionConfiguration.draftId]={commentDraft:f,isDraftEmpty:D,isInCurrentContext:!0,pendingState:Ie.a.None,renderContextType:t.payload.draftRenderContextType,threadId:_},l)),cardIdToDraftIdMap:I,postIdToDraftIdMap:S,pendingDraft:void 0});return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:O,expandedComments:j?Te.a(e.expandedComments,O,x):Te.R(e.expandedComments,O,x),selectedThreadIdBeforeCommentSession:m,draftState:x,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(d.i)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var a=Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:void 0});return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:Te.R(e.expandedComments,n,a),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:a})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n;if(e.createdCommentLie)return Object(d.i)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(ht.f(t.payload.params))n=t.payload.params.threadId;else if(ht.e(t.payload.params)){var a=t.payload.params.commentId,o=Object(Ee.b)(Object(Ee.a)(e),a);if(!o)return Object(d.i)().assertConditionTag(!1,"Could not lock selection on missing comment ".concat(a),593764357),e;n=Object($e.b)(o)}else n=Object(I.y)();var i=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(i=e.selectedComment.selectedCardId);var s=Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),c=Te.F(e.selectedComment,t,n),u=Object(Se.j)(c.selectionDetails)?Te.a(e.expandedComments,c,s):e.expandedComments;return Object(r.__assign)(Object(r.__assign)({},e),{selectedThreadIdBeforeCommentSession:i,selectedComment:c,expandedComments:u,draftState:s})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,a,o,s=Object(Ie.h)(),c={},u={},l=void 0,m=void 0,f=void 0,p=void 0,g=Te.G(e.draftState),h=!!e.createdCommentLie;o=t.payload.contextDetails?Object(r.__assign)(Object(r.__assign)({},Nt(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:Je.a.Unknown,isReadOnly:C.F()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var b,v=t.payload.contextDrafts;if(v){var y=Te.W(e.draftState);if(Object(Ie.e)(y)>0){var T={},O=void 0,I=void 0,S=!C.lb();if(Object(Ie.f)(y).forEach((function(n){var a,o,i=v.find((function(e){return e.draftId===n}));T[n]=Object(r.__assign)(Object(r.__assign)({},y.drafts[n]),{isInCurrentContext:!!i}),g===n&&(h=!!i,i&&(O=i.insertIndex,I=i.anchorHintText,(null===(a=t.payload.contextDetails)||void 0===a?void 0:a.selectedCommentId)===g&&(l=Te.n(g)))),S||l||!i||T[n].threadId!==(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId)||(S=!0)})),s=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:T}),m=e.createdCommentLie,f=g?Object(Ee.e)(e)?e.postData[g]:null==m?void 0:m.newComment_deprecated:void 0,S&&(l=e.selectedComment),m&&g&&h){Object(d.i)().assertConditionTag(void 0!==O,"Index unknown for lie in latest context",587309136);var _=null!=O?O:0;_!==m.flatIndex&&(m=Object(r.__assign)(Object(r.__assign)({},m),{flatIndex:_})),f&&void 0!==I&&I!==m.newComment_deprecated.anchorHintText&&(f=Object(r.__assign)(Object(r.__assign)({},f),{anchorHintText:I}),m=Object(r.__assign)(Object(r.__assign)({},m),{newComment_deprecated:f})),c=Te.w(g),u=Te.x(g),m.flatIndex>-1&&(c[g].pending=Oe.a.None,u[g].pending=At.a.None)}}else p=null!=p?p:-1}else p=null!=p?p:4;o.isReadOnly&&(h&&(m=void 0),s=Te.X(s),p=null!=p?p:5);if(Object(Ot.b)(e.draftState,s,p,4,i.d.reserveTag(539297116)),Object(Ee.e)(e)){var j=[],D={},E={};m&&g&&f&&((n={})[g]=f,E=n,h&&!m.flatIndex&&(j=[g],(a={})[g]=[g],D=a)),b={commentThreadIds:j,cardPostIds:D,postData:E}}else b={commentData:[]};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),b),{cardViewState:c,postViewState:u,selectedComment:l,expandedComments:Te.R(e.expandedComments,l,s),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:void 0!==t.payload.selectedThreadIndex&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:o,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?Te.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:m,selectedThreadIdBeforeCommentSession:void 0,draftState:s,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,a=t.payload,o=a.commentId,i=a.lowFidelityWarningType,s=Object(Ee.b)(Object(Ee.a)(e),o);if(!s)return Object(d.i)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(Ie.d)(e.draftState))return Object(d.i)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var c=e.expandedComments;i===Se.a.DeleteThread?n={selectedCardId:o,selectionDetails:{lowFidelityWarningType:i}}:(n={selectedCardId:Object($e.b)(s),selectionDetails:{selectedPostId:o,lowFidelityWarningType:i}},c=Te.a(c,n,e.draftState));return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:c})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:Object(r.__assign)(Object(r.__assign)({},n),{selectionDetails:{lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!Te.bb(e.draftState,e.selectedComment,t))return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,a=Object(r.__assign)({},e.contextState),o=e.createdCommentLie,s=e.draftState,c=void 0;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,a.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,a.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,a.isReadOnly=t.payload.contextState.isReadOnly,a.isReadOnly&&(s=Te.X(e.draftState),c=null!=c?c:5,Te.G(e.draftState,!0)&&(o=void 0)));if(!n)return e;return Object(Ot.b)(e.draftState,s,c,5,i.d.reserveTag(539297117)),Object(r.__assign)(Object(r.__assign)({},e),{draftState:s,contextState:a,createdCommentLie:o})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(Ie.b)(e.draftState))return Object(d.i)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var a=e.draftState,o=Te.K(e.draftState);o&&(a=Object(r.__assign)(Object(r.__assign)({},a),{drafts:Object(r.__assign)(Object(r.__assign)({},a.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:Ie.a.Commit}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:a})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(Ie.i)(e.draftState))return Object(d.i)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var a=e.draftState,o=Te.K(e.draftState);o&&(a=Object(r.__assign)(Object(r.__assign)({},a),{drafts:Object(r.__assign)(Object(r.__assign)({},a.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:Ie.a.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:o.savedDraftContent}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:a})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(Ie.b)(e.draftState)&&!Object(Se.g)(e.selectedComment))return Object(d.i)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,a=Te.K(e.draftState);a&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:Ie.a.Discard}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(Ie.j)(e.draftState))return Object(d.i)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,a=Te.K(e.draftState);a&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:Ie.a.None}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(r.__assign)(Object(r.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(r.__assign)(Object(r.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=Te.H(e.draftState);if(void 0===n)return Object(d.i)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){var n;if(!e.createdCommentLie)return e;var a=Te.G(e.draftState);if(!a)return e;var o=t.temporaryCommentId;if(!o)throw Object(d.i)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new F.a(te.c,i.d.reserveTag(589103637),-2130957545);var s=Object(Ee.e)(e)?e.postData[a]:e.createdCommentLie.newComment_deprecated;if(Object(Ee.e)(e)&&!s)return Object(d.i)().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var c=Object(r.__assign)(Object(r.__assign)({},s),{commentId:o,commentBody:t.commentBody}),u=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),Te.w(o)),l=Object(r.__assign)(Object(r.__assign)({},e.postViewState),Te.x(o)),m=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},f=Te.T(e.draftState,a);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:m,expandedComments:Te.a(e.expandedComments,m,f)}),Object(Ee.e)(e)?{postData:Object(r.__assign)(Object(r.__assign)({},e.postData),(n={},n[a]=c,n))}:{createdCommentLie:Object(r.__assign)(Object(r.__assign)({},e.createdCommentLie),{newComment_deprecated:c})}),{cardViewState:u,postViewState:l,selectedThreadIdBeforeCommentSession:void 0,draftState:Object(r.__assign)(Object(r.__assign)({},f),{committedLieId:o})})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new F.a(te.d,i.d.reserveTag(589103638),-2130957536);var a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.parentId]),{pending:Oe.a.Editor,loadState:{state:Et.a.Loaded}}),n)),o=Te.n(t.parentId),s=Te.T(e.draftState,t.parentId);return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a,selectedComment:o,expandedComments:Te.R(e.expandedComments,o,s),selectedThreadIdBeforeCommentSession:void 0,draftState:s})}(e,t.payload.data);case"EDIT":return function(e,t){var n,a=Te.A(e,t.commentId),o=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.commentId]),{pending:At.a.Post}),i=Te.ab(e.draftState,t.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),(n={},n[t.commentId]=o,n)),selectedComment:a,expandedComments:Te.R(e.expandedComments,a,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);default:throw new F.a("Unexpected session type for commit",i.d.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{modelCapabilities:Object(r.__assign)(Object(r.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,a=e.draftState.drafts;if(void 0===a[t.payload.draftId])return Object(d.i)().assertConditionTag(!Object(Ie.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=Object(r.__assign)(Object(r.__assign)({},a),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},a[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:o})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,a=e.draftState.drafts;if(void 0===a[t.payload.draftId])return Object(d.i)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=Object(r.__assign)(Object(r.__assign)({},a),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},a[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:o})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=Te.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===ke.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:ke.a.None}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=Te.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(Fe.b)(r.renderContextType)?Object(vt.a)(t.payload.viewContainer.containerType):r.renderContextType}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,a,o=Te.H(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=o.sessionConfiguration.draftId,s=e.draftState.drafts;if(!s[i])return Object(d.i)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var c=s[i].draftWarningState,u=Object(r.__assign)(Object(r.__assign)({},s[i]),{draftWarningState:{warningCounter:c?c.warningCounter+1:0,type:t.payload.draftWarningType}}),l=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=u,n)),m=C.lb()&&(Object(bt.b)(u.commentDraft.sessionConfiguration)||(null===(a=e.selectedComment)||void 0===a?void 0:a.selectedCardId)!==u.threadId)?Te.E(u):e.selectedComment,f=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:l});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:f,selectedComment:m,expandedComments:Te.R(e.expandedComments,m,f)})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&Qe.AtMentionKnown?t.payload.modelCapabilityFlags&Qe.AtMentionEnabled?pt.b.Enabled:pt.b.Disabled:pt.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Qe.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Qe.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Qe.Virtualized),tasks:t.payload.modelCapabilityFlags&Qe.TasksKnown?t.payload.modelCapabilityFlags&Qe.TasksEnabled?Ct.a.Enabled:Ct.a.Disabled:Ct.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Qe.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Qe.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&Qe.ContentExtensionHostingDisabled)};return Object(r.__assign)(Object(r.__assign)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,a=Te.H(e.draftState);if(void 0===a)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=a.sessionConfiguration;if(Object(bt.b)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return Object(d.i)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var s=i.currentMentionees,c={};for(var u in s)c[u]={mentionee:Object(r.__assign)({},s[u].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(u)};var l=i.selectedTaskAssignee;if(l){var m=Object(oe.h)(l);c[m]&&c[m].stillInDraft||(l=void 0)}var f=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:c,selectedTaskAssignee:l}),n))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:f})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,a,o=Te.H(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var i=o.sessionConfiguration;if(Object(bt.b)(i))return e;var s=e.draftState.drafts[i.draftId];if(!s)return Object(d.i)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var c=s.currentMentionees,u=Object(oe.h)(t.payload.mentionee);if(c&&c[u])return e;var l={};for(var m in c)l[m]={mentionee:Object(r.__assign)({},c[m].mentionee),stillInDraft:c[m].stillInDraft};l[u]={mentionee:Object(r.__assign)({},t.payload.mentionee),stillInDraft:!0};var f=void 0;e.draftState.drafts[i.draftId].selectedTaskAssignees&&(f=Object(r.__assign)({},e.draftState.drafts[i.draftId].selectedTaskAssignees),Object(oe.b)(f,((n={})[u]={mentionee:Object(r.__assign)({},t.payload.mentionee),stillInDraft:!0},n)));var p=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(a={},a[i.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[i.draftId]),{currentMentionees:l,selectedTaskAssignees:f}),a))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:p})}(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return function(e){var t;if(!C.i())return Object(d.i)().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var n=Te.K(e.draftState);if(void 0===n)return Object(d.i)().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var a=n.commentDraft,o=n.selectedTaskAssignees,i={};if(void 0===o){if(Object(bt.c)(a.sessionConfiguration)){var s=e.tasks[a.sessionConfiguration.threadId];Object(d.i)().assertConditionTag(!!s,"Task not found.",529143616),Object(oe.a)(i,s.currentState.assignees)}void 0!==n.currentMentionees&&Object(oe.b)(i,n.currentMentionees)}else i=void 0;var c=a.sessionConfiguration.draftId,u=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(t={},t[c]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[c]),{selectedTaskAssignees:i}),t))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:u})}(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n;if(C.i())return Object(d.i)().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var a=Te.H(e.draftState);if(void 0===a)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=a.sessionConfiguration;if(Object(bt.b)(o))return e;var i=o.draftId,s=e.draftState.drafts;if(!s[i])return Object(d.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=Object(r.__assign)(Object(r.__assign)({},s[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:c})})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return function(e,t){var n,a;if(!C.i())return Object(d.i)().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var o=Te.H(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var i=o.sessionConfiguration;if(Object(bt.b)(i))return e;var s=i.draftId,c=e.draftState.drafts;if(!c[s])return Object(d.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var u=null!==(a=c[s].selectedTaskAssignees)&&void 0!==a?a:{},l=Object(r.__assign)({},u);Object(oe.n)(l,t.payload.selectedAssignee);var m=Object(r.__assign)(Object(r.__assign)({},c),((n={})[s]=Object(r.__assign)(Object(r.__assign)({},c[s]),{selectedTaskAssignees:l}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:m})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Te.r(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),a=Object(r.__assign)({},e.postViewState);return a[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),a=Object(r.__assign)({},e.postViewState);return a[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){var n;if(!e.createdCommentLie)return e;if(Te.G(e.draftState)!==t.payload.draftId)return Object(d.i)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var a=Object(Ee.e)(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if(Object(Ee.e)(e)&&!a)return Object(d.i)().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var o=e.createdCommentLie,i={};if(void 0!==t.payload.insertIndex&&t.payload.insertIndex!==o.flatIndex&&(o=Object(r.__assign)(Object(r.__assign)({},o),{flatIndex:t.payload.insertIndex}),Object(Ee.e)(e))){var s=Te.fb(e.commentThreadIds,e.cardPostIds,t.payload.draftId,o);i=Object(r.__assign)(Object(r.__assign)({},i),{commentThreadIds:s})}if(void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==a.anchorHintText){var c=Object(r.__assign)(Object(r.__assign)({},a),{anchorHintText:t.payload.anchorHintText});if(Object(Ee.e)(e)){var u=Object(r.__assign)(Object(r.__assign)({},e.postData),((n={})[t.payload.draftId]=c,n));i=Object(r.__assign)(Object(r.__assign)({},i),{postData:u})}else o=Object(r.__assign)(Object(r.__assign)({},o),{newComment_deprecated:c})}return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),i),{createdCommentLie:o})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,a=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==B.a.Visible&&!C.o()&&(n=Te.W(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var i=Te.I(e.draftState);i&&(a=Te.n(i),o=Te.R(e.expandedComments,a,n))}return n=Te.eb(n,(function(n){var r=e.draftState.drafts[n];return Te.cb(r.renderContextType,t.payload.visibilityState)})),Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:a,expandedComments:o,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n,a,o=t,i="android"===Object(Re.a)()||"ios"===Object(Re.a)(),s=null===(n=o.selectedComment)||void 0===n?void 0:n.selectedCardId,c=Te.G(o.draftState);if(Object(Ee.e)(o)){var d=i&&s&&!o.expandedComments.includes(s)?Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(o.expandedComments),!1),[s],!1):o.expandedComments,u=o.cardPostIds,l=o.postData,m=void 0;d.forEach((function(e){e!==c&&u[e]&&(m=Te.g(u[e],null!=m?m:o.postViewState,l,o.localizationDetails))})),m&&(o=Object(r.__assign)(Object(r.__assign)({},o),{postViewState:m}))}else{if(s&&s!==c&&(i?s!==(null===(a=e.selectedComment)||void 0===a?void 0:a.selectedCardId):o.expandedComments.includes(s)&&!e.expandedComments.includes(s)))(f=Te.h(s,o.postViewState,o.commentData,o.localizationDetails))&&(o=Object(r.__assign)(Object(r.__assign)({},o),{postViewState:f}));var f,p=Te.G(e.draftState);if(p&&p!==c&&(i||o.expandedComments.includes(p)))(f=Te.h(p,o.postViewState,o.commentData,o.localizationDetails))&&(o=Object(r.__assign)(Object(r.__assign)({},o),{postViewState:f}))}return o}(e,n)}function $t(){Object(d.i)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function en(e,t){switch(void 0===e&&(e={viewContainer:{closeView:$t,openView:$t,containerType:w.b.FullPane,moveFocusToCanvas_donotuse:$t},componentTree:new Gt(ke.a.FullPane,o.a),visibilityState:B.a.Closed,initializationStatus:Mt.a.NotInitialized,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=he.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new Gt(Object(vt.a)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:t.payload.visibilityState!==B.a.Closed||C.s()?e.initializationStatus:Mt.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:Mt.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:Mt.a.Initialized})}(e);default:return e}}var tn=void 0;function nn(e,t){void 0===t&&(t=mt.a),tn||(tn=Object(ct.c)({paneState:en,contentExtensions:Wt,commentState:Jt,filterState:qt}));var n=tn(e,t);return n}var rn=n(131);var an=function(){return{threadIdRequests:new Map,sequenceId:0}};function on(e){return e&&(e.loadState.state===Et.a.Placeholder||e.loadState.state===Et.a.NeedsReload)}var sn=function(e,t,n){return void 0===n&&(n=20),a=function(e){return function(t,n){var a,o,i=_e.c(e.getState());try{for(var s=Object(r.__values)(n),c=s.next();!c.done;c=s.next()){var d=c.value;on(i[d])&&t.threadIdRequests.set(d,t.sequenceId++)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}return t}}(e),o=function(e,t,n){return function(a){for(var o=Array.from(a.threadIdRequests.entries()).sort((function(e,t){var n=Object(r.__read)(e,2),a=(n[0],n[1]),o=Object(r.__read)(t,2);return o[0],a-o[1]})),s=[],c=_e.c(e.getState()),d=o.pop();d&&s.length<n;d=o.pop()){var u=Object(r.__read)(d,1)[0];a.threadIdRequests.delete(u),on(c[u])&&s.push(u)}if(s.length&&e.dispatch(Object(he.dispatchLoadThreads)({renderContextType:ke.a.None,telemetryVisitor:t,trackback:i.d.reserveTag(594888212)},{threadIds:s})),a.threadIdRequests.size>0)return a}}(e,t,n),c=500,l=(s=an)(),m=function(){var e=o(l);e?(l=e,u=setTimeout(m,c)):(l=s(),u=void 0)},(f=function(e){l=a(l,e),u||d||(u=setTimeout(m,0)),u||(u=setTimeout(m,d||c))}).reset=function(){void 0!==u&&(clearTimeout(u),l=s(),u=void 0)},f;var a,o,s,c,d,u,l,m,f},cn=n(297),dn=n(257),un=function(e,t){return function(n){var r=sn(n,t);return function(t){return function(a){var o=n.getState();switch(a.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":r.reset();break;case"COMMIT_DRAFT":var s=dn.b(o),c=_e.v(o);if(void 0!==c){var u=c.commentDraft;if(a.payload.metadataUpdates&&a.payload.metadataUpdates.Task){var l=void 0;u.sessionConfiguration.sessionType!==rn.a&&u.sessionConfiguration.sessionType!==rn.b&&(l=s[u.sessionConfiguration.threadId]&&s[u.sessionConfiguration.threadId].id),a.payload.metadataUpdates.Task.taskId=l,u.updateProperties("Task",a.payload.metadataUpdates.Task)}a.payload.data.temporaryCommentId=u.commit(a.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return _e.p(o).virtualized?void r(a.payload.threadIds):void Object(d.i)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!_e.p(o).virtualized)return;e.loadThreads(a.payload.threadIds);break;case"HIGHLIGHT_COMMENT":a.payload.actionSource===be.a.SharedComments&&e.highlightComment(a.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var m=_e.h(o);if(Object(Ie.d)(m))return;e.deleteComment(a.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":C.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:a.payload.commentId}).then((function(e){var t=dn.b(o)[a.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(S.a)(i.d.reserveTag(593768922))):e.setThreadResolvedState(a.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":C.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:a.payload.commentId}).then((function(e){var t=dn.b(o)[a.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(S.a)(i.d.reserveTag(593768924))):e.setThreadResolvedState(a.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(a.payload.commentId)}var f=t(a),p=n.getState(),g=_e.t(o),h=_e.t(p),b=void 0;switch("LOAD_COMMENT"===a.type||"VIRTUALIZE_COMMENTS"===a.type||"SELECT_COMMENT"===a.type&&a.payload.source!==be.a.SharedComments||!h||h.selectedCardId===(null==g?void 0:g.selectedCardId)||h.selectedCardId===Object(I.y)()||(b=h.selectedCardId),a.type){case"CLEAR_COMMENT_HIGHLIGHT":a.payload.actionSource===be.a.SharedComments&&void 0!==o.commentState.highlightedCommentId&&void 0===p.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(C.G()&&(C.l()?!cn.b(n.getState()):!C.ib())){var v=_e.v(p);v&&(b=v.threadId)}}return b&&e.selectComment(b),f}}}};function ln(e,t,n){var r=e.getState(),a=cn.a(r)[l.e.Isolated];return!!a&&(n(t),a.controller.triggerUpdate(),!0)}function mn(e,t,n,r){return"CREATE"===r&&ln(e,t,n)}function fn(e,t){return 0===_e.f(t).lastContextChangeIncrement?l.d.Disabled:e===l.e.TaskPane||e===l.e.TaskPaneItem?De.a(t)?l.d.Primary:l.d.Disabled:_e.q(t)?l.d.Disabled:fn(l.e.TaskPane,t)!==l.d.Primary?l.d.Primary:e===l.e.Integrated?l.d.Disabled:l.d.Secondary}function pn(e,t){var n=cn.a(e)[t];n&&(n.controller.priority=n.priority)}var gn=function(e){return function(t){return function(n){return function(a){var o,s,c;switch(a.type){case"ADD_CONTENT_EXTENSION":a.payload.extension.priority=fn(a.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var d=Object(r.__values)(a.payload.renderModes),u=d.next();!u.done;u=d.next()){var m=u.value,f=cn.a(t.getState())[m];f&&f.controller.unregisterExtension()}}catch(e){o={error:e}}finally{try{u&&!u.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(a),pn(t.getState(),l.e.TaskPane),pn(t.getState(),l.e.TaskPaneItem),pn(t.getState(),l.e.Integrated),pn(t.getState(),l.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(ln(t,a,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(a),void t.dispatch(Object(he.updateExtensionPriority)({renderContextType:ke.a.None,telemetryVisitor:e,trackback:i.d.reserveTag(594834319)},(c={},c[l.e.TaskPane]=fn(l.e.TaskPane,t.getState()),c[l.e.TaskPaneItem]=fn(l.e.TaskPaneItem,t.getState()),c[l.e.Integrated]=fn(l.e.Integrated,t.getState()),c[l.e.Isolated]=fn(l.e.Isolated,t.getState()),c)));case"BEGIN_DRAFTING_SUCCESS":if(mn(t,a,n,a.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(mn(t,a,n,a.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(a.payload.isClaimingLock||a.actionDetail.renderContextType===ke.a.DiscreteIsolated)break;var p=_e.v(t.getState());if(p&&mn(t,a,n,p.commentDraft.sessionConfiguration.sessionType))return}return n(a)}}}},Cn=function(e){return function(t){return function(n){return function(r){var a;if(C.l()){if(!e||!cn.b(t.getState()))return n(r)}else{if(!C.ib())return n(r);Object(d.i)().assertConditionTag(!!e,"Content navigation API should be defined in change gate off path.",526405721)}var o=e,i=t.getState(),s=n(r),c=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":var u=_e.t(i),m=_e.t(c),f=!m||m.selectedCardId===(null==u?void 0:u.selectedCardId);if(C.G()&&f){var p=_e.v(c);p&&o.bringContentIntoView({contentIdentifier:{contentId:p.threadId,contentType:l.b.CommentThread}})}break;case"SELECT_COMMENT":var g=_e.t(c);r.payload.source===be.a.SharedComments&&r.payload.selectType!==he.SelectActionType.Polite&&Object(Fe.b)(r.actionDetail.renderContextType)&&g&&o.bringContentIntoView({contentIdentifier:{contentId:g.selectedCardId,contentType:l.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(De.a(c))break;var h=_e.v(c),b=h&&h.isInCurrentContext&&(null===(a=_e.t(c))||void 0===a?void 0:a.selectedCardId)===h.threadId?h.threadId:void 0;b&&o.bringContentIntoView({contentIdentifier:{contentId:b,contentType:l.b.CommentThread}});break;case"SELECT_CONTENT":o.selectNextOrPreviousContent(r.payload);break;case"MOVE_FOCUS_TO_CANVAS":o.moveFocus({region:E.a.Canvas,resource:r.payload.resource})}return s}}}},hn=function(e){return function(t){return function(n){return function(r){var a=t.getState().commentState.draftState.drafts;n(r);var o=t.getState().commentState.draftState.drafts;Object.keys(a).forEach((function(t){if(void 0===o[t]){var n=Object(d.i)().createActivityObject("EndDraftingCalledOnAction",e,d.a.None,d.b.NecessaryServiceDataEvent);n.addDataField("ActionName",r.type,d.d.SystemMetadata),n.successTag(539313865),a[t].commentDraft.endDrafting()}}))}}}},bn=n(178),vn=n(456),yn=n(604);function Tn(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CLEAR_COMMENT_SELECTION":return{name:"ClearCommentSelectionAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"COLLAPSE_CARD":return{name:"CollapseCardAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"COMMIT_DRAFT":return{name:"CommitDraftAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent,logDocumentMetadata:d.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent,logDocumentMetadata:d.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};default:return}}var On=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===Tn(t)){var n=Object(d.i)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);n.addDataField("OperationType",t.type,d.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,d.d.SystemMetadata),n.failTag(593278723,Object(bn.a)(e))}!function(e){if(Object(vn.a)(e))throw e;if(!Object(F.b)(e))throw Object(d.i)().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat(Object(i.l)(e)),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(d.i)().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat(Object(i.l)(e)),e.tag)}}(e)}}}};var In=n(826),Sn=n(170),_n=function(e){return function(t){return function(n){return function(r){var a,o,i=t.getState(),s=n(r),c=t.getState();switch(r.type){case"BEGIN_DRAFTING_SUCCESS":var d=_e.h(c),u=r.payload.draftDetails.sessionConfiguration.draftId;(l=d.drafts[u])&&e.setDeferredActiveEditorFocusCommand(u);break;case"DISPLAY_DRAFT_WARNING":if(r.payload.draftWarningType===Sn.a.CommitFailed)break;var l;d=_e.h(c);(l=Object(Te.H)(d))&&e.setDeferredActiveEditorFocusCommand(l.sessionConfiguration.draftId)}return(null===(a=_e.t(c))||void 0===a?void 0:a.selectedCardId)===(null===(o=_e.t(i))||void 0===o?void 0:o.selectedCardId)&&_e.h(c)===_e.h(i)||e.clearPendingOnComponentFocusedRequest(),s}}}},jn=n(355),Dn=function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":if(!C.G())break;var r=jn.g(e,n.payload.draftWarningType);Object(W.b)(n.payload.draftWarningType===Sn.a.ReturnToDraft?e.formatString(230,r):r)}return t(n)}}}},En=n(1612),An=n(268);var Pn;function xn(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(Pn||(Pn={}));var kn=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var a=t.performanceActivities[e];a&&(a.activity.failTag(n,null!=r?r:-2130957541),xn(a),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var a=t.performanceActivities[e];a&&(xn(a),a.activity.addDataField("Timeout",!0,d.d.SystemMetadata),n.failOnTimeout?a.activity.failTag(r,-2130957491):a.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,a){var o=this;void 0===a&&(a={timeout:5e3,failOnTimeout:!0});var s=r||Object(d.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);s.addDataField("OperationType",n,d.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(d.i)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,i.d.reserveTag(595907678)));var c={activity:s,expectedChangeType:t};c.timerHandle=setTimeout((function(){return o.timeoutTracker(e,a,i.d.reserveTag(575484417))}),a.timeout),this.performanceActivities[e]=c},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(d.i)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,i.d.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var a=n.performanceActivities[r];xn(a),a.activity.failTag(e,null!=t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(xn(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?Pn.Yes:Pn.No,d.d.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];xn(n),n.activity.addDataField("ExpectedChangeArrived",Pn.Unknown,d.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),wn=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(Se.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",d.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(d.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(Se.b)(t);!this.activity||n===this.selectedCommentId&&Object(Se.h)(t)||(this.activity.addDataField("OperationType",e.type,d.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function Rn(e,t){t?e.addDataField("AffectingTaskMetadata",!0,d.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,d.d.SystemMetadata)}function Fn(e,t,n,r){var a=Object(Ee.b)(t,r);if(a){var o=Object(pt.j)(a);if(Object(Ee.c)(t))n[o].some((function(e){return 0!=(t[e].commentFlags&pt.e.IsNew)}));else if(!t.some((function(e){return(e.commentId===o||e.parentId===o)&&0!=(e.commentFlags&pt.e.IsNew)})))return;e.addDataField("CommentIsNew",o,d.d.SystemMetadata)}}var Nn=function(e){var t=new kn(e),n=new wn(e),a=Object(En.a)((function(e){Object(d.i)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent).successTag(573687565)}));return function(e){return function(o){return function(s){var c,u,l=function(){var t,n,r,a,i,c,u=Tn(s);if(!u)return Object(d.i)().assertConditionTag(!1,"Event name not defined for action type: ".concat(s.type),595616738),o(s);var l=Object(d.i)().createActivityObject(u.name,s.actionDetail.telemetryVisitor,u.aggregationMode,u.diagnosticLevel);l.addDataField("Trackback",s.actionDetail.trackback,d.d.SystemMetadata),l.addDataField("RenderContextType",s.actionDetail.renderContextType,d.d.SystemMetadata),u.logDocumentMetadata&&l.addDocumentMetadata(u.logDocumentMetadata);var m=function(e,t,n){l.addDataField("CommentId",n,d.d.SystemMetadata);var r=Object(Te.i)(e,n);r.valid&&(l.addDataField("MatchesCommentAuthor",r.matchesCurrentUser,d.d.SystemMetadata),l.addDataField("ThreadCreationDeltaMs",r.timeElapsed,d.d.SystemMetadata)),Fn(l,e,t,n)},f=e.getState(),p=dn.b(f);switch(Object(ve.c)(f,l),s.type){case"COMMIT_DRAFT":var g=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft".concat(Object(yn.b)(e.payload),"Action"),aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent}}(s);if(!g)return Object(d.i)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),o(s);var C=Object(d.i)().createActivityObject(g.name,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);C.addDataField("RenderContextType",s.actionDetail.renderContextType,d.d.SystemMetadata),C.successTag(595903074);var h=ht.b[s.payload.sessionType];l.addDataField("SessionType",h,d.d.SystemMetadata),"REPLY"===s.payload.sessionType&&Fn(l,_e.d(f),_e.b(f),s.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":l.addDataField("DraftWarningType",s.payload.draftWarningType,d.d.SystemMetadata),l.addDataField("DraftWarningReason",s.payload.draftWarningReason,d.d.SystemMetadata);var b=Object(Te.K)(f.commentState.draftState);b&&(l.addDataField("IsDraftInCurrentContext",b.isInCurrentContext,d.d.SystemMetadata),l.addDataField("DraftId",b.commentDraft.sessionConfiguration.draftId,d.d.SystemMetadata));break;case"UPDATE_DRAFT_RENDER_CONTEXT":l.addDataField("IsClaimingDraftLock",s.payload.isClaimingLock,d.d.SystemMetadata),l.addDataField("IsUpdatingAllDraftLocks",!s.payload.draftId,d.d.SystemMetadata);break;case"SELECT_COMMENT":l.addDataField("SelectType",he.SelectActionType[s.payload.selectType],d.d.SystemMetadata),l.addDataField("ActionSource",be.a[s.payload.source],d.d.SystemMetadata);var v=_e.t(f),y=!(!v||v.selectedCardId!==s.payload.selectedCard);l.addDataField("IsCurrentCard",y,d.d.SystemMetadata),y||Fn(l,_e.d(f),_e.b(f),s.payload.selectedCard),Object(An.b)(s.payload.source)&&Object(An.c)(s.payload.selectType)&&Object(An.d)(l,Object(An.a)(_e.e(f,s.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":Rn(l,s.payload.isTask),m(_e.d(f),_e.b(f),s.payload.commentId);var T=void 0;if(s.payload.isTask){T="REQUEST_THREAD_RESOLVE"===s.type?"ResolveThreadWithTask":"ReopenThreadWithTask",l.addDataField(T,!0,d.d.SystemMetadata,d.e.Critical);var O=null===(r=null===(n=null===(t=p[s.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;l.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,d.d.SystemMetadata,d.e.Critical)}Object(An.d)(l,Object(An.a)(_e.e(f,s.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(Rn(l,s.payload.isTask),s.payload.isTask){l.addDataField("DeleteThreadWithTask",!0,d.d.SystemMetadata,d.e.Critical);O=null===(c=null===(i=null===(a=p[s.payload.commentId])||void 0===a?void 0:a.history[0])||void 0===i?void 0:i.records[0])||void 0===c?void 0:c.time;l.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,d.d.SystemMetadata,d.e.Critical)}Object(An.d)(l,Object(An.a)(_e.e(f,s.payload.commentId))),m(_e.d(f),_e.b(f),s.payload.commentId);break;case"REQUEST_DELETE_POST":m(_e.d(f),_e.b(f),s.payload.commentId)}try{var I=e.getState(),S=o(s),_=e.getState(),j=_e.h(I),D=_e.h(_);switch(s.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var E=s.payload.draftId?j.drafts[s.payload.draftId]:Object(Te.K)(j),A=s.payload.draftId?D.drafts[s.payload.draftId]:Object(Te.K)(D),P=void 0!==E&&void 0!==A&&E.renderContextType!==A.renderContextType;l.addDataField("DidDraftLockUpdate",P,d.d.SystemMetadata)}return l.successTag(595616739),S}catch(e){throw l.failTag(595616768,Object(bn.a)(e,-2130957541)),e}};switch(s.type){case"BEGIN_PROCESSING_COMMIT":var m=Object(d.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);try{l()}catch(e){throw m.failTag(595687567,Object(bn.a)(e,-2130957541)),e}if(!(p=_e.v(e.getState()))){m.failTag(595687569,-2130957541);break}var f=p.commentDraft.sessionConfiguration;t.beginTracking(f.draftId,ht.a[f.sessionType],f.sessionType,m);break;case"COMMIT_FAILURE":var p=_e.v(e.getState());Object(d.i)().assertConditionTag(!!p,"Draft should exist when failing a commit.",595132701),p&&t.failTracker(p.commentDraft.sessionConfiguration.draftId,i.d.reserveTag(595132702)),o(s);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(s.payload.commentId,gt.a.Modify,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.d.reserveTag(595907670),Object(bn.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(s.payload.commentId,gt.a.Delete,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.d.reserveTag(595907671),Object(bn.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{o(s)}catch(e){throw t.failAllTrackers(i.d.reserveTag(595731294),Object(bn.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===s.type?s.payload.commentData:s.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",gt.a.Load)){m=Object(d.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",gt.a.Load,s.type,m,{timeout:1e6,failOnTimeout:!1})}o(s);break;case"RELOAD_COMMENTS":try{l()}catch(e){throw t.failAllTrackers(i.d.reserveTag(595907672),Object(bn.a)(e,-2130957541)),e}t.endAllTrackers(i.d.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var g=t.getTracker("LoadCommentTracker",gt.a.Load);g&&(s.payload.commentId&&g.activity.addDataField("AssociatedCommentId",s.payload.commentId,d.d.SystemMetadata),g.activity.addDataField("RenderContextType",s.payload.renderContextType,d.d.SystemMetadata),t.endTracker("LoadCommentTracker",gt.a.Load,i.d.reserveTag(595646476))),o(s);break;case"APPLY_COMMENT_CHANGES":try{l()}catch(e){throw t.failAllTrackers(i.d.reserveTag(595907674),Object(bn.a)(e,-2130957541)),e}try{for(var C=Object(r.__values)(s.payload.changes),h=C.next();!h.done;h=C.next()){var b=h.value;if(b.type===gt.a.Load||b.type===gt.a.Unknown)break;if(b.type!==gt.a.Delete&&b.type!==gt.a.Modify){if(b.type===gt.a.Insert){void 0!==b.tempId&&""===b.model.parentId&&Object(Ot.a)(b.tempId,b.model.commentId,s.actionDetail.telemetryVisitor);var v=b.tempId||b.model.parentId;void 0!==v&&t.endTracker(v,b.type,i.d.reserveTag(595857620))}}else t.endTracker(b.model.commentId,b.type,i.d.reserveTag(595907675))}}catch(e){c={error:e}}finally{try{h&&!h.done&&(u=C.return)&&u.call(C)}finally{if(c)throw c.error}}break;case"COMMIT_DRAFT":p=_e.v(e.getState());if(l(),s.payload.data.temporaryCommentId&&p){var y=void 0;switch((f=p.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e,t,n){Object(Ot.a)(e,t,n)}(f.draftId,s.payload.data.temporaryCommentId,s.actionDetail.telemetryVisitor),y=s.payload.data.temporaryCommentId;break;case"REPLY":y=s.payload.data.temporaryCommentId;break;case"EDIT":y=f.commentId;break;case"METADATA":y=f.threadId;break;default:Object(i.m)(f)}y&&t.updateTrackerId(f.draftId,y)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"CLEAR_COMMENT_SELECTION":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":l();break;case"SHOW_LOW_FIDELITY_WARNING":l();var T=_e.t(e.getState());T&&n.beginTracking(T);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var O="";switch(s.payload.visibilityState){case B.a.Closed:O="ViewContainerClosed";break;case B.a.Hidden:O="ViewContainerHidden";break;case B.a.Visible:O="ViewContainerVisible";break;default:Object(i.m)(s.payload.visibilityState)}var I=Object(d.i)().createActivityObject(O,s.actionDetail.telemetryVisitor,d.a.Always,d.b.NecessaryServiceDataEvent);o(s),I.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var S=_e.h(e.getState()).drafts[s.payload.draftId].commentDraft.sessionConfiguration.sessionType;S!==pt.c&&S!==pt.h||a(s),o(s);break;default:o(s)}var _=_e.t(e.getState());_&&n.endTrackingIfWarningDismissed(s,_)}}}},Mn=n(592),Ln=n(369),Vn=n(374),Bn=n(414),Un=function(e,t){return function(e){return function(n){return function(r){switch(r.type){case"REQUEST_SHOW_PANE":(o=De.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(o=De.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(C.l()?!cn.b(e.getState()):!C.ib())(o=De.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(o=De.d(e.getState())).invokeModalConfirmationDialog?o.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):(Object(d.i)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),o.closeView());break;case"READY_TO_RENDER":(o=De.d(e.getState())).onReadyToRender&&o.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(C.w()){var a=r.payload.capability===Mn.a.Enabled;t.initializeController(a)}break;case"BEGIN_DRAFTING_SUCCESS":var o=De.d(e.getState());Object(Ln.a)(o)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&Gn(e.dispatch,r.actionDetail,{displayMode:ge.a.Variable,desiredHeight:0}),Hn(e.getState(),o);break;case"DISPLAY_DRAFT_WARNING":Hn(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard){o=De.d(e.getState());return n(r),void o.closeView()}break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(C.s()&&"ios"===Object(Re.a)()&&r.payload.visibilityState===B.a.Closed){var s=_e.h(e.getState());Object(Ie.c)(s)&&(c=e.dispatch,u=r.actionDetail,c(Object(Vn.a)(u,be.a.SharedComments,!0)).catch(Object(S.a)(i.d.reserveTag(546104259))))}}var c,u,l=e.getState(),m=n(r),f=e.getState();return function(e,t,n,r){var a=De.d(r);if(!Object(Ln.a)(a))return;var o=_e.h(r),i=_e.h(n),s=Object(Ie.c)(o),c=Object(Ie.c)(i),d=!!Object(Te.G)(o),u=!!Object(Te.G)(i);if(s!==c||!Object(Ln.a)(De.d(n))||!d&&u){if(!s)return d?void Gn(e,t,{displayMode:ge.a.Variable,desiredHeight:0}):void Gn(e,t,{displayMode:ge.a.Normal});var l=_e.t(r);if(l&&l.selectedCardId===Object(Te.G)(o))return;Gn(e,t,{displayMode:ge.a.FullScreen})}}(e.dispatch,r.actionDetail,l,f),m}}}};function Hn(e,t){(function(e){var t=De.e(e);return C.s()&&(C.o()?t===B.a.Hidden:t!==B.a.Visible)})(e)&&(t||De.d(e)).openView()}function Gn(e,t,n){e(Object(Bn.a)(t,n)).catch(Object(S.a)(i.d.reserveTag(578426776)))}var Wn=n(226),qn=n(368),zn=n(136),Yn=n(171),Kn=n(132),Xn=n(101),Qn=n(99),Zn=function(){function e(e,t,n){this.commentStore=e,this.commandFactory=new it(this.commentStore,t,n)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var r=C.o()&&!De.a(this.commentStore.getState()),a=De.c(this.commentStore.getState());return Ue(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,r),a,this.commentStore,(function(){}))===ae.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=De.c(this.commentStore.getState()),r=_e.f(this.commentStore.getState()),a=C.o()&&!De.a(this.commentStore.getState());Ue(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,r.nextPopulatedContextDetails,a),n,this.commentStore,(function(){}))},e}(),Jn=n(827),$n=n(457),er={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function tr(e){var t=e.itemCount,n=e.readOnly,r=e.isTask,a=er.PostHeight;return t>1&&(a+=er.PostHeight+0),t>2&&(a+=er.ExpandButtonHeight+0),n||(a+=er.ReplyDraftHeight+0),r&&(a+=er.TaskTopper),a}function nr(e,t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(a,n),a.prototype.render=function(){var n=Object(r.__assign)(Object(r.__assign)({},t),this.props);return T.createElement(e,n)},a}(T.PureComponent)}var rr=n(432);function ar(e,t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(a,n),a.prototype.render=function(){return T.createElement(rr.a,{store:t},T.createElement(e,Object(r.__assign)({},this.props)))},a}(T.PureComponent)}var or,ir=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,Object(r.__spreadArray)([],Object(r.__read)(e),!1)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=Object(r.__values)(this.eventQueue),a=n.next();!a.done;a=n.next()){var o=a.value;this.handler.apply(this,Object(r.__spreadArray)([],Object(r.__read)(o),!1))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}(),sr=n(81);!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(or||(or={}));var cr,dr=n(518),ur=n(161),lr=n(213),mr=n(939),fr=n(331),pr=(i.d.reserveTag(595723983),i.d.reserveTag(595723984),i.d.reserveTag(574456150)),gr=i.d.reserveTag(574456151),Cr=i.d.reserveTag(574456152),hr=i.d.reserveTag(574456153),br=n(692),vr=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),yr=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(cr||(cr={}));var Tr=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),Or=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=cr.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(e){return De.a(e)?De.c(e):n.viewManager.getComponentTreeForRenderMode(l.e.Integrated)},this.makeGetRenderableItemThreads=function(e){return Object(sr.a)([_e.h,_e.g,_e.c,e,n.getActiveComponentTree],(function(e,t,n,r,a){return nt.c(r,n,t,a.componentTreeId.renderContextType!==ke.a.HalfPane,Object(mr.a)(e,a.componentTreeId.renderContextType))}))},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getHostableCommentCardRendererProps(l.e.Integrated)),{resource:{id:e},componentInstanceId:Object(s.a)()})},this.getCompletePaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return De.a(t)?Object(dr.b)(r,n.getCompletePaneOwnProps()):Object(dr.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){return Object(Te.G)(_e.h(n.commentStore.getState()),!0)},this.getParentId=function(e){var t=n.commentStore.getState(),r=_e.d(t),o=Object(Ee.b)(r,e);return o?Object(a.h)(o):void 0},this.invokeModalDialog=function(e,t,r){var a=n.commentStore.getState(),o={renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,trackback:i.d.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},s=n.commentStore.dispatch,c=n.getCompletePaneOwnProps(),d=Object(dr.b)(s,c),u=_e.t(a);switch(e){case ur.a.CancelNewDraft:case ur.a.CancelReplyDraft:case ur.a.CancelPostEdit:return d.discardDraftAsync(o,be.a.SharedComments,!1);case ur.a.DeleteThread:return u&&d.requestDeleteThread(o,u.selectedCardId),Promise.resolve(Kn.a.Handled);case ur.a.ClosePaneDraft:return lr.p({ownProps:c,dispatchProps:d,componentTree:n.getActiveComponentTree(a),draftState:_e.h(a),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(Kn.a.Handled);default:Object(i.m)(e)}},this.updateEventProcessingState=function(e){var t=_e.q(n.previousStoreState),r=_e.q(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=_e.h(e),r=_e.h(n.previousStoreState);!Object(Ie.d)(t)&&n.pendingActionReason===cr.NeedNotDrafting&&n.pendingAction&&(Object(d.i)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=cr.None);var a=Object(Ie.b)(t),o=Object(Ie.b)(r);a&&!o&&n.pendingActionReason===cr.NeedDrafting&&n.pendingAction&&(Object(d.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=cr.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(d.i)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);Object(Ie.b)(_e.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,d.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,d.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=cr.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(d.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);Object(Ie.d)(_e.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,d.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=cr.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,d.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case cr.NeedDrafting:return n.onDrafting(t);case cr.NeedNotDrafting:return n.onNotDrafting(t);case cr.None:return t()}},this.onMockUIAction=new ir((function(e){var t=Object(d.i)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,d.d.SystemMetadata);try{switch(e.actionType){case or.CreateThread:!function(e){return e.actionType===or.CreateThread&&void 0!==e.content}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction(cr.NeedDrafting,(function(){return n.onCreateOrReply(new vr(n.getNewThreadDraftId(),e.content))}));break;case or.CancelCreateThread:!function(e){return e.actionType===or.CancelCreateThread}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction(cr.NeedDrafting,(function(){return n.onCancelCreateThread(new vr(n.getNewThreadDraftId()))}));break;case or.StartReplySession:!function(e){return e.actionType===or.StartReplySession&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction(cr.NeedNotDrafting,(function(){return n.onStartReplySession(new vr(e.threadId))}));break;case or.CancelReplySession:!function(e){return e.actionType===or.CancelReplySession&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction(cr.NeedDrafting,(function(){return n.onCancelReplySession(new vr(e.threadId))}));break;case or.PostReply:!function(e){return e.actionType===or.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction(cr.NeedDrafting,(function(){return n.onCreateOrReply(new vr(e.threadId,e.content))}));break;case or.DeleteComment:!function(e){return e.actionType===or.DeleteComment&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction(cr.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case or.DeleteThread:!function(e){return e.actionType===or.DeleteThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction(cr.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case or.ResolveThread:!function(e){return e.actionType===or.ResolveThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction(cr.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case or.ReopenThread:!function(e){return e.actionType===or.ReopenThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction(cr.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case or.StartEditSession:!function(e){return e.actionType===or.StartEditSession&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction(cr.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case or.CancelEditSession:!function(e){return e.actionType===or.CancelEditSession&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction(cr.NeedDrafting,(function(){return n.onCancelEditSession(new yr(e.commentId))}));break;case or.PostEdit:if(function(e){return e.actionType===or.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var r=new yr(e.commentId);r.setContents(e.content),n.runAction(cr.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case or.SelectComment:!function(e){return e.actionType===or.SelectComment&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction(cr.NeedNotDrafting,(function(){return n.onSelectComment(new Tr(e.commentId))}));break;case or.ClosePane:n.onClosePane();break;case or.ClickGhostCard:!function(e){return e.actionType===or.ClickGhostCard}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction(cr.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:Object(i.m)(e.actionType)}}catch(e){return void t.failTag(592269507,Object(bn.a)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();lr.E({trackback:i.d.reserveTag(592269509),id:e,data:n.getFilteredRenderableItems(t),selectedComment:_e.t(t),renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){var r=n.commentStore.getState();lr.m({componentTree:n.getActiveComponentTree(r),focusManager:n.viewManager.getFocusManager(),trackback:i.d.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree(r).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(De.b(e)){var t=n.commentStore.dispatch;Object(dr.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:ke.a.None,trackback:i.d.reserveTag(592269511)})}else Object(d.i)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),o=_e.h(r),s=Object(Te.K)(o),c=s&&"CREATE"===s.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};lr.c({trackback:i.d.reserveTag(592269513),commentCardRef:e,draftState:o,areMentionsEnabled:_e.p(r).atMention===a.b.Enabled,session:c,componentTree:n.getActiveComponentTree(r),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:br.a.Programmatic}).catch(Object(S.a)(i.d.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),a=n.commentStore.getState(),o=_e.t(a),s=_e.h(a),c=De.b(a),d=n.getActiveComponentTree(a).componentTreeId.renderContextType,u=_e.u(a),l=(null==o?void 0:o.selectedCardId)===e.getId()&&Object(fr.b)(c,d,s,o,u),m=nt.f(n.getRenderableItemThreads(a),t);lr.e({trackback:i.d.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(a),dispatchProps:r,closeOnDiscard:l,cardId:t,draftState:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:m})},this.onGhostCommentClicked=function(){var e=n.commentStore.getState();De.b(e)||Object(d.i)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(E.d.Next,n.getActiveComponentTree(e).componentTreeId.renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getParentId(e.getId());r&&lr.C({trackback:i.d.reserveTag(592269518),id:e.getId(),data:n.getFilteredRenderableItems(t),draftState:_e.h(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:_e.p(t).atMention===a.b.Enabled,componentTree:n.getActiveComponentTree(t),actionDispatchers:n.getDispatchProps(r),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:br.a.Programmatic}).catch(Object(S.a)(i.d.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=_e.h(t),a=_e.t(t),o=De.b(t),s=_e.u(t),c=Object(fr.b)(o,n.getActiveComponentTree(t).componentTreeId.renderContextType,r,a,s),d=n.getFilteredRenderableItems(t),u=n.getParentId(e.getId());if(u){var l=n.getDispatchProps(u);lr.z({trackback:i.d.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:d,draftState:r,shouldClosePaneAfterDiscardDraft:c,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=_e.t(t),a=_e.h(t),o=e.getId(),s=n.getDispatchProps(o),c=De.b(t),d=n.getActiveComponentTree(t).componentTreeId.renderContextType,u=_e.u(n.commentStore.getState()),l=(null==r?void 0:r.selectedCardId)===e.getId()&&Object(fr.b)(c,d,a,r,u);lr.e({trackback:i.d.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(t),dispatchProps:s,closeOnDiscard:l,cardId:e.getId(),draftState:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=_e.t(t),a=n.getDispatchProps(e);lr.d({trackback:i.d.reserveTag(592269523),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(t),invokeModalDialog:n.invokeModalDialog,dispatchProps:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!dn.b(t)[e],threadIndex:nt.f(n.getRenderableItemThreads(t),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=_e.t(t),a=n.getParentId(e);if(a){var o=n.getDispatchProps(a);lr.D({trackback:i.d.reserveTag(592269524),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(e){var t,r=n.commentStore.getState(),a=_e.g(r,!0),o=n.getNewThreadDraftId(),s=n.getFilteredRenderableItems(r),c=e.getId(),u=C.kb()||c!==o?s.find((function(e){return nt.e(e)===c})):a&&{commentModel:a.newComment_deprecated};if(u&&Object(at.a)(u)){var l=u,m=n.getDispatchProps(null!==(t=l.commentModel.parentId)&&void 0!==t?t:l.commentModel.commentId),f=_e.t(r),p=_e.h(r),g=n.getActiveComponentTree(r),h=Object(we.a)(nt.i(u),_e.j(r),g.componentTreeId.renderContextType);lr.J({trackback:i.d.reserveTag(592269526),renderableItem:u,selectedComment:f,cardCollapsedState:h,dispatchProps:m,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:g,draftState_deprecated:p}).catch(Object(S.a)(i.d.reserveTag(590123734)))}else Object(d.i)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){lr.a({trackback:i.d.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=_e.y(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var e=Object(d.i)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(Cr)},e.prototype.teardown=function(){var e,t=Object(d.i)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(hr)},e.prototype.beginProcessing=function(){var e=this,t=Object(d.i)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(pr)}),100)},e.prototype.pauseProcessing=function(){var e=Object(d.i)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(gr)},e.prototype.onReopenThread=function(e,t){lr.l({trackback:i.d.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),Ir=n(613);var Sr=n(595);function _r(e,t,n,r){return function(a){return Object(l.f)().registerExtension(t,n,r).then((function(t){return a(Object(Sr.a)(e,t)),t}))}}var jr=n(512);var Dr,Er=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),Ar=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(r.__extends)(t,e),t}(function(){function e(e){var t=this,n=e.apiContext,r=e.viewProvider,a=e.commentAPI,o=e.peopleAPI,c=e.localizationAPI,u=e.themeAPI,m=e.focusManager,f=e.lppManager,p=e.initializationReason,g=e.commentStore,h=e.viewStrategyFactory,b=e.mockUIDriver,v=e.contentFilteredRangeAPI,y=e.contentNavigationAPI;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(he.onInitialRender({renderContextType:ke.a.None,trackback:i.d.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(Fe.b)(e.renderContextType)&&t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(En.a)((function(){P.sendCodeMarker({context:t.apiContext,type:j.DataReceived,assertTag:i.d.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case ke.a.None:Object(i.n)(!1,"Unexpected render context type:".concat(e),i.d.reserveTag(589088338));case ke.a.FullPane:case ke.a.HalfPane:return t.getComponentTreeForRenderMode(l.e.TaskPaneItem);case ke.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(l.e.Integrated);case ke.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(l.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor,onInitialRender:t.onInitialRender,correlationId:t.correlationId,lppManager:t.lppManager}},this.setComponentRef=function(e,n,r){t.viewManagerRefRegistry.registerComponent(e,n,r)},this.onSuggestionsDetailsChange=function(e){t.commentStore.dispatch(he.updateSuggestionsDetails({renderContextType:ke.a.None,trackback:i.d.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.createOrUpdateFilter=function(e){var n=t.contentFilteredRangeAPI;if(n&&Object(je.g)(t.commentStore.getState())){var r=je.h(t.commentStore.getState());if(Object(d.i)().assertConditionTag(r||!!Object(je.e)(t.commentStore.getState()),"We should have a default filter already or a default filter request should be in flight.",528779339),!r){var a=Object(ve.a)(t.commentStore.getState());a?t.updateFilter(a,e):t.createFilter(n,e)}}else Object(d.i)().assertConditionTag(!1,"Should not request new filter with gate off",528779338)},this.updateFilter=function(e,n){t.commentStore.dispatch(he.updateFilterRange({renderContextType:ke.a.FullPane,telemetryVisitor:t.telemetryVisitor,trackback:i.d.reserveTag(528779344)},{filterId:e,changes:[{type:"FilterUpdate",updatedFilter:n}]}))},this.createFilter=function(e,n){e.createFilteredRange({contentTypes:[l.b.CommentThread],filters:n,supportsFilterUpdates:!0}).then((function(e){t.commentStore.dispatch(he.loadFilter({renderContextType:ke.a.FullPane,telemetryVisitor:t.telemetryVisitor,trackback:i.d.reserveTag(528779340)},{filteredRange:e,shouldSetActive:!0}))})).catch(Object(S.a)(i.d.reserveTag(528779341)))},this.apiContext=n,this.viewProvider=r,this.commentAPI=a,this.peopleAPI=o,this.localizationAPI=c,this.themeAPI=u,this.focusManager=m,this.contentFilteredRangeAPI=v,this.contentNavigationAPI=y,this.lastInitializationReason=p,this.viewStrategyFactory=h,this.mockUIDriver=b,this.telemetryVisitor=V.getTelemetryVisitor(this.apiContext),this.correlationId=V.getCorrelationId(this.apiContext)||Object(s.a)(),this.lppManager=f,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new Zn(g,this.telemetryVisitor,!!this.contentNavigationAPI);var T=g.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(T.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=g,this.discreteIntegratedComponentTree=new Gt(ke.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new Gt(ke.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Er,C.p()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new Or(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:ke.a.None,trackback:i.d.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,function(n){var r=Object(d.i)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then((function(t){r.addDataField("AtMentionsEnabled",t,d.d.SystemMetadata),r.successTag(595903522),n(Object(jr.a)(e,t?pt.b.Enabled:pt.b.Disabled))}),(function(t){r.failTag(595903523,Object(bn.a)(t,-2130957528)),n(Object(jr.a)(e,pt.b.Disabled))}))})).catch(Object(S.a)(i.d.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t,n,r=this;this.initialized||(this.contentNavigationAPI&&(C.l()&&this.commentStore.dispatch(he.setContentNavigationEnablement({renderContextType:ke.a.None,trackback:i.d.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),null===(e=this.contentFilteredRangeAPI)||void 0===e||e.getCapabilities().then((function(e){r.commentStore.dispatch(he.setFilteringCapabilities({renderContextType:ke.a.None,trackback:i.d.reserveTag(537421135),telemetryVisitor:r.telemetryVisitor},{capabilities:e}))})).catch(Object(S.a)(i.d.reserveTag(528779335)))),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),C.o()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),C.o()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&Wn.b.GetSuggestionsDetails&&(this.commentStore.dispatch((t={renderContextType:ke.a.None,trackback:i.d.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},n=this.peopleAPI,function(e){if(!(n.capabilities&Wn.b.GetSuggestionsDetails))return Promise.resolve();var r=Object(d.i)().createActivityObject("RefreshSuggestionsDetails",t.telemetryVisitor,d.a.OnSuccess,d.b.NecessaryServiceDataEvent);return n.getSuggestionsDetails?n.getSuggestionsDetails().then((function(n){r.successTag(592492760),e(Object(Ir.a)(t,n))}),(function(e){r.failTag(592492761,-2130957495)})):(r.failTag(592492759,-2130957494),Promise.resolve())})).catch(Object(S.a)(i.d.reserveTag(592492754))),Object(d.i)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===_e.q(e)&&_e.l(e)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState();if(C.p()){var a=_e.q(r);a!==t&&(t=a,n.onChange(r))}}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(d.i)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Yn.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Yn.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yn.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yn.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yn.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Yn.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case l.e.Integrated:return this.discreteIntegratedComponentTree;case l.e.Isolated:return this.discreteIsolatedComponentTree;case l.e.TaskPane:case l.e.TaskPaneItem:return De.c(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var a=this,o=ar(nr(n.HostableCommentCardRendererContainer,Object(r.__assign)({},this.getHostableCommentCardRendererProps(e))),this.commentStore),i=_(t,this.apiContext),s=Object(y.c)().registerComponent(i,o);return s.onComponentCommand.subscribe((function(t){a.processHostableComponentCommand(t,e)})),{componentController:s,contextAwareName:i}},e.prototype.initializeContentExtensions=function(){var e=this;Object(Z.d)("ExtensionAwareCommentPaneContainer").then((function(t){var n;if(void 0!==t){var a=ar(nr(t.ExtensionAwareCommentPane,Object(r.__assign)(Object(r.__assign)({},e.getPaneOwnProps()),{extensionRenderMode:l.e.Integrated,themeAPI:e.themeAPI})),e.commentStore),o=_("SharedCommentPane",e.apiContext);e.commentPaneComponentController=Object(y.c)().registerComponent(o,a),C.P()&&e.commentStore.dispatch(_r({renderContextType:ke.a.None,trackback:i.d.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,o,{renderMode:l.e.TaskPane,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch(Object(S.a)(i.d.reserveTag(573384479)))}Object(Z.d)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var r=e.registerCommentCardHostableComponent(l.e.Integrated,"DiscreteIntegratedCommentCard",n),a=r.componentController,o=r.contextAwareName;e.discreteIntegratedComponentController=a;var s=e.registerCommentCardHostableComponent(l.e.Isolated,"DiscreteIsolatedCommentCard",n),c=s.componentController,d=s.contextAwareName;e.discreteIsolatedComponentController=c;var u=e.registerCommentCardHostableComponent(l.e.TaskPaneItem,"TaskPaneItemCommentCard",n),m=u.componentController,f=u.contextAwareName;e.commentPaneItemComponentController=m,e.commentStore.dispatch(_r({renderContextType:ke.a.None,trackback:i.d.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,o,{renderMode:l.e.Integrated,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(S.a)(i.d.reserveTag(595645980))),e.commentStore.dispatch(_r({renderContextType:ke.a.None,trackback:i.d.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,d,{renderMode:l.e.Isolated,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),r=Object($n.d)(t,_e.a(n),_e.c(n)),a=_e.h(n);return Object($n.a)(t,Object($n.c)(t,_e.d(n),_e.b(n),r,_e.g(n,!0),a.drafts[t],Object(Te.G)(a)),a,ke.a.DiscreteIsolated,Object(Jn.a)(t,ke.a.DiscreteIsolated,a))}})).catch(Object(S.a)(i.d.reserveTag(595645982))),e.commentStore.dispatch(_r({renderContextType:ke.a.None,trackback:i.d.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,f,{renderMode:l.e.TaskPaneItem,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(S.a)(i.d.reserveTag(546174345)))}})).catch(Object(S.a)(i.d.reserveTag(595645984)))})).catch(Object(S.a)(i.d.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:tr({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void Object(d.i)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,a,o=[l.e.Integrated,l.e.Isolated,l.e.TaskPaneItem];C.P()&&o.push(l.e.TaskPane),this.commentStore.dispatch(he.removeContentExtensions.apply(he,Object(r.__spreadArray)([{renderContextType:ke.a.None,trackback:i.d.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],Object(r.__read)(o),!1))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(a=this.discreteIsolatedComponentController)||void 0===a||a.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Yn.a.AddComment),this.commentAPI.unregisterForAction(Yn.a.NextThread),this.commentAPI.unregisterForAction(Yn.a.PreviousThread),this.commentAPI.unregisterForAction(Yn.a.DeleteThread),this.commentAPI.unregisterForAction(Yn.a.BackKeyPressed),this.commentAPI.unregisterForAction(Yn.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&Wn.b.GetSuggestionsDetails&&(Object(d.i)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),C.o()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(C.o()&&e.actionBehavior===qn.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var a=Object(r.__values)(this.commentUIActionListeners),o=a.next();!o.done;o=a.next()){var i=(0,o.value)(e);if(i!==Xn.a.NotHandled)return i===Xn.a.Success}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===Xn.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(i.k)(i.b.Comments,zn.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),C.o()&&!this.initialLoadComplete&&e===zn.a.CommentContextChanged&&Qn.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(Kn.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==Kn.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case U.a.VisibilityChanged:return void n(he.viewContainerVisibilityChanged({renderContextType:ke.a.None,trackback:i.d.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case U.a.ViewContainerChanged:return n(he.viewContainerChanged({renderContextType:ke.a.None,trackback:i.d.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case U.a.FocusTriggered:return void(C.P()?setTimeout((function(){t.focusManager.focusCommentPaneCommand(De.c(t.commentStore.getState()))})):this.focusManager.focusCommentPaneCommand(De.c(this.commentStore.getState())));case U.a.FoldableLayoutStateChanged:n(he.viewContainerFoldableLayoutStateChanged({renderContextType:ke.a.None,trackback:i.d.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),Pr=function(){function e(e,t,n){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.ensureLPPController=function(){throw new Error("ensureLPPController not supported in Web")},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}(),xr=n(734),kr=function(){function e(){this.maxAcceptableInterval=3e3,this.lastHeartbeatReceived=0,this.timerStarted=!1}return e.prototype.heartbeatReceived=function(){var e,t,n=this;this.lastHeartbeatReceived=Date.now(),null===(t=(e=Object(d.i)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(fe.a)(Dr||(Dr=Object(r.__makeTemplateObject)(["Native HeartbeatReceived"],["Native HeartbeatReceived"]))),i.d.reserveTag(540361865),d.h.Info,d.c.ProductServiceUsage,Object(d.j)(d.g.ReviewedAsNotNecessary),Object(d.l)("HeartbeatTimestamp",this.lastHeartbeatReceived,d.d.SystemMetadata)),this.timerStarted||(this.timerStarted=!0,setInterval((function(){n.checkHeartbeatInterval()}),this.maxAcceptableInterval))},e.prototype.checkHeartbeatInterval=function(){var e=Date.now()-this.lastHeartbeatReceived;e>this.maxAcceptableInterval&&Object(d.i)().assertConditionTag(!1,"Max heartbeat interval exceeded: ".concat(e),561071552)},e}(),wr=n(177),Rr=n(337),Fr=n(409),Nr=n(338),Mr=n(363),Lr=n(235);function Vr(e){return function(e){var t=C.o()&&!De.b(e);return _e.f(e).nextPopulatedContextDetails!==Je.a.NoComments||Object(Te.d)(t?_e.a(e):_e.k(e),_e.d(e),t)}(e)&&Br(_e.h(e))}function Br(e){return C.G()||!Object(Ie.d)(e)}var Ur=function(){function e(e,t,n,r,a){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=a}return e.prototype.processCommentEvent=function(e,t,n,r){var a,o=r();switch(e){case zn.a.CommentContextChanged:if(!Qn.b(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(he.commentContextChanged({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case zn.a.CommentsChanged:if(!Qn.h(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case zn.a.LoadComments:if(!Qn.i(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case zn.a.CommentSelected:if(!Qn.g(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var s=void 0;if(void 0!==_e.c(o)[t.commentId])s=Object(Nr.a)(t.commentId,be.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===E.c.Keyboarding?he.SelectActionType.SelectCard:he.SelectActionType.ExpandCard});else{var c=Object(Ee.b)(_e.d(o),t.commentId);if(void 0===c)return;s=Object(Nr.a)(c.parentId,be.a.Canvas,{selectType:he.SelectActionType.SelectPost,selectedPost:t.commentId})}n(Object(Nr.b)(void 0,{renderContextType:ke.a.None,trackback:i.d.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},s,!1)).catch(Object(S.a)(i.d.reserveTag(579744150)))}else n(he.clearCommentSelection({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case zn.a.CommentContextReload:if(!Qn.d(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case zn.a.CommentHighlighted:if(!Qn.f(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(he.highlightComment({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,be.a.Canvas)):n(he.clearCommentHighlight({renderContextType:ke.a.None,trackback:i.d.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},be.a.Canvas,void 0));break;case zn.a.NextPopulatedContextDetailsUpdated:if(!Qn.k(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(he.nextPopulatedContextDetailsUpdated({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case zn.a.ModelCapabilitiesChanged:Qn.j(t)?n(he.updateModelCapabilities({renderContextType:ke.a.None,trackback:i.d.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case zn.a.CommentError:if(!Qn.e(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case zn.a.ReturnToDraftRequested:Qn.l(t)&&n(he.displayDraftWarning({draftWarningType:Sn.a.ReturnToDraft,draftWarningReason:Lr.a.HostRequest},{renderContextType:ke.a.None,trackback:i.d.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case zn.a.UpdateDraftThread:Qn.n(t)?n(he.updateDraftThread({renderContextType:ke.a.None,trackback:i.d.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case zn.a.SmartReplyPopulated:if(!Qn.m(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(he.populateSmartReply({renderContextType:ke.a.None,trackback:i.d.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;case zn.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new kr),null===(a=this.heartbeatHelper)||void 0===a||a.heartbeatReceived();break;default:return void Object(d.i)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var a,o=this,s=n();switch(e.actionType){case Yn.a.ShowHideCommentPane:return Xn.c(e.actionBehavior)?De.b(s)?Xn.a.Success:Xn.a.Fail:(Xn.d(e.actionBehavior)&&(De.b(s)?t(he.requestClosePane({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(he.requestShowPane({renderContextType:ke.a.None,trackback:i.d.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),Xn.a.Success);case Yn.a.AddComment:if(Xn.b(e.actionBehavior)){if(a=_e.h(s),!C.G()&&(Object(Ie.d)(a)||a.committedLieId))return Xn.a.Fail}else if(Xn.d(e.actionBehavior)){var c={renderContextType:ke.a.None,trackback:i.d.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(Rr.a)(c,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(S.a)(i.d.reserveTag(592314376))),Xn.a.Success}return Xn.a.Success;case Yn.a.NextThread:if(Object(d.i)().assertConditionTag(!Xn.c(e.actionBehavior),"This action type does not support toggled status",595899713),Xn.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:E.d.Next,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:[l.b.CommentThread]},E.c.HostAction,ke.a.None)}),t,C.lb()?void 0:Lr.a.NextThread,i.d.reserveTag(591729749));else if(Xn.b(e.actionBehavior))return Vr(s)?Xn.a.Success:Xn.a.Fail;return Xn.a.Success;case Yn.a.PreviousThread:if(Object(d.i)().assertConditionTag(!Xn.c(e.actionBehavior),"This action type does not support toggled status",595899714),Xn.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:E.d.Previous,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:[l.b.CommentThread]},E.c.HostAction,ke.a.None)}),t,C.lb()?void 0:Lr.a.PreviousThread,i.d.reserveTag(591729750));else if(Xn.b(e.actionBehavior))return Vr(s)?Xn.a.Success:Xn.a.Fail;return Xn.a.Success;case Yn.a.DeleteThread:if(Object(d.i)().assertConditionTag(!Xn.c(e.actionBehavior),"This action type does not support toggled status",595899715),Xn.b(e.actionBehavior)){if(!function(e){return!!e.selectedComment&&Br(e.draftState)}(s.commentState))return Xn.a.Fail}else Xn.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=_e.t(s);e&&t(he.requestDeleteThread({renderContextType:ke.a.None,trackback:i.d.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,Lr.a.DeleteThread,i.d.reserveTag(591729751));return Xn.a.Success}return Xn.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,r){return e(Object(Rr.a)({renderContextType:ke.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(S.a)(r)).then((function(){return a.e.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},i.d.reserveTag(574371082),i.d.reserveTag(574371083));case"EditComment":var r,o=n(),s=_e.t(o);r=Object(nt.l)(Object($n.b)(e.commentId,_e.d(o),_e.b(o)),void 0);var c=Object(nt.b)(r,e.commentId);return c?Object(lr.K)({comment:c,threads:r,selectedComment:s,warningType:Se.a.Edit})?(t(he.showLowFidelityWarning({renderContextType:ke.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(593000206)},e.commentId,Se.a.Edit)),Promise.resolve(a.e.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},i.d.reserveTag(593000207),i.d.reserveTag(593000208)):(Object(d.i)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(a.e.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},i.d.reserveTag(593000209),i.d.reserveTag(593000210));case"DiscardDraft":var u=n();if(e.mode===xr.a.TryAutoDiscard)return t(Object(Fr.a)({renderContextType:ke.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(575411521)},be.a.Canvas)).then((function(e){return e.draftDiscardResult}));s=_e.t(u);if(e.mode===xr.a.Dialog&&Object(Mr.a)(_e.h(u))===wr.a.CannotAutoDiscard)return De.a(u)?Promise.resolve(a.e.Unhandled):Promise.resolve(a.e.Canceled);var l=Object(fr.b)(De.e(u)===B.a.Visible,Object(vt.a)(De.d(u).containerType),_e.h(u),s,_e.u(u));return t(Object(Vn.a)({renderContextType:ke.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(575411522)},be.a.Canvas,l,void 0));default:return Promise.resolve(a.e.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,r){t(Object(Fr.a)({renderContextType:ke.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},be.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==wr.a.NoDraft&&t.draftDiscardResult!==a.e.Handled||e()})).catch(Object(S.a)(i.d.reserveTag(591738704)))},e}(),Hr=n(602),Gr=n(603),Wr=n(605),qr=n(113),zr=n(611),Yr=n(612);function Kr(e,t,n,r){return function(a,o){var s=o();r&&a(r);var c=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&a(Object(zr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){var d=_e.t(s);if(n.selectedCommentId)if(d&&d.selectedCardId===n.selectedCommentId)if(Object(Se.j)(d.selectionDetails)){var u=d.selectionDetails.selectedPostId,l=o();Object(Ee.b)(_e.d(l),u)?a(Object(qr.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953698)},n.selectedCommentId,u,qr.a.SelectPost,be.a.Canvas)):a(Object(qr.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953699)},n.selectedCommentId,void 0,qr.a.ExpandCard,be.a.Canvas))}else a(Object(qr.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953697)},n.selectedCommentId,void 0,qr.a.SelectCard,be.a.Canvas));else a(Object(qr.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953728)},n.selectedCommentId,void 0,qr.a.ExpandCard,be.a.Canvas));else if(d){var m=_e.h(s),f=m.cardIdToDraftIdMap[d.selectedCardId];f&&"CREATE"===m.drafts[f].commentDraft.sessionConfiguration.sessionType||a(Object(Gr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953729)}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?a(Object(Wr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953730)},n.highlightedCommentId,be.a.Canvas)):a(Object(Hr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(578586722)},be.a.Canvas,void 0)));var p=Nt(n);p&&a(Object(Yr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953732)},p))}}}var Xr=n(19),Qr=n(375);var Zr=n(606),Jr=n(607);function $r(e,t,n){return function(r){Qn.o(t)?r(Object(Jr.a)(Object(Xr.a)(e,i.d.reserveTag(595137280)),t.threads)):(C.H()&&r(Object(Qr.a)(Object(Xr.a)(e,i.d.reserveTag(595137282)),t.comments,t.tasks,n)),r(Object(Zr.a)(Object(Xr.a)(e,i.d.reserveTag(595137283)),t.comments,t.tasks)))}}var ea=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case zn.a.CommentsChanged:Qn.h(t)&&n(Kr(ke.a.None,this.telemetryVisitor,t.contextDetails,Object(he.applyCommentChanges)({renderContextType:ke.a.None,trackback:i.d.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case zn.a.LoadComments:Qn.i(t)&&n($r({renderContextType:ke.a.None,trackback:i.d.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case zn.a.CommentContextReload:Qn.d(t)&&n((a={renderContextType:ke.a.None,trackback:i.d.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},o=t,s=this.peopleAPI,c=this.telemetryVisitor,function(e,t){var n=[];Object(Qn.c)(o)?(Object(d.i)().assertConditionTag(!t||_e.p(t()).virtualized,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=Object(yt.b)(o.commentIds,(function(){return t().commentState}))):n=o.comments;var r=Object(Qn.c)(o)?[]:o.tasks;e(Kr(a.renderContextType,c,o.contextDetails,Object(he.reloadComments)(Object(Xr.a)(a,i.d.reserveTag(595953694)),{comments:n,tasks:r}))),C.H()&&e(Object(Qr.a)(Object(Xr.a)(a,i.d.reserveTag(595932895)),n,r,s)).catch(Object(S.a)(i.d.reserveTag(595645974)))}))}var a,o,s,c;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===a.d.AddComment&&e.actionBehavior!==a.a.CheckEnabled){var r=n();De.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:Ze.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();var ta=n(608);var na=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,a){switch(e){case zn.a.CommentsChanged:Qn.h(t)&&n((o=t,s=this.telemetryVisitor,function(e,t){var n,a,c,u,l,m=t(),f=!1,p=o.contextDetails;if(""===(null==p?void 0:p.selectedCommentId)&&(p=Object(r.__assign)(Object(r.__assign)({},p),{selectedCommentId:void 0})),e(Kr(ke.a.None,s,p,Object(he.applyCommentChanges)({renderContextType:ke.a.None,trackback:i.d.reserveTag(595953743),telemetryVisitor:s},o.changes))),!o.contextDetails||!o.contextDetails.selectedCommentId){var g=_e.t(m),C=g?g.selectedCardId:void 0,h=t(),b=_e.t(h);Object(d.i)().assertConditionTag(!Object(je.g)(m),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var v=_e.a(m),y=_e.a(h);if(C){if(C&&o.changes.some((function(e){return e.type===gt.a.Delete&&e.model.commentId===C}))){var T=void 0;if(Object(Ee.f)(v)){var O=_e.b(m),I=[],S=0;T=-1;for(var _=0;_<v.length;_++)I.push(S),S+=O[v[_]].length,v[_]===C&&(T=_);try{for(var j=Object(r.__values)(o.changes),D=j.next();!D.done;D=j.next())switch((k=D.value).type){case gt.a.Insert:var E=void 0;for(E=I.length-1;E>=0&&k.index<=I[E];E--)I[E]+=1;Object($e.a)(k.model)&&(E<T&&++T,I.splice(E+1,0,k.index));break;case gt.a.Delete:var A=void 0;for(A=I.length-1;A>=0;A--){if(!(k.index<I[A])){k.index===I[A]&&(A<T&&--T,I.splice(A,1));break}I[A]-=1}break;case gt.a.Modify:case gt.a.Unknown:case gt.a.Load:break;default:Object(i.m)(k)}}catch(e){n={error:e}}finally{try{D&&!D.done&&(a=j.return)&&a.call(j)}finally{if(n)throw n.error}}}else{T=v.findIndex((function(e){return e.commentId===C}));try{for(var P=Object(r.__values)(o.changes),x=P.next();!x.done;x=P.next()){var k;switch((k=x.value).type){case gt.a.Insert:k.index<=T&&++T;break;case gt.a.Delete:k.index<T&&--T;break;case gt.a.Modify:case gt.a.Unknown:case gt.a.Load:break;default:Object(i.m)(k)}}}catch(e){c={error:e}}finally{try{x&&!x.done&&(u=P.return)&&u.call(P)}finally{if(c)throw c.error}}}if(b)throw new F.a(te.l,i.d.reserveTag(589103626),-2130957551);if(y.length){var w=T;w===y.length&&(w-=1);var R=Object(Ee.f)(y)?y[w]:Object($e.b)(y[w]);e(Object(he.selectComment)({renderContextType:ke.a.None,trackback:i.d.reserveTag(595953744),telemetryVisitor:s},R,void 0,qr.a.ExpandCard,be.a.SharedComments)),f=!0}}}else!v.length&&y.length&&(e(Object(he.selectComment)({renderContextType:ke.a.None,trackback:i.d.reserveTag(595947723),telemetryVisitor:s},Object(Ee.f)(y)?y[0]:y[0].commentId,void 0,qr.a.ExpandCard,be.a.SharedComments)),f=!0);Object(d.i)().assertConditionTag(f||0===y.length||""!==(null===(l=o.contextDetails)||void 0===l?void 0:l.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case zn.a.LoadComments:Qn.i(t)&&(a().paneState.initializationStatus!==Mt.a.Initialized&&this.lastInitializationReason===R.a.NewThread||C.r()&&!De.b(a())?n($r({renderContextType:ke.a.None,trackback:i.d.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)):n(function(e,t,n,r){return function(a,o){a($r({renderContextType:e,trackback:i.d.reserveTag(595899530),telemetryVisitor:r},t,n));var s=o();Object(d.i)().assertConditionTag(void 0===Object(je.g)(s),"Half pane specific logic should not run with filtering enabled.",523866629);var c=_e.p(s).virtualized,u=_e.t(s),l=_e.k(s);!Object(ye.a)(_e.q(s),c,!!Object(je.g)(o()))||!l.length||u&&Object(ve.b)(s,u.selectedCardId)||a(Object(he.selectComment)({renderContextType:e,trackback:i.d.reserveTag(595953680),telemetryVisitor:r},Object(Ee.f)(l)?l[0]:l[0].commentId,void 0,qr.a.ExpandCard,be.a.SharedComments))}}(ke.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)));break;case zn.a.CommentContextReload:Qn.d(t)&&n(function(e,t,n,a){return function(o,s){var c,u,l=s(),m=!1,f=[];Object(Qn.c)(t)?(Object(d.i)().assertConditionTag(_e.p(l).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),f=Object(yt.b)(t.commentIds)):f=t.comments;var p=t.contextDetails;""===(null==p?void 0:p.selectedCommentId)&&(p=Object(r.__assign)(Object(r.__assign)({},p),{selectedCommentId:void 0}));var g=Object(Qn.c)(t)?[]:t.tasks;o(Kr(e,a,p,Object(ta.a)({renderContextType:e,telemetryVisitor:a,trackback:i.d.reserveTag(595953677)},{comments:f,tasks:g}))),C.H()&&o(Object(Qr.a)({renderContextType:e,telemetryVisitor:a,trackback:i.d.reserveTag(595162892)},f,g,n)).catch(Object(S.a)(i.d.reserveTag(595645962))),Object(d.i)().assertConditionTag(!Object(je.g)(l),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var h=null===(c=_e.t(l))||void 0===c?void 0:c.selectedCardId,b=_e.a(l),v=s(),y=_e.a(v);if(h){if(!_e.t(v)){var T=Object(Ee.f)(b)?b.findIndex((function(e){return e===h})):b.findIndex((function(e){return e.commentId===h}));if(T<0)return;if(y.length){var O=T;O===y.length&&(O-=1);var I=Object(Ee.f)(y)?y[O]:Object($e.b)(y[O]);o(Object(he.selectComment)({renderContextType:e,telemetryVisitor:a,trackback:i.d.reserveTag(595953678)},I,void 0,qr.a.ExpandCard,be.a.SharedComments)),m=!0}}}else!b.length&&y.length&&(o(Object(he.selectComment)({renderContextType:e,telemetryVisitor:a,trackback:i.d.reserveTag(595947722)},Object(Ee.f)(y)?y[0]:y[0].commentId,void 0,qr.a.ExpandCard,be.a.SharedComments)),m=!0);Object(d.i)().assertConditionTag(m||0===y.length||""!==(null===(u=t.contextDetails)||void 0===u?void 0:u.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(ke.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var o,s;this.commonViewStrategy.processCommentEvent(e,t,n,a)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),ra=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,a,o,i,s){var c=new Ur(t,n,r,a,s);switch(e.containerType){case w.a.HalfPane:return new na(c,n,i,s);case w.a.FullPane:return new ea(c,n,o,s)}},e}();function aa(e){if(void 0===e.hostCommentAPI)throw new F.a("'hostCommentAPI' was not supplied",i.d.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new F.a("'peopleAPI' was not supplied",i.d.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new F.a("'viewContainerProvider' was not supplied",i.d.reserveTag(589103636),-2130957511);var t=Object(E.g)(e.apiContext)?Object(E.f)(e.apiContext):void 0,n=Object(D.e)(e.apiContext)?Object(D.d)(e.apiContext):void 0,a=Object(m.a)(),o=e.themeAPI||new me,s=new de(e.hostCommentAPI),c=V.getTelemetryVisitor(e.apiContext),d=new st(a.getLocaleInfo().isRightToLeft,c),u=new Pr(e.peopleAPI,c,e.correlationId||"");C.w()&&u.initializeController(!1);var l=function(e,t,n,a,o,i,s,c,d){var u=d?[Object(In.b)(d,a)]:[],l=Object(ct.d)(ct.a.apply(void 0,Object(r.__spreadArray)([lt,ut,dt.a,On,Nn(a),un(e,a),hn(a),_n(s),Un(0,c),Dn(i),gn(a),Cn(o)],Object(r.__read)(u),!1))),m=Object(ct.e)(nn,n,l);return s.initialize(m,!!o),m}(s,e.viewContainerProvider,Xt(e.viewContainerProvider.getViewContainer(),e.paneVisible,a.getLocaleInfo(),e.apiContext),V.getTelemetryVisitor(e.apiContext),t,a,d,u,n);return new Ar({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:s,peopleAPI:e.peopleAPI,localizationAPI:a,themeAPI:o,focusManager:d,lppManager:u,initializationReason:e.initializationReason,commentStore:l,viewStrategyFactory:new ra,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentNavigationAPI:t,contentFilteredRangeAPI:n})}function oa(e,t,r,a,h,b,v,y,O){try{try{if(ne())return void Object(d.i)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(F.b)(e))throw e}L=aa;var I=[];Object(c.c)()?I.push([!v,"App settings should not be passed in when feature gate API is already initialized. Please inspect feature gate initialization on host.",i.d.reserveTag(527754333)]):(I.push([!!v,"Must initialize feature gate API but no appSettings passed to instantiate.",i.d.reserveTag(527754332)]),Object(c.b)({appSettings:null!=v?v:{},mapping:J.a})),Object(d.i)().hasBeenInitialized()?Object(d.i)().assertConditionTag(!t,"Telemetry details should not be passed in if telemetry API is already initialized. Please inspect telemetry API initialization on host.",527754334):Object(d.k)(ee,t),I.forEach((function(e){Object(d.i)().assertConditionTag(e[0],e[1],e[2])})),Object(d.i)().assertConditionTag(!!v,"appSettings should not be undefined",595616278);var _=function(){var t=Object(m.b)(h);Object(u.c)(t.getLocaleInfo().isRightToLeft),function(e){var t=n(1203),r=n(1204),a=Object(u.a)()?n(1205):n(1206),o=n(1207),i=n(1208),s=n(1209),c=n(1210),d=n(1211),l=n(1212),m=n(1213),f=n(936),p=n(1214),g=n(1215),h={HintBarEllipses_16:T.createElement(t,null),CancelGlyph:T.createElement(r,null),NewComment:T.createElement(a,null),CancelGlyph_TaskPane:T.createElement(o,null),Send2_Fluent:T.createElement(i,null),Delete_Fluent:T.createElement(s,null),Edit_Fluent:T.createElement(c,null),Checkmark_Fluent:T.createElement(d,null),CommentReopen_Fluent:T.createElement(l,null),Error:T.createElement(m,null),ReopenThread:T.createElement(f,null),DeleteFilter:T.createElement(p,null),DeleteFilterDefault:T.createElement(g,null)};if(e||C.b()){var b=n(1216),v=n(1217),y=n(1218),O=n(1219),I=n(936),S=n(1220),_=n(1221);h.TaskAssign=T.createElement(b,null),h.TaskComplete=T.createElement(v,null),h.TaskDelete=T.createElement(y,null),h.TaskEdit=T.createElement(O,null),h.TaskReopen=T.createElement(I,null),h.TaskStatusCircleCheckmark=T.createElement(S,null),h.ChevronDown12=T.createElement(_,null)}if(e||C.a()){var j=n(1222),D=n(1223);h.CommentLikeEmpty=T.createElement(j,null),h.CommentLikeSolid=T.createElement(D,null)}if(e||C.x()){var E=n(1224);h.LinkToComment=T.createElement(E,null)}Object($.hb)({icons:h})}();var i,c=(i=o.a,new G(i,a));V.ensureViewManager({apiContext:o.a,displayMode:g.b.FullPane,foldableLayoutState:g.a.Indeterminate,initializationReason:b||R.a.PaneOpen,correlationId:Object(s.a)(),viewContainerProvider:c,peopleAPI:r,hostCommentAPI:e,paneVisible:!1,initializeImmediately:!1}),Object(f.b)(y),C.W()&&O&&p.a.setThemeAPI(O),K(),Object(l.f)().onExtensionFirstRequested.subscribe((function(e){e.contentType===l.b.CommentThread&&e.instanceId===l.c&&re()}))};C.ab()?Object(Z.b)().then((function(){_()})).catch((function(e){return Object(S.a)(i.d.reserveTag(526254819))(e)})):_()}catch(e){throw Object(S.a)(i.d.reserveTag(594367139))(e),e}}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var ia=n(362),sa=n(289),ca=n(804);function da(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];oa.apply(void 0,Object(r.__spreadArray)(Object(r.__spreadArray)([],e,!1),[sa.a],!1))}n.d(t,"instantiate",(function(){return da})),n.d(t,"initializeRuntime",(function(){return re})),n.d(t,"setWebpackPublicPath",(function(){return ia.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return W.a})),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return ca.a}))},129:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(23);function a(e){return e===r.a.FullPane||e===r.a.HalfPane}function o(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},1292:function(e,t,n){"use strict";var r,a,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(r||(r={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(a||(a={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(o||(o={}))},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),a=n(1001);function o(e){var t=Object(r.__read)(e,1)[0];return Object(a.a)(t)}},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return e.reduce((function(e,t){return Array.isArray(t)?e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(a(t)),!1)):e.push(t),e}),[])}},131:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i}));var r="CREATE",a="EDIT",o="REPLY",i="METADATA"},132:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},136:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated",e[e.NativeHeartbeat=50]="NativeHeartbeat"}(r||(r={}))},142:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(235),a=n(90),o=n(131);function i(e){return e.sessionType===o.a}function s(e){return e.sessionType===o.d&&void 0!==e.threadId}function c(e){return e.sessionType===o.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:a.a.Insert,REPLY:a.a.Insert,EDIT:a.a.Modify,METADATA:a.a.Modify};function l(e){return i(e)?r.a.InitCreateCommentSession:s(e)?r.a.InitReplyCommentSession:c(e)?r.a.InitEditCommentSession:r.a.Unknown}},143:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},15:function(e,t,n){"use strict";var r=n(1),a=n(5);function o(e,t){var n=e.filter(t);return n.length===e.length?e:n}var i=n(4),s=n(118),c=n(193),d=n(382),u=n(279),l=n(142),m=n(73),f=n(106),p=n(177),g=n(23),C=n(355),h=n(93),b=n(84),v=n(129),y=n(373),T=n(47),O=n(117),I=n(17),S=n(113),_=n(143),j=n(51),D=n(102),E=n(212),A=n(44),P=n(40),x=n(210),k=n(363),w=n(447);n.d(t,"P",(function(){return R})),n.d(t,"Z",(function(){return F})),n.d(t,"Y",(function(){return N})),n.d(t,"O",(function(){return M})),n.d(t,"z",(function(){return L})),n.d(t,"f",(function(){return V})),n.d(t,"L",(function(){return B})),n.d(t,"y",(function(){return U})),n.d(t,"l",(function(){return H})),n.d(t,"t",(function(){return G})),n.d(t,"o",(function(){return W})),n.d(t,"h",(function(){return q})),n.d(t,"g",(function(){return z})),n.d(t,"k",(function(){return Y})),n.d(t,"j",(function(){return K})),n.d(t,"N",(function(){return X})),n.d(t,"v",(function(){return Q})),n.d(t,"x",(function(){return Z})),n.d(t,"w",(function(){return J})),n.d(t,"a",(function(){return $})),n.d(t,"U",(function(){return ee})),n.d(t,"R",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"n",(function(){return re})),n.d(t,"m",(function(){return ae})),n.d(t,"A",(function(){return oe})),n.d(t,"C",(function(){return se})),n.d(t,"E",(function(){return ce})),n.d(t,"D",(function(){return de})),n.d(t,"gb",(function(){return ue})),n.d(t,"F",(function(){return me})),n.d(t,"bb",(function(){return fe})),n.d(t,"p",(function(){return pe})),n.d(t,"q",(function(){return ge})),n.d(t,"B",(function(){return Ce})),n.d(t,"G",(function(){return he})),n.d(t,"fb",(function(){return be})),n.d(t,"b",(function(){return ve})),n.d(t,"M",(function(){return Te})),n.d(t,"u",(function(){return Oe})),n.d(t,"W",(function(){return Se})),n.d(t,"db",(function(){return _e})),n.d(t,"eb",(function(){return je})),n.d(t,"cb",(function(){return De})),n.d(t,"H",(function(){return Ee})),n.d(t,"I",(function(){return Pe})),n.d(t,"J",(function(){return xe})),n.d(t,"K",(function(){return ke})),n.d(t,"X",(function(){return we})),n.d(t,"T",(function(){return Re})),n.d(t,"ab",(function(){return Fe})),n.d(t,"S",(function(){return Ne})),n.d(t,"c",(function(){return Me})),n.d(t,"Q",(function(){return Le})),n.d(t,"i",(function(){return Ve})),n.d(t,"d",(function(){return Be})),n.d(t,"s",(function(){return Ue})),n.d(t,"r",(function(){return He})),n.d(t,"e",(function(){return Ge}));function R(e){return""===e||null===e?void 0:e}function F(e,t){if(!e[t])return e;var n=Object(r.__assign)({},e);return delete n[t],n}function N(e,t,n){var a=void 0!==n&&e[n]===t?n:-1;if(a<0&&(a=e.findIndex((function(e){return e===t}))),a<0)return e;var o=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return o.splice(a,1),o}function M(e){return e.state===D.a.Placeholder||e.state===D.a.Loading}function L(e,t,n){var r,a;return Object(P.c)(e)?null!==(a=null===(r=t[n])||void 0===r?void 0:r.map((function(t){return e[t]})))&&void 0!==a?a:[]:e.filter((function(e){return Object(m.b)(e)===n}))}function V(e){return{commentId:e,commentBody:y.a,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function B(e,t,n,r){if(n<0)return-1;for(var a=0,o=-1,i=0;i<e.length;i++)if(e[i]!==r){if(a===n)return i;if(a>n)return o===i-1?i-2:i-1;a+=t[e[i]].length}else o=i;return a===n?e.length:-1}function U(e,t,n){for(var r={},a=0;a<e.length;++a)r[e[a].commentId]=H(!I.kb()&&t.includes(Object(m.b)(e[a]))?W(e[a].date,e[a].displayDate,n.dataCulture):e[a].displayDate);return r}function H(e){return{displayDate:e,displayingErrorUI:!1,pending:E.a.None}}function G(e){return{displayDate:e}}function W(e,t,n){return t||(!e||isNaN(e.getDate())?"":C.a(e,n))}function q(e,t,n,a){for(var o,s=void 0,c=!1,d=0;d<n.length;d++)if(Object(m.b)(n[d])===e){c=!0,Object(i.i)().assertConditionTag(!!t[n[d].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=null!==(o=t[n[d].commentId])&&void 0!==o?o:H(void 0);u.displayDate||(s||(s=Object(r.__assign)({},t)),s[n[d].commentId]=Object(r.__assign)(Object(r.__assign)({},u),{displayDate:W(n[d].date,n[d].displayDate,a.dataCulture)}))}else if(c)break;return s}function z(e,t,n,a){var o=void 0;return e.forEach((function(e){var s;if(n[e]){Object(i.i)().assertConditionTag(!!t[e],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var c=null!==(s=t[e])&&void 0!==s?s:H(void 0);c.displayDate||(o||(o=Object(r.__assign)({},t)),o[e]=Object(r.__assign)(Object(r.__assign)({},c),{displayDate:W(n[e].date,n[e].displayDate,a.dataCulture)}))}})),o}function Y(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=K(void 0,t));return n}function K(e,t){return Q(e,t===D.a.Loading||t===D.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:D.a.Loaded})}function X(e){var t,n,a={};try{for(var o=Object(r.__values)(e),i=o.next();!i.done;i=o.next()){var s=i.value;a[s.threadId]=Q(void 0,{state:D.a.Placeholder,initialItemCount:s.itemCount})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}function Q(e,t){return{loadState:null!=t?t:{state:D.a.Loaded},pending:_.a.None,alternateId:e}}function Z(e){var t={};return t[e]={pending:E.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function J(e){var t={};return t[e]={pending:_.a.Card,loadState:{state:D.a.Loaded},alternateId:e},t}function $(e,t,n){var r=te(e,t,n);if(!t||r.includes(t.selectedCardId))return r;var a=ke(n);return a&&a.threadId===t.selectedCardId?[a.threadId]:a&&r.includes(a.threadId)?[t.selectedCardId,a.threadId]:[t.selectedCardId]}function ee(e,t,n,r){if(!t.includes(e))return t;var a=ke(n);return a&&a.threadId===e?t:r&&Object(A.j)(r.selectionDetails)?(Object(i.i)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):a&&t.includes(a.threadId)?[a.threadId]:[]}function te(e,t,n){var r=ke(n);return o(e,(function(e){return e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId)}))}function ne(e,t,n){var r=ke(n);return o(e,(function(e){return t[e]||e===(null==r?void 0:r.threadId)}))}function re(e){return{selectedCardId:e,selectionDetails:ae()}}function ae(){return{lowFidelityWarningType:void 0}}function oe(e,t){var n,r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;var o=e.draftState.drafts[r];if(!o.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===o.threadId?void 0:e.selectedComment;var i=Object(P.b)(Object(P.a)(e),t);if(!i)throw new T.a(O.i,a.d.reserveTag(589103587),-2130957563);return re(Object(m.b)(i))}function ie(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function se(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return re(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=Object(P.b)(e,t);if(n)return ie(Object(m.b)(n),t);throw new T.a(O.d,a.d.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=Object(P.b)(e,t);if(n&&""===n.parentId)return re(t);throw new T.a(O.d,a.d.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new T.a(O.c,a.d.reserveTag(589103618),-2130957532)}}function ce(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return re(e.threadId);case"EDIT":return ie(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new T.a(O.c,a.d.reserveTag(577610274),-2130957532)}}function de(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&Object(A.j)(t.selectionDetails)&&!Object(j.l)(n)?re(e):t}function ue(e,t){var n=t.payload;return{selectedCardId:n.selectedCard,selectionDetails:le(e,n)}}function le(e,t){return t.selectType===S.a.SelectPost?e&&Object(A.j)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0}:{lowFidelityWarningType:e&&!Object(A.j)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function me(e,t,n){var r,a=t.payload.params;return Object(l.f)(a)?re(n):Object(l.e)(a)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:a.commentId}}:re(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n)}function fe(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!Object(j.l)(e);if(!t)return!0;if(Object(j.l)(e))return n.payload.selectedCard===t.selectedCardId&&!Object(A.j)(t.selectionDetails)&&n.payload.selectType===S.a.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case S.a.SelectCard:return Object(A.j)(t.selectionDetails);case S.a.Polite:return!1;case S.a.SelectPost:case S.a.ExpandCard:return!0;default:Object(a.m)(n.payload)}return!0}function pe(e){var t={};return e.commentId&&(t[e.commentId]={pending:_.a.None,loadState:{state:D.a.Loaded},alternateId:e.commentId}),t}function ge(e){var t={};return e.commentId&&(t[e.commentId]={pending:E.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function Ce(e,t){return e&&e.selectedCardId===t.payload.commentId?re(t.payload.commentId):e}function he(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return Object(h.y)();if(e.committedLieId)return e.committedLieId;var r=ke(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==g.a.None?void 0:r.commentDraft.sessionConfiguration.draftId}function be(e,t,n,r){var a=N(e,n);if(a.length<e.length){var o=B(a,t,r.flatIndex);o>=0&&a.splice(o,0,n)}return a}function ve(e,t,n,a){if(!he(a,!0))return e;var o=he(a);if(e&&o&&n[o]&&n[o].pending===_.a.None){var i=Object(r.__assign)({},e),s=t.length;if(i.flatIndex>=s)i.flatIndex=s;else if(i.flatIndex>=0&&t[i.flatIndex].parentId){var c=new u.a(t,i.flatIndex);c.next().done?i.flatIndex=s:i.flatIndex=c.currentIndex()}return i}}function ye(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(A.b)(t);return e.findIndex((function(e){return e.commentId===r}))}function Te(e,t){return Object(P.f)(e)?t?e.findIndex((function(e){return e===t.selectedCardId})):-1:ye(e,t,!0)}function Oe(e,t,n){if(Object(P.c)(e)){if(!n||!t[n.selectedCardId])return-1;var r=Object(A.b)(n);return t[n.selectedCardId].findIndex((function(e){return e===r}))}return ye(e,n,!1)}function Ie(e,t){return void 0===t?(Object(i.i)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e):(Object(i.i)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.i)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518),F(e,t.sessionConfiguration.draftId))}function Se(e){return Object(k.a)(e)===p.a.CanAutoDiscard?Object(j.h)():e}function _e(e,t,n,r,o,i){var s,c;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(!t[s=e.pendingDraft.threadId])return e;break;case"EDIT":if(!r[c=e.pendingDraft.commentId])return e;break;default:return e}else{var d=ke(e);if(!d||!d.isInCurrentContext)return e;switch(d.commentDraft.sessionConfiguration.sessionType){case"REPLY":s=d.threadId;break;case"EDIT":c=d.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(s&&!n[s]){var u=Re(e,s);return Object(x.b)(e,u,3,i,a.d.reserveTag(539297118)),u}if(c&&!o[c]){u=Fe(e,c);return Object(x.b)(e,u,2,i,a.d.reserveTag(539297119)),u}return e}function je(e,t){var n=Object(r.__assign)({},e.drafts),a=!1;return Object.keys(n).forEach((function(e){var o=t(e);o!==n[e].renderContextType&&(n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{renderContextType:o}),a=!0)})),a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:n}):e}function De(e,t){if(t===f.a.Closed){if(Object(v.b)(e))return g.a.None}else if(e===g.a.DiscreteIntegrated)return g.a.FullPane;return e}function Ee(e){var t=ke(e);return t?t.commentDraft:void 0}function Ae(e){var t=Object.keys(e);if(t.length>1)throw Object(i.i)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new T.a("Only a single draft is supported at this time.",a.d.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function Pe(e){return Ae(e.cardIdToDraftIdMap)}function xe(e){return Ae(e.postIdToDraftIdMap)}function ke(e){var t=e.drafts,n=Ae(t);return n?t[n]:void 0}function we(e){var t,n,o=e.drafts,s=Object.keys(o).filter((function(e){var t;return null===(t=o[e])||void 0===t?void 0:t.isInCurrentContext})).map((function(e){return o[e]}));if(0===s.length)return e;var c=Object(r.__assign)({},e);try{for(var d=Object(r.__values)(s),u=d.next();!u.done;u=d.next()){var l=u.value;switch(l.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":Object(i.i)().assertConditionTag("METADATA"!==l.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),c=Re(c,l.threadId);break;case"EDIT":c=Fe(c,l.commentDraft.sessionConfiguration.commentId);break;default:Object(a.m)(l.commentDraft.sessionConfiguration)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return c}function Re(e,t){var n,a=e.pendingDraft&&Object(l.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,o=e.cardIdToDraftIdMap[t];return o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Ie(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:F(e.cardIdToDraftIdMap,t),pendingDraft:a?void 0:e.pendingDraft}):a?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Fe(e,t){var n,a=e.pendingDraft&&Object(l.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,o=e.postIdToDraftIdMap[t];return o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Ie(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:F(e.postIdToDraftIdMap,t),pendingDraft:a?void 0:e.pendingDraft}):a?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Ne(e,t,n){var a=Re(e,t),o=xe(a);if(o){var i=a.postIdToDraftIdMap[o],s=a.drafts[i];s&&s.threadId===t&&(a=Fe(a,o))}if(a.pendingDraft&&Object(l.e)(a.pendingDraft)){var c=a.pendingDraft.commentId,d=n.find((function(e){return e.commentId===c}));d&&Object(m.b)(d)===t&&(a=Object(r.__assign)(Object(r.__assign)({},a),{pendingDraft:void 0}))}return a}function Me(e){if("web"===Object(b.a)()||"win32"===Object(b.a)()){if(e.tasks===d.a.Unknown){if("win32"===Object(b.a)())return I.b();Object(i.i)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===d.a.Enabled&&I.b()}return I.b()}function Le(e,t,n,o){var s,c=e.pendingCommentLoad,d=void 0,u=e.expandedComments,l=function(e,t){var n=t?Object(P.e)(t)?{commentThreadIds:Object(r.__spreadArray)([],Object(r.__read)(t.commentThreadIds),!1),cardPostIds:Object(r.__assign)({},t.cardPostIds),postData:Object(r.__assign)({},t.postData)}:{commentData:Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t.commentData),!1),Object(r.__read)(e),!1)}:I.kb()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!Object(P.d)(n))return n;var a=void 0;return e.forEach((function(e){if(Object(m.a)(e))n.commentThreadIds.push(e.commentId),n.cardPostIds[e.commentId]=[e.commentId],a=e.commentId;else if(a===e.parentId)n.cardPostIds[e.parentId].push(e.commentId);else{if(!n.cardPostIds[e.parentId])return void Object(i.i)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);n.cardPostIds[e.parentId]=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(n.cardPostIds[e.parentId]),!1),[e.commentId],!1),a=e.parentId}n.postData[e.commentId]=e})),n}(t,e);if(c){var f=c.numberOfLoadedComments+t.length,p=c.numberOfLoadedThreads+t.filter(m.a).length;f>=c.numberOfTotalComments?(Object(i.i)().assertConditionTag(f===c.numberOfTotalComments,"Loaded more comments than expected",525693528),c=void 0):c=Object(r.__assign)(Object(r.__assign)({},c),{numberOfLoadedComments:f,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var g=e.pendingCommentLoad.selectedThreadIndex,C=void 0!==g&&Object(w.a)(c,n,o);if(Object(P.d)(l)&&e.createdCommentLie){var h=he(e.draftState,!0);if(h&&(!l.cardPostIds[h]||C)){var b=B(l.commentThreadIds,l.cardPostIds,e.createdCommentLie.flatIndex);l.cardPostIds[h]||(b<0&&!c&&(Object(i.i)().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),b=l.commentThreadIds.length),b>=0&&(l.commentThreadIds.splice(b,0,h),l.cardPostIds[h]=[h])),b>=0&&void 0!==g&&b<=g&&(g+=1)}}if(void 0!==g&&C){var v=Object(P.d)(l)?l.commentThreadIds:l.commentData.filter(m.a);if(!(g>=0&&g<v.length))throw Object(a.i)("selectedThreadIndex out of bounds"),new T.a(O.k,a.d.reserveTag(589103620),-2130957565);u=$(u,d=re(Object(P.f)(v)?v[g]:v[g].commentId),e.draftState)}}if(e.selectedComment)if(I.lb()){var y=ke(e.draftState);(null!==(s=null==y?void 0:y.threadId)&&void 0!==s?s:he(e.draftState))===e.selectedComment.selectedCardId&&(d=e.selectedComment,u=e.expandedComments)}else Object(j.d)(e.draftState)&&(d=e.selectedComment,u=e.expandedComments);return Object(r.__assign)(Object(r.__assign)({},l),{pendingCommentLoad:c,selectedComment:d,expandedComments:u})}function Ve(e,t){var n=Object(P.b)(e,t);return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Be(e,t,n){return Object(P.f)(e)?n?Object(P.c)(t)?e.some((function(e){return!(t[e].commentFlags&c.a.Resolved)})):t.some((function(t){return""===t.parentId&&!(t.commentFlags&c.a.Resolved)&&e.find((function(e){return e===t.parentId}))})):e.length>0:Object(P.c)(t)?(Object(a.n)(!1,"ThreadData and CommentData must align if Map-Based",a.d.reserveTag(526402327)),!1):n?t.filter((function(e){return""===e.parentId&&!(e.commentFlags&c.a.Resolved)})).length>0:t.length>0}function Ue(){return{atMention:s.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:0,tasks:d.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1}}function He(e,t){var n,a=e.cardIdToDraftIdMap[t.commentId],o=a?e.drafts[a].commentDraft:void 0;if(void 0===o)return Object(i.i)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var s=t.smartReplies,c=o.sessionConfiguration.sessionType,d=s.length;return"REPLY"===c&&(d<=3&&d>0)?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Object(r.__assign)(Object(r.__assign)({},e.drafts),(n={},n[a]=Object(r.__assign)(Object(r.__assign)({},e.drafts[a]),{smartReplies:s}),n))}):e}function Ge(e,t){return!(!(e.commentFlags&c.a.Resolved)||t[e.commentId]&&t[e.commentId].commentFlags&c.a.Resolved)}},159:function(e,t,n){"use strict";var r=n(118);n(825),n(517);n.d(t,"h",(function(){return r.j})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.e})),n.d(t,"f",(function(){return r.h})),n.d(t,"d",(function(){return r.f})),n.d(t,"e",(function(){return r.g})),n.d(t,"g",(function(){return r.i}))},160:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function a(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},161:function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},1612:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(e),!1)),t=void 0}}},162:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},167:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"a",(function(){return S})),n.d(t,"g",(function(){return _})),n.d(t,"i",(function(){return j})),n.d(t,"h",(function(){return D})),n.d(t,"n",(function(){return E}));var r,a,o,i,s,c=n(3),d=n(41),u=1e3,l="2px",m="4px",f="@media screen and (-ms-high-contrast: active), (forced-colors: active)",p={content:'""',position:"absolute",left:-1,top:-1,bottom:-1,right:-1,border:0,outline:"none",zIndex:1},g={BUTTON_HOVER:"#F3F2F1",BUTTON_SELECT:"#E1DFDD",BUTTON_DOWN:"#D2D0CE",BUTTON_DISABLED:"#FAF9F8",HIGH_CONTRAST:{BUTTON_FOCUS:"highlight"}},C=((r={forcedColorAdjust:"auto",MsHighContrastAdjust:"auto",svg:{forcedColorAdjust:"auto"}})[f]={color:"revert",stroke:"revert"},r);function h(e){return Object(c.db)(e,C)}var b={selectors:(a={},a[c.l]={backgroundColor:"Highlight",color:"HighlightText",borderColor:"WindowText",MsHighContrastAdjust:"none",selectors:{"svg > path":{fill:"HighlightText"}}},a)},v=Object(c.db)(b,{selectors:(o={},o[c.l]={outline:"2px",outlineOffset:"-2px"},o)}),y=Object(c.db)({selectors:(i={},i[c.l]={outline:"2px",outlineOffset:"-2px"},i)}),T=Object(c.db)(((s={})[f]={color:"ButtonText"},s)),O=function(e){void 0===e&&(e={});var t={rootHovered:h(v),rootFocused:h(b),rootDisabled:h(y),icon:h(T)};return Object(c.cb)(e,t)};function I(e){var t;return Object(c.cb)(e,{root:(t={},t[c.l]={color:"ButtonText"},t)})}var S={LEVEL1:"0px 1px 2px 0px rgba(0,0,0,0.10)",LEVEL2:"0px 2px 4px 0px rgba(0,0,0,0.10)",LEVEL3:"0px 4px 8px 0px rgba(0,0,0,0.10)",LEVEL4:"0px 8px 16px 0px rgba(0,0,0,0.10)",LEVEL5:"0px 16px 24px 0px rgba(0,0,0,0.10)"},_='"Segoe UI"',j='"Segoe UI Web"',D='"Segoe UI Semibold"';function E(e,t,n){var r,a;return!e||t?null!==(r=null==n?void 0:n.CardBackground)&&void 0!==r?r:d.a.WHITE:null!==(a=null==n?void 0:n.ResolvedCardBackground)&&void 0!==a?a:d.a.REST_RESOLVED_BODY}},168:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},17:function(e,t,n){"use strict";var r=n(76),a=n(86),o=n(4),i=n(594);function s(e,t){return void 0===t&&(t=new Set),!!Object(a.a)().isFeatureEnabled(e)&&(t.add(e),i.a[e].dependencies.every((function(n){var r=t.has(n)||s(n,t);return Object(o.i)().assertConditionTag(r,"Gate ".concat(e," enabled without dependency gate ").concat(n),544482649),r})))}function c(){return s("LivePersonaPicker")}function d(){return s("PersonaFeature")}function u(){return s("NewCommentButton")}function l(){return s("DiscreteHostedComments")}function m(){return s("CommentsFluentUI")}function f(){return s("RenderDHCInPane")}function p(){return s("CommentTasks")}function g(){return s("NewDraftingUI")}function C(){return s("TaskPaneWithNewInfrastructure")}function h(){return s("CommentTasksFromReply")}function b(){return s("HeadlessBoot")}function v(){return s("HyperlinksInComments")}function y(){return s("ContentNavigation")}function T(){return s("AtMentionFloodgateSurvey")}function O(){return s("ExtendedDrafting")}function I(){return s("RichTextFormattingInWeb")}function S(){return s("LogDraftCommentIdPair")}function _(){return s("RichContentEditIntegrationInWeb")}function j(){return s("SmartReplies")}function D(){return s("NewSelectionInteractions")}function E(){return s("CommentReactions")}function A(){return s("HyperlinksWithDisplayText")}function P(){return s("LinkToComment")}function x(){return s("WebThemeIntegration")}function k(){return s("TruncationUIWithReadMoreText")}function w(){return s("QuillInitializationTelemetry")}function R(){return s("QuickEdit")}function F(){return s("CtrlEnterTip")}function N(){return s("HighlightsAndFontColorInWebComments")}function M(){return s("DiagnosticHeartbeat")}function L(){return s("TaskHistoryRecordIDs")}function V(){return s("AtMentionHintMessage")}function B(){return s("LivePersonaCardForWeb")}function U(){return s("MapBasedStore")}function H(){return s("CommentTasksMultiAssignCreation")}function G(){return!1}function W(){return Object(a.a)().isChangeGateEnabled("WebThemeIntegrationHighContrastFixes",Object(r.d)(5746447))}function q(){return Object(a.a)().isChangeGateEnabled("CommentTasksRenderMultiAssignData",Object(r.d)(5949645))}function z(){return Object(a.a)().isChangeGateEnabled("MitigateSafariPasteIssue",Object(r.d)(5991403))}function Y(){return Object(a.a)().isChangeGateEnabled("MoreRepliesContrast",Object(r.d)(6016251))}function K(){return Object(a.a)().isChangeGateEnabled("TruncationFix",Object(r.d)(6009826))}function X(){return Object(a.a)().isChangeGateEnabled("NewButtonBarRefactor2",Object(r.d)(5956095))}function Q(){return Object(a.a)().isChangeGateEnabled("RemoveUnneededDHCFGs",Object(r.d)(6030543))||l()}function Z(){return Object(a.a)().isChangeGateEnabled("ContentNavigationFGDeprecationV3",Object(r.d)(6041163))}function J(){return Object(a.a)().isChangeGateEnabled("DelayLoadImmerES5",Object(r.d)(6051195))}function $(){return Object(a.a)().isChangeGateEnabled("ChangeTreeItemRoleToCommentRole",Object(r.d)(5439614))}function ee(){return Object(a.a)().isChangeGateEnabled("EnableTaskSpreadFix",Object(r.d)(6107520))}function te(){return Object(a.a)().isChangeGateEnabled("ModelCapabilitiesCheck",Object(r.d)(6152847))}function ne(){return Object(a.a)().isChangeGateEnabled("RemoveProdFilterFGUsageV2",Object(r.d)(6176704))}function re(){return Object(a.a)().isChangeGateEnabled("UseFilterReadyToRender",Object(r.d)(6175773))}function ae(){return Object(a.a)().isChangeGateEnabled("TaskHonorResolveSupport",Object(r.d)(6195660))}function oe(){return Object(a.a)().isChangeGateEnabled("MoreAADObjectIdV2",Object(r.d)(6079803))}function ie(){return Object(a.a)().isChangeGateEnabled("ReactionButtonFocusFix",Object(r.d)(6214348))}function se(){return Object(a.a)().isChangeGateEnabled("UseIUserArrayForReactionsUserList",Object(r.d)(6249072))}function ce(){return Object(a.a)().isChangeGateEnabled("UseCommentApiContext",Object(r.d)(6252893))}function de(){return Object(a.a)().isChangeGateEnabled("TaskStateComparison",Object(r.d)(6256824))}function ue(){return Object(a.a)().isChangeGateEnabled("FixPostKeyboarding",Object(r.d)(6254309))}function le(){return Object(a.a)().isChangeGateEnabled("AlignAllyAndTooltipForPostButton",Object(r.d)(6299697))}function me(){return Object(a.a)().isChangeGateEnabled("SetPostLevel",Object(r.d)(6337532))}function fe(){return Object(a.a)().isChangeGateEnabled("ImagesInWebComments",Object(r.d)(6401322))}function pe(){return Object(a.a)().isChangeGateEnabled("FixReactionVisibility",Object(r.d)(6404718))}function ge(){return Object(a.a)().isChangeGateEnabled("HalfPaneNoSelectAfterClose",Object(r.d)(6403025))}function Ce(){return Object(a.a)().isChangeGateEnabled("SkipInsertLieWithFiltering",Object(r.d)(6514909))}function he(){return Object(a.a)().isChangeGateEnabled("CtrlEnterInCard",Object(r.d)(6381581))}n.d(t,"w",(function(){return c})),n.d(t,"H",(function(){return d})),n.d(t,"F",(function(){return u})),n.d(t,"o",(function(){return l})),n.d(t,"k",(function(){return m})),n.d(t,"fb",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"G",(function(){return g})),n.d(t,"P",(function(){return C})),n.d(t,"c",(function(){return h})),n.d(t,"s",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"ib",(function(){return y})),n.d(t,"f",(function(){return T})),n.d(t,"q",(function(){return O})),n.d(t,"N",(function(){return I})),n.d(t,"z",(function(){return S})),n.d(t,"M",(function(){return _})),n.d(t,"e",(function(){return j})),n.d(t,"lb",(function(){return D})),n.d(t,"a",(function(){return E})),n.d(t,"u",(function(){return A})),n.d(t,"x",(function(){return P})),n.d(t,"W",(function(){return x})),n.d(t,"S",(function(){return k})),n.d(t,"J",(function(){return w})),n.d(t,"I",(function(){return R})),n.d(t,"m",(function(){return F})),n.d(t,"t",(function(){return N})),n.d(t,"n",(function(){return M})),n.d(t,"jb",(function(){return L})),n.d(t,"g",(function(){return V})),n.d(t,"y",(function(){return B})),n.d(t,"kb",(function(){return U})),n.d(t,"i",(function(){return H})),n.d(t,"B",(function(){return G})),n.d(t,"X",(function(){return W})),n.d(t,"j",(function(){return q})),n.d(t,"A",(function(){return z})),n.d(t,"D",(function(){return Y})),n.d(t,"R",(function(){return K})),n.d(t,"E",(function(){return X})),n.d(t,"p",(function(){return Q})),n.d(t,"l",(function(){return Z})),n.d(t,"ab",(function(){return J})),n.d(t,"h",(function(){return $})),n.d(t,"bb",(function(){return ee})),n.d(t,"eb",(function(){return te})),n.d(t,"L",(function(){return ne})),n.d(t,"U",(function(){return re})),n.d(t,"O",(function(){return ae})),n.d(t,"C",(function(){return oe})),n.d(t,"K",(function(){return ie})),n.d(t,"V",(function(){return se})),n.d(t,"T",(function(){return ce})),n.d(t,"Q",(function(){return de})),n.d(t,"cb",(function(){return ue})),n.d(t,"Y",(function(){return le})),n.d(t,"gb",(function(){return me})),n.d(t,"v",(function(){return fe})),n.d(t,"db",(function(){return pe})),n.d(t,"r",(function(){return ge})),n.d(t,"hb",(function(){return Ce})),n.d(t,"Z",(function(){return he}))},170:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},171:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},176:function(e,t,n){"use strict";var r,a=n(0),o=a.createContext(void 0);function i(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&(!!(t=e)&&void 0!==t.focus&&void 0!==t.blur);var t}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}));var s=n(85),c=n(809),d=n(1);s.c.Tab,s.a.AtTarget,s.c.Tab,s.a.AtTarget;var u=n(371);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(879),function(){function e(e,t,n,r,o){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=o,this.registrationRef=a.createRef(),this.innerComponentRef=a.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var a=this.focusState;this.focusState=r,l(a)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();var m=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}};!function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new m,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var a=Object(d.__values)(this.viewTreeMap.values()),o=a.next();!o.done;o=a.next()){var i=null===(r=o.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(i)return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}();!function(){function e(){var e=this;this.ref=a.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():s.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}();var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return a.Children.only(this.props.children)},t}(a.PureComponent);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=a.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.__extends)(t,e),t.prototype.render=function(){var e=this;return a.createElement(o.Consumer,null,(function(t){return a.createElement(f,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(a.PureComponent);n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(function(){return s.c})),n.d(t,"c",(function(){return s.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"f",(function(){return c.b}))},177:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},178:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47),a=n(456);function o(e,t){return Object(r.b)(e)?e.errorCode:Object(a.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},181:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));n(1),n(176);var r=n(15),a=n(93),o=n(43);function i(e){var t="";return Object(o.e)(e.componentType)?t=s(e.componentType):Object(o.c)(e)&&(t=c(e)),t}function s(e){switch(e){case o.a.ClosePaneButton:return a.l();case o.a.NextCommentButton:return a.E();case o.a.PreviousCommentButton:return a.M();case o.a.GhostCard:return a.A();case o.a.NewCommentButton:return a.D();case o.a.PaneRoot:return a.z();case o.a.CommentsList:return a.q()}}function c(e){switch(e.componentType){case o.a.Card:return a.i(e,!1);case o.a.DraftCard:return a.i(e,!0);case o.a.PostEditor:return a.w(a.G(e));case o.a.CardEditor:return a.w(a.f(e));case o.a.Post:return a.I(e);case o.a.DiscreteHostedCommentRoot:return a.s(e);case o.a.ReopenThreadButton:return a.d(e,a.P())}}function d(e){return e?o.a.DraftCard:o.a.Card}function u(e,t){return d(Object(r.G)(t)===e)}},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1);function a(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{trackback:t})}function o(e,t,n){return{type:e,payload:t,actionDetail:n}}},193:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted",e[e.ReactionRestricted=128]="ReactionRestricted"}(r||(r={}))},195:function(e,t,n){"use strict";var r;function a(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},196:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(7),a=n(3),o=n(207),i=n(395),s=n(167),c={TASK_ASSIGNER_CHECKED_BOX:"#605E5C",TASK_BORDER_FOCUS:"#797775",TASK_BORDER:"#252423",TASK_CHECKBOX_COLOR:"#31752F",TASK_CHECKBOX_COLOR_COMPLETED_HOVER:"#255924",TASK_CHECKMARK_COLOR:"#31752F",TASK_DISABLED:"#A19F9D",TASK_TEXT:"#252423"},d="10px",u=Object(r.c)((function(e,t){var n,r,d,u=Object(a.db)(!t&&{color:c.TASK_TEXT,selectors:{":hover":{selectors:{".ms-Checkbox-text":Object(a.db)({color:c.TASK_TEXT,selectors:(n={},n[a.l]={color:"HighlightText"},n)},e&&{color:Object(i.a)().primary})}}}}),l={alignItems:"center",border:"1px solid transparent",borderRadius:"3px",borderSpacing:"2px",height:"16px",overflow:"hidden",padding:"3px",selectors:(r={":hover":s.l},r[a.l]={color:"ButtonText"},r)},m=Object(a.db)({borderRadius:s.c,boxSizing:"content-box",height:"14px",textAlign:"center",width:"14px"},t&&{borderColor:c.TASK_DISABLED}),f={selectors:(d={},d[".".concat(o.a," &:focus + .ms-Checkbox-label:before")]={outline:"none"},d[".".concat(o.a," &:focus + .ms-Checkbox-label")]={borderColor:c.TASK_BORDER_FOCUS},d[".".concat(o.a," &:focus + label")]=s.k,d[".".concat(o.a," &:focus + label .ms-Checkbox-text")]=s.k,d)};return Object(a.cb)({root:u,label:l,checkbox:m,input:f})})),l=Object(r.c)((function(){return{CHECKMARK_ICON_TOPPER:{iconName:"TaskStatusCircleCheckmark",style:{height:"7px",width:"10px",transform:"translateY(-7.5px)"}},CHECKMARK_ICON_ASSIGNER:{iconName:"TaskStatusCircleCheckmark",style:{height:"10px",transform:"translateY(-1px)",width:"14px"}}}}))},197:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubsscriptAndSuperscript=131072]="SubsscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},199:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},206:function(e,t,n){"use strict";var r,a,o;!function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"}(r||(r={})),function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"}(o||(o={}));var i=n(5),s=n(130),c=function(){function e(e){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743701))},this.getExistingFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743702))},this.updateFilterForFilteredRangeId=function(e,t){throw new i.c("Method not implemented.",i.d.reserveTag(537743703))},this.setActiveFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743704))},this.getActiveFilteredRangeId=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743705))},this.onFilteredRangeUpdated=new s.EventImpl((function(){})),this.onUserFilterManagerEvent=new s.EventImpl((function(){})),this.onActiveFilterUpdated=new s.EventImpl((function(){}))}return e.prototype.getFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743697))},e.prototype.teardownFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743698))},e.prototype.getOrder=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743699))},e.prototype.getFilterUsers=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743706))},e}(),d=n(277),u=n(533),l=n(4),m=n(1),f=function(){function e(e,t,n,r,a,o){this.id=e,this.filter=t,this.order=n,this.hostAPI=r,this.supportsUpdates=a,this.onTeardown=o,this.active=!0,this.onRangeUpdated=new s.EventImpl((function(){}))}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(e){return!!this.supportsUpdates&&(this.filter=e,this.hostAPI.updateFilterForFilteredRangeId(this.id,Object(m.__assign)({},e)),!0)},e.prototype.onChangeEventReceived=function(e){if(this.active){for(var t=0,n=e.changes;t<n.length;t++){var r=n[t];if(this.active)switch(r.type){case"FilterUpdate":this.filter=r.updatedFilter;break;case"Insert":this.order=Object(m.__spreadArray)(Object(m.__spreadArray)(Object(m.__spreadArray)([],this.order.slice(0,r.index),!0),[r.content],!1),this.order.slice(r.index),!0);break;case"Remove":this.order=Object(m.__spreadArray)(Object(m.__spreadArray)([],this.order.slice(0,r.index),!0),this.order.slice(r.index+1),!0);break;case"Reload":this.order=r.fullContent,Object(l.i)().assertConditionTag(r.reason===o.DivergentChange,"Received a full reload for an error reason.",537743690);break;case"Teardown":this.active=!1}}this.onRangeUpdated.trigger(e)}},e}(),p=function(e){var t=this;this.hostApi=e,this.getFilterUsers=function(){return void 0!==t.cachedUsers?Promise.resolve(t.cachedUsers):t.hostApi.getFilterUsers().then((function(e){return t.cachedUsers=e,e}))},this.onUserFilterManagerEventReceived=function(e){if(t.cachedUsers){var n=e.payload.type;switch(n){case"UserAdded":t.cachedUsers=Object(m.__spreadArray)(Object(m.__spreadArray)([],t.cachedUsers,!0),[e.payload.user],!1);break;case"UserRemoved":t.cachedUsers=t.cachedUsers.filter((function(t){return t.Provider===e.payload.user.Provider&&t.UserId===e.payload.user.UserId}));break;default:Object(i.m)(n)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)},g=function(e){var t=this;this.contentFilteredRangeHostAPI=e,this.filteredRanges=new Map,this.createFilteredRange=function(e){return t.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:e.contentTypes,hostFilter:e.filters,supportsFilterUpdates:e.supportsFilterUpdates}).then((function(e){var n=e.filterId,r=new f(n,e.filter,e.content,t.contentFilteredRangeHostAPI,e.supportsFilterUpdates,(function(){return t.onFilterTearDown(n)}));return t.filteredRanges.set(n,r),r}))},this.getFilteredRange=function(e){return t.filteredRanges.has(e)?Promise.resolve(t.filteredRanges.get(e)):t.contentFilteredRangeHostAPI.getExistingFilteredRange(e).then((function(n){if(n){var r=new f(n.filterId,n.filter,n.content,t.contentFilteredRangeHostAPI,n.supportsFilterUpdates,(function(){return t.onFilterTearDown(e)}));return t.filteredRanges.has(e)||t.filteredRanges.set(e,r),r}}))},this.setActiveFilteredRange=function(e){t.contentFilteredRangeHostAPI.setActiveFilteredRange(e)},this.getActiveFilteredRangeId=function(){return t.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(e){var n=t.filteredRanges.get(e.filterId);n&&n.onChangeEventReceived(e.payload)},this.onFilterTearDown=function(e){t.filteredRanges.delete(e)},this.getCapabilities=function(){return t.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return t.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return t.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new p(e)};var C=new Map;function h(e,t){Object(l.i)().assertConditionTag(e===d.a,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var n=C.get(e);n||(n=new u.a("ContentFilteredRange"),C.set(e,n)),n.injectInstance(new g(t))}function b(e){var t=C.get(e);if(!t)throw new i.c("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),i.d.reserveTag(538035221));return t.getInstanceOrThrow()}function v(e){var t;return void 0!==(null===(t=C.get(e))||void 0===t?void 0:t.getInstance())}!function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421141))},this.getExistingFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(e,t){throw new i.c("Method not implemented.",i.d.reserveTag(537421143))},this.setActiveFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421145))},this.onFilteredRangeUpdated=new s.EventImpl((function(){})),this.onUserFilterManagerEvent=new s.EventImpl((function(){})),this.onActiveFilterUpdated=new s.EventImpl((function(){}))}e.prototype.getFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421139))},e.prototype.getOrder=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421146))}}();n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v}))},210:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(4),a=n(17),o=n(51);function i(e,t,n,a,i){if(-1!==n&&Object(o.e)(t)<Object(o.e)(e)){var s=Object(r.i)().createActivityObject("SilentDraftDiscard",Object(r.j)(r.g.GlobalAPI),r.a.None,r.b.NecessaryServiceDataEvent);s.addDataField("DiscardReason",null!=n?n:0,r.d.SystemMetadata),s.addDataField("Source",a,r.d.SystemMetadata),s.successTag(i)}}function s(e,t,n){if(a.z()){var o=Object(r.i)().createActivityObject("MarkCommentCreation",n,r.a.None,r.b.NecessaryServiceDataEvent);o.addDataField("DraftId",e,r.d.SystemMetadata),o.addDataField("CommentId",t,r.d.SystemMetadata),o.addDocumentMetadata(r.f.Basic),o.successTag(591152859)}}},212:function(e,t,n){"use strict";var r;function a(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},213:function(e,t,n){"use strict";var r=n(5),a=n(4),o=n(231),i=n(159),s=n(193),c=n(132),d=n(73),u=n(89),l=n(195),m=n(229),f=n(54),p=n(47),g=n(17);function C(e,t,n,r,o){if(!g.lb()){var i=Object(a.i)().createActivityObject("SelectionAttemptWhileDrafting",n,a.a.None,a.b.NecessaryServiceDataEvent);i.addDataField("Trackback",r,a.d.SystemMetadata),i.addDataField("RenderContextType",o,a.d.SystemMetadata),i.addDataField("SelectionAttemptType",e,a.d.SystemMetadata),i.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,a.d.SystemMetadata),i.addDataField("DraftId",t.commentDraft.sessionConfiguration.draftId,a.d.SystemMetadata),i.successTag(590206682)}}var h,b=n(24),v=n(48),y=n(338),T=n(221),O=n(15),I=n(51),S=n(44),_=n(275),j=n(218);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(h||(h={}));var D=h,E=n(177),A=n(161),P=n(23),x=n(181),k=n(199),w=n(614),R=n(331),F=n(615),N=n(84),M=n(129),L=n(82),V=n(624);function B(e){var t=e.comment,n=e.threads,r=e.selectedComment,a=e.warningType,o=!t.parentId,i=!!(t.commentFlags&s.a.LowFidelity);if(!r)return!(!o||a!==S.a.DeleteThread||!i&&!L.j(n,t.commentId))||g.k()&&i&&o;var c=i||o&&(a===S.a.DeleteReply||a===S.a.DeleteThread)&&L.j(n,t.commentId),d=Object(S.j)(r.selectionDetails)?r.selectionDetails.selectedPostId:r.selectedCardId;return!(!c||d===t.commentId&&r.selectionDetails.lowFidelityWarningType===a)}function U(e){var t=e.result,n=e.localizationAPI;t===T.a.Success&&Object(o.b)(n.getString(67))}function H(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,c=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,m=L.b(i,n);m?B({comment:m,threads:i,selectedComment:s,warningType:S.a.DeleteReply})?d.showLowFidelityWarning({renderContextType:c,telemetryVisitor:u,trackback:r.d.reserveTag(593826118)},n,S.a.DeleteReply):(Object(o.b)(l.getString(65)),d.requestDeleteComment({renderContextType:c,telemetryVisitor:u,trackback:t},n)):Object(a.i)().assertConditionTag(!1,"Comment not found",593826117)}function G(e){var t=e.trackback,n=e.id,r=e.data,o=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=L.b(r,n);c?i.showPostErrorUI({renderContextType:o,telemetryVisitor:s,trackback:t},c.commentId):Object(a.i)().assertConditionTag(!1,"Comment not found",593875075)}function W(e){var t=e.trackback,n=e.id,r=e.data,o=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=L.b(r,n);c?i.clearPostErrorUI({renderContextType:o,telemetryVisitor:s,trackback:t},c.commentId):Object(a.i)().assertConditionTag(!1,"Comment not found",593875076)}function q(e){var t=e.trackback,n=e.id,o=e.data,i=e.selectedComment,s=e.renderContextType,c=e.actionDispatchers,d=e.telemetryVisitor,u=L.b(o,n);u?B({comment:u,threads:o,selectedComment:i,warningType:S.a.Edit})?c.showLowFidelityWarning({renderContextType:s,telemetryVisitor:d,trackback:r.d.reserveTag(593826120)},n,S.a.Edit):c.requestEditCommentSession({renderContextType:s,telemetryVisitor:d,trackback:t},n):Object(a.i)().assertConditionTag(!1,"Comment not found",593826119)}function z(e){var t=e.trackback,n=e.id,o=e.data,i=e.draftState,s=e.contentPromise,c=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,m=e.telemetryVisitor,g=e.localizationAPI,C=e.commitSource;if(Object(I.i)(i))return Promise.resolve();if(!i.postIdToDraftIdMap[n])return Object(a.i)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new p.a("Post draft to commit not found",r.d.reserveTag(587850403),-2130957492));var h=L.b(o,n);return h?l.commitCommentAndFocus({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},(function(){return s}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},c,u,Object(d.b)(h),C).then((function(e){U({result:e,localizationAPI:g})})).catch(Object(f.a)(r.d.reserveTag(593826122))):(Object(a.i)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new p.a("Comment not found in model",r.d.reserveTag(587850432),2130957505)))}function Y(e){var t=e.trackback,n=e.renderableItem,a=e.selectedComment,o=e.cardCollapsedState,i=e.dispatchProps,s=e.telemetryVisitor,c=e.componentTree,d=e.draftState_deprecated,u=e.shouldFocusAfter,l=L.i(n),m=L.e(n);return i.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:s,trackback:r.d.reserveTag(593237586)},v.a.SharedComments,void 0).then((function(e){if(g.lb()||e.draftDiscardBehavior!==E.a.CannotAutoDiscard||a&&Object(S.j)(a.selectionDetails)&&a.selectionDetails.selectedPostId===m){var n=o===_.a.Collapsed;i.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:s,trackback:t},Object(y.a)(l,v.a.SharedComments,n?{selectType:b.SelectActionType.ExpandCard}:{selectType:b.SelectActionType.SelectPost,selectedPost:m}),u||n).catch(Object(f.a)(r.d.reserveTag(590104649)))}else{var p=Object(O.K)(d);p&&C(2,p,s,r.d.reserveTag(590206683),c.componentTreeId.renderContextType)}}),Object(f.a)(r.d.reserveTag(593032901)))}function K(e){var t=e.trackback,n=e.commentId,i=e.setContents,s=e.data,d=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,m=e.renderContextType,p=e.dispatchProps,g=e.telemetryVisitor,C=e.localizationAPI;Object(F.a)();var h=L.b(s,n);d.postIdToDraftIdMap[n]&&h?(Object(o.b)(C.getString(66)),p.discardDraftAsync({renderContextType:m,telemetryVisitor:g,trackback:t},v.a.SharedComments,u,l).then((function(e){e===c.a.Handled&&h&&i&&i(h.commentBody)})).catch(Object(f.a)(r.d.reserveTag(593826127)))):Object(a.i)().assertConditionTag(!1,"Cannot find comment post to cancel '".concat(n,"'"),593826126)}function X(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function Q(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function Z(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function J(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function $(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;a.requestReplyCommentSession({renderContextType:r,telemetryVisitor:o,trackback:t},n)}function ee(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;a.collapseCard({renderContextType:r,telemetryVisitor:o,trackback:t},n.getId())}function te(e){var t=e.trackback,n=e.commentCardRef,a=e.dispatchProps,o=e.telemetryVisitor,i=e.componentTree,s=e.options,c=e.focusManager,d=e.isDraftThread,u={componentType:Object(x.b)(d),id:n.getId(),renderContextType:i.componentTreeId.renderContextType};c.postOnComponentFocusedRequest(u,(function(){m.a&&Object(r.i)("Handling card focus with polite selection on ".concat(n.getId())),i.isFocusOnOrWithin(u)&&ne({trackback:t,commentCardRef:n,dispatchProps:a,telemetryVisitor:o,componentTree:i,options:s})}))}function ne(e){var t,n=e.trackback,a=e.commentCardRef,o=e.dispatchProps,i=e.telemetryVisitor,s=e.componentTree,c=e.options,d=!1,u=c.selectActionType;switch(u){case b.SelectActionType.ExpandCard:var l=c,m=l.selectRootPost&&(g.lb()||!l.relativeDraftingState);d=l.shouldFocusAfter,t=m?{selectType:b.SelectActionType.SelectPost,selectedPost:a.getId()}:{selectType:b.SelectActionType.ExpandCard};break;case b.SelectActionType.SelectCard:case b.SelectActionType.Polite:t={selectType:u};break;default:Object(r.m)(u)}var p=Object(y.a)(a.getId(),v.a.SharedComments,t);c.selectActionType===b.SelectActionType.ExpandCard&&o.discardDraftIfEmpty({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(571281760)},v.a.SharedComments,void 0).then((function(e){if(!g.lb()&&e.draftDiscardBehavior===E.a.CannotAutoDiscard&&c.relativeDraftingState===j.a.InOtherCard){var t=Object(O.K)(c.draftState);t&&C(1,t,i,r.d.reserveTag(571281761),s.componentTreeId.renderContextType)}})).catch(Object(f.a)(r.d.reserveTag(571281762))),o.selectComment(s,{renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:i,trackback:n},p,d).catch(Object(f.a)(r.d.reserveTag(571340118)))}function re(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;e.shouldHighlightCard?a.highlightComment({renderContextType:r,telemetryVisitor:o,trackback:t},n.getId()):a.clearCommentHighlight({renderContextType:r,telemetryVisitor:o,trackback:t},n.getId())}function ae(e){var t=e.trackback,n=e.focusManager,o=e.componentTree,i=e.cardId,s=e.isCardLie,c=e.newHeight,d=e.renderContextType,u=e.selectedComment,m=e.dispatchProps,p=e.telemetryVisitor;if(d===P.a.HalfPane){if(void 0===c)return Object(a.i)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);s&&u&&u.selectedCardId===i&&m.requestDisplayConfiguration({renderContextType:d,telemetryVisitor:p,trackback:t},{displayMode:l.a.Variable,desiredHeight:c}).then((function(){n.focusCommentPaneCommand(o)})).catch(Object(f.a)(r.d.reserveTag(593826130)))}}function oe(e){var t=e.trackback,n=e.id,r=e.draftState,a=e.renderContextType,o=e.dispatchProps,s=e.telemetryVisitor;if(Object(V.b)(Object(N.a)())){var c=r.drafts[r.cardIdToDraftIdMap[n]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===i.f&&o.discardDraftAsync({renderContextType:a,telemetryVisitor:s,trackback:t},v.a.SharedComments,!1)}}function ie(e){var t,n=e.trackback,s=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,m=e.closeOnDiscard,p=e.cardId,g=e.draftState,C=e.telemetryVisitor,h=e.localizationAPI,b=e.focusManager,y=e.lieIndex,T=g.cardIdToDraftIdMap[p];if(T){Object(F.a)();var O=void 0;s&&(O=Object(R.a)(g,u,d));var I=(null===(t=g.drafts[T])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===i.f,S=function(e){var t=e.componentTree,n=e.focusManager,r=e.lieIndex,a=e.cardId,o=e.isReplyDraft,i=e.discardCallback;return function(e,s){if(i){return i((function(){return n.onUserAction(t,{userAction:k.a.CancelNewThreadDraft,threadIndex:r}),e?e():c.a.Unhandled}),s)}return e?(o?n.onUserAction(t,{userAction:k.a.CancelReplyDraft,cardId:a}):n.onUserAction(t,{userAction:k.a.CancelNewThreadDraft,threadIndex:r}),Promise.resolve(e())):Promise.resolve(c.a.Unhandled)}}({componentTree:u,focusManager:b,lieIndex:y,cardId:p,isReplyDraft:I,discardCallback:O});Object(o.b)(h.getString(I?64:103)),l.discardDraftAsync({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:C,trackback:n},v.a.SharedComments,m,S).then((function(e){e===c.a.Handled&&(I?b.onUserAction(u,{userAction:k.a.CancelReplyDraft,cardId:p}):b.onUserAction(u,{userAction:k.a.CancelNewThreadDraft,threadIndex:y}))}),Object(f.a)(r.d.reserveTag(592840735)))}else Object(a.i)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function se(e){var t=e.trackback,n=e.commentCardRef,o=e.draftState,i=e.areMentionsEnabled,s=e.session,c=e.componentTree,d=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,m=e.commitSource;if(Object(I.i)(o))return Promise.resolve();var g=n.getId();return o.cardIdToDraftIdMap[g]?d.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:c.componentTreeId.renderContextType},n.getContentsAsync,s,i,c,g,m).then((function(e){U({result:e,localizationAPI:l})})).catch(Object(f.a)(r.d.reserveTag(593826134))):(Object(a.i)().assertConditionTag(!1,"Card draft to commit not found, card ID ".concat(g),588853383),Promise.reject(new p.a("Card draft to commit not found",r.d.reserveTag(587850433),-2130957492)))}function ce(e){var t=e.trackback,n=e.id,r=e.renderContextType,a=e.dispatchProps,i=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(o.b)(s.getString(125)),a.requestReopenThread({renderContextType:r,telemetryVisitor:i,trackback:t},n,c)}function de(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,a=e.id,i=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(o.b)(d.getString(124)),n.onUserAction(t,{userAction:k.a.ResolveThread,cardId:a}),s.requestResolveThread({renderContextType:i,telemetryVisitor:c,trackback:r},a,u)}function ue(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,m=e.telemetryVisitor,p=e.localizationAPI,g=e.focusManager,C=e.isTask,h=e.threadIndex;if(e.shouldCheckForLowFidelity){var b=L.b(i,n);if(!b)return void Object(a.i)().assertConditionTag(!1,"Comment not found",593605342);if(B({comment:b,threads:i,selectedComment:s,warningType:S.a.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:r.d.reserveTag(593605343)},b.commentId,S.a.DeleteThread)}if(d.componentTreeId.renderContextType===P.a.HalfPane&&u){u(A.a.DeleteThread,(function(){return function(e){var t=e.dispatchProps,n=e.componentTree,o=e.selectedComment,i=e.telemetryVisitor;if(o)return t.requestDeleteThread({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(592840775)},o.selectedCardId),c.a.Handled;return Object(a.i)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),c.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:s,telemetryVisitor:m})}),(function(){return c.a.Canceled})).then((function(e){e===c.a.Handled&&g.onUserAction(d,{userAction:k.a.DeleteThread,threadIndex:h})})).catch(Object(f.a)(r.d.reserveTag(595632546)))}else Object(o.b)(p.getString(63)),g.onUserAction(d,{userAction:k.a.DeleteThread,threadIndex:h}),Object(M.a)(d.componentTreeId.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,C)}),100):l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,C)}function le(e){de({componentTree:e.componentTree,focusManager:e.focusManager,trackback:e.trackback,id:e.id,renderContextType:e.renderContextType,dispatchProps:e.dispatchProps,telemetryVisitor:e.telemetryVisitor,localizationAPI:e.localizationAPI,isTask:!0})}function me(e){var t=e.failTag,n=e.successTag,r=e.person,o=e.dispatchProps,i=e.telemetryVisitor,s=e.renderContextType,c=e.trackback,d=Object(a.i)().createActivityObject("CheckUserAccess",i,a.a.None,a.b.NecessaryServiceDataEvent),l={UserId:Object(u.h)(r),Provider:w.b,DisplayName:Object(u.g)(r),Email:Object(u.h)(r)};o.checkUserAccess(l).then((function(e){var t;d.addDataField("UserCanWrite",e.UserCanWrite,a.d.SystemMetadata),d.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,a.d.SystemMetadata),d.successTag(n)}),(function(e){d.failTag(t,-2130957562)})),o.addToCurrentMentionees({telemetryVisitor:i,trackback:c,renderContextType:s},r)}function fe(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,a=e.renderContextType,o=e.draftIdMap,i=e.actionDispatchers,s=e.telemetryVisitor,c=o[n];c&&i.draftEmptinessChanged({renderContextType:a,telemetryVisitor:s,trackback:t},c,r)}function pe(e){var t=e.trackback,n=e.id,a=e.editor,o=e.renderContextType,i=e.draftIdMap,s=e.draftMap,c=e.actionDispatchers,d=e.telemetryVisitor,u=i[n];if(u){var l=s[u];Object(r.n)(l,"Draft should be defined if draftId exists!",r.d.reserveTag(587850434)),l.pendingState===I.a.None&&c.saveDraft({renderContextType:o,telemetryVisitor:d,trackback:t},u,{editorContent:a.getContentsAsync(),editorCursorPosition:a.getCursorPositionAsync()})}}function ge(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;a.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:o,trackback:t},n)}function Ce(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,a=e.telemetryVisitor,o=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:a,trackback:t},o)}function he(e){var t=e.selectedState,n=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;t&&Object(S.h)(t)?o.clearLowFidelityWarning({renderContextType:n,telemetryVisitor:i,trackback:r.d.reserveTag(573612046)}):Object(a.i)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function be(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,o=e.onPostEdit;if(t)if(!Object(S.j)(t.selectionDetails)||Object(S.d)(t)){if(Object(S.e)(t))return void n(i=t.selectedCardId);if(Object(S.f)(t))return void Object(a.i)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var i=t.selectionDetails.selectedPostId;if(Object(S.c)(t))return void r(i);if(Object(S.f)(t))return void o(i)}else Object(a.i)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function ve(e){var t=e.ownProps,n=e.dispatchProps,o=e.componentTree,i=e.draftState,s=e.invokeModalDialog;if(o.componentTreeId.renderContextType!==P.a.HalfPane&&Object(I.b)(i)&&!g.o()){n.discardDraftAsync({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.d.reserveTag(592840770)},v.a.SharedComments,!0,Object(R.a)(i,o,s,A.a.ClosePaneDraft)).then((function(e){e===c.a.Canceled?Object(F.c)():e===c.a.Unhandled&&Object(a.i)().assertConditionTag(e!==c.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch(Object(f.a)(r.d.reserveTag(592840771)))}else!function(e){var t=e.dispatchProps,n=e.componentTree,o=e.telemetryVisitor,i=Object(a.i)().createActivityObject("ClosePane",o,a.a.None,a.b.NecessaryServiceDataEvent);i.addDataField("PaneCloseResult",D.NoDialog,a.d.SystemMetadata),i.successTag(592840773),t.requestClosePane({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:o,trackback:r.d.reserveTag(592840774)})}({dispatchProps:n,componentTree:o,telemetryVisitor:t.telemetryVisitor})}function ye(e,t,n,r,a){n.collapseCard({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},L.i(t))}function Te(e,t,n,r){if(!Object(I.d)(r)||g.lb()||"win32"===Object(N.a)()){var a=L.i(e);n.focusCommentCardCommand(t,a)}}function Oe(e,t,n,r,a,o,i){a.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:o,trackback:e},t,i,n)}function Ie(e,t,n,r,a){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:a,trackback:e},t)}n.d(t,"K",(function(){return B})),n.d(t,"D",(function(){return H})),n.d(t,"G",(function(){return G})),n.d(t,"A",(function(){return W})),n.d(t,"E",(function(){return q})),n.d(t,"C",(function(){return z})),n.d(t,"J",(function(){return Y})),n.d(t,"z",(function(){return K})),n.d(t,"k",(function(){return X})),n.d(t,"h",(function(){return Q})),n.d(t,"I",(function(){return Z})),n.d(t,"F",(function(){return J})),n.d(t,"a",(function(){return $})),n.d(t,"b",(function(){return ee})),n.d(t,"i",(function(){return te})),n.d(t,"n",(function(){return ne})),n.d(t,"j",(function(){return re})),n.d(t,"f",(function(){return ae})),n.d(t,"g",(function(){return oe})),n.d(t,"e",(function(){return ie})),n.d(t,"c",(function(){return se})),n.d(t,"l",(function(){return ce})),n.d(t,"m",(function(){return de})),n.d(t,"d",(function(){return ue})),n.d(t,"o",(function(){return le})),n.d(t,"t",(function(){return me})),n.d(t,"q",(function(){return fe})),n.d(t,"x",(function(){return pe})),n.d(t,"u",(function(){return ge})),n.d(t,"y",(function(){return Ce})),n.d(t,"r",(function(){return he})),n.d(t,"s",(function(){return be})),n.d(t,"p",(function(){return ve})),n.d(t,"B",(function(){return ye})),n.d(t,"H",(function(){return Te})),n.d(t,"w",(function(){return Oe})),n.d(t,"v",(function(){return Ie}))},218:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},219:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},221:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},226:function(e,t,n){"use strict";var r,a,o;function i(e){return!!e&&void 0!==e.Id&&void 0!==e.Name&&void 0!==e.UserPrincipalName&&void 0!==e.EmailAddresses&&void 0!==e.SuggestionType&&void 0!==e.SuggestionSubtype&&void 0!==e.HostAppSuggestion&&void 0!==e.Source&&void 0!==e.SuggestionOrigin}function s(e){return!!e&&void 0!==e.UserId&&void 0!==e.Provider}!function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(a||(a={})),function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(o||(o={})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}))},229:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));n(84);var r="sharedcommentsdemo"===Object({NODE_ENV:"production"}).TEST_PAGE,a=!1},23:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},230:function(e,t,n){"use strict";var r,a=n(368),o=n(592),i=n(90);!function(e){e[e.FailedToCommit=1]="FailedToCommit"}(r||(r={}));var s=n(136),c=n(193),d=n(131),u=n(171),l=n(132),m=(n(168),n(797));n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"c",(function(){return d.a})),n.d(t,"j",(function(){return d.d})),n.d(t,"i",(function(){return d.c})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"k",(function(){return m.a}))},231:function(e,t,n){"use strict";var r=n(575),a=new r.a;n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r.c})),n.d(t,"b",(function(){return r.b}))},234:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(131);function a(e){return e.sessionType===r.a}function o(e){return e.sessionType===r.d&&void 0!==e.threadId}function i(e){return e.sessionType===r.b&&void 0!==e.commentId}},235:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},24:function(e,t,n){"use strict";n.r(t);var r=n(19),a=n(595);function o(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function i(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}var s=n(596),c=n(597),d=n(598),u=n(599),l=n(600);function m(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function f(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function p(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}var g=n(601),C=n(602),h=n(603);function b(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function v(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function y(e,t){return Object(r.b)("COLLAPSE_CARD",{cardId:t},e)}function T(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}var O=n(604),I=n(408);function S(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}var _=n(372);function j(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var D=n(328),E=n(510),A=n(605),P=n(606);function x(e,t){return Object(r.b)("LOAD_DEFAULT_FILTER",t,e)}function k(e,t){return Object(r.b)("LOAD_FILTER",t,e)}var w=n(511),R=n(607);function F(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function N(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function M(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}function L(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}function V(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function B(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}function U(e){return Object(r.b)("READY_TO_RENDER",{},e)}var H=n(608);function G(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function W(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}function q(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}function z(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}function Y(e,t,n,a){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:a},e)}function K(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function X(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}function Q(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}var Z=n(512);function J(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}var $=n(113);function ee(e,t,n,a,o,i,s){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:i,reason:s,iterableContentTypes:n,restrictToCurrentContext:a,preventLooping:o},e)}function te(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function ne(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var re=n(609);function ae(e,t){return Object(r.b)("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}function oe(e,t){return Object(r.b)("SET_FILTERING_CAPABILITIES",t,e)}var ie=n(610);function se(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}function ce(e){return Object(r.b)("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}var de=n(611),ue=n(612);function le(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function me(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}function fe(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function pe(e,t){return Object(r.b)("UPDATE_FILTER_RANGE",t,e)}function ge(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function Ce(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function he(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}function be(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var ve=n(613);function ye(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function Te(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function Oe(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}n.d(t,"chainActionDetails",(function(){return r.a})),n.d(t,"createAction",(function(){return r.b})),n.d(t,"addContentExtension",(function(){return a.a})),n.d(t,"addToCurrentMentionees",(function(){return o})),n.d(t,"applyCommentChanges",(function(){return i})),n.d(t,"beginDraftingFailure",(function(){return s.a})),n.d(t,"beginDraftingSuccess",(function(){return c.a})),n.d(t,"beginProcessingCommit",(function(){return d.a})),n.d(t,"beginProcessingDiscard",(function(){return u.a})),n.d(t,"beginViewInitialization",(function(){return l.a})),n.d(t,"cancelCommentCreateThread",(function(){return m})),n.d(t,"cancelCommentPostEdit",(function(){return f})),n.d(t,"cancelCommentReply",(function(){return p})),n.d(t,"cancelDiscard",(function(){return g.a})),n.d(t,"clearCommentHighlight",(function(){return C.a})),n.d(t,"clearCommentSelection",(function(){return h.a})),n.d(t,"clearLowFidelityWarning",(function(){return b})),n.d(t,"clearPostErrorUI",(function(){return v})),n.d(t,"collapseCard",(function(){return y})),n.d(t,"commentContextChanged",(function(){return T})),n.d(t,"commitDraft",(function(){return O.a})),n.d(t,"getCommitDraftSessionType",(function(){return O.b})),n.d(t,"commitFailure",(function(){return I.a})),n.d(t,"dispatchLoadThreads",(function(){return S})),n.d(t,"displayDraftWarning",(function(){return _.a})),n.d(t,"draftEmptinessChanged",(function(){return j})),n.d(t,"emptyAction",(function(){return D.b})),n.d(t,"EMPTY_ACTION",(function(){return D.a})),n.d(t,"endViewInitialization",(function(){return E.a})),n.d(t,"highlightComment",(function(){return A.a})),n.d(t,"loadComment",(function(){return P.a})),n.d(t,"loadDefaultFilter",(function(){return x})),n.d(t,"loadFilter",(function(){return k})),n.d(t,"loadPersonaIconProperties",(function(){return w.a})),n.d(t,"loadVirtualizedComments",(function(){return R.a})),n.d(t,"moveFocusToCanvas",(function(){return F})),n.d(t,"nextPopulatedContextDetailsUpdated",(function(){return N})),n.d(t,"onInitialRender",(function(){return M})),n.d(t,"populateSmartReply",(function(){return L})),n.d(t,"requestPresentLinkToComment",(function(){return V})),n.d(t,"queueLoadThreads",(function(){return B})),n.d(t,"readyToRender",(function(){return U})),n.d(t,"reloadComments",(function(){return H.a})),n.d(t,"removeContentExtensions",(function(){return G})),n.d(t,"requestClosePane",(function(){return W})),n.d(t,"requestDeletePost",(function(){return q})),n.d(t,"requestDeleteThread",(function(){return z})),n.d(t,"requestModalConfirmation",(function(){return Y})),n.d(t,"requestReopenThread",(function(){return K})),n.d(t,"requestShowPane",(function(){return X})),n.d(t,"requestThreadResolve",(function(){return Q})),n.d(t,"resolveAtMentionCapability",(function(){return Z.a})),n.d(t,"saveDraft",(function(){return J})),n.d(t,"SelectActionType",(function(){return $.a})),n.d(t,"shouldSelectActionExpandCard",(function(){return $.c})),n.d(t,"selectComment",(function(){return $.b})),n.d(t,"selectContent",(function(){return ee})),n.d(t,"selectFirstThreadInNextCommentContext",(function(){return te})),n.d(t,"selectLastThreadInPreviousCommentContext",(function(){return ne})),n.d(t,"sessionRequestStartedAndLockSelection",(function(){return re.a})),n.d(t,"setContentNavigationEnablement",(function(){return ae})),n.d(t,"setFilteringCapabilities",(function(){return oe})),n.d(t,"showLowFidelityWarning",(function(){return ie.a})),n.d(t,"showPostErrorUI",(function(){return se})),n.d(t,"toggleTaskAssigner",(function(){return ce})),n.d(t,"topVisibleThreadChanged",(function(){return de.a})),n.d(t,"updateContextState",(function(){return ue.a})),n.d(t,"updateDraftRenderContext",(function(){return le})),n.d(t,"updateDraftThread",(function(){return me})),n.d(t,"updateExtensionPriority",(function(){return fe})),n.d(t,"updateFilterRange",(function(){return pe})),n.d(t,"updateMentioneesStillInDraft",(function(){return ge})),n.d(t,"updateModelCapabilities",(function(){return Ce})),n.d(t,"updateSelectedTaskAssignee",(function(){return he})),n.d(t,"updateSelectedTaskAssignees",(function(){return be})),n.d(t,"updateSuggestionsDetails",(function(){return ve.a})),n.d(t,"viewContainerChanged",(function(){return ye})),n.d(t,"viewContainerFoldableLayoutStateChanged",(function(){return Te})),n.d(t,"viewContainerVisibilityChanged",(function(){return Oe}))},243:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n(4),a=n(80);function o(e){if(function(e){var t=a.a(e);if(!t||t===a.e(e))return!1;var n=a.f(e,t);return!!n&&n.canUpdateFilter}(e))return a.a(e)}function i(e,t){return!a.g(e)||void 0!==a.d(e).find((function(e){return e.contentId===t}))}function s(e,t){t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,r.d.SystemMetadata),t.addDataField("IsFilterApplied",!!e.filterState.activeFilterId&&e.filterState.activeFilterId!==a.e(e),r.d.SystemMetadata)}},257:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(17),a={},o=function(e){return Object(r.b)()?e.commentState.tasks:a},i=function(e){return e.commentState.historyRecordViewState}},261:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},268:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u}));var r=n(4),a=n(159),o=n(24),i=n(48);function s(e){return void 0!==e&&0!=(e.commentFlags&a.c.Resolved)}function c(e){return e!==i.a.Canvas}function d(e){return Object(o.shouldSelectActionExpandCard)(e)}function u(e,t){e.addDataField("IsCommentResolved",t,r.d.SystemMetadata)}},275:function(e,t,n){"use strict";var r;!function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={})),t.a=r},276:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),a=n(219),o=n(23);function i(e){switch(e){case a.b.HalfPane:return o.a.HalfPane;case a.b.FullPane:return o.a.FullPane;default:Object(r.m)(e)}}},279:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(268),a=n(40),o=n(230),i=function(){function e(e,t,n){this.threadIds=e,this.commentData=t,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,e.length))}return e.prototype.next=function(){var e=this.pointer,t=this.threadIds.length-1;if(this.pointer<t)do{++this.pointer}while(this.pointer<=t&&Object(r.a)(Object(a.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer<t||this.pointer===t&&e<t?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&Object(r.a)(Object(a.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),s=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&o.f.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&o.f.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(5),a=n(26),o=function(e){return e.contentExtensions.extensions},i=function(e,t){var n=o(e)[t];return void 0!==n&&n.priority!==a.d.Disabled},s=function(e,t){if(!t)return!1;switch(t.renderMode){case a.e.Integrated:case a.e.TaskPaneItem:return void 0!==(n=o(e)[t.renderMode])&&n.priority!==a.d.Disabled;case a.e.Isolated:var n;return void 0!==(n=o(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==a.d.Disabled;default:Object(r.m)(t)}},c=function(e){return e.contentExtensions.contentNavigationSupported}},328:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(5),a=n(4),o=n(23),i=n(19);function s(e){return Object(i.b)("",{},e)}var c=s({renderContextType:o.a.None,telemetryVisitor:Object(a.j)(a.g.ReviewedAsNotNecessary),trackback:r.d.reserveTag(595735680)})},330:function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},331:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(363),a=n(15),o=n(177),i=n(23),s=n(938),c=function(e,t,n,r,o){return e&&t===i.a.HalfPane&&void 0===o&&(!r||r.selectedCardId===Object(a.G)(n,!0,t))},d=function(e,t,n,a){if(n&&Object(r.a)(e)===o.a.CannotAutoDiscard){var i=null!=a?a:Object(s.a)(e,t.componentTreeId.renderContextType);return function(e,t){return n(i,e,t)}}}},337:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(5),a=n(4),o=n(118),i=n(131),s=n(142),c=n(106),d=n(177),u=n(23),l=n(276),m=n(129),f=n(396),p=n(54),g=n(47),C=n(178),h=n(117),b=n(17),v=n(15),y=n(51),T=n(11),O=n(63),I=n(19),S=n(48),_=n(596),j=n(597),D=n(328),E=n(609),A=n(409),P=n(375);function x(e,t,n,x,k){return function(w,R){var F=R(),N=Object(a.i)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),M=s.b[n.sessionType];return N.addDataField("SessionType",M,a.d.SystemMetadata),N.addDataField("Trackback",e.trackback,a.d.SystemMetadata),N.addDataField("RenderContextType",e.renderContextType,a.d.SystemMetadata),N.addDataField("PaneVisibilityState",O.e(F),a.d.SystemMetadata),b.b()||n.sessionType!==i.c?(T.p(F).atMention===o.b.Enabled&&Object(f.a)().catch(Object(p.a)(r.d.reserveTag(591397600))),w(Object(A.a)(e,S.a.SharedComments,s.c(n))).catch((function(e){return Object(p.a)(r.d.reserveTag(591397602))(e),{draftDiscardResult:o.g.Unhandled,draftDiscardBehavior:d.a.CannotAutoDiscard}})).then((function(o){var i,d;N.addDataField("DraftDiscardBehavior",o.draftDiscardBehavior,a.d.SystemMetadata);var f=R(),p=T.h(f);return Object(y.d)(p)||!b.kb()&&T.g(f)&&s.d(n)?(N.addDataField("SessionAlreadyRequested",!0,a.d.SystemMetadata),N.addDataField("DraftRenderContextType",null!==(d=null===(i=Object(v.K)(p))||void 0===i?void 0:i.renderContextType)&&void 0!==d?d:u.a.None,a.d.SystemMetadata),N.successTag(591397633),Promise.resolve(w(D.a))):(N.addDataField("SessionAlreadyRequested",!1,a.d.SystemMetadata),w(Object(E.a)(Object(I.a)(e,r.d.reserveTag(591397634)),n,x)),t.beginDraftingAsync(n).then((function(t){if(void 0===t.sessionConfiguration)throw new g.a(h.c,r.d.reserveTag(589103630),-2130957532);s.d(n)&&b.H()&&w(Object(P.a)(Object(I.a)(e,r.d.reserveTag(591397635)),[],[],k,t.author)),N.addDataField("DraftId",t.sessionConfiguration.draftId,a.d.SystemMetadata);var o=R(),i=function(e,t,n){if(t!==c.a.Closed&&e!==u.a.DiscreteIsolated)return Object(l.a)(n);if(!Object(m.b)(e))return e;if(b.p()&&t===c.a.Closed)return u.a.None;return Object(l.a)(n)}(e.renderContextType,O.e(o),O.d(o).containerType);return N.addDataField("DraftRenderContextType",i,a.d.SystemMetadata),Object(a.i)().assertConditionTag(i===e.renderContextType||e.renderContextType===u.a.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(i," based on pane state"),554714642),N.successTag(591397640),w(Object(j.a)(Object(I.a)(e,r.d.reserveTag(591397641)),t,i))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?N.successTag(591397643):N.failTag(591397642,Object(C.a)(t)),w(Object(_.a)(Object(I.a)(e,r.d.reserveTag(591397644)),n,t))})))}))):(N.failTag(591397599,-2130957513),Promise.resolve(w(D.a)))}}},338:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(1),a=n(5),o=n(4),i=n(181),s=n(43),c=n(229),d=n(44),u=n(11),l=n(19),m=n(113);function f(e,t,n,r){return function(f,p){f(Object(l.b)("SELECT_COMMENT",n,t));var g=p(),C=Object(u.t)(g);return r&&C&&C.selectedCardId===n.selectedCard&&(n.selectType!==m.a.SelectPost||Object(d.j)(C.selectionDetails)&&C.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if(Object(d.j)(C.selectionDetails))r={componentType:s.a.Post,id:C.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var l=Object(u.h)(g).drafts[C.selectedCardId],m=!!l&&"CREATE"===l.commentDraft.sessionConfiguration.sessionType;r={componentType:Object(i.b)(m),id:C.selectedCardId,renderContextType:t.renderContextType}}var f=e.getComponentById(r);f?(c.a&&Object(a.i)("Focusing comment ".concat(r.id," with render context type ").concat(r.renderContextType," after selection.")),f.focus()):Object(o.i)().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(r)),590104655),n()}))})):(Object(o.i)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function p(e,t,n){return Object(r.__assign)({selectedCard:e,source:t},n)}},355:function(e,t,n){"use strict";var r=n(206),a=n(5),o=n(1038),i=n(4),s=n(168),c=n(89),d=n(47),u=n(117),l=n(17),m=n(170),f=n(44),p=n(499),g=n(218);n(161),n(23);function C(e,t,n){var r=n&&l.k()?t-1:t-2;if(r<1)throw new d.a(u.f,a.d.reserveTag(589103692),-2130957559);var o=l.k();return 1===r?o?e.getString(106):e.getString(9):o?e.formatString(107,String(r)):e.formatString(10,String(r))}function h(e,t){switch(t){case s.a.AtFinishNextCommentIsFirst:return e.getString(8);case s.a.AtStartNextCommentIsFirst:return e.getString(6);case s.a.MoreCommentsUpcoming:case s.a.DocumentHasComments:return e.getString(7);case s.a.OnlyCommentsInCurrent:case s.a.NoComments:case s.a.Unknown:return"";default:Object(a.m)(t)}}function b(e,t,n,r){return n?t?e.getString(16):e.getString(17):l.G()&&void 0!==r&&r!==g.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function v(e,t){switch(t){case m.a.ReturnToDraft:return e.getString(110);case m.a.GrantAccessFailedSilently:return e.getString(134);case m.a.GrantAccessCanceled:return e.getString(234);case m.a.CommitFailed:return e.getString(135);case m.a.None:return Object(i.i)().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function y(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function T(e,t){return t?Object(f.f)(t)?e.getString(35):Object(f.c)(t)?e.getString(36):"":""}n.d(t,"v",(function(){return C})),n.d(t,"j",(function(){return h})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"k",(function(){return T})),n.d(t,"a",(function(){return I})),n.d(t,"f",(function(){return S})),n.d(t,"c",(function(){return _})),n.d(t,"m",(function(){return j})),n.d(t,"q",(function(){return D})),n.d(t,"r",(function(){return E})),n.d(t,"u",(function(){return A})),n.d(t,"t",(function(){return P})),n.d(t,"d",(function(){return x})),n.d(t,"l",(function(){return k})),n.d(t,"b",(function(){return w})),n.d(t,"o",(function(){return R})),n.d(t,"s",(function(){return F})),n.d(t,"n",(function(){return N})),n.d(t,"e",(function(){return M})),n.d(t,"i",(function(){return L}));var O=Object(o.a)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return e instanceof Error&&"RangeError"===e.name}return!1}));function I(e,t){var n=!!t&&O();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,r)}return Object(i.i)().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(O(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(n){return Object(i.i)().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(n instanceof Error?n.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(O(),", Date: ").concat(e.toString()),595953050),""}}function S(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function _(e,t){switch(e){case p.a.Draft:case p.a.DraftPreCommitPending:return t.getString(16);default:return t.getString(89)}}function j(e){return e.getString(122)}function D(e,t){return 0===e.length?(Object(i.i)().assertConditionTag(l.j(),"Unexpected state: task is unassigned",528064848),A(t)):l.j()&&1!==e.length?Object(c.c)(e)?t.getString(250):t.getString(251):function(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(c.k)(e))}(e[0],t)}function E(e,t,n){if(0===e.length)return P(t,n);if(!l.j())return function(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(c.k)(e)):n.formatString(129,Object(c.k)(e))}(e[0],t,n);var r=e.map((function(e){return Object(c.k)(e)})).join(", ");return t?n.formatString(130,r):n.formatString(129,r)}function A(e){return e.formatString(111,e.getString(133))}function P(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function x(e,t,n,r){var a,o=t===p.a.Draft||t===p.a.DraftPreCommitPending;return null!==(a=w(e,n,r))&&void 0!==a?a:o?e.getString(173):e.getString(174)}function k(e,t,n){var r="";switch(n.length){case 0:r=e.getString(133);break;case 1:r=n[0];break;case 2:r=e.formatString(242,n[0],n[1]);break;case 3:r=e.formatString(243,n[0],n[1],n[2]);break;default:r=e.formatString(244,n[0],(n.length-1).toString())}var a=t?114:252;return e.formatString(a,r)}function w(e,t,n){var r=Object(c.g)(n);if(r)return e.formatString(t?179:178,r)}function R(e,t){return e?t.getString(176):t.getString(126)}function F(e,t,n){return l.j()?0===t.length?n.getString(181):n.formatString(114,t.map((function(e){return Object(c.k)(e)})).join(", ")):function(e,t,n){return e?n.getString(180):(null==t?void 0:t.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}(e,t[0],n)}function N(e,t){switch(t){case r.a.ActiveOnly:return e.getString(247);case r.a.ResolvedOnly:return e.getString(246);case r.a.All:return e.getString(245);default:Object(a.m)(t)}}function M(e,t){switch(t){case r.c.HostDefaultOrder:return"";case r.c.NewestFirst:return e.getString(248);default:Object(a.m)(t)}}function L(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}},359:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},361:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(275),a=n(23);function o(e,t,n){return n===a.a.HalfPane||t.includes(e)?r.a.Expanded:r.a.Collapsed}},363:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(118),a=n(177),o=n(51),i=n(15);function s(e){if(!Object(o.c)(e))return a.a.NoDraft;if(!function(e){var t=Object(i.I)(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return a.a.CannotAutoDiscard;var t=Object(i.K)(e);return t&&Object(r.k)(t.commentDraft.sessionConfiguration)?a.a.CannotAutoDiscard:a.a.CanAutoDiscard}},368:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},369:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(219);function a(e){return e.containerType===r.b.HalfPane}},370:function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},371:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},372:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},373:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n(1),a=n(99),o=n(15),i=n(40),s=n(437);function c(e,t){for(var n=null==t?void 0:t(),r=[],o=0,i=void 0;o<e.length;){if(e[o].type===a.a.Thread){var s=e[o].id;i=s,r.push(u(s,void 0,n))}else r.push(u(e[o].id,i,n));o++}return r}function d(e){return e.map((function(e){return u(e,void 0,void 0)}))}function u(e,t,n){var a=void 0;return n&&(a=Object(i.b)(Object(i.a)(n),e)),a||Object(r.__assign)(Object(r.__assign)({},Object(o.f)(e)),{parentId:null!=t?t:""})}var l=(new s.a).insert("").toJSON();(new s.a).toJSON()},374:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(5),a=n(4),o=n(24),i=n(131),s=n(132),c=n(15),d=n(51),u=n(44),l=n(11),m=n(19),f=n(599),p=n(601);function g(e,t,n,g){return function(C,h){var b,v,y=h(),T=Object(a.i)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),O=l.h(y),I=l.t(y),S=Object(d.i)(O);T.addDataField("Trackback",e.trackback,a.d.SystemMetadata),T.addDataField("RenderContextType",e.renderContextType,a.d.SystemMetadata),T.addDataField("CommitPendingAttemptedCancel",S,a.d.SystemMetadata),T.addDataField("ActionSource",t,a.d.SystemMetadata);var _=function(e,t,n){var s=l.v(e),c=l.t(e);if(!s)return c&&Object(u.j)(c.selectionDetails)&&Object(u.h)(c)?{cancelAction:o.cancelCommentPostEdit(Object(m.a)(n,r.d.reserveTag(593278744)),c.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;var d=s.commentDraft.sessionConfiguration.sessionType;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:o.cancelCommentCreateThread(Object(m.a)(n,r.d.reserveTag(593278745)),t),sessionType:d};case"REPLY":return{cancelAction:o.cancelCommentReply(Object(m.a)(n,r.d.reserveTag(593278746)),s.commentDraft.sessionConfiguration.threadId,t),sessionType:d};case"EDIT":return{cancelAction:o.cancelCommentPostEdit(Object(m.a)(n,r.d.reserveTag(593278747)),s.commentDraft.sessionConfiguration.commentId,t),sessionType:d};default:return Object(a.i)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(y,n,e);if("number"==typeof _)return T.failTag(r.d.reserveTag(593278749),_),Promise.resolve(s.a.Handled);var j=_.sessionType,D=_.cancelAction;return T.addDataField("ActiveSessionType",j,a.d.SystemMetadata),S||!Object(d.b)(O)&&!Object(u.g)(I)?(T.addDataField("DraftId","NoActiveDraft",a.d.SystemMetadata),T.addDataField("DiscardUnnecessary",!0,a.d.SystemMetadata),T.successTag(593278755),Promise.resolve(s.a.Unhandled)):(T.addDataField("DiscardUnnecessary",!1,a.d.SystemMetadata),T.addDataField("DraftId",null!==(v=null===(b=Object(c.K)(O))||void 0===b?void 0:b.commentDraft.sessionConfiguration.draftId)&&void 0!==v?v:"InvalidDraftState",a.d.SystemMetadata),C(Object(f.a)(Object(m.a)(e,r.d.reserveTag(593278750)))),g?g((function(){return C(D),T.addDataField("CancelledByUser",!1,a.d.SystemMetadata),T.successTag(593278751),s.a.Handled}),(function(){return T.addDataField("CancelledByUser",!0,a.d.SystemMetadata),T.successTag(593278752),C(Object(p.a)(Object(m.a)(e,r.d.reserveTag(593278753)))),s.a.Canceled})):(C(D),T.successTag(593278754),Promise.resolve(s.a.Handled)))}}},375:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(54),o=n(531),i=n(11),s=n(511);function c(e,t,n,c,d){return function(u,l){var m=Object(o.c)(t,n,i.r(l()),d);if(0===m.length)return Promise.resolve();if(c.getPersonaIconPropertiesArray)c.getPersonaIconPropertiesArray(m).then((function(t){u(Object(s.a)(e,Object(o.b)(t)))})).catch(Object(a.a)(r.d.reserveTag(595645964)));else{var f=Object(o.a)(m);u(Object(s.a)(e,Object(o.b)(f)))}return Promise.resolve()}}},382:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},395:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r,a=n(5),o=n(4),i=n(47);function s(e){if(r)throw Object(o.i)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",a.d.reserveTag(577610271),-2130957508);r=e}function c(){if(!r)throw Object(o.i)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",a.d.reserveTag(577610272),-2130957509);return r}},396:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(5),a=n(4),o=n(84),i=!1,s=!1;function c(){var e=void 0;return s||(e=Object(a.i)().createActivityObject("LPPLazyLoad",Object(a.j)(a.g.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent),s=!0),m((function(){return Promise.all([n.e(1),n.e(4)]).then(n.bind(null,1416))}),e).then((function(t){return e&&e.successTag(528282444),t}),(function(t){e&&e.failTag(528282445,-2130957488),s=!1}))}function d(){var e;return i||(e=Object(a.i)().createActivityObject("AtMentionLazyLoad",Object(a.j)(a.g.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent),i=!0),Promise.all([n.e(1),n.e(2)]).then(n.bind(null,1422)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e&&e.failTag(595895121,-2130957515),i=!1}))}function u(e){var t,o=Object(a.i)().createActivityObject("SharedCommentsUILazyLoad",Object(a.j)(a.g.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent);switch(o.addDataField("ContainerName",e,a.d.SystemMetadata),e){case"ExtensionAwareCommentPaneContainer":t=m((function(){return Promise.all([n.e(1),n.e(20)]).then(n.bind(null,1418))}),o);break;case"HostableCommentCardRendererContainer":t=m((function(){return Promise.all([n.e(1),n.e(20)]).then(n.bind(null,1421))}),o);break;default:Object(r.m)(e)}return t.then((function(e){return o.successTag(595731075),e}),(function(e){o.failTag(595734544,-2130957504)}))}function l(){var e=Object(a.i)().createActivityObject("ImmerEs5PluginDelayLoad",Object(a.j)(a.g.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent);return"undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect?(e.successTag(526254848),Promise.resolve(void 0)):(Object(a.i)().assertConditionTag("web"===Object(o.a)(),"Native should not need to support the ES5 fallback and Immer reducers will fail",526254849),m((function(){return n.e(3).then(n.bind(null,1417))}),e).then((function(t){return e&&e.successTag(526254850),t}),(function(t){e&&e.failTag(526254851,-2130957484)})))}function m(e,t,n){void 0===n&&(n=3);return new Promise((function(r,o){e().then((function(e){t&&t.addDataField("DelayLoadRetryCount",n,a.d.SystemMetadata),r(e)}),(function(a){setTimeout((function(){1!==n?m(e,t,n-1).then(r,o):o(a)}),500)}))}))}},40:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(17);function a(e){return r.kb()}function o(e){return r.kb()}function i(e){return r.kb()||0===e.length||"string"==typeof e[0]}function s(e){return r.kb()}function c(e){return s()?e.postData:e.commentData}function d(e,t){return o()?e[t]:e.find((function(e){return e.commentId===t}))}},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("COMMIT_FAILURE",{commitText:t},e)}},409:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),a=n(4),o=n(132),i=n(177),s=n(363),c=n(51),d=n(170),u=n(11),l=n(19),m=n(372),f=n(374);function p(e,t,n){return function(p,g){var C=g(),h=u.h(C),b=Object(a.i)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),v=Object(c.i)(h);b.addDataField("Trackback",e.trackback,a.d.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,a.d.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",v,a.d.SystemMetadata),b.addDataField("ActionSource",t,a.d.SystemMetadata);var y=Object(s.a)(h);return b.addDataField("DraftDiscardBehavior",y,a.d.SystemMetadata),y===i.a.CanAutoDiscard?p(Object(f.a)(e,t,!1)).then((function(e){return b.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:y}})):(void 0!==n&&y===i.a.CannotAutoDiscard&&(b.addDataField("DraftWarningReason",n,a.d.SystemMetadata),p(Object(m.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,r.d.reserveTag(591728722))))),b.successTag(539754958),Promise.resolve({draftDiscardResult:o.a.Canceled,draftDiscardBehavior:y}))}}},41:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},o={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",REST_RESOLVED_BODY:a.GRAY_20,RESOLVED_CARD_TEXT:a.GRAY_130,ACTIVE_COMMENT_TEXT:a.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object(r.__assign)(Object(r.__assign)({},a),o)},414:function(e,t,n){"use strict";var r=n(5),a=n(195),o=n(369),i=n(54),s=n(47),c=n(63),d=n(19);function u(e,t){return function(n,u){var l=c.d(u());return Object(o.a)(l)&&Object(a.b)(t)?l.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return Object(d.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return Object(i.a)(r.d.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new s.a("Not half pane or half pane configuration",r.d.reserveTag(577610273),-2130957557))}}n.d(t,"a",(function(){return u}))},43:function(e,t,n){"use strict";var r;function a(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function o(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function i(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return o(e)&&o(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},437:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));n(5),n(47);var r,a=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function o(e,t,n){return{fullName:e,email:t,resolveState:n}}function i(e){return{atmention:{contentId:e.contentId,isCurrentUser:e.isCurrentUser,directoryId:e.directoryId}}}function s(e){return c(JSON.parse(e))}function c(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},44:function(e,t,n){"use strict";var r;function a(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function o(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function s(e){return o(e)||i(e)}function c(e){return!!e&&(a(e)||o(e))}function d(e){return!!e&&(s(e)||a(e))}function u(e){return void 0!==e.selectedPostId}function l(e){return u(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function m(e,t){return!!t&&u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return m})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},440:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=261;function a(){return r}function o(e){r=e}},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17);function a(e,t,n){return!e||!!t&&((!Object(r.U)()||!n)&&(0!==e.numberOfLoadedComments&&(void 0===e.selectedThreadIndex||e.selectedThreadIndex<e.numberOfLoadedThreads)))}},448:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function a(e){return!!e&&!!e[K]}function o(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===X}(e)||Array.isArray(e)||!!e[Y]||!!e.constructor[Y]||f(e)||p(e))}function i(e){return a(e)||r(23,e),e[K].t}function s(e,t,n){void 0===n&&(n=!1),0===c(e)?(n?Object.keys:Q)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function c(e){var t=e[K];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:f(e)?2:p(e)?3:0}function d(e,t){return 2===c(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){return 2===c(e)?e.get(t):e[t]}function l(e,t,n){var r=c(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function m(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function f(e){return G&&e instanceof Map}function p(e){return W&&e instanceof Set}function g(e){return e.o||e.t}function C(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Z(e);delete t[K];for(var n=Q(t),r=0;r<n.length;r++){var a=n[r],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function h(e,t){return void 0===t&&(t=!1),v(e)||a(e)||!o(e)||(c(e)>1&&(e.set=e.add=e.clear=e.delete=b),Object.freeze(e),t&&s(e,(function(e,t){return h(t,!0)}),!0)),e}function b(){r(2)}function v(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function y(e){var t=J[e];return t||r(18,e),t}function T(e,t){J[e]||(J[e]=t)}function O(){return U}function I(e,t){t&&(y("Patches"),e.u=[],e.s=[],e.v=t)}function S(e){_(e),e.p.forEach(D),e.p=null}function _(e){e===U&&(U=e.l)}function j(e){return U={p:[],l:U,h:e,m:!0,_:0}}function D(e){var t=e[K];0===t.i||1===t.i?t.j():t.O=!0}function E(e,t){t._=t.p.length;var n=t.p[0],a=void 0!==e&&e!==n;return t.h.g||y("ES5").S(t,e,a),a?(n[K].P&&(S(t),r(4)),o(e)&&(e=A(t,e),t.l||x(t,e)),t.u&&y("Patches").M(n[K].t,e,t.u,t.s)):e=A(t,n,[]),S(t),t.u&&t.v(t.u,t.s),e!==z?e:void 0}function A(e,t,n){if(v(t))return t;var r=t[K];if(!r)return s(t,(function(a,o){return P(e,r,t,a,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return x(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=C(r.k):r.o;s(3===r.i?new Set(a):a,(function(t,o){return P(e,r,a,t,o,n)})),x(e,a,!1),n&&e.u&&y("Patches").R(r,n,e.u,e.s)}return r.o}function P(e,t,n,r,i,s){if(a(i)){var c=A(e,i,s&&t&&3!==t.i&&!d(t.D,r)?s.concat(r):void 0);if(l(n,r,c),!a(c))return;e.m=!1}if(o(i)&&!v(i)){if(!e.h.F&&e._<1)return;A(e,i),t&&t.A.l||x(e,i)}}function x(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&h(t,n)}function k(e,t){var n=e[K];return(n?g(n):e)[t]}function w(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function R(e){e.P||(e.P=!0,e.l&&R(e.l))}function F(e){e.o||(e.o=C(e.t))}function N(e,t,n){var r=f(t)?y("MapSet").N(t,n):p(t)?y("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:O(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,o=$;n&&(a=[r],o=ee);var i=Proxy.revocable(a,o),s=i.revoke,c=i.proxy;return r.k=c,r.j=s,c}(t,n):y("ES5").J(t,n);return(n?n.A:O()).p.push(r),r}function M(e){return a(e)||r(22,e),function e(t){if(!o(t))return t;var n,r=t[K],a=c(t);if(r){if(!r.P&&(r.i<4||!y("ES5").K(r)))return r.t;r.I=!0,n=L(t,a),r.I=!1}else n=L(t,a);return s(n,(function(t,a){r&&u(r.t,t)===a||l(n,t,e(a))})),3===a?new Set(n):n}(e)}function L(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return C(e)}function V(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[K];return $.get(t,e)},set:function(t){var n=this[K];$.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var a=e[t][K];if(!a.P)switch(a.i){case 5:r(a)&&R(a);break;case 4:n(a)&&R(a)}}}function n(e){for(var t=e.t,n=e.k,r=Q(n),a=r.length-1;a>=0;a--){var o=r[a];if(o!==K){var i=t[o];if(void 0===i&&!d(t,o))return!0;var s=n[o],c=s&&s[K];if(c?c.t!==i:!m(s,i))return!0}}var u=!!t[K];return r.length!==Q(t).length+(u?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var o={};T("ES5",{J:function(t,n){var r=Array.isArray(t),a=function(t,n){if(t){for(var r=Array(n.length),a=0;a<n.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var o=Z(n);delete o[K];for(var i=Q(o),s=0;s<i.length;s++){var c=i[s];o[c]=e(c,t||!!o[c].enumerable)}return Object.create(Object.getPrototypeOf(n),o)}(r,t),o={i:r?5:4,A:n?n.A:O(),P:!1,I:!1,D:{},l:n,t:t,k:a,o:null,O:!1,C:!1};return Object.defineProperty(a,K,{value:o,writable:!0}),a},S:function(e,n,o){o?a(n)&&n[K].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[K];if(n){var a=n.t,o=n.k,i=n.D,c=n.i;if(4===c)s(o,(function(t){t!==K&&(void 0!==a[t]||d(a,t)?i[t]||e(o[t]):(i[t]=!0,R(n)))})),s(a,(function(e){void 0!==o[e]||d(o,e)||(i[e]=!1,R(n))}));else if(5===c){if(r(n)&&(R(n),i.length=!0),o.length<a.length)for(var u=o.length;u<a.length;u++)i[u]=!1;else for(var l=a.length;l<o.length;l++)i[l]=!0;for(var m=Math.min(o.length,a.length),f=0;f<m;f++)o.hasOwnProperty(f)||(i[f]=!0),void 0===i[f]&&e(o[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}n.d(t,"b",(function(){return V})),n.d(t,"c",(function(){return i}));var B,U,H="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),G="undefined"!=typeof Map,W="undefined"!=typeof Set,q="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,z=H?Symbol.for("immer-nothing"):((B={})["immer-nothing"]=!0,B),Y=H?Symbol.for("immer-draftable"):"__$immer_draftable",K=H?Symbol.for("immer-state"):"__$immer_state",X=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Q="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Z=Object.getOwnPropertyDescriptors||function(e){var t={};return Q(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},J={},$={get:function(e,t){if(t===K)return e;var n=g(e);if(!d(n,t))return function(e,t,n){var r,a=w(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!o(r)?r:r===k(e.t,t)?(F(e),e.o[t]=N(e.A.h,r,e)):r},has:function(e,t){return t in g(e)},ownKeys:function(e){return Reflect.ownKeys(g(e))},set:function(e,t,n){var r=w(g(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=k(g(e),t),o=null==a?void 0:a[K];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(m(n,a)&&(void 0!==n||d(e.t,t)))return!0;F(e),R(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==k(e.t,t)||t in e.t?(e.D[t]=!1,F(e),R(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=g(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},ee={};s($,(function(e,t){ee[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ee.deleteProperty=function(e,t){return ee.set.call(this,e,t,void 0)},ee.set=function(e,t,n){return $.set.call(this,e[0],t,n,e[0])};var te=new(function(){function e(e){var t=this;this.g=q,this.F=!0,this.produce=function(e,n,a){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return s.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))}))}}var c;if("function"!=typeof n&&r(6),void 0!==a&&"function"!=typeof a&&r(7),o(e)){var d=j(t),u=N(t,e,void 0),l=!0;try{c=n(u),l=!1}finally{l?S(d):_(d)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then((function(e){return I(d,a),E(e,d)}),(function(e){throw S(d),e})):(I(d,a),E(c,d))}if(!e||"object"!=typeof e){if(void 0===(c=n(e))&&(c=e),c===z&&(c=void 0),t.F&&h(c,!0),a){var m=[],f=[];y("Patches").M(e,c,m,f),a(m,f)}return c}r(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(a))}))};var r,a,o=t.produce(e,n,(function(e,t){r=e,a=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,r,a]})):[o,r,a]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){o(e)||r(8),a(e)&&(e=M(e));var t=j(this),n=N(this,e,void 0);return n[K].C=!0,_(t),n},t.finishDraft=function(e,t){var n=(e&&e[K]).A;return I(n,t),E(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!q&&r(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var o=y("Patches").$;return a(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}()),ne=te.produce;te.produceWithPatches.bind(te),te.setAutoFreeze.bind(te),te.setUseProxies.bind(te),te.applyPatches.bind(te),te.createDraft.bind(te),te.finishDraft.bind(te);t.a=ne},456:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},457:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return y}));var r,a=n(1),o=n(5),i=n(1293),s=n(4),c=n(26),d=n(279),u=n(73),l=n(17),m=n(15),f=n(51),p=n(40),g=n(218),C=n(23);function h(e,t,n){var r;if(Object(p.f)(t))return t.find((function(t){var r;return t===e||(null===(r=n[t])||void 0===r?void 0:r.alternateId)===e}));for(var a,o=new d.a(t,-1);!(a=o.next()).done;){var i=a.value.commentId,s=n[i];if((null==s?void 0:s.alternateId)===e||i===e)break}return null===(r=a.value)||void 0===r?void 0:r.commentId}function b(e,t,n){var r=Object(p.b)(t,e);return r?Object(m.z)(t,n,Object(u.b)(r)):[]}function v(e,t,n,c,d,f,p){var g,C;if(!l.kb()){if(d&&p===e)return{thread:[d.newComment_deprecated],isDraftThread:!0,draftThreadState:f};Object(s.i)().assertConditionTag(!f||!f.isInCurrentContext||"CREATE"!==f.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370)}var h=c||e,b=Object(m.z)(t,n,h);b.length>0&&void 0===Object(u.a)(b[0])&&(null===(C=(g=Object(s.i)()).logDiagnosticTrace)||void 0===C||C.call(g,Object(i.a)(r||(r=Object(a.__makeTemplateObject)(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),o.d.reserveTag(540575834),s.h.Info,s.c.ProductServiceUsage,Object(s.j)(s.g.ReviewedAsNotNecessary)),b=[]);var v=l.kb()&&p===h;return{thread:b,isDraftThread:v,draftThreadState:v?f:void 0}}function y(e,t,n,r,a){if(t.draftThreadState)return t.draftThreadState.renderContextType===C.a.None||t.draftThreadState.renderContextType===r?c.a.Enabled_ForcePrimary:c.a.Disabled;if(t.isDraftThread||t.thread.length>0)return a===g.a.InCard||a===g.a.InChildPost?c.a.Enabled_ForcePrimary:c.a.Enabled_Default;if(Object(f.k)(n))return c.a.Disabled;var o=Object(m.K)(n);return o&&o.threadId===e?c.a.Disabled:c.a.Invalid}},47:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1),a=n(5),o=function(e){function t(t,n,r){var a=e.call(this,t,n)||this;return a.tag=n,a.errorCode=r,a.name="CommentError",a}return Object(r.__extends)(t,e),t.prototype.stringify=function(){return Object(a.e)(this.tag,this.stack,"Error ".concat((e=this.errorCode)>4294967295||e<-4294967296?"dword_out_of_range(".concat(e,")"):"0x".concat((e<0?4294967295+e+1:e).toString(16))),this.innerException);var e},t}(a.c);function i(e){return Object(a.g)(e,"CommentError")}},48:function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},499:function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},503:function(e,t,n){var r=n(504),a=n(359),o=n(719),i=n(1172),s=n(924),c=function(e,t,n){var d,u,l,m,f=e&c.F,p=e&c.G,g=e&c.S,C=e&c.P,h=e&c.B,b=p?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,v=p?a:a[t]||(a[t]={}),y=v.prototype||(v.prototype={});for(d in p&&(n=t),n)l=((u=!f&&b&&void 0!==b[d])?b:n)[d],m=h&&u?s(l,r):C&&"function"==typeof l?s(Function.call,l):l,b&&i(b,d,l,e&c.U),v[d]!=l&&o(v,d,m),C&&y[d]!=l&&(y[d]=l)};r.core=a,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},504:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return b}));var r,a=n(1),o=n(17);function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function s(e){return Object.keys(e.drafts)}function c(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function d(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function u(e){return c(e)>0}function l(e){return u(e)||f(e)}function m(e){return!o.lb()&&l(e)}function f(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var o=Object(a.__values)(s(e)),i=o.next();!i.done;i=o.next()){var c=i.value;if(e.drafts[c].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}function g(e){return p(e,r.None)}function C(e){return p(e,r.Commit)}function h(e){return p(e,r.Discard)}function b(e,t){return h(e)&&g(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},510:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("END_VIEW_INIT",{},e)}},511:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},515:function(e,t,n){"use strict";n(101);var r=n(99),a=n(73),o=n(234);n(162);n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.n})),n.d(t,"a",(function(){return a.b})),n.d(t,"c",(function(){return o.a}))},517:function(e,t,n){"use strict";var r=n(593),a=(n(369),n(195),n(261),n(219));n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a}))},518:function(e,t,n){"use strict";var r=n(1),a=n(5),o=n(54),i=n(24),s=n(48),c=n(337),d=n(4),u=n(178),l=n(243);var m,f=n(1293),p=n(226),g=n(131),C=n(142),h=n(234),b=n(275),v=n(361),y=n(810),T=n(17),O=n(614),I=function(){function e(e,t){void 0===t&&(t=!0),this.rawDelta=e,this.onlyNewMentions=t,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t,r;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var a=e.attributes.atmention,o=e.optional;!a||n.onlyNewMentions&&(Object(T.C)()?void 0!==(null===(t=null==o?void 0:o.atmention)||void 0===t?void 0:t.contentId):void 0!==o&&void 0!==o.atmention)||null===(r=n._users)||void 0===r||r.push({UserId:a.email,Provider:O.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}(),S=n(47),_=n(456),j=n(221),D=n(15),E=n(51),A=n(235),P=n(170),x=n(11),k=n(257),w=n(598),R=n(408),F=n(372);function N(e,t,n,o,s,c){return function(u,l){var O,S,_=Object(d.i)().createActivityObject("CommitComment",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);_.addDocumentMetadata(d.f.Basic);var N=C.b[s.type],V=l(),B=k.b(V),U=x.v(V);if(void 0===U||U.commentDraft.sessionConfiguration.sessionType!==s.type)return _.failTag(593278784,-2130957522),Promise.resolve(j.a.CommitFailed);var H="",G=!1;switch(s.type){case g.b:H=s.commentId;break;case g.d:H=s.parentId,G=!0;break;case g.a:U&&(H=U.commentDraft.sessionConfiguration.draftId||"")}var W=x.j(V),q=!G||Object(v.a)(H,W,e.renderContextType)===b.a.Expanded;_.addDataField("IsCardExpanded",q,d.d.SystemMetadata);var z=function(e,t){var n;if(!t||Object(h.b)(t.commentDraft.sessionConfiguration)||!T.b())return;var r=void 0,a=T.i()?Object(y.b)(null!==(n=null==e?void 0:e.currentState.assignees)&&void 0!==n?n:[],t.selectedTaskAssignees):void 0;if(a)r={Task:{type:"Task",assigneeUpdate:a}};else{var o=t.selectedTaskAssignee;r=o?{Task:{type:"Task",assignee:o}}:void 0}return r}(B[H],U);if((null==z?void 0:z.Task)&&!Object(D.c)(V.commentState.modelCapabilities)&&(Object(d.i)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),z.Task=void 0),(T.b()&&s.type===g.a||T.c()&&s.type===g.d)&&(_.addDataField("IsPreExistingTask",!!B[H],d.d.SystemMetadata,d.e.Critical),_.addDataField("AffectingTaskMetadata",!!(null==z?void 0:z.Task),d.d.SystemMetadata,d.e.Critical)),_.addDataField("SessionType",N,d.d.SystemMetadata),s.type!==g.a){var Y=Object(D.i)(x.d(V),H);Y.valid&&(_.addDataField("MatchesCommentAuthor",Y.matchesCurrentUser,d.d.SystemMetadata),_.addDataField("ThreadCreationDeltaMs",Y.timeElapsed,d.d.SystemMetadata))}_.addDataField("AssociatedCommentId",H,d.d.SystemMetadata),_.addDataField("AtMentionsEnabled",n,d.d.SystemMetadata),_.addDataField("Trackback",e.trackback,d.d.SystemMetadata),_.addDataField("RenderContextType",e.renderContextType,d.d.SystemMetadata),_.addDataField("CommitSource",c,d.d.SystemMetadata);var K=x.h(V);return Object(E.i)(K)?(null===(S=(O=Object(d.i)()).logDiagnosticTrace)||void 0===S||S.call(O,Object(f.a)(m||(m=Object(r.__makeTemplateObject)(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),a.d.reserveTag(556827598),d.h.Info,d.c.ProductServiceUsage,e.telemetryVisitor,Object(d.l)("DraftId",U.commentDraft.sessionConfiguration.draftId,d.d.SystemMetadata)),Promise.resolve(j.a.CommitPending)):(u(Object(w.a)(i.chainActionDetails(e,a.d.reserveTag(593278785)))),o().then((function(r){if(!n){var o=L(u,s,r,0,_,a.d.reserveTag(593278786),a.d.reserveTag(593278787),e,z);return Promise.resolve(o)}var i=new I(r),c=i.Mentions,l=Object(d.i)();if(T.f()&&c.length>0&&l.logFloodgateActivity&&l.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),_.addDataField("CreateCommentWithRichFormatting",i.HasRichTextFormatting,d.d.SystemMetadata),!c.length){o=L(u,s,r,0,_,a.d.reserveTag(593278788),a.d.reserveTag(593278789),e,z);return Promise.resolve(o)}return t.grantUsersAccess(c).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===p.a.Success}(t),o=function(e){return!!e.Details&&e.Details.Canceled}(t);if(_.addDataField("AllUsersGrantedAccess",n,d.d.SystemMetadata),_.addDataField("ShareDialogCanceled",o,d.d.SystemMetadata),t.OperationResult===p.a.FailedSilently)return Object(a.i)("Check Access Phase failed - share dialog not shown"),_.failTag(593278790,-2130957561),M(u,r,P.a.GrantAccessFailedSilently,a.d.reserveTag(593278791),a.d.reserveTag(593278792),e),Promise.resolve(j.a.ShareFailed);if(o)return Object(a.i)("Share dialog was canceled by user"),_.successTag(593278793),M(u,r,P.a.GrantAccessCanceled,a.d.reserveTag(593278794),a.d.reserveTag(554801174),e),Promise.resolve(j.a.ShareFailed);if(!n)return Object(a.i)("Not all users have been granted access - going back to initial state"),_.successTag(593278795),M(u,r,P.a.GrantAccessCanceled,a.d.reserveTag(593278796),a.d.reserveTag(554784648),e),Promise.resolve(j.a.ShareFailed);var i=L(u,s,r,c.length,_,a.d.reserveTag(593278797),a.d.reserveTag(593278798),e,z);return Promise.resolve(i)}),(function(t){return _.failTag(593278799,-2130957561),Object(a.i)("Grant Users Access has failed",Object(a.l)(t)),M(u,r,P.a.GrantAccessFailedSilently,a.d.reserveTag(593278800),a.d.reserveTag(554784393),e),Promise.resolve(j.a.ShareFailed)}))}),(function(t){return _.failTag(593278801,-2130957539),u(Object(R.a)(i.chainActionDetails(e,a.d.reserveTag(593278802)),void 0)),Object(a.i)("getCommentBody failed",Object(a.l)(t)),T.G()&&u(Object(F.a)({draftWarningReason:A.a.CommitFailure,draftWarningType:P.a.CommitFailed},i.chainActionDetails(e,a.d.reserveTag(593278803)))),Promise.resolve(j.a.CommitFailed)})))}}function M(e,t,n,r,a,o){e(Object(R.a)(i.chainActionDetails(o,r),t)),e(Object(F.a)({draftWarningType:n,draftWarningReason:A.a.GrantUsersAccessFailure},i.chainActionDetails(o,a)))}function L(e,t,n,r,o,s,c,l,m){var f=function(e,t,n,r,o){try{switch(t.type){case"CREATE":e(i.commitDraft(i.chainActionDetails(r,a.d.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:o}));break;case"EDIT":e(i.commitDraft(i.chainActionDetails(r,a.d.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(i.commitDraft(i.chainActionDetails(r,a.d.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:o}));break;default:return Object(d.i)().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e(Object(R.a)(i.chainActionDetails(r,a.d.reserveTag(593278808)),n)),-2130957532}}catch(t){if(!Object(S.b)(t)&&!Object(_.a)(t))throw t;return e(Object(R.a)(i.chainActionDetails(r,a.d.reserveTag(593278809)),n)),T.G()&&e(Object(F.a)({draftWarningReason:A.a.CommitFailure,draftWarningType:P.a.CommitFailed},i.chainActionDetails(r,a.d.reserveTag(593278810)))),Object(u.a)(t)}return}(e,t,n,l,m);return f?(o.failTag(c,f),j.a.CommitFailed):r?(t.type===g.a?(o.addDataField("CreateThreadWithMentions",!0,d.d.SystemMetadata,d.e.Critical),m&&m.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,d.d.SystemMetadata,d.e.Critical)):t.type===g.d&&(o.addDataField("CreateReplyWithMentions",!0,d.d.SystemMetadata,d.e.Critical),m&&m.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,d.d.SystemMetadata,d.e.Critical)),o.successTag(s),j.a.Success):(o.successTag(s),j.a.Success)}var V=n(409),B=n(374),U=n(195),H=n(370),G=n(23),W=n(600),q=n(510),z=n(414);var Y=n(113),K=n(610);var X=n(338);function Q(e,t){return{requestDeleteComment:function(t,n){e(i.requestDeletePost(t,n))},requestDeleteThread:function(t,n,r){e(i.requestDeleteThread(t,n,r))},requestReopenThread:function(t,n,r){e(i.requestReopenThread(t,n,r))},requestResolveThread:function(t,n,r){e(i.requestThreadResolve(t,n,r))},requestEditCommentSession:function(n,r){e(Object(c.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r},!1,t.peopleAPI)).catch(Object(o.a)(a.d.reserveTag(574362624)))},requestReplyCommentSession:function(n,r){e(Object(c.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch(Object(o.a)(a.d.reserveTag(574362625)))},commitCommentAndFocus:function(n,r,a,o,i,s,c){return e(N(n,t.peopleAPI,o,r,a,c)).then((function(e){return e===j.a.Success&&t.focusManager.focusCommentCardCommand(i,s),e}))},discardDraftAsync:function(t,n,r,a){return e(Object(B.a)(t,n,r,a))},discardDraftIfEmpty:function(t,n,r){return e(Object(V.a)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(i.showLowFidelityWarning(t,n,r))},clearLowFidelityWarning:function(t){e(i.clearLowFidelityWarning(t))},saveDraft:function(t,n,r){e(i.saveDraft(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(i.clearCommentHighlight(t,s.a.SharedComments,n))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(i.updateMentioneesStillInDraft(t,n))},addToCurrentMentionees:function(t,n){e(i.addToCurrentMentionees(t,n))},updateSelectedTaskAssignee:function(t,n){e(i.updateSelectedTaskAssignee(t,n))},updateSelectedTaskAssignees:function(t,n){e(i.updateSelectedTaskAssignees(t,n))},toggleTaskAssigner:function(t){e(i.toggleTaskAssigner(t))},displayDraftWarning:function(t,n,r){e(i.displayDraftWarning({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(i.showPostErrorUI(t,n))},clearPostErrorUI:function(t,n){e(i.clearPostErrorUI(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(function(e,t,n){return function(r,a){var o,i=a();(null===(o=x.t(i))||void 0===o?void 0:o.selectedCardId)!==t&&r(Object(Y.b)(e,t,void 0,Y.a.ExpandCard,s.a.SharedComments)),r(Object(K.a)(e,t,n))}}(t,n,r))},draftEmptinessChanged:function(t,n,r){e(i.draftEmptinessChanged(t,r,n))},selectComment:function(t,n,r,a){return e(Object(X.b)(t,n,r,a))},collapseCard:function(t,n){e(i.collapseCard(t,n))},requestUpdateCommentReactions:function(n,r,a,o){e(function(e,t,n,r,a){return function(o,i){var s=Object(d.i)().createActivityObject("CommentReaction",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);Object(l.c)(i(),s),t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:a}),e.commit(),e.endDrafting(),s.successTag(587317280)})).catch((function(e){s.failTag(587317281,Object(u.a)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},a,o))},requestPresentLinkToComment:function(t,n){e(i.requestPresentLinkToComment(t,n))}}}function Z(e,t){return Object(r.__assign)(Object(r.__assign)({},Q(e,t)),{highlightComment:function(t,n){e(i.highlightComment(t,n,s.a.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Object(c.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(Object(o.a)(a.d.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(i.queueLoadThreads(t,{threadIds:n}))},requestClosePane:function(t){e(i.requestClosePane(t))},requestDisplayConfiguration:function(t,n){return e(Object(z.a)(t,n))},readyToRender:function(t){e(i.readyToRender(t))},requestModalConfirmation:function(t,n,r,a){e(i.requestModalConfirmation(t,n,r,a))},initializeView:function(n){e(function(e,t,n,r,i){return function(s){return s(Object(W.a)({renderContextType:e,trackback:a.d.reserveTag(595899542),telemetryVisitor:i})),t===H.a.NewThread?(e===G.a.HalfPane&&s(Object(z.a)({renderContextType:e,trackback:a.d.reserveTag(595899543),telemetryVisitor:i},{displayMode:U.a.Variable,desiredHeight:0})).catch(Object(o.a)(a.d.reserveTag(595645966))),s(Object(c.a)({renderContextType:e,trackback:a.d.reserveTag(595898586),telemetryVisitor:i},n,{sessionType:"CREATE"},!1,r)).then((function(){s(Object(q.a)({renderContextType:e,trackback:a.d.reserveTag(595899545),telemetryVisitor:i}))}))):s(Object(q.a)({renderContextType:e,trackback:a.d.reserveTag(595899546),telemetryVisitor:i}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(t,n){e(i.updateDraftRenderContext(t,n))}})}function J(e,t){return Object(r.__assign)(Object(r.__assign)({},Q(e,t)),{updateRenderLockForDraft:function(t,n,r){e(i.updateDraftRenderContext(t,n,r))},highlightComment:function(n){e(i.highlightComment(n,t.resource.id,s.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.componentTreeId.renderContextType!==G.a.HalfPane?Promise.resolve(void 0):e(Object(z.a)(n,r))},queueLoadThread:function(n){return e(i.queueLoadThreads(n,{threadIds:[t.resource.id]}))}})}n.d(t,"b",(function(){return Z})),n.d(t,"a",(function(){return J}))},531:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var r=n(1294),a=n(89),o=n(41);function i(e,t,n,o){var i,s=e.map((function(e){return e.author})),c=null!==(i=null==t?void 0:t.map((function(e){return e.history.map((function(e){return e.records[0].user}))})))&&void 0!==i?i:[];return function(e,t){var n={};return e.filter((function(e){var r=Object(a.j)(e);return!(!r||n[r]||d(t,e))&&(n[r]=!0)}))}(Object(r.a)([s,c,null!=o?o:[]]),n)}function s(e){return e.reduce((function(e,t){var n=function(e){if(!e.authorID&&!e.authorName)return;return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e}),{})}function c(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:o.a.COMMENTS_PURPLE,authorImageURL:""})})),t}function d(e,t){var n=Object(a.j)(t);if(n){var r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}}},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),a=n(4),o=n(47),i=function(e){return function(t){Object(o.b)(t)?Object(a.i)().assertConditionTag(!1,t.message,e):Object(a.i)().assertConditionTag(!1,"Unknown error ".concat(Object(r.l)(t)),e)}}},571:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},572:function(e,t,n){e.exports=!n(573)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},573:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},575:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,a=n(4);function o(e){r=e}function i(e){r?r.announceToScreenReader(e):Object(a.i)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&o(e)},e}(),c=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},578:function(e,t,n){"use strict";var r=n(5),a=n(4),o=n(47),i=n(117),s=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||"en-us",dataCulture:this.localizationDetails.dataCulture||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new o.a(i.j,r.d.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 38:return CommentPaneStrings.PostSaveA11yLabel;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 49:return CommentPaneStrings.CardSendReplyA11yLabel;case 83:return CommentPaneStrings.CardPostCommentA11yLabel;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.CommentPostedA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 230:return CommentPaneStrings.FocusMovedToUnpostedDraftA11yUpdate;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 134:return CommentPaneStrings.FailedToCommitMentionText;case 234:return CommentPaneStrings.FailedToCommitMentionShareCanceledText;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;case 229:return CommentPaneStrings.TruncationUIReadMoreText;case 231:return CommentPaneStrings.CommentLikeA11yLabel;case 232:return CommentPaneStrings.TaskHistoryItemA11yLabelDesktop;case 223:return CommentPaneStrings.DraftCardA11yLabelDesktop;case 225:return CommentPaneStrings.LoadingCardA11yLabelDesktop;case 216:return CommentPaneStrings.CardA11yLabelDesktopUnassignedTask;case 217:return CommentPaneStrings.CardA11yLabelDesktopUnassignedCompletedTask;case 219:return CommentPaneStrings.CardA11yLabelDesktopOneReplyModifier;case 221:return CommentPaneStrings.CardA11yLabelDesktopLoadingModifier;case 222:return CommentPaneStrings.CardA11yLabelDesktopDraftModifier;case 226:return CommentPaneStrings.A11yLabelSubstringDelimiterDesktop;case 224:return CommentPaneStrings.DraftCardA11yLabelDesktopHintText;case 209:return CommentPaneStrings.NewPostA11yLabelDesktop;case 208:return CommentPaneStrings.PostA11yLabelDesktop;case 210:return CommentPaneStrings.PendingPostA11yLabelDesktop;case 214:return CommentPaneStrings.CardA11yLabelDesktopAssignedTask;case 215:return CommentPaneStrings.CardA11yLabelDesktopAssignedCompletedTask;case 211:return CommentPaneStrings.CardA11yLabelDesktopBaseThread;case 212:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadWithTask;case 213:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadResolved;case 218:return CommentPaneStrings.CardA11yLabelDesktopAnchorHintModifier;case 220:return CommentPaneStrings.CardA11yLabelDesktopMultipleRepliesModifier;case 239:return CommentPaneStrings.CommentLikePluralA11yLabel;case 240:return CommentPaneStrings.CommentLikeDescriptionA11yLabel;case 233:return this.isMac()?CommentPaneStrings.CtrlEnterHint_Mac:CommentPaneStrings.CtrlEnterHint;case 241:return CommentPaneStrings.AtMentionsInfoCommentNotificationUber;case 242:return CommentPaneStrings.AtMentionsInfoCommentMentionsTwoPeopleModifier;case 243:return CommentPaneStrings.AtMentionsInfoCommentMentionsThreePeopleModifier;case 244:return CommentPaneStrings.AtMentionsInfoCommentMentionsMoreThanThreePeopleModifier;case 245:return CommentPaneStrings.FilterShowAllResolutions;case 246:return CommentPaneStrings.FilterShowResolvedOnly;case 247:return CommentPaneStrings.FilterShowActiveOnly;case 248:return CommentPaneStrings.FilterNewestFirst;case 249:return CommentPaneStrings.FilterAtMentionsToMe;case 250:return CommentPaneStrings.TaskHeaderAssignedToYouAndOthersText;case 251:return CommentPaneStrings.TaskHeaderAssignedToMultipleText;case 252:return CommentPaneStrings.TaskItemUnassignedFromText;case 256:return CommentPaneStrings.FilterItemCount;case 257:return CommentPaneStrings.FilterItemCountPlural;case 258:return CommentPaneStrings.FilterOldestFirst;case 260:return CommentPaneStrings.FilterSortBy;case 261:return CommentPaneStrings.FilterFilterBy;case 259:return CommentPaneStrings.FilterCollaborators;case 262:return CommentPaneStrings.FilterResetAll;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(this.getString(e),t)},e.prototype.toFormattedString=function(e,t){for(var n="",r=0;;){var o=e.indexOf("{",r),i=e.indexOf("}",r);if(o<0&&i<0){n+=e.slice(r);break}if(i>0&&(i<o||o<0))n+=e.slice(r,i+1),r=i+2;else if(n+=e.slice(r,o),r=o+1,"{"!==e.charAt(r)){if(i<0)break;var s=e.substring(r,i),c=s.indexOf(":"),d=t[parseInt(c<0?s:s.substring(0,c),10)];null==d&&(Object(a.i)().assertConditionTag(!1,"Incorrect substitution provided to string",562937946),d=""),n+=d,r=i+1}else n+="{",r++}return n},e}();n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var c=void 0;function d(){if(!c)throw new o.a(i.g,r.d.reserveTag(589103748),-2130957552);return c}function u(e){return Object(a.i)().assertConditionTag(void 0===c,"LocalizationAPI has already been initialized",589103749),void 0===c&&(c=new s(e)),c}},592:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},593:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},594:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={LivePersonaPicker:{webSettingName:"LivePersonaPicker",dependencies:[]},PersonaFeature:{webSettingName:"PersonaColor",dependencies:[]},NewCommentButton:{webSettingName:"NewCommentButton",dependencies:[]},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments",dependencies:["NewDraftingUI"]},CommentsFluentUI:{webSettingName:"CommentsFluentUI",dependencies:[]},RenderDHCInPane:{dependencies:[]},CommentTasks:{webSettingName:"CommentTasks",dependencies:["CommentsFluentUI"]},NewDraftingUI:{webSettingName:"DiscreteHostedComments",dependencies:[]},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure",dependencies:[]},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{dependencies:[]},HyperlinksInComments:{webSettingName:"HyperlinksInComments",dependencies:[]},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText",dependencies:[]},ContentNavigation:{webSettingName:"ContentNavigation",dependencies:[]},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey",dependencies:[]},ExtendedDrafting:{webSettingName:"ExtendedDrafting",dependencies:["NewDraftingUI"]},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb",dependencies:[]},SmartReplies:{webSettingName:"SmartReplies",dependencies:[]},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",dependencies:[]},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration",dependencies:[]},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions",dependencies:[]},CommentReactions:{webSettingName:"CommentReactions",dependencies:[]},LinkToComment:{webSettingName:"LinkToComment",dependencies:[]},WebThemeIntegration:{webSettingName:"WebThemeIntegration",dependencies:[]},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText",dependencies:[]},QuickEdit:{dependencies:[]},QuillInitializationTelemetry:{webSettingName:"QuillInitializationTelemetry",dependencies:[]},CtrlEnterTip:{webSettingName:"CtrlEnterTip",dependencies:["CommentsFluentUI"]},LPPVerboseLogging:{dependencies:[]},FluentSVRefreshWin32:{dependencies:[]},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},DiagnosticHeartbeat:{dependencies:[]},EnableExperimentalLists:{dependencies:[]},TaskHistoryRecordIDs:{webSettingName:"TaskHistoryRecordIDs",dependencies:[]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage",dependencies:[]},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb",dependencies:[]},MapBasedStore:{webSettingName:"MapBasedStore",dependencies:[]},ContentFiltering:{dependencies:[]},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]}}},595:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},596:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},597:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n},e)}},598:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},599:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},601:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},602:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},604:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(19);function a(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function o(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},605:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},606:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},608:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},609:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},612:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function a(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},614:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="O365",a="@"},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(93);function a(){}function o(){var e=document.getElementById(r.z());e&&e.focus()}function i(e){if(e&&e.target){var t=e.target.closest(".ql-editor");null!==t&&"true"===t.contentEditable||e.preventDefault()}}},624:function(e,t,n){"use strict";var r;n(17);!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(r||(r={}));n(23),n(84),n(129);var a=n(41);n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));r.None;var o=function(e){return"ios"===e||"android"===e};function i(e,t){return!e||t?a.a.WHITE:a.a.REST_RESOLVED_BODY}function s(e,t,n){return e&&(!n||t)}},63:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(106),a=function(e){return e.paneState.visibilityState===r.a.Visible},o=function(e){return e.paneState.visibilityState!==r.a.Closed},i=function(e){return e.paneState.visibilityState},s=function(e){return e.paneState.componentTree},c=function(e){return e.paneState.viewContainer}},692:function(e,t,n){"use strict";var r;!function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={})),t.a=r},719:function(e,t,n){var r=n(1166),a=n(1171);e.exports=n(572)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},720:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},721:function(e,t,n){var r=n(359),a=n(504),o=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(1174)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},722:function(e,t,n){var r=n(927);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},723:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},724:function(e,t,n){var r=n(930)("unscopables"),a=Array.prototype;null==a[r]&&n(719)(a,r,{}),e.exports=function(e){a[r][e]=!0}},73:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function a(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},734:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},793:function(e,t,n){"use strict";var r=n(1038),a=n(4),o=n(1292),i=n(7),s=n(41),c=n(167),d=n(196),u=function(){function e(){}return e.prototype.getThemeMode=function(){return 0},e.prototype.registerOnThemeChanged=function(e){},e.prototype.convertColorForTheme=function(e,t){return e},e}(),l=n(17);n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return b}));var m,f=(m=new u,{setThemeAPI:function(e){m=e},getThemeAPI:function(){return m},resetThemeAPI:function(){m=new u}});function p(){return!!l.W()&&1===f.getThemeAPI().getThemeMode()}function g(){return!l.W()||0===f.getThemeAPI().getThemeMode()}var C=Object(i.c)((function(e){return Object(a.i)().assertConditionTag(l.W(),"Semantic color map should not be used if web theme integration is disabled.",553710797),p()?function(e){return Object(a.i)().assertConditionTag(p(),"Should not retrieve dark mode semantic colors if dark theme is not set.",545067039),{AtMentionHighlight:o.b.gray140,AtMentionMessageBackground:o.b.gray140,AtMentionMessageText:o.b.gray40,AtMentionText:o.b.gray40,AtMentionToMeHighlight:e.palette.themeTertiary,AtMentionToMeText:e.palette.black,BlueDot:"#5099FF",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:o.b.gray180,CardBorder:o.b.gray120,CardBorderEmphasis:"#C480CB",CardTopperContainerBorder:o.b.gray140,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:e.palette.themePrimary,CheckBoxBackgroundCheckedHovered:"#3D7CE8",CheckBoxBackgroundHovered:o.b.gray190,CheckBoxBackgroundPressed:e.palette.white,CheckBoxBorder:o.b.gray80,CheckBoxBorderCheckedHovered:"#3D7CE8",CheckBoxBorderDisabled:o.b.gray130,CheckBoxBorderHovered:o.b.gray80,CheckBoxCheckMark:o.b.gray80,CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:o.b.gray160,ClosePaneButtonPressed:o.b.gray150,ClosePaneButtonIcon:o.b.gray20,ClosePaneButtonIconHovered:o.b.gray20,ClosePaneButtonIconPressed:o.b.gray20,CommonControlBorder:o.b.gray120,CtrlEnterTip:o.b.gray80,DefaultButton:"transparent",DefaultButtonHovered:o.b.gray160,DefaultButtonIcon:o.b.gray20,DefaultButtonIconDisabled:o.b.gray130,DefaultButtonPressed:e.palette.white,ExpandButtonTextResolved:o.b.gray80,ExpandButtonTextResolvedHovered:o.b.gray50,ExpandButtonTextResolvedPressed:o.b.gray30,Hyperlink:"#7DB0FF",HyperlinkActive:"#FF0000",MenuIcon:e.palette.black,MenuIconDisabled:o.b.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.themeDark,NewCommentButton:"transparent",NewCommentButtonBorderFocused:o.b.gray20,NewCommentButtonDisabled:o.b.gray130,NewCommentButtonHovered:o.b.gray180,NewCommentButtonLabel:o.b.gray20,NewCommentButtonLabelHovered:o.b.gray20,NewCommentButtonPressed:o.b.gray160,NewCommentButtonIconHoveredPressed:"#3D7CE8",PaneBackground:o.b.gray200,PersonaColorResolved:o.b.gray80,PersonaInitialsTextColor:e.palette.black,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themePrimary,PrimaryButtonHovered:"#3D7CE8",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:e.palette.themeDarker,ResolvedCardBackground:e.palette.white,ResolvedCardText:o.b.gray80,ResolvedCardTitle:o.b.gray50,SmartRepliesText:o.b.gray20,SubText:o.b.gray80,SuggestedItem:o.b.gray140,SuggestedItemHovered:o.b.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:e.palette.black,TaskAssignerText:o.b.gray20,TaskBorder:e.palette.black,TaskPickerButton:e.palette.black,Text:o.b.gray20}}(e):function(e){return Object(a.i)().assertConditionTag(g(),"Should not retrieve light mode semantic colors if light theme is not set.",545067040),{AtMentionHighlight:o.b.gray20,AtMentionMessageBackground:"#F0F0F0",AtMentionMessageText:o.b.gray160,AtMentionText:o.b.gray180,AtMentionToMeHighlight:e.palette.themeLighter,AtMentionToMeText:e.palette.themeDarkAlt,BlueDot:"#006bFF",CancelDraftButtonIcon:s.a.GRAY_E,CancelDraftButtonIconFocused:s.a.GRAY_J,CancelDraftButtonIconHovered:s.a.GRAY_J,CancelDraftButtonIconPressed:s.a.GRAY_J,CardBackground:e.palette.white,CardBorder:s.a.COMMENTS_GRAY,CardBorderEmphasis:s.a.COMMENTS_PURPLE,CardTopperContainerBorder:s.a.GRAY_B,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:d.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundCheckedHovered:d.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundHovered:"transparent",CheckBoxBackgroundPressed:"transparent",CheckBoxBorder:d.b.TASK_BORDER,CheckBoxBorderCheckedHovered:d.b.TASK_BORDER,CheckBoxBorderDisabled:d.b.TASK_DISABLED,CheckBoxBorderHovered:d.b.TASK_CHECKBOX_COLOR,CheckBoxCheckMark:d.b.TASK_TEXT,CheckBoxCheckMarkChecked:e.palette.white,ClosePaneButtonFocused:s.a.ACTIVE_COMMENT_TEXT,ClosePaneButtonHovered:o.b.gray40,ClosePaneButtonPressed:o.b.gray70,ClosePaneButtonIcon:s.a.GRAY_F,ClosePaneButtonIconHovered:s.a.GRAY_J,ClosePaneButtonIconPressed:s.a.GRAY_J,CommonControlBorder:o.b.gray110,CtrlEnterTip:o.b.gray120,DefaultButton:"transparent",DefaultButtonHovered:void 0,DefaultButtonIcon:o.b.gray200,DefaultButtonIconDisabled:o.b.gray100,DefaultButtonPressed:void 0,ExpandButtonTextResolved:o.b.gray130,ExpandButtonTextResolvedHovered:s.a.GRAY_H,ExpandButtonTextResolvedPressed:s.a.GRAY_H,Hyperlink:"#0000EE",HyperlinkActive:"#FF0000",MenuIcon:s.a.GRAY_F,MenuIconDisabled:s.a.GRAY_C,MenuIconHoveredPressed:s.a.GRAY_J,MoreRepliesColor:e.palette.themePrimary,NewCommentButton:e.palette.white,NewCommentButtonBorderFocused:e.palette.black,NewCommentButtonDisabled:c.b.BUTTON_DISABLED,NewCommentButtonHovered:void 0,NewCommentButtonLabel:o.b.gray180,NewCommentButtonLabelHovered:s.a.GRAY_J,NewCommentButtonPressed:void 0,NewCommentButtonIconHoveredPressed:s.a.GRAY_J,PaneBackground:o.b.gray30,PersonaColorResolved:o.b.gray130,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themeDarkAlt,PrimaryButtonHovered:e.palette.themeDarkAlt,PrimaryButtonIcon:e.palette.white,PrimaryButtonPressed:e.palette.themeDark,ResolvedCardBackground:o.b.gray20,ResolvedCardText:o.b.gray130,ResolvedCardTitle:o.b.gray160,SmartRepliesText:o.b.gray140,SubText:s.a.GRAY_E,SuggestedItem:s.a.SUGGESTED_PICKER_ITEM,SuggestedItemHovered:s.a.SUGGESTED_PICKER_ITEM_HOVER,SuggestedItemPressed:s.a.SUGGESTED_PICKER_ITEM_HOVER,TaskAssignerFocus:d.b.TASK_BORDER_FOCUS,TaskAssignerText:e.palette.black,TaskBorder:d.b.TASK_BORDER,TaskPickerButton:d.b.TASK_BORDER,Text:s.a.ACTIVE_COMMENT_TEXT}}(e)})),h=Object(i.c)((function(e){return Object(a.i)().assertConditionTag(l.W(),"Semantic style map should not be used if web theme integration is disabled",545067043),p()?function(e){return Object(a.i)().assertConditionTag(p(),"Should not retrieve dark mode semantic styles if dark theme is not set.",545067041),{BoxShadowLevel1:"0px 1px 4px 0px rgba(0,0,0,0.2)",BoxShadowLevel2:"0px 1px 8px 8px rgba(0,0,0,0.2)",BoxShadowLevel3:"0px 1px 16px 8px rgba(0,0,0,0.2)",BoxShadowLevel4:"0px 1px 32px 8px rgba(0,0,0,0.2)",BoxShadowLevel5:"0px 1px 48px 8px rgba(0,0,0,0.2)",CalloutBoxShadow:"0px 1px 16px 8px rgba(0,0,0,0.2)",CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(255, 255, 255, 0.2)",DefaultButtonFocusedBorder:"1px solid ".concat(e.palette.black),DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #323130",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px black",PostOverlay:"rgba(0,0,0,0.5)"}}(e):(Object(a.i)().assertConditionTag(g(),"Should not retrieve light mode semantic styles if light theme is not set.",545067042),{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"})})),b=Object(r.a)((function(){return!!l.W()&&!!f.getThemeAPI().convertColorForTheme}))},797:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},80:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l}));var r=function(e){return e.filterState.activeFilterId},a=function(e){return e.filterState.defaultFilterId},o=function(e){var t,n=e.filterState.activeFilterId;if(n)return null===(t=e.filterState.filteredRanges[n])||void 0===t?void 0:t.filter},i=function(e,t){return e.filterState.filteredRanges[t]},s=[],c=function(e){var t,n,r=e.filterState.activeFilterId;return r&&null!==(n=null===(t=e.filterState.filteredRanges[r])||void 0===t?void 0:t.order)&&void 0!==n?n:s},d=function(e){return c(e).length},u=function(e){return e.filterState.filteringCapabilities},l=function(e){return e.filterState.requestDefaultFilter}},804:function(e,t,n){"use strict";var r,a,o=n(197);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(a||(a={}));var i,s=((r={})[0]=o.DeltaFormattingType.Weight,r[1]=o.DeltaFormattingType.Highlight,r[2]=o.DeltaFormattingType.Hyperlink,r[3]=o.DeltaFormattingType.Italic,r[4]=o.DeltaFormattingType.Strikethrough,r[5]=o.DeltaFormattingType.Underline,r[6]=o.DeltaFormattingType.Color,r[7]=o.DeltaFormattingType.Image,r),c=n(4),d=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,a,i,s,c;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var d=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=d.bold;break;case 3:n.italic=d.italic;break;case 5:n.underline=d.underline;break;case 4:n.strikethrough=d.strikethrough;break;case 1:n.highlight=d.highlight;break;case 6:n.fontColor=d.fontColor}return 2}var u=void 0,l=void 0;switch(e){case 0:u={type:o.DeltaFormattingType.Weight};break;case 3:u={type:o.DeltaFormattingType.Italic};break;case 5:u={type:o.DeltaFormattingType.Underline};break;case 4:u={type:o.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var m=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.link,f=null!==(s=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.text)&&void 0!==s?s:m;l={type:o.DeltaFormattingType.Hyperlink,data:{text:f,link:m}}}break;case 7:(null===(c=null==n?void 0:n.imageData)||void 0===c?void 0:c.base64)&&(l={type:o.DeltaFormattingType.Image,data:{src:n.imageData.base64}});break;case 1:(null==n?void 0:n.highlight)&&(u={type:o.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(u={type:o.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}})}return u&&this.richContentEditorActor.applyFormattingToCurrentSelection(u),l&&this.richContentEditorActor.addContent(l),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(c.i)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(s[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}();function u(){return void 0===i&&(i=new d),i}var l=new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}());n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}))},808:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},809:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(85);function a(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function o(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},810:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(1),a=n(226),o=n(89),i=100;function s(e){return e===i}function c(e,t){var n=Object(r.__assign)({},t);Object(o.m)(n,e);var i=[];Object.keys(n).forEach((function(e){var t=n[e].assignee;Object(a.d)(t)||i.push(t)}));var s=t?e.filter((function(e){return void 0===t[Object(o.i)(e)]})):Object(r.__spreadArray)([],Object(r.__read)(e),!1);if(0!==i.length||0!==s.length)return{assigneesToAdd:i,assigneesToRemove:s}}},82:function(e,t,n){"use strict";n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return T})),n.d(t,"k",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"h",(function(){return S})),n.d(t,"g",(function(){return _})),n.d(t,"a",(function(){return j})),n.d(t,"e",(function(){return D})),n.d(t,"i",(function(){return E})),n.d(t,"d",(function(){return P})),n.d(t,"f",(function(){return x})),n.d(t,"j",(function(){return k})),n.d(t,"c",(function(){return w}));var r=n(1),a=n(5),o=n(4),i=n(230),s=n(73),c=n(162),d=n(89),u=n(47),l=n(117),m=n(17),f=n(15),p=n(143),g=n(40),C=n(160),h=n(355);function b(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function v(e,t,n,r,a,i){for(var s=[],c=t,d=a;c<=n&&d<=i;){var u=e[c].date;Object(o.i)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(o.i)().assertConditionTag(e[c].parentId===r.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(o.i)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:r.history[d],parentThreadId:r.commentId}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=i;++d)Object(o.i)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:r.history[d],parentThreadId:r.commentId});return s}function y(e,t){if(!m.b()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(m.c()||t.commentId===t.history[0].commentId||(Object(o.i)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(o.i)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var a=[];m.c()||a.push({commentModel:e[0],historyItem:t.history[0]});for(var i=m.c()?0:1,s=m.c()?0:1,c=m.c()?0:1;i<e.length&&c<t.history.length;){var d=b(e,i,t.history[c]);d>=0&&(a.push.apply(a,Object(r.__spreadArray)([],Object(r.__read)(v(e,i,d-1,t,s,c-1)),!1)),Object(o.i)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),a.push({commentModel:e[d],historyItem:t.history[c]}),i=d+1,s=c+1),++c}return a.push.apply(a,Object(r.__spreadArray)([],Object(r.__read)(v(e,i,e.length-1,t,s,t.history.length-1)),!1)),a}function T(e,t,n,a){var i=[];if(Object(g.c)(n))Object(g.f)(e)?e.forEach((function(e){i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(y(Object(f.z)(n,t,e),a[e])),!1))})):Object(o.i)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var c=0,d=1;d<=n.length;d++)(d===n.length||Object(s.a)(n[d]))&&(i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(y(n.slice(c,d),a[n[c].commentId])),!1)),c=d);return i}function O(e,t,n,a,o,i){var c=[];if(0===e.length)return c;if(Object(g.c)(n))e.forEach((function(e){c.push.apply(c,Object(r.__spreadArray)([],Object(r.__read)(y(Object(f.z)(n,t,e.contentId),a[e.contentId])),!1))}));else for(var d=0,u=0,l=function(e,t,n,r){return e<t.length&&!!Object(s.a)(t[e])&&-1===n&&t[e].commentId===r};d<e.length&&!((null==o?void 0:o.newComment_deprecated)&&e[d].contentId===Object(f.G)(i,!0)&&(c.push({commentModel:o.newComment_deprecated}),++d>=e.length));){for(var m=-1,p=0;p<=n.length;p++)if(l(p,n,m,e[d].contentId))m=p;else if(-1!==m&&(p===n.length||Object(s.a)(n[p]))){if(c.push.apply(c,Object(r.__spreadArray)([],Object(r.__read)(y(n.slice(m,p),a[n[m].commentId])),!1)),++d>=e.length)break;l(p,n,m=-1,e[d].contentId)&&(m=p)}u===d&&d++,u=d}return c}function I(e,t){var n=e.find((function(e){return Object(C.a)(e)&&e.commentModel.commentId===t}));if(Object(C.a)(n))return n.commentModel}function S(e){var t=e[0];if(Object(C.a)(t))return t.commentModel;throw new u.a(l.a,a.d.reserveTag(589103627),2130957505)}function _(e){return Object(C.a)(e)?e.commentModel.parentId:e.parentThreadId}function j(e,t){return m.jb()?"".concat(e,"__").concat(t):t}function D(e){return Object(C.a)(e)?e.commentModel.commentId:j(e.historyItem.taskId,e.historyItem.records[0].recordId)}function E(e){return Object(C.a)(e)?Object(s.b)(e.commentModel):e.parentThreadId}function A(e,t){var n=e.records[0];switch(n.type){case c.a.Create:if(!(a=e.records[1])||a.type!==c.a.Assign)return Object(o.i)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:t.getString(119)};var r=Object(d.k)(a.assignee);return{icon:13,description:t.formatString(114,r)};case c.a.UnassignAll:case c.a.Unassign:var a;if(!(a=e.records[1])||a.type!==c.a.Assign)return Object(o.i)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:14,description:t.getString(204)};r=Object(d.k)(a.assignee);return{icon:14,description:t.formatString(115,r)};case c.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:21,description:t.getString(117)};case c.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(o.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function P(e,t){if(!m.j())return[A(e,t)];var n=[],r=e.records[0];switch(r.type){case c.a.Create:case c.a.UnassignAll:for(var a=[],i=1;i<e.records.length;i++){(u=e.records[i]).type===c.a.Assign&&a.push(Object(d.k)(u.assignee))}n.push({icon:13,description:Object(h.l)(t,!0,a)});break;case c.a.Assign:case c.a.Unassign:a=[];var s=[];for(i=0;i<e.records.length;i++){var u;if((u=e.records[i]).type!==c.a.Assign&&u.type!==c.a.Unassign)return Object(o.i)().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];u.type===c.a.Assign?a.push(Object(d.k)(u.assignee)):s.push(Object(d.k)(u.assignee))}a.length>0&&n.push({icon:13,description:Object(h.l)(t,!0,a)}),s.length>0&&n.push({icon:13,description:Object(h.l)(t,!1,s)});break;case c.a.Progress:return 100===r.completion?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case c.a.Schedule:return[{icon:17,description:t.getString(118)}];default:return Object(o.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return 0===n.length&&n.push({icon:0,description:t.getString(119)}),n}function x(e,t){return e.findIndex((function(e){return e.length>0&&E(e[0])===t}))}function k(e,t){return e.some((function(e){return Object(C.a)(e)&&!!(e.commentModel.commentFlags&i.f.LowFidelity)&&(void 0===t||t===Object(s.b)(e.commentModel))}))}function w(e,t,n,r,a){for(var i=[],s=!m.kb()&&!a&&void 0!==n,c=-1,d=-1,u=0;u<e.length;u+=1){var l=e[u],f=Object(C.a)(l)?l:void 0;if(f&&void 0!==t[f.commentModel.commentId])if(t[f.commentModel.commentId].pending===p.a.Delete&&r)for(Object(C.a)(l)&&++d;!(u+1>=e.length||""===_(e[u+1]));)++u,Object(C.a)(e[u])&&++d;else{++d,i.push([f]),s&&d===(null==n?void 0:n.flatIndex)&&(c=i.length-1);for(var g=u+1;g<e.length;g+=1){if(l=e[g],Object(C.a)(l)){var h=_(l);if(h!==f.commentModel.commentId){Object(o.i)().assertConditionTag(!h,"Orphaned reply with id ".concat(D(l),", expected parent ").concat(f.commentModel.commentId," but was ").concat(h),593085889);break}i[i.length-1].push(l),++d}else i[i.length-1].push(l);++u}}else{var b=f?f.commentModel.commentId:"",v=f?f.commentModel.parentId:"";for(Object(o.i)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(s," | CommentId: ").concat(b," | ParentId: ").concat(v),593085888),Object(C.a)(l)&&++d;!(u+1>=e.length||""===_(e[u+1]));)++u,Object(C.a)(e[u])&&++d}}return s&&n&&(-1!==c?i.splice(c,0,[{commentModel:n.newComment_deprecated}]):(Object(o.i)().assertConditionTag(n.flatIndex>d,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),n.flatIndex===d+1&&i.push([{commentModel:n.newComment_deprecated}]))),i}},825:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=!1;function a(){r=!0}function o(){return r}},826:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return m}));var r=n(206),a=n(5),o=n(4),i=n(26),s=n(23),c=n(54),d=n(24),u=n(80),l={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:r.a.All},TrackedChange:{stubField:""},contentOrder:r.c.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0},m=function(e,t){return function(n){var r=new Map;return function(i){return function(s){if(!u.g(n.getState()))return i(s);var c,l=u.a(n.getState());switch(s.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":c=u.f(n.getState(),s.payload.filteredRange.id);break;case"UPDATE_FILTER_RANGE":c=u.f(n.getState(),s.payload.filterId);break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":s.payload.filteringEnabled=!0}var m=i(s);switch(s.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":!function(e,t,n,r,i,s,c){void 0===s&&u.f(n.getState(),r.payload.filteredRange.id)&&(i.set(r.payload.filteredRange.id,{filter:r.payload.filteredRange,changeToken:r.payload.filteredRange.onRangeUpdated.subscribe((function(e){!function(e,t,n,r,i,s){i.get(n)?t(d.updateFilterRange({renderContextType:r,telemetryVisitor:e,trackback:a.d.reserveTag(528779331)},{filterId:n,changes:s.changes})):Object(o.i)().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330)}(t,n.dispatch,r.payload.filteredRange.id,r.actionDetail.renderContextType,i,e)}))}),"LOAD_DEFAULT_FILTER"!==r.type&&!r.payload.shouldSetActive||u.a(n.getState())!==r.payload.filteredRange.id||(e.setActiveFilteredRange(r.payload.filteredRange.id),c&&c!==u.a(n.getState())&&c!==u.e(n.getState())&&n.dispatch(d.updateFilterRange({renderContextType:r.actionDetail.renderContextType,telemetryVisitor:t,trackback:a.d.reserveTag(528779332)},{filterId:c,changes:[{type:"Teardown"}]}))))}(e,t,n,s,r,c,l);break;case"UPDATE_FILTER_RANGE":!function(e,t,n,r,a,i,s){u.a(n.getState())!==s&&e.setActiveFilteredRange(u.a(n.getState()));var c=u.f(n.getState(),r.payload.filterId);if(i&&c&&i.filter!==c.filter){var d=a.get(r.payload.filterId);d&&d.filter.canBeUpdated()?d.filter.updateFilter(c.filter)||(Object(o.i)().assertConditionTag(!1,"The filter should have been able to update",528527826),f(e,t,n,c.filter,s===r.payload.filterId)):f(e,t,n,c.filter,s===r.payload.filterId)}var l=function(){return r.payload.changes.findIndex((function(e){return"Teardown"===e.type}))>=0};if(!u.f(n.getState(),r.payload.filterId)){Object(o.i)().assertConditionTag(l(),"Range should not be removed unless there was a Teardown",528749966);var m=a.get(r.payload.filterId);m&&(m.filter.teardown(),m.changeToken.unsubscribe(),a.delete(r.payload.filterId))}u.e(n.getState())||(Object(o.i)().assertConditionTag(l(),"Default filter should not be removed unless there was a Teardown",528749967),p(e,t,n))}(e,t,n,s,r,c,l)}return u.h(n.getState())&&p(e,t,n),m}}}};var f=function(e,t,n,r,o){e.createFilteredRange({contentTypes:[i.b.CommentThread],filters:r,supportsFilterUpdates:!1}).then((function(e){n.dispatch(d.loadFilter({renderContextType:s.a.None,telemetryVisitor:t,trackback:a.d.reserveTag(528532107)},{filteredRange:e,shouldSetActive:o}))})).catch(Object(c.a)(a.d.reserveTag(528532108)))},p=function(e,t,n){e.createFilteredRange({contentTypes:[i.b.CommentThread],filters:l,supportsFilterUpdates:!1}).then((function(e){n.dispatch(d.loadDefaultFilter({renderContextType:s.a.None,telemetryVisitor:t,trackback:a.d.reserveTag(528779333)},{filteredRange:e}))})).catch((function(e){Object(o.i)().assertConditionTag(!1,"Error creating new filter: ".concat(Object(a.l)(e)),528779334)}))}},827:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17),a=n(15),o=n(218);function i(e,t,n){var i=Object(a.K)(n);if(i)return i.threadId!==e?o.a.InOtherCard:r.o()&&i.renderContextType!==t?o.a.InOtherContextOfThisCard:"EDIT"===i.commentDraft.sessionConfiguration.sessionType?o.a.InChildPost:o.a.InCard}},84:function(e,t,n){"use strict";function r(){return"web"}n.d(t,"a",(function(){return r}))},85:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var a,o=n(371),i=n(808);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(a||(a={})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return a}))},86:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(5),o=n(76),i=n(47);function s(){if(!r)try{r=Object(o.a)()}catch(e){throw new i.a("FeatureGateAPI not initialized",a.d.reserveTag(589103629),-2130957531)}return r}},879:function(e,t,n){"use strict";var r,a=n(0),o=n(1);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(o.__spreadArray)(Object(o.__spreadArray)([],n,!1),t,!1))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var a=s.apply(void 0,t);return r=void 0,a}}c(a.useMemo);var d,u=c(a.useEffect),l=(c(a.useLayoutEffect),d=a.useCallback,function(e,t,n){return e()&&n?n(t):null});n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}))},89:function(e,t,n){"use strict";n.d(t,"l",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return h})),n.d(t,"o",(function(){return b})),n.d(t,"m",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return T})),n.d(t,"n",(function(){return O})),n.d(t,"d",(function(){return I})),n.d(t,"c",(function(){return S}));var r=n(5),a=n(226),o=n(4),i=n(84),s=n(624),c=n(47),d=n(17);function u(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function l(e){return e?Object(a.e)(e)?e.Name:e.DisplayName:""}function m(e){if(!e)return"";if(!Object(a.e)(e))return Object(o.i)().assertConditionTag(!d.w()||Object(s.b)(Object(i.a)()),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(o.i)().assertConditionTag("win32"===Object(i.a)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new c.a("UserPrincipalName and EmailAddresses, both not available",r.d.reserveTag(589103706),-2130957499)}function f(e){if(!e)return"";if(Object(a.d)(e)){var t=e.Email||e.UserId;return Object(o.i)().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return m(e)}function p(e){return e.UserId?e.UserId:g(e)}function g(e){return void 0!==e.DisplayName?e.DisplayName:(Object(o.i)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function C(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function h(e){return 0===Object.keys(e).length&&Object(o.i)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function b(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function v(e,t){t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]}))}function y(e,t){return t.forEach((function(t){e[f(t)]={assignee:t}})),e}function T(e,t){Object.keys(t).forEach((function(n){e[n]={assignee:t[n].mentionee}}))}function O(e,t){var n=f(t);e[n]?delete e[n]:e[n]={assignee:t}}function I(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}function S(e){return e.some((function(e){return e.IsCurrentUser}))}},90:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},923:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},924:function(e,t,n){var r=n(1175);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},925:function(e,t,n){var r=n(926),a=n(928),o=n(1176);e.exports=function(e){return function(t,n,i){var s,c=r(t),d=a(c.length),u=o(i,d);if(e&&n!=n){for(;d>u;)if((s=c[u++])!=s)return!0}else for(;d>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},926:function(e,t,n){var r=n(722),a=n(723);e.exports=function(e){return r(a(e))}},927:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},928:function(e,t,n){var r=n(929),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},929:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},93:function(e,t,n){"use strict";n(5),n(4),n(23);function r(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function a(e){return"cardEditor".concat(r(e))}function o(e){return"postEditor".concat(r(e))}function i(e){return"editorRoot_".concat(e)}function s(e){return"postRoot".concat(r(e))}function c(e,t){return t?"draftCardRoot".concat(r(e)):"cardRoot".concat(r(e))}function d(){return"GhostCard"}function u(e){return"replyBoxDescription".concat(r(e))}function l(e){return"editorBoxDescription".concat(r(e))}function m(e){return"sendReplyButton".concat(r(e))}function f(e){return"cancelReplyButton".concat(r(e))}function p(e){return"cardContextMenu".concat(r(e))}function g(e){return"postContextMenu".concat(r(e))}function C(e){return"renderableItemList".concat(r(e))}function h(e,t){return"actionBarButton_".concat(t).concat(r(e))}function b(e){return"editorFocusContainer_".concat(e)}function v(e){return"draftCancelButton".concat(r(e))}function y(e){return"innerReplyBoxContainer".concat(r(e))}function T(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function O(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function I(e){return"viewMoreReply".concat(r(e))}function S(e){return"postTimeStamp".concat(r(e))}function _(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function j(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function D(e){return"anchorHintText".concat(r(e))}function E(e){return"lowFidelityWarning".concat(r(e))}function A(){return"CommentsListScrollView"}function P(){return"CommentsList"}function x(){return"EmptyCreatedCommentLie"}function k(){return"NewCommentButton"}function w(e){return"taskAssignerCheckbox".concat(r(e))}function R(e){return"cardTaskFooterPickerButton".concat(r(e))}function F(e){return"cardTaskTopperCheckbox".concat(r(e))}function N(e){return"cardTaskTopperDiv".concat(r(e))}function M(e){return"taskAssignerDiv".concat(r(e))}function L(){return"TaskChevronIcon"}function V(e){return"postWarning".concat(r(e))}function B(e){return"draftWarning".concat(r(e))}function U(e){return"postingTip".concat(r(e),";")}function H(e){return"truncationOverlay".concat(e)}function G(){return"next-thread-button"}function W(){return"previous-thread-button"}function q(e){return"loadingPlaceholder".concat(r(e))}function z(e){return"DiscreteHostedCommentRoot".concat(r(e))}function Y(e){return"AtMentionExtraInfoButton".concat(r(e))}function K(){return"ReopenThread"}function X(){return"suggestion-list"}function Q(){return"lppSuggestionListId"}function Z(e){return"smartReplyHeader_".concat(e)}function J(e){return"reactionButtonDescription_".concat(e)}function $(e){return"reactionButtonUserList_".concat(e)}function ee(e,t){return"".concat(e,"_").concat(t)}function te(e){return"commentReactionButton".concat(r(e))}n.d(t,"f",(function(){return a})),n.d(t,"G",(function(){return o})),n.d(t,"x",(function(){return i})),n.d(t,"I",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"A",(function(){return d})),n.d(t,"R",(function(){return u})),n.d(t,"v",(function(){return l})),n.d(t,"S",(function(){return m})),n.d(t,"Q",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"H",(function(){return g})),n.d(t,"O",(function(){return C})),n.d(t,"a",(function(){return h})),n.d(t,"w",(function(){return b})),n.d(t,"t",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"z",(function(){return T})),n.d(t,"l",(function(){return O})),n.d(t,"Z",(function(){return I})),n.d(t,"J",(function(){return S})),n.d(t,"r",(function(){return _})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return D})),n.d(t,"C",(function(){return E})),n.d(t,"p",(function(){return A})),n.d(t,"q",(function(){return P})),n.d(t,"y",(function(){return x})),n.d(t,"D",(function(){return k})),n.d(t,"U",(function(){return w})),n.d(t,"W",(function(){return R})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return N})),n.d(t,"V",(function(){return M})),n.d(t,"X",(function(){return L})),n.d(t,"K",(function(){return V})),n.d(t,"u",(function(){return B})),n.d(t,"L",(function(){return U})),n.d(t,"Y",(function(){return H})),n.d(t,"E",(function(){return G})),n.d(t,"M",(function(){return W})),n.d(t,"g",(function(){return q})),n.d(t,"s",(function(){return z})),n.d(t,"c",(function(){return Y})),n.d(t,"P",(function(){return K})),n.d(t,"F",(function(){return X})),n.d(t,"B",(function(){return Q})),n.d(t,"T",(function(){return Z})),n.d(t,"N",(function(){return J})),n.d(t,"o",(function(){return $})),n.d(t,"m",(function(){return ee})),n.d(t,"n",(function(){return te}))},930:function(e,t,n){var r=n(721)("wks"),a=n(720),o=n(504).Symbol,i="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=i&&o[e]||(i?o:a)("Symbol."+e))}).store=r},931:function(e,t,n){var r=n(924),a=n(722),o=n(932),i=n(928),s=n(1179);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,u=4==e,l=6==e,m=5==e||l,f=t||s;return function(t,s,p){for(var g,C,h=o(t),b=a(h),v=r(s,p,3),y=i(b.length),T=0,O=n?f(t,y):c?f(t,0):void 0;y>T;T++)if((m||T in b)&&(C=v(g=b[T],T,h),e))if(n)O[T]=C;else if(C)switch(e){case 3:return!0;case 5:return g;case 6:return T;case 2:O.push(g)}else if(u)return!1;return l?-1:d||u?u:O}}},932:function(e,t,n){var r=n(723);e.exports=function(e){return Object(r(e))}},936:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=a,a.default=a},937:function(e,t,n){"use strict";var r=n(1225).SharedCommentsVersion;t.a=r},938:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),a=n(15),o=n(161),i=n(129);function s(e,t){var n=Object(a.K)(e);if(!n)return Object(r.i)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(i.b)(t)?o.a.ClosePaneDraft:o.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return o.a.CancelNewDraft;case"EDIT":return o.a.CancelPostEdit;case"REPLY":return o.a.CancelReplyDraft;case"METADATA":return Object(r.i)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),o.a.CancelNewDraft}}},939:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(131),a=n(17),o=n(15);function i(e,t){if(!a.p())return!1;var n=Object(o.K)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},99:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function a(e){return void 0!==e.comments||void 0!==e.threads}function o(e){return void 0!==e.threads&&void 0===e.comments}var i;function s(e){return void 0!==e.comments||void 0!==e.commentIds}function c(e){return void 0!==e.commentIds}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function m(e){return void 0!==e.contextDetails}function f(e){return void 0!==e.modelCapabilityFlags}function p(e){return void 0!==e.errorType}function g(e){return void 0!==e.draftId}function C(e){return void 0!==e.draftId}function h(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"o",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"n",(function(){return C})),n.d(t,"m",(function(){return h})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(i||(i={}))}},[[1239,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map