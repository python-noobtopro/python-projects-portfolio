function j6(a,b){a.xk(b,Date.now())}a_.prototype.ffa=q(-2024655713,function(){Bm()&&gDc(PCc(this),{PeopleWell:"PeopleWell"},18)});b_.prototype.ffa=q(1241399318,function(){this.KQ.ffa()});Mrd.prototype.ffa=q(-1223737966,function(){this.wo.ffa()});w.Ca.Ys.cva.prototype.ENb=q(-779142581,function(){return this.Vld.ENb()});Hhc.prototype.ENb=q(-952640264,function(){return this.lb.ia("IsUserProfilePictureResolutionEnabled")});uy.prototype.Aib=q(-1606213440,function(){return this.yxg.Wf()});
fkd.prototype.Aib=q(1521642731,function(){return this.qSe.Wf()});on.prototype.Ax=q(-462992048,function(){return this.eh});function NFd(a,b,c){return a.qzd?a.qzd.Ace(new Date(b),new Date(c)):-1}function OFd(a,b){return b&&b in a.lxc?a.lxc[b]:null}function PFd(a){Ukd(a);return a.jAa}function QFd(a,b){a.qa.Ha("RC",b,null)}function k6(a,b){a.hw|=b}function RFd(a,b){a.ku=b}function SFd(a){return new $2(new zJ(a.slideId),a.shapes,a.sn)}window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");
w=window.Common||{};w.Ca=w.Ca||{};w.Ca.BSa=w.Ca.BSa||{};function TFd(a){this.Z1e=Function.createDelegate(this,this.lJf);this.zra=Function.createDelegate(this,this.yea);this.sfc={};this.Kkc={};this.oga=a}
TFd.prototype={sJ:null,oga:null,rHb:null,d$a:p(-1999828422),ub:function(){if(this.rHb)return this.rHb.Wf();this.rHb=new (bb.$$(Object));var a=this;this.oga.CW(function(){a.sJ=ab(a.oga);UFd(a.sJ,a.zra);VFd(a);a.rHb.Uh(null)});return this.rHb.Wf()},yea:function(){VFd(this)},lJf:function(a,b){return a.Asa>b.Asa?1:a.Asa<b.Asa?-1:0}};
function VFd(a){var b=l6(a.sJ,!1);b.sort(a.Z1e);a.sfc={};for(var c=0;c<b.length&&b[c]&&b[c].Asa;c++){var d=a,e=b[c].Ax(),f=c;a.sfc[e]=f;e in d.Kkc&&(mb(d.Kkc[e],f),delete d.Kkc[e])}}
function WFd(a,b,c,d,e,f,g,h,k){this.dBc=Function.createDelegate(this,this.iZc);this.vYb=Function.createDelegate(this,this.j0c);this.kfa=a;this.ghb=new (bb.$$(w.N4b));this.lb=c;this.tfc=b;this.eJ=d;this.Xk=e;this.Lkc=f;this.oga=g;this.poe=h;this.Wbd=this.Vbd=!1;this.MLb=0;this.J9c=1;this.Mma=k;this.Dhb=this.lb.ia("PeoplesWellExtraButtonInfoIsEnabled");this.xIa=window.$$as(String,F.od.Application)||""}
WFd.prototype={kfa:null,ghb:null,tfc:null,lb:null,eJ:null,Xk:null,Lkc:null,oga:null,poe:null,Dhb:!1,sJ:null,Qpe:null,hAe:null,J9c:0,Wbd:!1,Vbd:!1,MLb:0,Mma:null,xIa:null,ub:function(){var a=this;Oa.WAA.call(null,this.oga,this.tfc,this.Lkc).CW(function(){a.sJ=ab(a.oga);a.Qpe=ab(a.tfc);a.hAe=ab(a.Lkc);Oa.WAA.call(null,ab(a.tfc).Goa(),ab(a.Lkc).shb.Wf()).CW(function(){a.J9c=ab(a.Qpe.Goa());a.MLb=ab(a.hAe.shb.Wf());UFd(a.sJ,a.vYb);l6(a.sJ,!1).length&&a.yea()})})},j0c:function(){this.yea()},yea:function(){this.poe(l6(this.sJ,
!1))?(XFd(this.sJ,this.vYb),YFd(this,this.Vbd)):mb(this.ghb,1);this.Vbd=!0},iZc:function(){var a=this.Xk.ts("AppInitStatus_"+w.Ca.qka.toString(4));vb(42259235,325,!!this.MLb,null);var b=this.MLb-a,c={};c.InteractiveTime=a;c.ReactRenderComplete=this.MLb;c.HadTabSwitch=this.Mma();c.IsModernGallery=this.Dhb;u(594883104,325,50,go(c));if(this.Dhb){u(42062997,325,15,b.toString());a=this.ghb;var c=this.lb.fd("CoauthorGalleryTimeToRenderDurationMs",1E4),c=b>c,d="Word"===this.xIa;this.Mma()?(u(50455714,325,
50,c.toString()),b=!1):(d&&Ce().recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null),c&&(d&&Ce().recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),u(42062998,325,15,b.toString())),b=c);mb(a,b?3:2)}else u(594883103,325,15,b.toString())}};function ZFd(a,b){b?Je(a.eJ,4,a.dBc,3):mb(a.ghb,1)}
function YFd(a,b){a.Wbd?a.ghb.Wf().CW(function(){u(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",w.N4b.toString(ab(a.ghb.Wf())))}):(a.Wbd=!0,ZFd(a,!a.J9c&&!b))}function $Fd(a,b){this.zra=Function.createDelegate(this,this.yea);this.mhd=a;this.rAe=b}function aGd(a){for(var b,c=null,d=a.length,e=0;e<d;++e)if(b=a[e])if(b=b.sca||!b.ED?b.Ax():b.ED.toUpperCase(),!c)c=b;else if(c!==b)return!0;return!1}
$Fd.prototype={clc:null,rAe:null,mhd:null,ub:function(){var a=this;this.mhd.CW(function(){a.clc=ab(a.mhd);UFd(a.clc,a.zra)})},yea:function(){aGd(l6(this.clc,!1))&&(XFd(this.clc,this.zra),this.rAe.IsRealCoauthSession=!0)}};function bGd(){}
bGd.prototype={Xb:function(){return"Common.App.CoauthTelemetry"},wc:function(a){C(D(lc(a.ma($Fd,null),UFa)),function(){return new $Fd(mc(Nc,kc(a,Nc)),F.hn)});C(D(lc(a.ma(WFd,null),Wfa)),function(){return new WFd(Zf(),mc(Ac,kc(a,Ac)),L,window.Common.App.AppLifecycleManager.get_instance(),ve(),mc(rga,kc(a,rga)),mc(Nc,kc(a,Nc)),aGd,function(){return cGd()})});C(D(lc(a.ma(dGd,null),VFa)),function(){return new dGd(mc(Ac,kc(a,Ac)),mc(Oc,kc(a,Oc)),mc(Nc,kc(a,Nc)),a.H(TFa,null),ve(),function(){return cGd()},
L,null,Ce())});C(D(lc(a.ma(TFd,null),TFa)),function(){return new TFd(mc(Nc,kc(a,Nc)))});C(D(a.ma(yzc,null)),function(){return new yzc(mc(Nc,kc(a,Nc)),mc(Zc,kc(a,Zc)),L,"{"+vp+"}")})},ub:function(){L.Nf(function(){B().H($Fd,null).ub();B().H(yzc,null).ub();L.ia("CoauthorGalleryTelemetryIsEnabled")&&B().H(Wfa,null).ub();L.ia("CashTelemetryIsEnabled")&&(B().H(VFa,null),B().H(TFa,null))})},ha:function(){}};function cGd(){return kia()&&ve().Cr("UserActions")?0<ve().ts("UserActions").VisiToggled:!1}
function yzc(a,b,c,d){this.zra=Function.createDelegate(this,this.yea);this.mhd=a;this.LYa=b;this.lb=c;this.Lfd=d}
yzc.prototype={mhd:null,LYa:null,clc:null,lb:null,Lfd:null,vJb:!1,cFb:!1,ub:function(){var a=this;this.mhd.CW(function(){a.clc=ab(a.mhd);UFd(a.clc,a.zra)})},yea:function(){for(var a=l6(this.clc,!1),b=new (Ca.$$(String)),c=0,d=a.length,e=0;e<d;++e){var f=a[e];if(f&&f.sca){aB("70eb6120;2gfeb930");if(zzc(this)&&!this.cFb)if(b.Kc(f.sU())){var g=Azc(a);u(526394833,302,50,"Duplicate guest friendly name detected among {0} total guest coauthors",g);this.cFb=!0}else b.ga(f.sU());f.Ax()===this.Lfd||this.vJb||
(c++,2<=c&&Bzc(this))}}!this.vJb||zzc(this)&&!this.cFb||XFd(this.clc,this.zra)}};function Azc(a){return Xn(a)?0:Zn(a,function(a){return a.sca}).length}function Bzc(a){u(525112603,302,50,"Multiple guests simultaneously coauthoring");a.vJb=!0;a.lb.fc("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)&&a.LYa&&a.LYa.CW(function(){window.setTimeout(function(){ab(a.LYa).Jn("MultipleGuestsCoauthoring",null,null)},15E3)})}
function zzc(a){return a.lb.fc("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}
function dGd(a,b,c,d,e,f,g,h,k){this.vYb=Function.createDelegate(this,this.j0c);this.Wef=Function.createDelegate(this,this.Y3f);this.$jf=Function.createDelegate(this,this.o$f);this.LAe={};this.L9c={};this.uwe=new (Ca.$$(String));this.yoa=new (ga.$$(Number))(function(){return g.v_("PresenceBootLatencyThreshold",1E4)});this.cna=new (ga.$$(Number))(function(){return g.v_("PresenceBootLatencyCutoffThreshold",6E4)});this.HFe=new (ga.$$(Number))(function(){return g.v_("PresenceLightupLatencyThreshold",
2E3)});this.Pqe=new (ga.$$(Number))(function(){return g.v_("PresenceLightupLatencyCutoffThreshold",1E4)});this.tAe=d;this.K9c=a;this.cjd=b;this.oga=c;this.Xk=e;this.Lfd=h;this.Mma=f;this.Uf=k;this.D8c=!1;this.ub()}
dGd.prototype={K9c:null,cjd:null,Ilc:null,oga:null,sJ:null,D8c:!1,Lfd:null,sHb:null,tAe:null,Xk:null,$De:0,aEe:0,yoa:null,cna:null,HFe:null,Pqe:null,Mma:null,Uf:null,ub:function(){if(this.sHb)return this.sHb.Wf();this.sHb=new (bb.$$(Object));this.Mma()&&u(50951700,302,15,"TabSwitched Session");var a=this;this.K9c.CW(function(){var b=ab(a.K9c),c=b.Goa(),f=b.Aib();f.CW(function(){c.CW(function(){a.Uf&&a.Uf.addQosPillar(window.Common.QosPillarName.toString(4));var b=ab(c),d=ab(f);a.$De=b;a.aEe=d?d:(new Date).getTime();
a.sHb.Uh(null)})})});var b=this;this.cjd.CW(function(){b.Ilc=ab(b.cjd);b.Ilc.s_a(b.$jf);b.Ilc.Yya(b.Wef)});var c=this;this.oga.CW(function(){c.sJ=ab(c.oga);UFd(c.sJ,c.vYb);0<l6(c.sJ,!1).length&&c.yea()});return this.sHb.Wf()},o$f:function(a,b){this.D8c||2!==b.yK||(a=Czc(this),a=Date.now()-a,b={},b.clientId=this.Lfd||"{"+vp+"}",b.bootTime=a,this.D8c=!0,this.Ilc.Qea(15,b,!1))},Y3f:function(a,b){if(15===b.Dk){a=Date.now();var c=b.Oya;b=c.bootTime;c=fGd(this,c.clientId);c.jEb=a-b;gGd(c)}},j0c:function(){this.yea()},
yea:function(){for(var a=Date.now(),b=l6(this.sJ,!1),c=new (Ca.$$(String)),d=b.length,e=0;e<d;++e){var f=b[e];this.uwe.Kc(f.Ax())||(this.uwe.ga(f.Ax()),c.ga(f.Ax()))}if(0<c.Qa())for(b=c.$$lge();b.$$mn();)c=b.$$cu(),c=fGd(this,c),c.H9c||(c.G9c=a,gGd(c))},d$a:p(-300453624)};function fGd(a,b){return b in a.L9c?a.L9c[b]:a.L9c[b]=new hGd(b,a.HFe,a.Pqe)}function Czc(a){return a.Xk.Cr("UserClickedHostUI")?a.Xk.ts("UserClickedHostUI"):kia()?window.performance.timing.fetchStart:-1}
function iGd(a,b,c,d,e,f,g,h,k){this._id=a;this.nk=b;this.aD=c;this.Gjc=d;this.Xmc=e;this.yoa=f;this.cna=g;this.Epe=h;this.Mma=k;this.xIa=window.$$as(String,F.od.Application)||""}
iGd.prototype={nk:0,yoa:null,cna:null,YCe:!1,xIa:null,aD:0,Gjc:null,Xmc:null,Epe:0,_id:null,Mma:null,hec:function(a){var b=this;Oa.WAA(this.Gjc,this.Xmc).CW(function(){if(ab(b.Gjc)<=ab(b.Xmc))mb(a,!1);else{var c=b.aD-b.nk,d=new window.Common.App.CoauthTelemetry.PL;d.id=b._id;d.et=b.aD;d.st=b.nk;d.d=b.aD-b.nk;d.mp=ab(b.Gjc);d.tp=ab(b.Xmc);d.ct=jGd(b.Epe);d.vc=b.Mma();var e=Id(d),f="Word"===b.xIa;u(42078597,302,15,e);if(f){var g=new window.Map;g.set("data",e);Ce().recordKpiUsage("PresenceExperienceDegraded",
0,"wordcollabrel",g)}if(c>b.yoa.Aa()&&!b.YCe&&!d.vc){b.YCe=!0;mb(a,!0);var h,d=(h=new nj,h.inStaging=!0,h.extendedProperties=new window.Map,h);d.extendedProperties.set("data",e);f&&Ce().recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,d);c<b.cna.Aa()&&u(42078598,302,15,window.Common.App.CoauthTelemetry.VD.nke(c,b.yoa.Aa(),b.cna.Aa()))}3<a.Wf().Th||mb(a,!1)}})}};
function jGd(a){switch(a){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}window.Common.App.CoauthTelemetry.PL=w.Ca.BSa.sdg=function(){};w.Ca.BSa.sdg.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};window.Common.App.CoauthTelemetry.VD=w.Ca.BSa.vtg=function(){};window.Common.App.CoauthTelemetry.VD.nke=function(a,b,c){var d=new window.Common.App.CoauthTelemetry.VD;d.d=a;d.vt=b;d.ct=c;return Id(d)};w.Ca.BSa.vtg.prototype={d:0,vt:0,ct:0};
function hGd(a,b,c){this._id=a;this.yoa=b;this.cna=c;this.xIa=window.$$as(String,F.od.Application)||""}
hGd.prototype={_id:null,jEb:0,G9c:0,j9c:0,xIa:null,yoa:null,cna:null,H9c:0,k9c:0,hec:function(a,b){var c=a-this.jEb,d=new window.Common.App.CoauthTelemetry.PL;d.id=this._id;d.et=a;d.st=this.jEb;d.d=c;var e=Id(d);a="Word"===this.xIa;d="CanvasPresenceLightupDurationTooLong"===b?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===b?u(572289499,302,15,e):u(571524118,302,15,e);if(a){var f=new window.Map;f.set("data",e);Ce().recordKpiUsage(d,0,"wordcollabrel",
f)}if(c>this.yoa.Aa()){var g,f=(g=new nj,g.inStaging=!0,g.extendedProperties=new window.Map,g);f.extendedProperties.set("data",e);g=c<this.cna.Aa();f.extendedProperties.set("cash",g?"true":"false");a&&Ce().recordKpiFailure(d,b,!1,!0,f);u(572289500,302,15,window.Common.App.CoauthTelemetry.VD.nke(c,this.yoa.Aa(),this.cna.Aa()));return g?2:1}return 3}};
function gGd(a){!a.H9c&&a.jEb&&a.G9c&&(a.H9c=a.hec(a.G9c,"CoauthGalleryLightupDurationTooLong"));!a.k9c&&a.jEb&&a.j9c&&(a.k9c=a.hec(a.j9c,"CanvasPresenceLightupDurationTooLong"))}TFd.registerClass("Common.App.CoauthTelemetry.CoauthorPositionFinder",null,TFa);WFd.registerClass("Common.App.CoauthTelemetry.CoauthorGalleryTelemetry",null,Wfa);$Fd.registerClass("Common.App.CoauthTelemetry.CoauthTelemetry",null,UFa);bGd.registerClass("Common.App.CoauthTelemetry.CoauthTelemetryPackage",null,yo,ec);yzc.registerClass("Common.App.CoauthTelemetry.GuestCoauthTelemetry");
dGd.registerClass("Common.App.CoauthTelemetry.PresenceBootTelemetry",null,VFa);iGd.registerClass("Common.App.CoauthTelemetry.PresenceLatencyActivityLogger");window.Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");window.Common.App.CoauthTelemetry.VD.registerClass("Common.App.CoauthTelemetry.VD");hGd.registerClass("Common.App.CoauthTelemetry.PresenceLightupLatencyLogger");zo(gj(),new bGd,0,!1);Type.registerNamespace("RealtimePresenceUI");function kGd(){}kGd.registerInterface("RealtimePresenceUI.IUserTracker");
function lGd(a,b,c){this.Xef=Function.createDelegate(this,this.Z3f);this.zra=Function.createDelegate(this,this.yea);this.shb=new (bb.$$(Number));this.dispose=this.ha;this.Qj=a;this.cva=b;if(c){var d=this;c.CW(function(){d.sJ=ab(c);UFd(d.sJ,d.zra);mGd(d)})}this.cvg=new on(this.Qj.eh,"Anonymous user","#cccccc",new pn(7),null,null,null,null,!1,!1,!1,0,null,0);this.Xrb=this.yic=!0;this.Bhc=this.nhd=!1;this.mT=nGd(this.Qj.eh,this.Qj.P5a,a.GRd)}
function oGd(a,b){return a.hw.hw&1&&b.hw.hw&1||!(a.hw.hw&1||b.hw.hw&1)?a.ku.localeCompare(b.ku)-Zka:a.hw.hw&1?-1:1}lGd.prototype={cvg:null,yic:!1,nhd:!1,Bhc:!1,Qj:null,mT:null,cva:null,sJ:null,Xrb:!1,yea:function(){if(!this.Bhc){var a=this;window.setTimeout(function(){mGd(a);a.Bhc=!1},3E3);this.Bhc=!0}},Z3f:function(a,b,c,d,e){mb(this.shb,e.RenderTime);return 32},ha:function(){this.sJ&&(XFd(this.sJ,this.zra),this.sJ=null)}};
function mGd(a){if(!a.nhd&&(mb(a.shb,(new Date).getTime()),u(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),pGd()))return;var b;if(a.Izd)b=l6(a.Izd,!0);else{R(50440411,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");b=[];var c=PFd(a.HTb),d;(d=V3(a.ri,a.ri.Px,{val:void 0}),d)||R(38589792,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",a.ri.Px);var e=null;
a.Rz&&(e=a.Rz.D6b());for(var f=L.ia("PeoplesWellExtraButtonInfoIsEnabled"),g=a.ri.UX(),h=g.length,k=0;k<h;++k){var l=g[k];d=a.pqa.rua(new CW(l.EmailAddress,null,l.Name,null,!1,null),l.ColorIndex,l.ID,1);var m=new pn(0);k6(m,0);var n=0,r=!1;if(e&&l.ID in e){k6(m,1);if(f){var t=e[l.ID];t&&(n=t.capabilities);r=!0;t&&t.capabilities&4&&k6(m,4)}delete e[l.ID]}qGd(c,l.EmailAddress)||(Array.add(b,new on(l.ID,l.Name,d,m,null,l.EmailAddress,null,null,!1,!1,!1,0,null,0)),R(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
l.ID,d,!!(m.hw&1),!!(m.hw&4),a.ri.Px,!l.EmailAddress,n,r))}if(!f&&a.DNa&&e)for(var v in e)t=e[v],!qGd(c,t.email)&&t&&t.userName&&(m=new pn(0),k6(m,1),t.capabilities&4&&k6(m,4),f=OFd(a.SMa,t.email)||t.email,d=a.pqa.rua(new CW(f,null,t.userName,null,!1,null),null,t.clientId,1),Array.add(b,new on(t.clientId,t.userName,d,m,null,f,null,null,!1,!1,!1,0,null,0)),R(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
t.clientId,d,!!(m.hw&1),!!(m.hw&4),a.Rz.Ax(),!t.email,t.capabilities));0<b.length&&R(50942294,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",b.length)}b=b||[];c=b.length;for(v=0;v<c;++v)d=b[v],d.Ax()||(m=Ae().toString(),d.eh=m),d.sU()||RFd(d,"Anonymous user"),d.hw||(d.hw=new pn(0)),d.C_a()||d.fob("#cccccc"),d.Asa||(d.Asa=0);c=a.mT;c.TDb=new (Da.$$(Array));v=b.length;for(d=0;d<v;++d)if(m=b[d],m.Ax()===c.APc){c.HQc=m;break}v=b.length;for(d=0;d<v;++d)m=b[d],m.Ax()!==c.APc&&
c.p9d(m);a.Xrb&&1<=m6(a.mT)&&(u(6092429,325,50,"PeoplesWell: User is no longer forever alone."),a.Xrb=!1);a.yic=!0;pGd()&&a.Xrb?L&&L.fc("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||io("ribbon","coauthorGallery","unused"):(L&&L.fc("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(zLa("ribbon","coauthorGallery"),wDa("ribbon","coauthorGallery")),rGd(a))}
function sGd(a){L.ia("CoauthorGalleryTelemetryIsEnabled")&&!a.nhd&&(Zf().n_(691867605)&&jna("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||Zf().ua(691867605,2147483648,a.Xef,96));a.Fa.ya(a.Qj.Zd.ACc,1,a.ecf);a.Fa.ua(a.Qj.Zd.ECc,1,a.Nqf,96);a.Fa.ua(a.Qj.Zd.CCc,1,a.V1e,96);a.Fa.ua(a.Qj.Zd.BCc,1,a.U1e,96);a.Fa.ua(a.Qj.Zd.DCc,1,a.xnf,96);a.Fa.ya(a.Qj.Zd.FCc,1,a.Xxf);a.Fa.ua(a.Qj.Zd.mPd,1,a.fnf,96);a.nhd=!0;mGd(a)}
function tGd(){return L&&L.ia("ColorPresenceHashIsEnabled")?"Initials":"Menu32"}function uGd(){var a;return a=new Dn,a.Id="BasicChat",a.Command="2288458806",a.LabelText=CommonUIStrings.l_StartGroupChat,a.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",a}
function vGd(a,b){if(!(b.hw.hw&1))return b.r6()?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;var c=b.r6(),d=a.Qj.P5a(b.Ax());b=a.Qj.a_b(b.Ax());if(!d)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(d.Se){case 1:if(b)if(c)a=CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline;else{var d=null,c=" ",e,f;(f=wGd(a,b,e={val:d}),d=e.val,f)&&d&&d.nh&&(a=FO(a.qc,d.nh))&&(c=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,
a.Sd+1));a=c||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}else a=CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;return a;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}
function xGd(a,b,c,d){if(!c)return d&&u(4482393,325,50,"User does not have any presence data"),!1;var e=null,f,g;return(g=wGd(a,c,f={val:e}),e=f.val,g)&&e&&e.nh?(a=a.Qj.P5a(b))&&2===a.Se?!1:!0:(d&&u(4482394,325,50,"User has presence data but app can't use it"),!1)}function pGd(){return L?L.ia("PeoplesWellExtraButtonInfoIsEnabled"):!1}function yGd(a,b,c,d,e){this.Zd=a;this.eh=b;this.GRd=e;this.a_b=c||function(){return null};this.P5a=d||function(){return null}}
function zGd(a,b,c,d){return new yGd(a,b,c,d,!0)}yGd.prototype={Zd:null,Ta:function(){return this.Zd.Db},eh:null,a_b:null,P5a:null,GRd:!1};function AGd(a){this.TDb=new (Da.$$(Array));this.APc=a}AGd.prototype={APc:null,HQc:null};function BGd(a,b,c){b=b.toUpperCase();var d,e,f;(f=a.TDb.ng(b,e={val:d},null),d=e.val,f)||(d=[],a.TDb.ea(b,d));Array.add(d,c)}function m6(a){return a.TDb.Qa()}function CGd(a){for(var b=[],c=a.TDb.Iy().$$ge();c.$$mn();){var d=c.$$cu(),d=a.fke(d);Array.add(b,d)}return b}
function nGd(a,b,c){return c?new DGd(a,b):new EGd(a)}function DGd(a,b){DGd.initializeBase(this,[a]);this.ite=b}DGd.prototype={ite:null,p9d:function(a){a.sca||!a.ED?BGd(this,a.Ax(),a):this.HQc&&pb().Sa(this.HQc.ED,a.ED)||BGd(this,a.ED,a)},fke:function(a){for(var b=new Date(0),c=0<a.length?a[0]:null,d=a.length,e=0;e<d;++e){var f=a[e],g=this.ite(f.eh);g&&b.getTime()<g.STa.getTime()&&(b=g.STa,c=f)}return c}};function EGd(a){EGd.initializeBase(this,[a])}
EGd.prototype={p9d:function(a){BGd(this,a.Ax(),a)},fke:function(a){return a[0]}};lGd.registerClass("RealtimePresenceUI.APeoplesWell",null,rga,Sys.IDisposable);yGd.registerClass("RealtimePresenceUI.PeoplesWellSettings");(function(){}).registerClass("RealtimePresenceUI.PeoplesWellUtility");AGd.registerClass("RealtimePresenceUI.UserTracker",null,kGd);(function(){}).registerClass("RealtimePresenceUI.UserTrackerFactory");DGd.registerClass("RealtimePresenceUI.UniqueUserTracker",AGd);
EGd.registerClass("RealtimePresenceUI.UserInstanceTracker",AGd);Type.registerNamespace("RealtimePresenceUI");
function FGd(a,b,c,d){this.fnf=Function.createDelegate(this,this.beg);this.Xxf=Function.createDelegate(this,this.ttg);this.xnf=Function.createDelegate(this,this.xeg);this.U1e=Function.createDelegate(this,this.YIf);this.V1e=Function.createDelegate(this,this.ZIf);this.Nqf=Function.createDelegate(this,this.gig);this.ecf=Function.createDelegate(this,this.tZf);this.Yxf=Function.createDelegate(this,this.utg);this.ynf=Function.createDelegate(this,this.yeg);this.Oqf=Function.createDelegate(this,this.hig);
FGd.initializeBase(this,[a,c,d]);this.fna=function(){return!0};this.Fa=b}
FGd.prototype={fna:null,Fa:null,hig:function(a){if(this.yic){this.Xrb||(a[PX.Visible]=!0);var b,c,d,e,f,g=b={val:b},h=c={val:c},k=d={val:d},l=e={val:e},m=f={val:f},n,r,t,v;2<=m6(this.mT)?v=[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,m6(this.mT))]:1===m6(this.mT)?(n=CGd(this.mT)[0],v=(r=this.Qj.P5a(n.Ax()))&&2===r.Se?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,n.sU()]:[n.r6()?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
n.sU()]):v=[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself];m6(this.mT)?1===m6(this.mT)?(n=!0,r=this.Qj.Zd.A2b.Mqb,t=CGd(this.mT)[0].C_a()):(n=!0,r=this.Qj.Zd.KYd.Mqb,t=""):(n=!1,t=r="");g.val=v[0];h.val=v.slice(1);k.val=n;l.val=r;m.val=t;b=b.val;c=c.val;d=d.val;e=e.val;f=f.val;a[PX.LabelText]=b;c&&c.length&&(a[PX.LabelTextUserGeneratedPlaceholderReplacements]=c);a.ImageIsVisible=d;a[PX.Image16by16Class]=e;a.ImageBackColor=f;this.yic=!1}return!0},yeg:function(a){if(0>=m6(this.mT))a=!1;else{var b=
CGd(this.mT),c=[];Array.addRange(c,b);c.sort(oGd);for(var b=[],d=c.length,e=0;e<d;++e){var f=c[e],g=String.format("buttonPeoplesWellUser-{0}",f.Ax()),h=f.Ax(),k=vGd(this,f),l=f.sU(),m=f.C_a(),n;n=new Gn;n.Id=g;n.Command=this.Qj.Zd.FCc.toString();n.LabelText="{0}";n.Image32by32=this.Qj.Zd.oMc.DDc;n.Image32by32Class=this.Qj.Zd.oMc.Mqb;n.MenuItemId=h;n.CommandValueId=h;n.Alt=l;n.DisplayMode=tGd();n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word";n.Description=
k;n.ImageBackColor=m;n.IsAnonymous=f.sca;g=n;if(l=[l],l.length){h=new Sys.StringBuilder("STRARRY@");k=l.length;for(m=0;m<k;++m){var r=l[m];h.append(r?r.length:0);h.append(",");h.append(r);h.append(",")}l=h.toString().slice(0,-1)}else l=null;n=(g.LabelTextUserGeneratedPlaceholderReplacements=l,n.Upn=f.ED,n);L.ia("PeoplesWellExtraButtonInfoIsEnabled")&&this.cva&&(g=f,g=this.cva.ENb()?this.cva.ewb(g.ED,"O365",F.sh,0):void 0,l=this.Qj.P5a(f.Ax()),l=!l||l&&1===l.Se?!0:!1,n.ImageUrl=g,n.ActiveStatus=l,
n.JoinTimeInMS=f.Asa,f=xGd(this,f.Ax(),this.Qj.a_b(f.Ax()),!1),n.CanJump=f,""===g&&u(40969413,302,50,"ImageURL collection failed"));Array.add(b,n)}var t,c=(t=new Pg,t.Id="menuCoauthors",t.MaxWidth="220px",t.MenuSectionList=[],t),v;t=(v=new Yg,v.Id="msCoauthors",v.ControlsId="msCoauthorsControls",v.DisplayMode=tGd(),v.ControlList=b,v);L.ia("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.cva&&(t.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,t.TitleId="menuCoauthorsTitle",t.Theme="Light");Array.add(c.MenuSectionList,
t);if(L.ia("DocChatIsEnabled")&&L.ia("PeoplesWellExtraButtonInfoIsEnabled")&&G()&&G().rb().vn()){v=[];Array.add(v,uGd());var x;v=(x=new Yg,x.Id="msGroupChat",x.ControlsId="msGroupChatControl",x.ControlList=v,x);Array.add(c.MenuSectionList,v)}G()&&G().rb().vn()?a.MenuItems=c:a.PopulationXML=Vn(c);a=!0}return a},utg:function(a){u(4482395,325,50,"PeoplesWell: Received user button click");var b=a.MenuItemId;if(b){var c=this.Qj.a_b(b);if(xGd(this,b,c,!0)){a=null;var d,e;(e=wGd(this,c,d={val:a}),a=d.val,
e)&&a&&a.nh&&(R(8958488,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",b,a.nh,this.ri.Px),(d=FO(this.qc,a.nh))?(this.Le.rCb(),this.Le.s4(d.Sd)):R(19191178,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",a.nh));a=!0}else a=!1}else a=!1;return a},kN:function(a,b,c,d,e,f,g){a=!1;switch(c){case 1:a=f(e);break;case 2:a=g(e)}return a?32:8},tZf:function(a,b,c,d,e){var f=this;return this.kN(a,b,c,d,e,function(){return 0<
m6(f.mT)},this.fna)},gig:function(a,b,c,d,e){return this.kN(a,b,c,d,e,this.Oqf,this.fna)},xeg:function(a,b,c,d,e){return this.kN(a,b,c,d,e,this.fna,this.ynf)},ZIf:function(a,b,c,d,e){return this.kN(a,b,c,d,e,this.fna,this.fna)},YIf:function(a,b,c,d,e){return this.kN(a,b,c,d,e,this.fna,this.fna)},ttg:function(a,b,c,d,e){return this.kN(a,b,c,d,e,this.fna,this.Yxf)},beg:function(a,b,c,d,e){var f=this;return this.kN(a,b,c,d,e,this.fna,function(){mGd(f);return!0})},ha:function(){lGd.prototype.ha.call(this)}};
FGd.registerClass("RealtimePresenceUI.ABox4PeoplesWell",lGd);Type.registerNamespace("PowerPointWebEditor");M=window.PowerPointWebEditor||{};function GGd(a){var b=this;a.pb(function(a){b.ITb=a})}GGd.prototype={ITb:null,m$a:function(a){return this.ITb?this.ITb.m$a(a):null},KFa:function(a){return this.ITb?this.ITb.KFa(a):null}};Type.registerNamespace("PowerpointPresence");VK=window.PowerpointPresence||{};function HGd(a){this.ri=a}HGd.prototype={ri:null,Goa:function(){return this.ri.Goa()},Aib:function(){return this.ri.Aib()}};
function IGd(a,b,c,d,e){this.XAc=Function.createDelegate(this,this.IYc);this.NDd=new re;this.ri=a;this.pqa=c;this.My=d;this.My.qa.Ka("ETC",this.XAc);this.YLe=L.ia("PeoplesWellExtraButtonInfoIsEnabled");this.HTb=e;if(b){var f=this;b.pb(function(a){f.Rz=a})}}IGd.prototype={My:null,ri:null,pqa:null,HTb:null,Rz:null,YLe:!1,IYc:function(){R(50440406,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.NDd.Ha("UsersUpdatedEvent",this,null)}};
function JGd(a,b,c){var d=a.pqa.rua(new CW(b.EmailAddress,null,b.Name,null,!1,null),b.ColorIndex,b.ID,1),e=new pn(0);k6(e,0);var f=0,g=!1,h=!1;if(c&&b.ID in c){k6(e,1);if(a.YLe){var k=c[b.ID];k&&k.capabilities&4&&k6(e,4);g=!0;k&&(f=k.capabilities,h=k.isAnonymous)}delete c[b.ID]}R(50440404,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",
b.ID,d,!!(e.hw&1),!!(e.hw&4),a.ri.Px,!b.EmailAddress,f,g,h);return new on(b.ID,b.Name,d,e,null,b.EmailAddress,null,null,h,!1,!1,b.JoinCoauthTime,null,0)}
function l6(a,b){var c=[],d;(d=V3(a.ri,a.ri.Px,{val:void 0}),d)||R(50440398,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",a.ri.Px);var e=null;a.Rz&&(e=a.Rz.D6b());var f=PFd(a.HTb);d=!1;for(var g=a.ri.UX(),h=g.length,k=0;k<h;++k){var l=g[k],m;if(m=b)m=l.EmailAddress,m=!!f&&!!m&&f.toLowerCase()===m.toLowerCase();m?d=!0:Array.add(c,JGd(a,l,e))}e={};e.fExcludeCurrent=b;e.fCurrentExcluded=d;e.CurrentID=a.ri.Px;e.EditorCount=a.ri.UX().length;e.IsRtcNull=!a.Rz;e.UserCount=
c.length;R(50642948,814,50,"PeopleInfoProvider::GetAllUsers:{0}",Id(e));return c}function XFd(a,b){a.NDd.eb("UsersUpdatedEvent",b)}function UFd(a,b){a.NDd.Ka("UsersUpdatedEvent",b)}
function KGd(a,b,c,d,e,f,g,h,k,l,m,n,r,t,v,x,y,z){this.C9e=Function.createDelegate(this,this.NTf);this.$nf=Function.createDelegate(this,this.ffg);KGd.initializeBase(this,[a,b,x,z?nb(Nc,z):null]);if(!e)throw Error.argumentNull("coauthStateGetter");if(!f)throw Error.argumentNull("appFrame");if(!g)throw Error.argumentNull("taskManager");this.ri=e;this.Fb=f;this.ob=g;if(d){var E=this;d.pb(function(a){E.Rz=a})}if(c){var H=this;c.pb(function(a){a.wyg(H.$nf)})}this.qc=h;this.Le=k;this.Me=l;this.DNa=r;this.lJe=
m;this.pqa=n;this.SMa=t;this.hK=v;this.HTb=y;this.Izd=z;var O=this;this.shb.Wf().CW(function(){var a=ab(O.shb.Wf()),b=O.hK;try{b.kwc||(b.kwc=a,b.xk(17,b.kwc),b.xk(13,NFd(b,cld(b),b.kwc)),mb(b.HTe,!0))}catch(c){u(594879176,814,10,c.toString())}})}function qGd(a,b){return!!a&&!!b&&a.toLowerCase()===b.toLowerCase()}
KGd.prototype={ri:null,Rz:null,Fb:null,ob:null,Bvd:!1,qc:null,Le:null,Me:null,DNa:!1,lJe:null,pqa:null,SMa:null,hK:null,HTb:null,Izd:null,ffg:function(){this.Fb.Xt().it?this.Bvd||(this.ob.Vb(new Si(2,1,0,this.C9e,90,"70",!1,0)),this.Bvd=!0):this.Fa.Ab(2052777571,2,null)},NTf:function(){this.Bvd=!1;this.Fa.Ab(2052777571,2,null)},ha:function(){FGd.prototype.ha.call(this)}};
function rGd(a){QFd(a.Me,new LLb(a.Qj.Ta(),!0));var b=1<m6(a.mT)||1===m6(a.mT)&&CGd(a.mT)[0].Ax()!==a.Qj.eh;a.lJe.pb(function(c){if(b&&a.hK){var d=a.hK;j6(d,15);0<ald(d)&&j6(d,16)}c.ffa()});b&&a.hK.xk(14,Date.now())}function wGd(a,b,c){c.val=null;if(!b)throw R(8958490,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",a.ri.Px),Error.argumentNull("presence");if(!b)return!1;c.val=SFd(b.data);return c.val?!0:!1}Type.registerNamespace("PowerPointWebEditor.PeoplesWell");
M.aeg=M.aeg||{};function LGd(){this.BHd=Function.createDelegate(this,this.uYf)}
LGd.prototype={J:null,rg:null,My:null,E2:null,Xb:function(){return"PowerPointWebEditor.PeoplesWell"},wc:function(a){MGd=Date.now();this.J=a;this.E2=this.J.H(CK,null);this.rg=this.E2.Jda(6,this.Xb());var b=this;C(D(this.J.ma(P$c,null)),function(){return new GGd(kc(b.J,Q$c))});var c=this;C(D(this.J.ma(Ac,null)),function(){return new HGd(c.J.H(VH,null))});var d=this;C(D(lc(this.J.ma(IGd,null),Nc)),function(){return new IGd(d.J.H(VH,null),kc(d.J,Oc),d.J.H(Yad,null),d.J.H(b3,null),d.J.H(X2,null))});R(50943688,
814,50,"PPTWebEditorPeoplesWellPackage:Configure")},ub:function(){this.J.H(Ac,null);this.J.H(Nc,null);F.jW.Dy()?(this.My=this.J.H(b3,null),io("ribbon","coauthorGallery","unused"),this.My.qa.Ka("CSC",this.BHd)):NGd(this)},uYf:function(){try{F.jW.Dy()||(NGd(this),this.My.qa.eb("CSC",this.BHd))}catch(a){R(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",a)}},ha:function(){}};
function OGd(a,b,c,d,e,f,g){var h=a.J.H(WK,null);h.xk(10,MGd);h.xk(9,PGd);h.xk(11,(new Date).getTime());h=Date.now();b=zGd(new fDa("PeoplesWellControl",929022654,3798167515,1285265560,250882013,3236517055,4033456482,2052777571,bk,"per_SingleCollabUserGlyph_16x16x32",bk,"per_SingleCollabUserGlyph_32x32x32",bk,"per_MoreUsersGlyph_16x16x32",null,null),g,b.F6e||(b.F6e=Function.createDelegate(b,b.m$a)),b.H6e||(b.H6e=Function.createDelegate(b,b.KFa)));(g=a.J.H(IGd,null))||R(50642959,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
R(50943691,814,50,"InitializePeoplesWellInternal; creating peopleswell");var k=new KGd(b,c,kc(a.J,Y2),kc(a.J,Oc),a.J.H(VH,null),d,e,a.J.H(WM,null),a.J.H(xQ,null),a.J.H(dS,null),kc(a.J,ju),a.J.H(Yad,null),f.y1b,a.J.H(Zad,null),a.J.H(WK,null),a.J.H(BW,null),a.J.H(X2,null),g);sGd(k);C(D(lc(a.J.ma(KGd,null),rga)),function(){return k});a.J.H(rga,null);kc(a.J,ju).pb(function(a){a.ffa()});R(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-
h);j6(a.J.H(WK,null),12)}function NGd(a){var b=a.rg.jq("peoplewell");OGd(a,a.J.H(P$c,null),a.J.H(dd,null),a.J.H(OS,null),a.J.H(Dd,null),a.J.H(T,null),a.J.H(a3,null).eh);a.rg.lq(b)}GGd.registerClass("PowerPointWebEditor.PresenceUserInfoGetterProxy",null,P$c);HGd.registerClass("PowerpointPresence.CoauthoringTelemetryInfoProvider",null,Ac);IGd.registerClass("PowerpointPresence.PeopleInfoProvider",null,Nc);KGd.registerClass("PowerpointPresence.PowerPointPeoplesWell",FGd);
LGd.registerClass("PowerPointWebEditor.PeoplesWell.PPTWebEditorPeoplesWellPackage",null,yo,ec);var PGd=0,MGd=0,PGd=Date.now();if(L&&L.ia("IsSyncConfigPresenceEnabled")){var Dzc=new LGd;Dzc.wc(B());Dzc.ub()}else zo(gj(),new LGd,0,!1);
