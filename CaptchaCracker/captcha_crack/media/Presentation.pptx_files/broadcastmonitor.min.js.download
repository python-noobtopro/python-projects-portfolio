var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(a,b){($jscomp.patches[a]=$jscomp.patches[a]||[]).push(b);for(var d=$jscomp.global,e=a.split("."),h=0;h<e.length-1&&d;h++)d=d[e[h]];e=e[e.length-1];d&&d[e]instanceof Function&&(d[e]=b(d[e]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var a=[],b=function(b){return function(e){a=[];e=b(e);for(var h=[],k=0,F=e.length;k<F;k++){var z;a:if(z=e[k],z.length<$jscomp.SYMBOL_PREFIX.length)z=!1;else{for(var l=0;l<$jscomp.SYMBOL_PREFIX.length;l++)if(z[l]!=$jscomp.SYMBOL_PREFIX[l]){z=!1;break a}z=!0}z?a.push(e[k]):h.push(e[k])}return h}};$jscomp.patch("Object.keys",b);$jscomp.patch("Object.getOwnPropertyNames",b);$jscomp.patch("Object.getOwnPropertySymbols",
function(d){return function(e){b.unused=Object.getOwnPropertyNames(e);a.push.apply(d(e));return a}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+a+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
function getLogger(a,b){var d=new bUlsCache(a,b);return{ULS:{trace:function(a,h,k){return traceTagImpl(d,0,a,h,k)},traceTag:function(a,h,k,b){return traceTagImpl(d,a,h,k,b)},flush:d.flush,flushOnClose:d.flushOnClose}}}function getExperimentLogger(a,b,d,e){var h=new bUlsCache(a,b);return h.configure(d,e),{ULS:{trace:function(a,e,b){return traceTagImpl(h,0,a,e,b)},traceTag:function(a,e,b,d){return traceTagImpl(h,a,e,b,d)},flush:h.flush,flushOnClose:h.flushOnClose}}}
function traceTagImpl(a,b,d,e,h){e>currentLevel||(b={timestamp:Date.now(),category:d,tag:b,level:e,type:logType.Trace,message:h},a.handleTrace(b))}function formatForUpload(a,b,d,e){a=a.map(function(a){return getLogEntryInWireFormat(a,e)});b=getLogBatchInWireFormat(e,a,b,d);return JSON.stringify(b)}function getLogEntryInWireFormat(a,b){var d={},e;return d.G=a.tag,d.T=a.timestamp-b,d.M=a.message,d.C=a.category,e=a.type*shiftFactory+a.level,d.D=e,d}
function getLogBatchInWireFormat(a,b,d,e){var h={};return h.T=a,h.L=b,h.S=d,h.I=e,h.V=1,h}function uploadLogs(a,b,d){if(""!==b){var e=new XMLHttpRequest;e.readyState!==XMLHttpRequest.UNSENT&&e.readyState!==XMLHttpRequest.DONE||(e.open("POST",b,d),e.send(a))}}var logLevel,ULS,currentLevel,bUlsCache,shiftFactory,logCategory,logType,PowerPointOnline;(function(a){a[a.Spam=200]="Spam";a[a.Verbose=100]="Verbose";a[a.Info=50]="Info";a[a.Warning=15]="Warning";a[a.Error=10]="Error"})(logLevel||(logLevel={}));
ULS={getLogger:getLogger,getExperimentLogger:getExperimentLogger};currentLevel=logLevel.Info;
bUlsCache=function(){function a(a,d){var e=this;this.uploadCadenceInMsSec=3E4;this.uploadTriggerSize=30;this.uploadId=0;this.logCache=[];this.timestampBase=Date.now();this.userSessionId="00000000-0000-0000-0000-000000000000";this.flushOnClose=function(){e.triggerUpload(!1,!1)};this.flush=function(){e.triggerUploadAsync()};this.triggerUploadAsync=function(){window.setTimeout(function(){return e.triggerUpload(!0,!0)},0)};this.triggerUpload=function(a,k){if(window.clearTimeout(e.timeoutId),0<e.logCache.length){e.uploadId+=
1;var b=formatForUpload(e.logCache,e.userSessionId,e.uploadId,e.timestampBase);uploadLogs(b,e.remoteUrlEndpoint,k);e.logCache=[];e.timestampBase=Date.now()}a&&(e.timeoutId=window.setTimeout(e.triggerUploadAsync,e.uploadCadenceInMsSec))};this.userSessionId=a;this.remoteUrlEndpoint=d+"?usid="+a;window.setTimeout(function(){return e.triggerUpload(!0,!0)},0)}return a.prototype.configure=function(a,d){this.uploadCadenceInMsSec=a;this.uploadTriggerSize=d},a.prototype.handleTrace=function(b){b.message.length>
a.messageMaxChars&&(b.message=b.message.substr(0,a.messageMaxChars-a.trimedMessage.length)+a.trimedMessage);this.logCache.push(b);(this.logCache.length>this.uploadTriggerSize||b.level===logLevel.Error)&&this.triggerUploadAsync()},a.messageMaxChars=3072,a.trimedMessage="... [Trimmed]",a}();shiftFactory=1E3;
(function(a){a[a.WordViewer=301]="WordViewer";a[a.WopiPendingApplication=379]="WopiPendingApplication";a[a.VisioApp=700]="VisioApp";a[a.PptNavigation=810]="PptNavigation";a[a.PptSession=817]="PptSession";a[a.PptVersionHistory=832]="PptVersionHistory";a[a.PptLive=833]="PptLive"})(logCategory||(logCategory={}));(function(a){a[a.Trace=0]="Trace";a[a.Assert=1]="Assert"})(logType||(logType={}));
(function(a){(function(a){var d=function(){function a(){}return a.prototype.trace=function(a,k,e){this.traceTag(0,a,k,e)},a.prototype.traceTag=function(a,k,e,b){switch(e){case logLevel.Verbose:a=console.debug;break;case logLevel.Info:a=console.log;break;case logLevel.Warning:case logLevel.Error:a=console.error;break;default:a=console.error}a(b)},a}();a.ConsoleSessionLogger=d;d=function(){function a(e,k){try{this.logger=ULS.getLogger(e,k+"RemoteUls.ashx")}catch(b){}}return a.prototype.trace=function(a,
k,e){null!=this.logger&&this.logger.ULS.trace(a,k,e)},a.prototype.traceTag=function(a,k,e,b){null!=this.logger&&this.logger.ULS.traceTag(a,k,e,b)},a.prototype.flush=function(){null!=this.logger&&this.logger.ULS.flush()},a.prototype.flushOnClose=function(){null!=this.logger&&this.logger.ULS.flushOnClose()},a}();a.UlsSessionLogger=d;d=function(){function a(){}return a.init=function(a){this.logger=a},a.trace=function(a,k,b){null!=this.logger&&this.logger.trace(a,k,b)},a.traceTag=function(a,k,b,e){null!=
this.logger&&this.logger.traceTag(a,k,b,e)},a}();a.SessionLogger=d})(a.Telemetry||(a.Telemetry={}))})(PowerPointOnline||(PowerPointOnline={}));var __awaiter=this&&this.__awaiter||function(a,b,d,e){function h(a){return a instanceof d?a:new d(function(b){b(a)})}return new (d||(d=Promise))(function(k,d){function z(a){try{y(e.next(a))}catch(b){d(b)}}function l(a){try{y(e["throw"](a))}catch(b){d(b)}}function y(a){a.done?k(a.value):h(a.value).then(z,l)}y((e=e.apply(a,b||[])).next())})},SHA1=function(){};
SHA1.RotateLeft=function(a,b){return a<<b|a>>32-b};SHA1.ConvertHex=function(a){var b=[],d,e;for(d=7;0<=d;d--)e=a>>4*d&15,b.push(e.toString(16));return b.join("")};SHA1.Utf8Encode=function(a){a=a.replace("\r\n","\n");for(var b="",d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b+=String.fromCharCode(e):(127<e&&2048>e?b+=String.fromCharCode(e>>6|192):(b+=String.fromCharCode(e>>12|224),b+=String.fromCharCode(e>>6&63|128)),b+=String.fromCharCode(e&63|128))}return b};
SHA1.GenerateSHA1=function(a){var b,d,e=1732584193,h=4023233417,k=2562383102,F=271733878,z=3285377520,l,y,v,J,K=0,g=Array(80);a=SHA1.Utf8Encode(a);l=a.length;var c=[];for(b=0;b<l-3;b+=4)d=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),c.push(d);switch(l%4){case 0:K=2147483648;break;case 1:K=a.charCodeAt(l-1)<<24|8388608;break;case 2:K=a.charCodeAt(l-2)<<24|a.charCodeAt(l-1)<<16|32768;break;case 3:K=a.charCodeAt(l-3)<<24|a.charCodeAt(l-2)<<16|a.charCodeAt(l-1)<<8|
128}for(c.push(K);14!=c.length%16;)c.push(0);c.push(l>>29);c.push(l<<3&4294967295);for(a=0;a<c.length;a+=16){for(b=0;16>b;b++)g[b]=c[a+b];for(b=16;79>=b;b++)g[b]=SHA1.RotateLeft(g[b-3]^g[b-8]^g[b-14]^g[b-16],1);d=e;l=h;y=k;v=F;J=z;for(b=0;19>=b;b++)K=SHA1.RotateLeft(d,5)+(l&y|~l&v)+J+g[b]+1518500249&4294967295,J=v,v=y,y=SHA1.RotateLeft(l,30),l=d,d=K;for(b=20;39>=b;b++)K=SHA1.RotateLeft(d,5)+(l^y^v)+J+g[b]+1859775393&4294967295,J=v,v=y,y=SHA1.RotateLeft(l,30),l=d,d=K;for(b=40;59>=b;b++)K=SHA1.RotateLeft(d,
5)+(l&y|l&v|y&v)+J+g[b]+2400959708&4294967295,J=v,v=y,y=SHA1.RotateLeft(l,30),l=d,d=K;for(b=60;79>=b;b++)K=SHA1.RotateLeft(d,5)+(l^y^v)+J+g[b]+3395469782&4294967295,J=v,v=y,y=SHA1.RotateLeft(l,30),l=d,d=K;e=e+d&4294967295;h=h+l&4294967295;k=k+y&4294967295;F=F+v&4294967295;z=z+J&4294967295}return(SHA1.ConvertHex(e)+SHA1.ConvertHex(h)+SHA1.ConvertHex(k)+SHA1.ConvertHex(F)+SHA1.ConvertHex(z)).toLowerCase()};var UlsSessionLogger=PowerPointOnline.Telemetry.UlsSessionLogger,PowerPointLive;
(function(a){var b=function(){};a.StartLiveSessionResult=b;var d=function(){};a.RendezvousSessionInfo=d;a.RendezvousSessionConfig=function(){};var e=function(){this.sessionStartUtc=this.action=this.sessionId="";this.accessControl="Anyone";this.sessionExitPoint=this.sessionEntryPoint=this.transcriberSessionIds=this.rendezvousServiceEnvironment=this.hostAuthType=this.pragueDocId="";this.startAttemptCount=this.sessionDurationInMS=this.sessionActiveDurationInMS=0;this.documentDownloadUrlOnStartLiveFetchTimeInMS=
this.pragueInitCallTimeInMS=this.rendezvousSessionCreationTimeInMS=this.authTokenOnStartLiveFetchTimeInMS=this.sessionCreationWebServiceCallTimeInMS=-1;this.calloutShownCount=this.welcomeShownCount=this.sessionResumeCount=this.sessionPauseCount=this.maxParticipantCount=0;this.isSubtitleStartedByLive=!1;this.errorMessage=this.errorCode="";this.hasUnexpectedError=!1;this.welcomeScreenDurations=[];this.welcomeScreenFirstTimeDuration=0;this.sessionEndedBeforePragueInitialized=!1;this.stateServiceMetrics=
""};e.prototype.SetErrorCode=function(a,v){0==this.errorCode.length&&a!=l.ErrorNone&&(this.errorCode=l[a],this.errorMessage=void 0===v?"":v)};a.LiveSessionTelemetryData=e;var h=function(){this.liveBroadcaster=null;this.telemetryData=new e};h.prototype.SetLiveBroadcast=function(a){this.liveBroadcaster=a};h.prototype.SetStateServiceMetrics=function(){null!=this.liveBroadcaster&&(this.telemetryData.stateServiceMetrics=JSON.stringify(this.liveBroadcaster.getServiceTelemetry()))};a.LiveSessionTelemetry=
h;var k=function(){},F=function(){};a.SurveyInfo=F;var z=function(){};a.LiveReaction=z;(function(a){a[a.Disconnected=0]="Disconnected";a[a.Connected=1]="Connected";a[a.Connecting=2]="Connecting"})(a.ConnectionState||(a.ConnectionState={}));var l;(function(a){a[a.ErrorNone=0]="ErrorNone";a[a.ErrorFailedToFetchDocumentDownloadURL=1]="ErrorFailedToFetchDocumentDownloadURL";a[a.ErrorFailedToInitializePrague=2]="ErrorFailedToInitializePrague";a[a.ErrorDisconnectedToPrague=3]="ErrorDisconnectedToPrague";
a[a.ErrorFailedToStartLiveBroadcast=4]="ErrorFailedToStartLiveBroadcast";a[a.ErrorFailedToPauseLiveBroadcast=5]="ErrorFailedToPauseLiveBroadcast";a[a.ErrorFailedToResumeLiveBroadcast=6]="ErrorFailedToResumeLiveBroadcast";a[a.ErrorFailedToEndLiveBroadcast=7]="ErrorFailedToEndLiveBroadcast";a[a.ErrorFailedToFetchAuthToken=8]="ErrorFailedToFetchAuthToken";a[a.ErrorFailedToCreateRendezvousSession=9]="ErrorFailedToCreateRendezvousSession";a[a.ErrorFailedToPauseRendezvousSession=10]="ErrorFailedToPauseRendezvousSession";
a[a.ErrorFailedToResumeRendezvousSession=11]="ErrorFailedToResumeRendezvousSession";a[a.ErrorFailedToEndRendezvousSession=12]="ErrorFailedToEndRendezvousSession";a[a.ErrorFailedToCreateSurvey=13]="ErrorFailedToCreateSurvey";a[a.ErrorFailedToRefreshFileUrl=14]="ErrorFailedToRefreshFileUrl";a[a.ErrorFailedToTriggerSaveThumbnails=15]="ErrorFailedToTriggerSaveThumbnails";a[a.ErrorFailedToCollectShowInfoForAudienceFeedback=16]="ErrorFailedToCollectShowInfoForAudienceFeedback";a[a.ErrorFailedToTryTriggerAudienceFeedback=
17]="ErrorFailedToTryTriggerAudienceFeedback"})(l=a.ErrorCode||(a.ErrorCode={}));a.PPTBroadcastMonitorSettings=function(){this.delayInSecsToCloseBroadcasterOnPause=-1;this.documentSnapshotRequestUrlGenerator=null;this.enableTransientSessionHandling=!1};h=function(a){this.fileInfo=null;this.welcomeScreenState=!0;this.liveBroadcaster=null;this.participantsCount=0;this.connectionStateEventListener=this.newReactionEventListener=this.participantsCountChangeEventListener=null;this.sessionId="";this.logger=
null;this.documentDownloadUrlLastFetchTimeInMS=-1;this.telemetry=null;this.deferredBroadcasterClosingTimerId=0;this.correlationId="";this.presenterState=this.sessionState=this.sessionStarterAuthTokenPromise=null;this.settings=a;this.pragueSessionInfo=this.rendezvousSessionInfo=null};h.prototype.SetCurrentPosition=function(a,v,b){this.currentSlideState={location:{slideId:{sid:a,cid:0},slideIndex:v},timelineMappings:b?b.map(function(a){return{timelineId:a.TimeLineId,step:a.Step,sequenceId:""}}):null};
this.SetSlideState()};h.prototype.RegisterParticipantsCountChangeEventListener=function(a){null==this.participantsCountChangeEventListener?this.participantsCountChangeEventListener=a:this.traceTag(50455765,logCategory.PptLive,logLevel.Error,"Currently we only support single listener for participant count change event!")};h.prototype.RegisterNewReactionEventListener=function(a){null==this.newReactionEventListener?this.newReactionEventListener=a:this.traceTag(51406347,logCategory.PptLive,logLevel.Error,
"Currently we only support single listener for new reaction event!")};h.prototype.RegisterConnectionStateEventListener=function(a){null==this.connectionStateEventListener?this.connectionStateEventListener=a:this.traceTag(594416988,logCategory.PptLive,logLevel.Error,"Currently we only support single listener for connection state!")};h.prototype.SetDefaultSubtitlesLanguage=function(a){try{null!=this.liveBroadcaster&&(this.liveBroadcaster.defaultSubtitleLanguage=a)}catch(b){this.traceTag(595140928,logCategory.PptLive,
logLevel.Error,"Exception thrown in PPTBroadCastMonitor::SetDefaultSubtitlesLanguage: ",b.message)}};h.prototype.UpdateFinalSubtitles=function(a){try{if(this.isBroadcastSessionActive){var b=new Map;a.forEach(function(a){b.set(a.language,{subtitle:a.transript})});this.liveBroadcaster.finalSubtitles=b}else this.traceTag(50455769,logCategory.PptLive,logLevel.Error,"UpdateFinalSubtitles called while live session is inactive!")}catch(k){this.traceTag(50455770,logCategory.PptLive,logLevel.Error,"Exception thrown in UpdateFinalSubtitles: ",
k.message)}};h.prototype.UpdatePartialSubtitles=function(a){try{if(this.isBroadcastSessionActive){var b=new Map;a.forEach(function(a){b.set(a.language,a.transript)});this.liveBroadcaster.partialSubtitles=b}else this.traceTag(50455771,logCategory.PptLive,logLevel.Error,"UpdatePartialSubtitles called while live session is inactive!")}catch(k){this.traceTag(50455772,logCategory.PptLive,logLevel.Error,"Exception thrown in UpdatePartialSubtitles: ",k.message)}};h.prototype.FetchDocumentDownloadURL=function(a){return __awaiter(this,
void 0,void 0,function(){function b(c,f){for(;;)switch(k){case 0:e=g;try{var v=(new Date).getTime(),d=g.downloadRequestUrl==a;g.downloadRequestUrl=a;g.downloadUrlPromise=fetch(g.downloadRequestUrl).then(function(a){return __awaiter(e,void 0,void 0,function(){function c(k,e){for(;;)switch(f){case 0:if(a.ok){f=1;break}f=2;return{value:a.text(),done:!1};case 2:if(void 0===e){f=3;break}f=-1;throw e;case 3:throw b=y=k,g="Unavailable",null!=a.headers&&a.headers.has("X-CorrelationId")&&(g=a.headers.get("X-CorrelationId")),
f=-1,Error("Document download URL request failed with statusText: "+a.statusText+", statusCode: "+a.status+", responseText: "+b+", correlationId: "+g+" !");case 1:return f=-1,{value:a.json(),done:!0};default:return{value:void 0,done:!0}}}var f=0,g,b,y,k={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k})}).then(function(a){a=a.downloadUrl;
var c=e.documentDownloadUrl==a,f=e.CalculateUrlHash(a),g=(new Date).getTime()-v;e.documentDownloadUrlLastFetchTimeInMS=g;e.traceTag(50734992,logCategory.PptLive,logLevel.Info,"RefreshDocumentDownloadURL Info: isDownloadRequestUrlSame: "+d+" isDownloadUrlSame: "+c+" requestTime (in MS) :"+g+" urlHash: "+f);return a})["catch"](function(a){e.traceTag(50872784,logCategory.PptLive,logLevel.Error,"Error catched in document download Url request promise: ",a.toString());throw Error("Document download URL request failed with error of "+
a.toString()+"!");})}catch(h){g.traceTag(50455773,logCategory.PptLive,logLevel.Error,"Exception thrown in FetchDocumentDownloadURL: ",h.message)}k=-1;default:return{value:void 0,done:!0}}}var k=0,e,g=this,c={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c})};h.prototype.InitializePrague=function(){return __awaiter(this,void 0,void 0,
function(){function a(c,f){for(;;)switch(b){case 0:return g.liveBroadcaster=PPTLiveBroadcast.createPPTLiveBroadcast(),e={pragueDocID:g.pragueSessionInfo.pragueDocId,preferredSubtitleLanguage:g.settings.preferredSubtitleLanguage,isPresenter:!0,routerlicious:g.pragueSessionInfo.pragueRouterlicious,historian:g.pragueSessionInfo.pragueHistorian,tenant:g.pragueSessionInfo.pragueTenant,secret:g.pragueSessionInfo.pragueSecret,timeoutDurationInMs:g.settings.pragueInitTimeoutInMS,batchedRequestsEnabled:g.settings.batchedRequestsEnabled,
logger:new OfficeOnline.Telemetry.ProxyLogger(g.logger),websocketAliveTimeAfterLoseFocusInMS:g.settings.websocketAliveTimeAfterLoseFocusInMs,pingTimeoutInMs:g.settings.pingTimeoutInMs,pongTimeoutInMs:g.settings.pongTimeoutInMs,correlationId:g.correlationId,isAutomation:g.telemetry.telemetryData.isAutomation,maxRoundtripRaw:g.settings.maxStateServiceRoundtripRaw},k=Date.now(),b=1,{value:g.liveBroadcaster.init(e),done:!1};case 1:if(void 0===f){b=2;break}b=-1;throw f;case 2:g.telemetry.telemetryData.pragueInitCallTimeInMS=
Date.now()-k,g.telemetry.SetLiveBroadcast(g.liveBroadcaster),g.traceTag(50455774,logCategory.PptLive,logLevel.Info,"Prague initialized: ",{HashedDocid:g.pragueSessionInfo.pragueDocId,HashedRouterlicious:g.pragueSessionInfo.pragueRouterlicious,HashedHistorian:g.pragueSessionInfo.pragueHistorian,HashedPragueClientId:g.liveBroadcaster.clientId}),b=-1;default:return{value:void 0,done:!0}}}var b=0,k,e,g=this,c={next:function(c){return a(c,void 0)},"throw":function(c){return a(void 0,c)},"return":function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c})};h.prototype.RefreshDownloadUrlPromiseIfNeeded=function(){return __awaiter(this,void 0,void 0,function(){function a(f,y){for(;;)switch(b){case 0:if(null==c.settings.documentSnapshotRequestUrlGenerator){b=1;break}try{e=c.settings.documentSnapshotRequestUrlGenerator();if(!e||e===c.downloadRequestUrl){b=4;break}if(!c.downloadUrlPromise){b=5;break}b=6;return{value:c.downloadUrlPromise,done:!1}}catch(d){g=d;b=2;break}case 6:try{if(void 0===
y){b=7;break}b=-1;throw y;}catch(d){g=d;b=2;break}case 7:case 5:try{return c.traceTag(592310492,logCategory.PptLive,logLevel.Warning,"Refetching download url ..."),b=8,{value:c.FetchDocumentDownloadURL(e),done:!1}}catch(d){g=d;b=2;break}case 8:try{if(void 0===y){b=9;break}b=-1;throw y;}catch(d){g=d;b=2;break}case 9:case 4:try{b=3;break}catch(d){g=d;b=2;break}case 2:k=g,c.traceTag(592310491,logCategory.PptLive,logLevel.Error,"Exception threw when checking and refetching download url:",k.message);case 3:case 1:b=
-1;default:return{value:void 0,done:!0}}}var b=0,k,e,g,c=this,d={next:function(c){return a(c,void 0)},"throw":function(c){return a(void 0,c)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d})};h.prototype.SetupPrague=function(a){return __awaiter(this,void 0,void 0,function(){function b(f,d){for(;;)switch(k){case 0:return g=c,k=1,{value:c.RefreshDownloadUrlPromiseIfNeeded(),done:!1};case 1:if(void 0===d){k=
2;break}k=-1;throw d;case 2:return k=3,{value:c.downloadUrlPromise["catch"](function(a){g.traceTag(593281174,logCategory.PptLive,logLevel.Info,"Refetch document download url");g.FetchDocumentDownloadURL(g.settings.fileDownloadUrl);g.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on intializing Prague!");}),done:!1};case 3:if(void 0===d){k=4;break}k=-1;throw d;case 4:e=f,c.documentDownloadUrl=e,c.fileInfo.fileUrl=c.documentDownloadUrl,
c.liveBroadcaster.fileInfo=c.fileInfo,c.telemetry.telemetryData.documentDownloadUrlOnStartLiveFetchTimeInMS=c.documentDownloadUrlLastFetchTimeInMS,c.isBroadcastSessionActive=!0,c.SetSlideState(),c.settings.enableTransientSessionHandling?(c.SetSessionState("paused"!=c.sessionState?"active":c.sessionState),c.SetPresenterState(null!=c.presenterState?c.presenterState:"unmuted")):(c.SetSessionState("active"),c.SetPresenterState("unmuted")),c.SetWelcomeScreenState(!a&&c.welcomeScreenState),c.liveBroadcaster.on("activeParticipantCountChanged",
function(a){null!=g.participantsCountChangeEventListener&&(g.participantsCount=a,g.participantsCountChangeEventListener(g.participantsCount))}),c.liveBroadcaster.on("newReaction",function(a,c){if(null!=g.newReactionEventListener){var b=new z;b.react=a.react;a.slideId&&(b.slideId=a.slideId.sid);g.traceTag(51406348,logCategory.PptLive,logLevel.Info,"Received new reaction: ",{SlideId:b.slideId,HashedDocid:g.pragueSessionInfo.pragueDocId,HashedPragueClientId:g.liveBroadcaster.clientId});g.newReactionEventListener(b)}}),
c.liveBroadcaster.on("connectionStateChanged",function(a){null!=g.connectionStateEventListener&&g.connectionStateEventListener(a)}),k=-1;default:return{value:void 0,done:!0}}}var k=0,e,g,c=this,d={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d})};h.prototype.ClosePrague=function(a){if(null!==this.liveBroadcaster){this.traceTag(593037071,
logCategory.PptLive,logLevel.Info,"Closing Live broadcaster under context of "+a);try{this.liveBroadcaster.close()}catch(b){this.traceTag(593037070,logCategory.PptLive,logLevel.Warning,"Exception thrown when closing Live boradcaster ...",b.message)}this.liveBroadcaster=null}};h.prototype.GetPragueSessionInfoJSONString=function(){return null!=this.pragueSessionInfo?JSON.stringify(this.pragueSessionInfo):""};h.prototype.SetSlideState=function(){return __awaiter(this,void 0,void 0,function(){function a(g,
c){for(;;)switch(b){case 0:try{k.isBroadcastSessionActive&&(k.liveBroadcaster.navigationState={to:k.currentSlideState},k.traceTag(50455776,logCategory.PptLive,logLevel.Info,"Slide set to: "+k.liveBroadcaster.navigationState.to.location.slideId.sid))}catch(e){k.traceTag(50455778,logCategory.PptLive,logLevel.Error,"Exception thrown in SetSlideState: ",e.message)}b=-1;default:return{value:void 0,done:!0}}}var b=0,k=this,e={next:function(b){return a(b,void 0)},"throw":function(b){return a(void 0,b)},
"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e})};h.prototype.SetSessionState=function(a){try{this.sessionState=a,null==this.liveBroadcaster||this.settings.enableTransientSessionHandling&&!this.isBroadcastSessionActive||(this.liveBroadcaster.sessionState=a,this.traceTag(50455779,logCategory.PptLive,logLevel.Info,"Live Session state set to: "+a))}catch(b){this.traceTag(50455808,logCategory.PptLive,logLevel.Error,
"Exception thrown in SetSessionState: ",b.message)}};h.prototype.SetPresenterState=function(a){try{this.presenterState=a,null==this.liveBroadcaster||this.settings.enableTransientSessionHandling&&!this.isBroadcastSessionActive||(this.liveBroadcaster.presenterState=a,this.traceTag(592307297,logCategory.PptLive,logLevel.Info,"Live presenter state set to: "+a))}catch(b){this.traceTag(592307296,logCategory.PptLive,logLevel.Error,"Exception thrown in SetPresenterState: ",b.message)}};h.prototype.SetWelcomeScreenState=
function(a){try{this.welcomeScreenState=a,null!=this.liveBroadcaster&&this.isBroadcastSessionActive&&(this.liveBroadcaster.welcomeScreenState=a,this.traceTag(595191057,logCategory.PptLive,logLevel.Info,"Live welcome screen state set to: "+a))}catch(b){this.traceTag(595191056,logCategory.PptLive,logLevel.Error,"Exception thrown in SetWelcomeScreenState: ",b.message)}};h.prototype.SetCurrentPollInfoState=function(a,b){try{null!=this.liveBroadcaster&&this.isBroadcastSessionActive&&(this.liveBroadcaster.pollInfoState=
{pollId:a,slideId:b})}catch(k){this.traceTag(556619101,logCategory.PptLive,logLevel.Error,"Exception thrown in SetCurrentPollIdState: ",k.message)}};h.prototype.TriggerSurvey=function(a){try{this.isBroadcastSessionActive&&null!=this.liveBroadcaster?(this.liveBroadcaster.lastTriggeredSurveyInfo=a,this.traceTag(50858203,logCategory.PptLive,logLevel.Info,"Triggering survey")):this.traceTag(50858204,logCategory.PptLive,logLevel.Error,"TriggerSurvey called while live session is inactive!")}catch(b){this.traceTag(50858205,
logCategory.PptLive,logLevel.Error,"Exception thrown in TriggerSurvey: ",b.message)}};h.prototype.CreateSurvey=function(a,b,k,e){var g=this;return null==this.rendezvousSessionInfo?null:new Promise(function(c,d){return __awaiter(g,void 0,void 0,function(){function f(f,p){for(;;)switch(g){case 0:try{if(null!=a||null==x.sessionStarterAuthTokenPromise){g=3;break}g=4;return{value:x.sessionStarterAuthTokenPromise,done:!1}}catch(C){B=C;g=1;break}case 4:try{if(void 0===p){g=5;break}g=-1;throw p;}catch(C){B=
C;g=1;break}case 5:try{a=I=f}catch(C){B=C;g=1;break}case 3:try{g=2;break}catch(C){B=C;g=1;break}case 1:return r=B,x.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,r.toString()),x.traceTag(590189791,logCategory.PptLive,logLevel.Error,"Exception thrown in CreateSurvey: ",r.toString()),d(r),g=-1,{value:void 0,done:!0};case 2:try{return x.traceTag(51168927,logCategory.PptLive,logLevel.Info,"Creating survey form"),L=null==k?x.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=CreateSurvey&sessionid="+
x.rendezvousSessionInfo.sessionId+"&isusersurvey="+(null!=b)+"&cid="+x.correlationId:x.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=DuplicateSurvey&sessionid="+x.rendezvousSessionInfo.sessionId+"&templatepollid="+k+"&pollorderindex="+e+"&cid="+x.correlationId,m=new Headers,x.settings.isBlueChicken&&m.append("OriginType","Test"),null!=a&&m.append("Authorization","Bearer "+a),q=fetch(L,{method:"POST",mode:"cors",headers:m,body:null!=b?JSON.stringify(b):""}),g=8,{value:q,done:!1}}catch(C){B=
C;g=6;break}case 8:try{if(void 0===p){g=9;break}g=-1;throw p;}catch(C){B=C;g=6;break}case 9:try{u=w=f;if(1!=u.ok){g=10;break}x.traceTag(51168928,logCategory.PptLive,logLevel.Info,"Rendezvous CreateSurvey service call succeeded!");g=12;return{value:u.json(),done:!1}}catch(C){B=C;g=6;break}case 12:try{if(void 0===p){g=13;break}g=-1;throw p;}catch(C){B=C;g=6;break}case 13:try{E=S=f;D=new F;D.isUserSurvey=E.IsUserSurvey;D.surveyId=E.SurveyId;D.surveyResponseUrl=E.SurveyResponseUrl;c(D);g=11;break}catch(C){B=
C;g=6;break}case 10:try{t=u.headers&&u.headers.has("X-ErrorCode")?u.headers.get("X-ErrorCode"):"Unavailable",H=u.headers&&u.headers.has("X-FailureReason")?u.headers.get("X-FailureReason"):"Unavailable",x.traceTag(51168929,logCategory.PptLive,logLevel.Error,"Rendezvous CreateSurvey service call failed with status of "+u.status+", X-ErrorCode: "+t+", X-FailureReason: "+H),d(Error(t))}catch(C){B=C;g=6;break}case 11:try{g=7;break}catch(C){B=C;g=6;break}case 6:h=B,x.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToCreateSurvey,
h.toString()),x.traceTag(51168930,logCategory.PptLive,logLevel.Error,"Exception thrown in Rendezvous survey creation Promise!",h.toString()),d(h);case 7:g=-1;default:return{value:void 0,done:!0}}}var g=0,h,H,t,D,E,S,u,w,q,m,L,r,I,B,x=this,p={next:function(a){return f(a,void 0)},"throw":function(a){return f(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();p[Symbol.iterator]=function(){return this};return p})})};h.prototype.SetAudienceFeedbackInfo=function(a){try{this.liveBroadcaster&&
(this.liveBroadcaster.audienceFeedbackInfo=a)}catch(b){this.traceTag(595122207,logCategory.PptLive,logLevel.Error,"Exception thrown in SetAudienceFeedbackInfo.",b.message)}};h.prototype.CreateRendezvousSession=function(a,b){return __awaiter(this,void 0,void 0,function(){function k(J,H){for(;;)switch(e){case 0:return h=l.settings.rendezvousSvcBaseUri+"RendezvousHandler.ashx?action=CreateSession&accesscontrol="+a.accessControl+"&sessionid="+a.sessionId+"&cid="+l.correlationId,a.presenterTenantId&&(h=
h+"&tenantid="+a.presenterTenantId),f=new Headers,l.settings.isBlueChicken&&f.append("OriginType","Test"),null!=b&&f.append("Authorization","Bearer "+b),l.traceTag(50455809,logCategory.PptLive,logLevel.Info,"Creating a Live session",{AccessControl:a.accessControl}),d=new Date,c=d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate()+" "+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds(),e=1,{value:fetch(h,{method:"POST",mode:"cors",headers:f,body:JSON.stringify({Locale:a.locale,PresentationName:a.presentationName,
LocalCreationTime:c,PodsUrl:a.webServiceBase,UseStateService:l.settings.useStateService,SharedSessionSettings:l.settings.sharedSessionSettings})}),done:!1};case 1:if(void 0===H){e=2;break}e=-1;throw H;case 2:return g=J,e=-1,{value:g,done:!0};default:return{value:void 0,done:!0}}}var e=0,g,c,d,f,h,l=this,H={next:function(a){return k(a,void 0)},"throw":function(a){return k(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();H[Symbol.iterator]=function(){return this};
return H})};h.prototype.StartLiveBroadcasting=function(a,k,e){var d=this;null!=this.rendezvousSessionInfo&&(this.traceTag(50857108,logCategory.PptLive,logLevel.Warning,"Creating a new Live session while last end was not cleaned up/ended properly!"),this.rendezvousSessionInfo=null);void 0==this.downloadUrlPromise&&(null!=this.settings.documentSnapshotRequestUrlGenerator&&(this.settings.fileDownloadUrl=this.settings.documentSnapshotRequestUrlGenerator()),this.FetchDocumentDownloadURL(this.settings.fileDownloadUrl));
this.ClosePrague("StartLiveBroadcast");this.logger=new UlsSessionLogger(a.userSessionId,a.webServiceBase);this.telemetry=k;this.sessionId=a.sessionId;this.correlationId=a.correlationId;this.welcomeScreenState=!0;this.fileInfo={fileUrl:"",podsUrl:a.webServiceBase,bootstrapperUrl:a.bootstrapperUrl,applicationUrl:a.webServiceBase.replace("/pods","/p/PowerPointFrame.aspx?PowerPointView=ReadingView&<ui=UI_LLCC&><rs=DC_LLCC&><dchat=DISABLE_CHAT&><hid=HOST_SESSION_ID&><IsLicensedUser=BUSINESS_USER&><actnavid=ACTIVITY_NAVIGATION_ID&>"),
fileName:a.fileName,fileSize:a.fileSize,slideHeight:a.slideHeight,slideWidth:a.slideWidth,fileSource:a.fileSource};return new Promise(function(g,c){return __awaiter(d,void 0,void 0,function(){function k(Q,M){for(;;)switch(f){case 0:O=l.ErrorNone,N="",P=null,R=1;case 1:if(!(R<=G.settings.numMaxAttempts)){f=3;break}G.rendezvousSessionInfo=null;try{C=null;if(!a.presenterTenantId){f=6;break}G.traceTag(591955083,logCategory.PptLive,logLevel.Info,"Use presenter tenant Id and skip getting auth token");G.sessionStarterAuthTokenPromise=
a.authTokenFunc();f=7;break}catch(n){A=n;f=4;break}case 6:try{return F=Date.now(),f=10,{value:a.authTokenFunc(),done:!1}}catch(n){A=n;f=8;break}case 10:try{if(void 0===M){f=11;break}f=-1;throw M;}catch(n){A=n;f=8;break}case 11:try{C=z=Q;G.telemetry.telemetryData.authTokenOnStartLiveFetchTimeInMS=Date.now()-F;f=9;break}catch(n){A=n;f=8;break}case 8:try{p=A;O=l.ErrorFailedToFetchAuthToken;N=p.toString();P=Error("Failed to get auth token on creating Live session: "+N);G.traceTag(51479690,logCategory.PptLive,
logLevel.Error,"Exception thrown in getting auth token: "+N);f=2;break}catch(n){A=n;f=4;break}case 9:case 7:try{x=void 0}catch(n){A=n;f=4;break}try{return B=Date.now(),f=14,{value:G.CreateRendezvousSession(a,C),done:!1}}catch(n){A=n;f=12;break}case 14:try{if(void 0===M){f=15;break}f=-1;throw M;}catch(n){A=n;f=12;break}case 15:try{x=I=Q;G.telemetry.telemetryData.rendezvousSessionCreationTimeInMS=Date.now()-B;f=13;break}catch(n){A=n;f=12;break}case 12:try{r=A;L=G.settings.rendezvousSvcBaseUri.replace("http://",
"").replace("https://","");O=l.ErrorFailedToCreateRendezvousSession;N=r.message;P=r;G.traceTag(51479691,logCategory.PptLive,logLevel.Error,"Exception thrown in creating rendezvous session! Domain: "+L+", Online: "+navigator.onLine,r.message);f=2;break}catch(n){A=n;f=4;break}case 13:try{if(!x.ok){f=16;break}f=18;return{value:x.json(),done:!1}}catch(n){A=n;f=4;break}case 18:try{if(void 0===M){f=19;break}f=-1;throw M;}catch(n){A=n;f=4;break}case 19:try{if(q=m=Q,G.SetSessionInfo(q),G.traceTag(50455810,
logCategory.PptLive,logLevel.Info,"Rendezvous CreateSession service call succeeded!"),w=new b,w.sessionInfo=G.rendezvousSessionInfo,w.authToken=C,w.numAttempt=R,!e){f=20;break}}catch(n){A=n;f=4;break}try{return f=24,{value:G.InitializePrague(),done:!1}}catch(n){A=n;f=22;break}case 24:try{if(void 0===M){f=25;break}f=-1;throw M;}catch(n){A=n;f=22;break}case 25:try{f=23;break}catch(n){A=n;f=22;break}case 22:try{u=A;O=l.ErrorFailedToInitializePrague;N=u.message;P=u;G.traceTag(51479692,logCategory.PptLive,
logLevel.Error,"Exception thrown in initializing prague session!",u.message);f=2;break}catch(n){A=n;f=4;break}case 23:try{if(!a.showQRCodeAfterFetchingDocDownloadUrl){f=26;break}f=27;return{value:G.EnsureDocumentDownloadUrlForNewLiveSession(),done:!1}}catch(n){A=n;f=4;break}case 27:try{if(void 0===M){f=28;break}f=-1;throw M;}catch(n){A=n;f=4;break}case 28:try{E=S=Q;if(null==E){f=29;break}O=l.ErrorFailedToFetchDocumentDownloadURL;N=E.message;P=E;f=2;break}catch(n){A=n;f=4;break}case 29:case 26:try{try{G.SetupPrague(!1)}catch(n){G.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToInitializePrague,
n.message),G.traceTag(50455775,logCategory.PptLive,logLevel.Error,"Exception thrown in SetupPrague: ",n.message)}g(w);f=-1;return{value:void 0,done:!0}}catch(n){A=n;f=4;break}case 20:try{if(!a.showQRCodeAfterFetchingDocDownloadUrl){f=30;break}f=31;return{value:G.EnsureDocumentDownloadUrlForNewLiveSession(),done:!1}}catch(n){A=n;f=4;break}case 31:try{if(void 0===M){f=32;break}f=-1;throw M;}catch(n){A=n;f=4;break}case 32:try{t=K=Q;if(null==t){f=33;break}O=l.ErrorFailedToFetchDocumentDownloadURL;N=t.message;
P=t;f=2;break}catch(n){A=n;f=4;break}case 33:case 30:try{return g(w),f=-1,{value:void 0,done:!0}}catch(n){A=n;f=4;break}case 21:try{f=17;break}catch(n){A=n;f=4;break}case 16:try{v=x.headers?x.headers.get("X-ErrorCode"):"";h=x.headers?x.headers.get("X-FailureReason"):"";O=l.ErrorFailedToCreateRendezvousSession;N=v;G.traceTag(50455811,logCategory.PptLive,logLevel.Error,"Rendezvous CreateSession service call failed with status of "+x.status+", X-ErrorCode: "+v+", X-FailureReason: "+h);P=Error(x);f=2;
break}catch(n){A=n;f=4;break}case 17:try{f=5;break}catch(n){A=n;f=4;break}case 4:d=A,O=l.ErrorFailedToStartLiveBroadcast,N=d.message(),G.traceTag(50455812,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session creation Promise!",d.message),P=d;case 5:case 2:R+=1;f=1;break;case 3:G.telemetry.telemetryData.SetErrorCode(O,N),G.telemetry.telemetryData.startAttemptCount=R,c(P),f=-1;default:return{value:void 0,done:!0}}}var f=0,d,h,v,t,K,E,S,u,w,q,m,L,r,I,B,x,p,z,F,C,A,R,P,N,O,G=this,
T={next:function(a){return k(a,void 0)},"throw":function(a){return k(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();T[Symbol.iterator]=function(){return this};return T})})};h.prototype.InitializeStateService=function(){var a=this;return new Promise(function(b,k){return __awaiter(a,void 0,void 0,function(){function a(K,u){for(;;)switch(g){case 0:t=l.ErrorNone,y=null,h=1,d=D.telemetry.telemetryData.sessionId;case 1:if(!(h<=D.settings.numMaxAttempts)){g=
3;break}if(!D.telemetry.telemetryData.sessionEndedBeforePragueInitialized&&d==D.telemetry.telemetryData.sessionId){g=4;break}D.traceTag(591738527,logCategory.PptLive,logLevel.Warning,"Live session ended or not started yet. Cancelling StateService!");g=3;break;case 4:try{return g=7,{value:D.InitializePrague(),done:!1}}catch(w){f=w;g=5;break}case 7:try{if(void 0===u){g=8;break}g=-1;throw u;}catch(w){f=w;g=5;break}case 8:try{g=6;break}catch(w){f=w;g=5;break}case 5:e=f;t=l.ErrorFailedToInitializePrague;
y=e;D.traceTag(594330503,logCategory.PptLive,logLevel.Error,"Exception thrown in initializing prague session!",e.message);g=2;break;case 6:try{return g=11,{value:D.SetupPrague(!1),done:!1}}catch(w){f=w;g=9;break}case 11:try{if(void 0===u){g=12;break}g=-1;throw u;}catch(w){f=w;g=9;break}case 12:try{g=10;break}catch(w){f=w;g=9;break}case 9:c=f;t=l.ErrorFailedToInitializePrague;y=c;D.traceTag(594330502,logCategory.PptLive,logLevel.Error,"Exception thrown in SetupPrague: ",c.message);g=2;break;case 10:return b(!0),
g=-1,{value:void 0,done:!0};case 2:h+=1;g=1;break;case 3:D.telemetry.telemetryData.sessionEndedBeforePragueInitialized||d!=D.telemetry.telemetryData.sessionId||D.telemetry.telemetryData.SetErrorCode(t,null!=y?t.toString():""),D.telemetry.telemetryData.startAttemptCount=h,k(y),g=-1;default:return{value:void 0,done:!0}}}var g=0,c,e,f,d,h,y,t,D=this,E={next:function(b){return a(b,void 0)},"throw":function(b){return a(void 0,b)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();
E[Symbol.iterator]=function(){return this};return E})})};h.prototype.PauseLiveBroadcasting=function(a){var b=this;return null==this.rendezvousSessionInfo?null:new Promise(function(k,e){return __awaiter(b,void 0,void 0,function(){function b(g,r){for(;;)switch(c){case 0:w=q;try{z=null;if(E=q.rendezvousSessionInfo.presenterToken){c=3;break}c=4;return{value:a()["catch"](function(a){w.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on pausing Live session:"+
a.toString());}),done:!1}}catch(m){u=m;c=1;break}case 4:try{if(void 0===r){c=5;break}c=-1;throw r;}catch(m){u=m;c=1;break}case 5:try{z=D=g}catch(m){u=m;c=1;break}case 3:try{return q.traceTag(50455813,logCategory.PptLive,logLevel.Info,"Pausing current Live session"),q.SetSessionState("paused"),t=q.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=PauseSession&sessionid="+q.rendezvousSessionInfo.sessionId+"&cid="+q.correlationId,E&&(t+="&presentertoken="+E),H=new Headers,q.settings.isBlueChicken&&
H.append("OriginType","Test"),null!=z&&H.append("Authorization","Bearer "+z),v=fetch(t,{method:"POST",mode:"cors",headers:H}),c=6,{value:v,done:!1}}catch(m){u=m;c=1;break}case 6:try{if(void 0===r){c=7;break}c=-1;throw r;}catch(m){u=m;c=1;break}case 7:try{f=h=g;1==f.ok&&204==f.status?(q.traceTag(50602783,logCategory.PptLive,logLevel.Info,"Rendezvous PauseSession service call succeeded!"),k(f),0<=q.settings.delayInSecsToCloseBroadcasterOnPause&&(q.deferredBroadcasterClosingTimerId=window.setTimeout(function(){w.ClosePrague("LongPauseLiveBroadcast");
w.deferredBroadcasterClosingTimerId=0},1E3*q.settings.delayInSecsToCloseBroadcasterOnPause))):(q.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToPauseRendezvousSession,"Rendezvous PauseSession service call failed with statusCode: "+f.status+" and statusText: "+f.statusText),q.traceTag(50602784,logCategory.PptLive,logLevel.Error,"Rendezvous PauseSession service call failed with status of "+f.status),e(f));c=2;break}catch(m){u=m;c=1;break}case 1:d=u,q.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToPauseLiveBroadcast,
d.message),q.traceTag(50729373,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session pause Promise!",d.message),e(d);case 2:c=-1;default:return{value:void 0,done:!0}}}var c=0,d,f,h,v,H,t,D,E,z,u,w,q=this,m={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();m[Symbol.iterator]=function(){return this};return m})})};h.prototype.ResumeLiveBroadcasting=function(a){var b=
this;return null==this.rendezvousSessionInfo?null:new Promise(function(k,e){return __awaiter(b,void 0,void 0,function(){function b(g,x){for(;;)switch(c){case 0:L=r;try{q=null;if(w=r.rendezvousSessionInfo.presenterToken){c=3;break}c=4;return{value:a()["catch"](function(a){L.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on resuming Live session: "+a.toString());}),done:!1}}catch(p){m=p;c=1;break}case 4:try{if(void 0===x){c=5;break}c=
-1;throw x;}catch(p){m=p;c=1;break}case 5:try{q=u=g}catch(p){m=p;c=1;break}case 3:try{r.traceTag(50455814,logCategory.PptLive,logLevel.Info,"Resuming paused Live session");0!=r.deferredBroadcasterClosingTimerId&&(window.clearTimeout(r.deferredBroadcasterClosingTimerId),r.deferredBroadcasterClosingTimerId=0);if(null!=r.liveBroadcaster){c=6;break}r.traceTag(594554962,logCategory.PptLive,logLevel.Info,"Re-initializing Prague for session resuming ...");F=0}catch(p){m=p;c=1;break}case 7:try{if(!(F<r.settings.numMaxAttempts)){c=
9;break}}catch(p){m=p;c=1;break}try{return c=12,{value:r.InitializePrague(),done:!1}}catch(p){m=p;c=10;break}case 12:try{if(void 0===x){c=13;break}c=-1;throw x;}catch(p){m=p;c=10;break}case 13:try{c=9;break}catch(p){m=p;c=10;break}case 10:try{z=m;r.traceTag(594554961,logCategory.PptLive,logLevel.Error,"Exception thrown when re-initializing prague session!",z.message);if(F+1!=r.settings.numMaxAttempts){c=14;break}r.traceTag(594554960,logCategory.PptLive,logLevel.Error,"Failed to re-initializing Prague after maxium attempts!");
c=-1;throw z;}catch(p){m=p;c=1;break}case 14:try{c=8;break}catch(p){m=p;c=1;break}case 11:case 8:try{F++;c=7;break}catch(p){m=p;c=1;break}case 9:try{return r.traceTag(594554959,logCategory.PptLive,logLevel.Info,"Setup Prague for session resuming ..."),c=15,{value:r.SetupPrague(!0),done:!1}}catch(p){m=p;c=1;break}case 15:try{if(void 0===x){c=16;break}c=-1;throw x;}catch(p){m=p;c=1;break}case 16:case 6:try{return r.SetSessionState("active"),r.SetWelcomeScreenState(!1),r.participantsCountChangeEventListener&&
r.participantsCountChangeEventListener(r.participantsCount),D=r.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=ResumeSession&sessionid="+r.rendezvousSessionInfo.sessionId+"&cid="+r.correlationId,w&&(D+="&presentertoken="+w),t=new Headers,r.settings.isBlueChicken&&t.append("OriginType","Test"),null!=q&&t.append("Authorization","Bearer "+q),H=fetch(D,{method:"POST",mode:"cors",headers:t}),c=17,{value:H,done:!1}}catch(p){m=p;c=1;break}case 17:try{if(void 0===x){c=18;break}c=-1;throw x;}catch(p){m=
p;c=1;break}case 18:try{h=v=g;if(1!=h.ok||204!=h.status){c=19;break}c=21;return{value:r.RefreshDownloadUrlPromiseIfNeeded(),done:!1}}catch(p){m=p;c=1;break}case 21:try{if(void 0===x){c=22;break}c=-1;throw x;}catch(p){m=p;c=1;break}case 22:try{return c=23,{value:r.downloadUrlPromise["catch"](function(a){L.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on resuming session!");}),done:!1}}catch(p){m=p;c=1;break}case 23:try{if(void 0===
x){c=24;break}c=-1;throw x;}catch(p){m=p;c=1;break}case 24:try{f=g;r.documentDownloadUrl=f;r.fileInfo.fileUrl=r.documentDownloadUrl;r.liveBroadcaster.fileInfo=Object.assign({},r.fileInfo);r.traceTag(50602785,logCategory.PptLive,logLevel.Info,"Rendezvous ResumeSession service call succeeded!");k(h);c=20;break}catch(p){m=p;c=1;break}case 19:try{r.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToResumeRendezvousSession,"Rendezvous ResumeSession service call failed with statusCode: "+h.status+" and statusText: "+
h.statusText),r.traceTag(50602786,logCategory.PptLive,logLevel.Error,"Rendezvous ResumeSession service call failed with status of "+h.status),e(h)}catch(p){m=p;c=1;break}case 20:try{c=2;break}catch(p){m=p;c=1;break}case 1:d=m,r.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToResumeLiveBroadcast,d.toString()),r.traceTag(50729374,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session resume Promise!",d.toString()),e(d);case 2:c=-1;default:return{value:void 0,done:!0}}}var c=
0,d,f,h,v,H,t,D,z,F,u,w,q,m,L,r=this,I={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();I[Symbol.iterator]=function(){return this};return I})})};h.prototype.EndLiveBroadcasting=function(a){var b=this;return new Promise(function(k,e){return __awaiter(b,void 0,void 0,function(){function b(g,m){for(;;)switch(c){case 0:w=q;if(null==q.rendezvousSessionInfo){c=1;break}try{q.traceTag(50455815,
logCategory.PptLive,logLevel.Info,"Ending current Live session!");F=q.rendezvousSessionInfo.presenterToken;E=q.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=EndSession&sessionid="+q.rendezvousSessionInfo.sessionId+"&cid="+q.correlationId;F&&(E+="&presentertoken="+F);q.settings.enableTransientSessionHandling&&(q.telemetry.telemetryData.sessionEndedBeforePragueInitialized=null==q.liveBroadcaster||!q.isBroadcastSessionActive);q.CleanUpBroadcastBeforeEnd();z=new Headers;q.settings.isBlueChicken&&
z.append("OriginType","Test");if(F){c=4;break}c=5;return{value:a()["catch"](function(a){w.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on ending Live session: "+a.toString());}),done:!1}}catch(I){u=I;c=2;break}case 5:try{if(void 0===m){c=6;break}c=-1;throw m;}catch(I){u=I;c=2;break}case 6:try{H=t=g,null!=H&&z.append("Authorization","Bearer "+H)}catch(I){u=I;c=2;break}case 4:try{return v=fetch(E,{method:"POST",mode:"cors",headers:z}),
c=7,{value:v,done:!1}}catch(I){u=I;c=2;break}case 7:try{if(void 0===m){c=8;break}c=-1;throw m;}catch(I){u=I;c=2;break}case 8:try{f=h=g;1==f.ok&&204==f.status?(q.traceTag(50455816,logCategory.PptLive,logLevel.Info,"Rendezvous EndSession service call succeeded!"),k(f)):(q.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToEndRendezvousSession,"Rendezvous EndSession service call failed with statusCode: "+f.status+" and statusText: "+f.statusText),q.traceTag(50455817,logCategory.PptLive,logLevel.Error,
"Rendezvous EndSession service call failed with status of "+f.status),e(f));0!=q.deferredBroadcasterClosingTimerId&&(window.clearTimeout(q.deferredBroadcasterClosingTimerId),q.deferredBroadcasterClosingTimerId=0);q.ClosePrague("EndLiveBroadcast");c=3;break}catch(I){u=I;c=2;break}case 2:d=u,q.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToEndLiveBroadcast,d.toString()),q.traceTag(50729375,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session end Promise!",d.toString()),e(d);
case 3:case 1:c=-1;default:return{value:void 0,done:!0}}}var c=0,d,f,h,v,H,t,z,E,F,u,w,q=this,m={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();m[Symbol.iterator]=function(){return this};return m})})};h.prototype.CleanUpBroadcastBeforeEnd=function(){this.SetSessionState("stopped");this.rendezvousSessionInfo=this.pragueSessionInfo=null;this.isBroadcastSessionActive=!1;this.participantsCount=
0;this.welcomeScreenState=!0;this.sessionId=""};h.prototype.OnPodSessionUpdated=function(a){return __awaiter(this,void 0,void 0,function(){function b(h,v){for(;;)switch(k){case 0:d=f;try{if(!f.downloadUrlPromise){k=5;break}k=6;return{value:f.downloadUrlPromise,done:!1}}catch(t){c=t;k=3;break}case 6:try{if(void 0===v){k=7;break}k=-1;throw v;}catch(t){c=t;k=3;break}case 7:case 5:try{k=4;break}catch(t){c=t;k=3;break}case 3:try{f.traceTag(594117345,logCategory.PptLive,logLevel.Info,"Session updated while old download request was not finished. Now fetching new download url...")}catch(t){c=
t;k=1;break}case 4:try{return k=8,{value:f.FetchDocumentDownloadURL(a),done:!1}}catch(t){c=t;k=1;break}case 8:try{if(void 0===v){k=9;break}k=-1;throw v;}catch(t){c=t;k=1;break}case 9:try{return k=10,{value:f.downloadUrlPromise["catch"](function(a){d.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on handing pods session updateing!");}),done:!1}}catch(t){c=t;k=1;break}case 10:try{if(void 0===v){k=11;break}k=-1;throw v;
}catch(t){c=t;k=1;break}case 11:try{g=h;f.documentDownloadUrl=g;f.fileInfo.fileUrl=f.documentDownloadUrl;null!=f.liveBroadcaster&&(f.liveBroadcaster.fileInfo=Object.assign({},f.fileInfo));k=2;break}catch(t){c=t;k=1;break}case 1:e=c,f.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToRefreshFileUrl,e.toString()),f.traceTag(51423305,logCategory.PptLive,logLevel.Error,"Exception thrown in OnPodSessionUpdated!",e.toString());case 2:k=-1;default:return{value:void 0,done:!0}}}var k=0,e,g,c,d,f=this,h=
{next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h})};h.prototype.TriggerSaveThumbnails=function(a,b){var k=this;return new Promise(function(e,g){return __awaiter(k,void 0,void 0,function(){function k(c,I){for(;;)switch(d){case 0:q=m;if(null==m.rendezvousSessionInfo){d=1;break}try{m.traceTag(595121313,logCategory.PptLive,logLevel.Info,
"Trigger save thumbnails request");u=m.rendezvousSessionInfo.presenterToken;J=m.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=SaveThumbnails&sessionid="+m.rendezvousSessionInfo.sessionId+"&fileUrl="+encodeURIComponent(m.fileInfo.fileUrl)+"&slideId="+b+"&cid="+m.correlationId;u&&(J+="&presentertoken="+u);E=new Headers;m.settings.isBlueChicken&&E.append("OriginType","Test");if(u){d=4;break}d=5;return{value:a()["catch"](function(a){q.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,
a.toString());throw Error("Failed to get auth token on trigger save thumbnails: "+a.toString());}),done:!1}}catch(B){w=B;d=2;break}case 5:try{if(void 0===I){d=6;break}d=-1;throw I;}catch(B){w=B;d=2;break}case 6:try{t=F=c,null!=t&&E.append("Authorization","Bearer "+t)}catch(B){w=B;d=2;break}case 4:try{return H=fetch(J,{method:"POST",mode:"cors",headers:E}),d=7,{value:H,done:!1}}catch(B){w=B;d=2;break}case 7:try{if(void 0===I){d=8;break}d=-1;throw I;}catch(B){w=B;d=2;break}case 8:try{h=z=c;1==h.ok?
(m.traceTag(595121312,logCategory.PptLive,logLevel.Info,"Rendezvous SaveThumbnails service call succeeded!"),e(h)):(m.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToTriggerSaveThumbnails,"Rendezvous SaveThumbnails service call failed with statusCode: "+h.status+" and statusText: "+h.statusText),m.traceTag(595121311,logCategory.PptLive,logLevel.Error,"Rendezvous SaveThumbnails service call failed with status of "+h.status),g(h));d=3;break}catch(B){w=B;d=2;break}case 2:f=w,m.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToTriggerSaveThumbnails,
f.toString()),m.traceTag(595121310,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous save thumbnails Promise!",f.toString()),g(f);case 3:case 1:d=-1;default:return{value:void 0,done:!0}}}var d=0,f,h,z,H,t,F,E,J,u,w,q,m=this,L={next:function(a){return k(a,void 0)},"throw":function(a){return k(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();L[Symbol.iterator]=function(){return this};return L})})};h.prototype.EnsureDocumentDownloadUrlForNewLiveSession=
function(){return __awaiter(this,void 0,void 0,function(){function a(f,l){for(;;)switch(b){case 0:c=null;try{return b=3,{value:h.downloadUrlPromise,done:!1}}catch(y){e=y;b=1;break}case 3:try{if(void 0===l){b=4;break}b=-1;throw l;}catch(y){e=y;b=1;break}case 4:try{d=f;h.documentDownloadUrl=d;b=2;break}catch(y){e=y;b=1;break}case 1:k=e,h.traceTag(592042071,logCategory.PptLive,logLevel.Error,"Exception thrown when fetching document download url!",k.message),c=k,null!=h.settings.documentSnapshotRequestUrlGenerator&&
(h.settings.fileDownloadUrl=h.settings.documentSnapshotRequestUrlGenerator()),h.FetchDocumentDownloadURL(h.settings.fileDownloadUrl);case 2:return b=-1,{value:c,done:!0};default:return{value:void 0,done:!0}}}var b=0,k,d,e,c,h=this,f={next:function(b){return a(b,void 0)},"throw":function(b){return a(void 0,b)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f})};h.prototype.SetSessionInfo=function(a){this.rendezvousSessionInfo=
new d;this.sessionId!=a.SessionId&&this.traceTag(594392212,logCategory.PptLive,logLevel.Error,"Rendezvous created new SessionId:"+a.SessionId);this.rendezvousSessionInfo.sessionId=this.sessionId;this.rendezvousSessionInfo.participantUrl=a.ParticipantUrl;this.rendezvousSessionInfo.shortParticipantUrl=a.ShortParticipantUrl;if(void 0==this.rendezvousSessionInfo.shortParticipantUrl||null==this.rendezvousSessionInfo.shortParticipantUrl)this.rendezvousSessionInfo.shortParticipantUrl=this.rendezvousSessionInfo.participantUrl;
this.rendezvousSessionInfo.sessionQRCode=a.QRCode;this.rendezvousSessionInfo.pragueDocId=a.PragueDocId;this.rendezvousSessionInfo.presenterToken=a.PresenterToken;this.rendezvousSessionInfo.rendezvousEndpoint=a.RendezvousEndpoint;this.pragueSessionInfo=new k;this.pragueSessionInfo.pragueDocId=a.PragueDocId;this.pragueSessionInfo.pragueRouterlicious=a.PragueRouterlicious;this.pragueSessionInfo.pragueHistorian=a.PragueHistorian;this.pragueSessionInfo.pragueTenant=a.PragueTenant;this.pragueSessionInfo.pragueSecret=
a.PragueSecret;this.pragueSessionInfo.broadcastSubtitlesInFD=this.settings.broadcastSubtitlesFromSpeechFrontDoor};h.prototype.getRendezvousEndpoint=function(){return this.rendezvousSessionInfo&&this.rendezvousSessionInfo.rendezvousEndpoint&&0<this.rendezvousSessionInfo.rendezvousEndpoint.length?this.rendezvousSessionInfo.rendezvousEndpoint:this.settings.rendezvousSvcBaseUri};h.prototype.traceTag=function(a,b,k,d,e){null!=this.logger&&(d={LiveSessionId:this.sessionId,Message:d},void 0!=e&&(d.Details=
e),this.logger.traceTag(a,b,k,JSON.stringify(d)))};h.prototype.CalculateUrlHash=function(a){for(var b=0,k=0;k<a.length;k++)b=(b<<5)-b+a.charCodeAt(k),b&=b;return b};a.PPTBroadcastMonitor=h})(PowerPointLive||(PowerPointLive={}));var OfficeOnline;
(function(a){(function(a){var d;(function(a){a[a.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS";a[a.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid";a[a.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart";a[a.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer";a[a.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral";a[a.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane";a[a.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral";a[a.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon";
a[a.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication";a[a.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";a[a.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities";a[a.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation";a[a.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync";a[a.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp";a[a.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache";a[a.msoulscat_Wac_PptAnimation=
800]="msoulscat_Wac_PptAnimation";a[a.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive";a[a.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb";a[a.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape";a[a.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession";a[a.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow";a[a.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory";a[a.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence";a[a.msoulscat_Wac_WordVersionHistory=3005]=
"msoulscat_Wac_WordVersionHistory";a[a.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard";a[a.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"})(d||(d={}));var e;(function(a){a[a.Error=10]="Error";a[a.Warning=15]="Warning";a[a.Info=50]="Info";a[a.Verbose=100]="Verbose";a[a.Spam=200]="Spam"})(e||(e={}));var h=function(a){this.m_logger=a};h.prototype.sendTraceTag=function(a,b,d,e){null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),
this.CovertToPowerPointOnlineTelemetryLogLevel(d),e)};h.prototype.shipAssertTag=function(a,b,d,e){d&&null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),logLevel.Error,e)};h.prototype.debugAssertTag=function(a,b,d,e){d&&null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),logLevel.Warning,e)};h.prototype.CovertToPowerPointOnlineTelemetryLogCategory=function(a){switch(a){case d.msoulscat_Wac_WordViewer:return logCategory.WordViewer;
case d.msoulscat_Wac_WopiPendingApplication:return logCategory.WopiPendingApplication;case d.msoulscat_Wac_VisioApp:return logCategory.VisioApp;case d.msoulscat_Wac_PptSession:return logCategory.PptSession;case d.msoulscat_Wac_PptLive:return logCategory.PptLive;default:return logCategory.PptSession}};h.prototype.CovertToPowerPointOnlineTelemetryLogLevel=function(a){switch(a){case e.Spam:return logLevel.Spam;case e.Verbose:return logLevel.Verbose;case e.Info:return logLevel.Info;case e.Warning:return logLevel.Warning;
case e.Error:return logLevel.Error}};a.ProxyLogger=h})(a.Telemetry||(a.Telemetry={}))})(OfficeOnline||(OfficeOnline={}));
