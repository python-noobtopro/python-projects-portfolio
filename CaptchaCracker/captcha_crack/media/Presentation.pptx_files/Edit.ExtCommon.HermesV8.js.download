function PV(a,b,c){an(a,b)&&(a.style[b]=c)}function oW(a){var b=window.parseInt(a);return!a||window.isNaN(b)?0:b}Type.registerNamespace("Common.App.CollabControls");w=window.Common||{};w.Ca=w.Ca||{};w.Ca.XEa=w.Ca.XEa||{};function kEd(){}kEd.registerInterface("Common.App.CollabControls.IPresenceTooltipControl");function lEd(){}lEd.registerInterface("Common.App.CollabControls.IPresenceTooltipFactory");w.Ca.XEa.Yab=function(){};
w.Ca.XEa.Yab.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18,ignoreEventOnExpandedTooltip:19,ipWidthAdjustForFlyout:20};
w.Ca.XEa.Yab.registerEnum("Common.App.CollabControls.PresenceTooltipSettingKeys",!1);function a6(a){this.mZ=Function.createDelegate(this,this.Npg);this.dispose=this.ha;a6.initializeBase(this);this._element=a}
a6.prototype={_element:null,lh:function(){return this._element},rj:function(){return"visible"===this._element.style.visibility},hf:function(a){this._element.style.visibility=a?"visible":"hidden";return a},CCa:function(a){return this._element.style.zIndex=a},ha:function(){this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null;re.prototype.ha.call(this)},Qi:function(a){return this._element.ownerDocument.createElement(a)},Npg:function(){return!0}};
function mEd(a,b){a._element.dir=b?"rtl":"ltr"}function b6(a,b){b6.initializeBase(this);this.qh=a;this.KEc=b}b6.prototype={qh:0,KEc:null};
function nEd(a,b,c){this.tra=Function.createDelegate(this,this.BGa);this.J4a=Function.createDelegate(this,this.q6f);this.Bm=[];this.dispose=this.ha;nEd.initializeBase(this,[a]);this.Keb={};this.Zd=c;this.Am=c.In(Boolean,8,!1);this.gcd=c.In(Boolean,15,!1);this.C5a=c.In(Number,12,0);this.Mra=c.In(Number,6,0);this.iLb=b;this.dmd=c.In(Function,16,null);this.uGb=c.In(Boolean,17,!1);this.ZGe=c.In(Boolean,19,!1);this.$Uc=c.In(Boolean,20,!1);this.jIb=0;this.uAe=new oEd(this.Am,this.uGb);this.Mcb=this.Am?
3:4;this.Ikc=!1;this.Kma=[];this.Neb=[];this._element.id=String.format("{0}-{1}","presencetooltip",pEd++);this._element.className="prControl"+(this.Am?"Rtl":"");this.C5a&&this.CCa(this.C5a);mEd(this,this.Am);this.H3c(b);this.pna=this.Qi("div");this.pna.className="prFlyoutContainer";this._element.appendChild(this.pna);this.SM=[];this.Wwa=new qEd(this.SM,this._element,this.Mra,4,6,32,this.Am);this.Ut=c.In(zd,9,null);this.Ut.Wa("msospPointerDown",this.Wwa.Jk,this.J4a);this.Ut.Wa("msospPointerOver",this.Wwa.Jk,
this.J4a);this.Ut.Wa("msospPointerOut",this.Wwa.Jk,this.J4a)}
nEd.prototype={Am:!1,Lwa:!1,fue:!1,yna:!1,iLb:0,jIb:0,ygb:!1,gcd:!1,uGb:!1,ZGe:!1,$Uc:!1,Ikc:!1,Keb:null,pna:null,Wwa:null,Kma:null,Neb:null,uAe:null,Mcb:0,Ut:null,Zd:null,dmd:null,TNb:function(){return uf(this.Bm)},SM:null,C5a:0,Mra:0,oLa:function(a){this.Ka("InteractivityChanged",a)},ha:function(){if(3!==c6(this)||this.Lwa){if(this.SM)for(var a=this.SM,b=a.length,c=0;c<b;++c){var d=a[c];d.azc(this.tra);vc(d)}this.SM=null;this.Ut.Sb("msospPointerDown",this.Wwa.Jk,this.J4a);this.Ut.Sb("msospPointerOver",
this.Wwa.Jk,this.J4a);this.Ut.Sb("msospPointerOut",this.Wwa.Jk,this.J4a);a6.prototype.ha.call(this)}else this.Ikc=!0},EHa:function(){d6(this,!1);this.hf(!0)},Pbb:function(){this.hf(!0);rEd(this);this.Lwa=!0},Cd:function(){sEd(this,5);this.VFa();this.Wwa.jx(c6(this),this.ygb)},zP:function(a){var b=c6(this),c=this.Lwa;a.eh||(a.eh=(pEd++).toString());var d;if(a.eh in this.Keb&&(d=this.xFa(a.eh),0<=d)){d=this.Bm[d];if(d.Zz===a.Zz&&d.ku===a.ku)return;this.V_(a.eh)}this.Cd();d=new tEd(this.Qi("div"),this.Zd);
d.oLa(this.tra);this.pna.insertBefore(d._element,this.pna.firstChild);this.Keb[a.eh]=d;Array.add(this.Bm,a);Array.add(this.SM,d);uEd(this,b,c);this.hf(!0)},V_:function(a){if(3!==c6(this)||this.Lwa){var b=c6(this),c=this.Lwa;this.Cd();this.DBb(a);uEd(this,b,c)}else Array.add(this.Neb,a)},ACb:function(a,b){if(b)a:if(-1===this.xFa(a))u(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Kma,a)){if(this.Bm[0].eh===a)break a;Array.remove(this.Kma,a)}Array.add(this.Kma,
a);vEd(this,a);1!==c6(this)&&d6(this,!1)}else wEd(this,a)},VFa:function(){var a=0,b=0;this.ygb&&(a=this.Mcb,b=-6);for(var c=0;c<e6(this);c++)this.SM[c].Cd(this.Bm[c],b,a);this.CCa(this.C5a);this.Lwa=!1;this.hf(!1);this.Ikc&&this.ha()},BGa:function(a,b){a=c6(this);if(!xzc()&&(2===b.qh||4===b.qh&&3!==a))this.yna&&(this.yna=!1),3!==a&&(rEd(this),3===b.KEc.ye&&xEd(this,2E3));else if(4===b.qh&&3===a)this.yna&&(this.yna=!1),xEd(this,0);else if(3===b.qh&&3===a&&!this.Lwa)if(1<e6(this)){this.yna=!0;var c=
this;nac(250).CW(function(){d6(c,!0);c.yna=!1})}else xEd(this,0);this.Ha("InteractivityChanged",b,null)},q6f:function(a){3===a.ye?this.BGa(this,new b6(4,a)):"msospPointerOver"===a.Om?this.BGa(this,new b6(2,a)):"msospPointerOut"===a.Om&&this.BGa(this,new b6(3,a));return!1},H3c:function(a){this._element.style.width=a+"px";this._element.style.height=this.Mra+"px"},DBb:function(a){wEd(this,a);a=this.xFa(a);if(!(0>a)){var b=this.Bm[a];Array.removeAt(this.Bm,a);delete this.Keb[b.eh];b=this.SM[a];this.pna.removeChild(b._element);
this.Zd.In(Boolean,18,!1)&&b.azc(this.tra);Array.removeAt(this.SM,a);b.ha()}},xFa:function(a){for(var b=0;b<this.Bm.length;b++)if(this.Bm[b].eh===a)return b;return-1},J2c:function(a){for(var b=0;b<e6(this);b++)this.SM[b].J2c(a)}};function yEd(a,b){b?Sys.UI.DomElement.addCssClass(a.pna,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(a.pna,"prBackgroundSelection")}
function wEd(a,b){-1===a.xFa(b)?u(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(a.Kma,b)&&(Array.remove(a.Kma,b),a.Bm[0].eh===b&&0<a.Kma.length&&vEd(a,a.Kma[a.Kma.length-1]),a.Bm[0].eh===b&&1===c6(a)&&d6(a,!1))}function sEd(a,b){if(a.Neb.length){a.rj()&&a.VFa();for(var c=0;c<a.Neb.length;c++)a.DBb(a.Neb[c]);Array.clear(a.Neb);0>=a.Bm.length||5===b?a.Cd():b||a.EHa()}}
function xzc(){if(G()&&G().rb().oza()&&Bm()){var a=window.appChrome.selectors.getShyState();return a.isActive&&!!a.state}return!1}function xEd(a,b){b?(a.yna=!0,nac(b).CW(function(){a.gcd?a.yna&&a.Cd():d6(a,!0);a.yna=!1})):a.gcd?a.Cd():d6(a,!1)}
function rEd(a){a.fue&&yEd(a,!1);a.CCa(a.C5a+1);var b,c,d,e=c={val:c},f=b={val:b},g=d={val:d};e.val=0;f.val=0;g.val=a.Mcb;if(a.dmd){var h=a.dmd(a);if(h){var k=4===c6(a),l;l=a.uAe;var m=e6(a),n=k?6:a.Mra,r=a.Mra,t=a._element,v=h.y,x=h.height,y=$l(t).y,z=y+n,E=m*r+2*(m-1),r=null;if(1===m||y+E<=v+x)v=new f6(0,0,2,4);else{var m=1,H=Math.max(v,z-E);E>z-v&&(m=2,H=E<x?x-E:v);v=new f6(H,0,m,4);v.mab-=y}l.uGb?r=new f6(0,0,2,l.Am?4:3):(l.Am?(y=h.width,t=$l(t),t=y-(t.x+t.width)):t=$l(t).x,y=Math.max(0,h.x),
h=h.width,n=t+n,t+150<=y+h?r=new f6(0,0,2,l.Am?3:4):150<=n-y&&(r=new f6(0,0,2,l.Am?4:3)),r||(h-n>=t-y?l=4:(n=t,l=3),r=new f6(0,n,2,l)));l=new f6(v.mab,r.Ege,v.j7c,r.vUc);f.val=l.mab;1===l.j7c?f=e6(a)-1:(f=Math.abs(l.mab),f=0<f?f/(a.Mra+2):0);a.jIb=f;g.val=l.vUc;g.val!==a.Mcb&&(a.J2c(g.val),a._element.dir=3===g.val?"rtl":"ltr",a.Mcb=g.val);g.val!==(a.Am?3:4)?(e.val=a.$Uc?-2:k?-6:-a.Mra,a.ygb=!0):a.ygb=!1}}c=c.val;b=b.val;d=d.val;for(e=0;e<e6(a);e++)a.SM[e].xf(a.Bm[e],c,b+(a.Mra+2)*e+20,3,e!==a.jIb,
d)}function d6(a,b){if(!b||a.yna){a.fue&&yEd(a,!0);var c=Math.min(3,e6(a))-1;b=0;var d=1,e=0;a.ygb&&(b=a.Mcb,d=-1,e=-a.Mra);for(var f=e6(a)-1;f>c;f--)a.SM[f].xf(a.Bm[f],-4*c*d+e,20,2,!0,b);for(f=c;0<=f;f--)c=Array.contains(a.Kma,a.Bm[f].eh),a.SM[f].xf(a.Bm[f],-4*f*d+e,20,0<f?2:c?1:0,f!==a.jIb,b);a.jIb=0;a.Wwa.jx(0,a.ygb);a.CCa(a.C5a);a.Lwa=!1;sEd(a,0);a.Ikc&&a.ha()}}function uEd(a,b,c){0>=a.Bm.length?a.Cd():3===b&&c?(a.hf(!0),rEd(a),a.Lwa=!0):a.EHa()}
function vEd(a,b){var c=a.xFa(b);if(!(0>=c)){var d=a.Bm[c];b=a.Keb[b];Array.removeAt(a.Bm,c);Array.insert(a.Bm,0,d);Array.removeAt(a.SM,c);Array.insert(a.SM,0,b);a.pna.removeChild(b._element);a.pna.appendChild(b._element);d6(a,!1)}}function c6(a){return 0<e6(a)?a.SM[0].ph:5}function e6(a){return a.SM?a.SM.length:0}
function zEd(a){var b=AEd/a,c=2*b,d=BEd/2;a=(a-12-8)*b/2;var e=document.createElementNS(CEd,"g");Sys.UI.DomElement.addCssClass(e,DEd);for(var f=1;3>=f;f++)e.appendChild(EEd(f,c,a+(6*f-2)*b,d));return e}function EEd(a,b,c,d){var e=document.createElementNS(CEd,"circle");Sys.UI.DomElement.addCssClass(e,String.format("{0}-{1}",FEd,a));e.setAttribute("cx",String.format("{0}",c));e.setAttribute("cy",String.format("{0}",d));e.setAttribute("r",String.format("{0}",b));return e}
function GEd(a){this.Zd=a;g6(this.Zd,10,Zh());g6(this.Zd,9,bi());g6(this.Zd,6,20);g6(this.Zd,13,li());g6(this.Zd,17,!1)}GEd.prototype={Zd:null,f5b:function(a,b){g6(this.Zd,15,b);return new nEd(a,20,this.Zd)}};
function tEd(a,b){this.qK=Function.createDelegate(this,this.FW);this.nF=Function.createDelegate(this,this.EW);this.KM=Function.createDelegate(this,this.rN);this.Aq=Function.createDelegate(this,this.oz);tEd.initializeBase(this,[a]);this.X5=b.In(Boolean,8,!1);this.dna=b.In(Number,6,0);this.wFe=b.In(Boolean,15,!1);this.Zd=b;this.Ead=0;this._element=a;this._element.className=HEd;this.gO=document.createElement("span");this._element.appendChild(this.gO);a=b.In(Number,6,0);var c=document.createElementNS(CEd,
"svg");c.setAttribute("viewBox",String.format(IEd,AEd,BEd));c.appendChild(zEd(a));this.Kre=c;this.KW(b);this.ph=5}
tEd.prototype={Bk:null,Ut:null,zfa:null,Zd:null,gO:null,exa:null,Kre:null,dna:0,X5:!1,wFe:!1,z9c:null,Ead:0,hJa:null,oLa:function(a){this.Ka("InteractivityChanged",a)},azc:function(a){this.eb("InteractivityChanged",a)},nEf:null,ph:0,ha:function(){this._element&&(this.Bk.Sb("click",this._element,this.Aq),this.Bk.Sb("dblclick",this._element,this.mZ),this.Ut.Sb("msospPointerDown",this._element,this.KM),this.Ut.Sb("msospPointerOut",this._element,this.nF),this.Ut.Sb("msospPointerOver",this._element,this.qK),
this.zfa.Sb(this._element,this.mZ));a6.prototype.ha.call(this)},KW:function(a){this.Bk=a.In(xd,10,null);this.Bk.Wa("click",this._element,this.Aq);this.Bk.Wa("dblclick",this._element,this.mZ);this.Ut=a.In(zd,9,null);this.Ut.Wa("msospPointerOver",this._element,this.qK);this.Ut.Wa("msospPointerOut",this._element,this.nF);this.Ut.Wa("msospPointerDown",this._element,this.KM);this.zfa=a.In(nl,13,null);this.zfa.Wa(this._element,this.mZ)},Cd:function(a,b,c){this.wFe&&a?this.xf(a,b,15,4,!1,c):(3===this.ph&&
JEd(this),this.hf(!1),this.ph=5)},xf:function(a,b,c,d,e,f){var g;if((g=a)&&!(g=d!==this.ph)){g=oW(this._element.style.left);var h=oW(this._element.style.top);g=!(g===b&&h===c)}if(g){if(!KEd(this.ph)||!KEd(d))switch(Sys.UI.DomElement.removeCssClass(this._element,this.z9c),this.ph){case 4:3===d?this.pta(LEd,MEd):KEd(d)&&this.pta(NEd,MEd);break;case 3:4===d?this.pta(OEd,PEd):KEd(d)&&(e&&JEd(this),this.pta(NEd,PEd,e?QEd:""));break;case 0:case 1:case 2:4===d?this.pta(OEd,REd):3===d&&(e&&SEd(this),this.pta(LEd,
REd,e?TEd:"",3===f?UEd:VEd));break;default:4===d?this.pta(OEd):3===d?this.pta(LEd):KEd(d)&&this.pta(NEd)}this.zP(a,d,f);this.ph=d;4===f||!f&&!this.X5?this._element.style.left=b+"px":this._element.style.right=b+"px";this._element.style.top=c+"px";this.hf(!0)}},zP:function(a,b,c){this.nEf=a;Qd(this.gO);this.gO.removeAttribute("style");this.gO.id="fly_"+a.eh;this.gO.style.backgroundColor=a.Zz;4!==b?(this.gO.style.height=this.dna+"px",this.gO.style.lineHeight=this.dna+"px",PV(this.gO,"border-radius",
this.dna+"px")):4===c||!c&&!this.X5?this.gO.style.left="0px":this.gO.style.right="0px";2!==b&&(4===b?IV(this.gO,""):1===b?this.gO.appendChild(this.Kre):(this.gO.setAttribute("dir","auto"),c=Q$b(a.ku,!1),(!a.sca||L.fc("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&c||b?(a=a.ku,b||(a=c,PV(this.gO,"text-align","center")),IV(this.gO,a)):(this.exa||(b=document.createElement("img"),b.src=dg("doughperson_white_glyph.svg"),b.setAttribute("Unselectable","on"),Wf(b,"role","presentation"),
this.exa=Wra(this.dna,this.dna,null,null,WEd,"",!1,"",this._element.ownerDocument,b)),this.gO.appendChild(this.exa),PV(this.gO,"text-align","start"))))},oz:function(a){if(!this.ph)return this.Ha("InteractivityChanged",new b6(1,a),null),!0;3===this.ph&&u(50436114,302,50,"User clicked on presence pill.");return!1},EW:function(a){3===this.ph&&this.Ha("InteractivityChanged",new b6(3,a),null);return!1},FW:function(a){3!==a.ye&&this.Ha("InteractivityChanged",new b6(2,a),null);return!1},rN:function(a){if(3!==
a.ye)return!0;this.Ha("InteractivityChanged",new b6(4,a),null);return!1},pta:function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];this.z9c=a.join(" ");Sys.UI.DomElement.addCssClass(this._element,this.z9c)},J2c:function(a){3===a&&an(this._element,"left")?(a=oW(this._element.style.left),PV(this._element,"left",""),this._element.style.right=-1*a+"px"):4===a&&an(this._element,"right")&&(a=oW(this._element.style.right),PV(this._element,"right",""),this._element.style.left=-1*a+"px")}};
function KEd(a){return!a||1===a||2===a}function JEd(a){window.clearTimeout(a.Ead);a.hJa&&(Sys.UI.DomElement.removeCssClass(a.hJa,REd+" "+TEd),Sys.UI.DomElement.addCssClass(a.hJa,XEd),nac(300).CW(function(){a._element&&a._element.parentNode===a.hJa.parentNode&&a._element.parentNode.removeChild(a.hJa)}),PV(a._element,"z-index",""))}
function SEd(a){a.Ead=window.setTimeout(function(){a._element&&(a.hJa=a._element.cloneNode(!0),a._element.parentNode.appendChild(a.hJa),a._element.style.zIndex=2,a.hJa.style.zIndex=1)},300)}function oEd(a,b){this.Am=a;this.uGb=b}oEd.prototype={Am:!1,uGb:!1};function f6(a,b,c,d){this.mab=a;this.Ege=b;this.j7c=c;this.vUc=d}f6.prototype={mab:0,Ege:0,j7c:0,vUc:0};
function qEd(a,b,c,d,e,f,g){this.t5=a;this._parent=b;this.M9c=c;this.Spe=d;this.Xte=e;this.XZa=f;this.X5=g;this.Jk=document.createElement("div");this.Jk.className="prTouchTarget"}
qEd.prototype={t5:null,_parent:null,X5:!1,M9c:0,Spe:0,Xte:0,XZa:0,Jk:null,jx:function(a,b){if(3!==a)if(5!==a&&this.t5&&this.t5.length){var c,d;if(4===a)c=this.Xte,d=(this.XZa-c)/2,this.Jk.style.height=this.XZa+"px",this.Jk.style.width=this.XZa+"px",a=oW(this.t5[0]._element.style.top),b=oW(this.X5?this.t5[0]._element.style.right:this.t5[0]._element.style.left);else{c=this.M9c;d=(this.XZa-c)/2;this.Jk.style.height=this.XZa+"px";this.Jk.style.width=(this.t5&&this.t5.length?this.M9c+Math.min(this.t5.length-
1,2)*this.Spe:0)+2*d+"px";a=oW(this.t5[this.t5.length-1]._element.style.top);var e=this.t5[this.t5.length-1]._element,f=c;b=this.X5&&!b?oW(e.style.right):this.X5||b?this.X5&&b?-oW(e.style.left)-f:-oW(e.style.right)-f:oW(e.style.left)}PV(this.Jk,"border-radius",this.XZa+"px");this.Jk.style.top=a-d-c+"px";this.X5?this.Jk.style.right=b-d+"px":this.Jk.style.left=b-d+"px";this.Jk.parentNode||this._parent.insertBefore(this.Jk,this._parent.firstChild)}else this.Jk.parentNode&&this.Jk.parentNode.removeChild(this.Jk)}};
function YEd(a,b,c){this.tra=Function.createDelegate(this,this.BGa);this.Bm=[];this.zJ=[];this.dispose=this.ha;YEd.initializeBase(this,[a]);this.jHb={};this.Zd=c;this.Am=c.In(Boolean,8,!1);this.nxa=c.In(Boolean,11,!1);a=c.In(Number,12,0);this.Gja=c.In(Number,6,0);this.iLb=b;this._element.id=String.format("{0}-{1}","presencetooltip",ZEd++);this._element.className="prControl"+(this.Am?"Rtl":"");a&&this.CCa(a);mEd(this,this.Am);this.H3c(b);this.D$=this.Qi("div");this.D$.className=this.nxa?"prContainerV":
"prContainerHr";this._element.appendChild(this.D$);this.nP=Array(this.Pna);for(b=0;b<this.Pna;b++)this.nP[b]=new $Ed(this.Qi("div"),this.Zd),this.nP[b].oLa(this.tra),this._element.appendChild(this.nP[b]._element)}
YEd.prototype={D$:null,Pna:0,Am:!1,zGb:!1,nxa:!1,hLb:!1,iLb:0,Zd:null,jHb:null,TNb:function(){return uf(this.Bm)},nP:null,HCc:null,Gja:0,$f:function(){return this.nxa?this.Gja+2:this.iLb},Rm:function(){return this.nxa?this.iLb:this.Gja+2},oLa:function(a){this.Ka("InteractivityChanged",a)},ha:function(){if(this.nP)for(var a=this.nP,b=a.length,c=0;c<b;++c){var d=a[c];d.azc(this.tra);vc(d)}lac(this.zJ);this.zJ=this.nP=null;a6.prototype.ha.call(this)},EHa:function(){this.VFa();aFd(this);this.hf(!0);this.zGb=
!1},Pbb:function(){if(this.zJ&&!(1>this.zJ.length)){this.hf(!0);aFd(this);for(var a=0,b=this.zJ,c=b.length,d=0;d<c;++d)bFd(this,b[d],a++);this.zGb=!1;this.hLb=!0}},Cd:function(){this.hf(!1);this.VFa();for(var a=0;a<this.zJ.length;a++)this.zJ[a].Cd();this.zGb=!1},zP:function(a){if(!(0>=this.Pna)){a.eh||(a.eh=(ZEd++).toString());if(a.eh in this.jHb){var b=this.xFa(a.eh);if(0<=b){b=this.Bm[b];if(b.Zz===a.Zz&&b.ku===a.ku)return;this.V_(a.eh)}}var b=cFd(this),c,d=0;this.Bm.length<this.Pna?(c=new dFd(this.Qi("div"),
this.Zd,a),c.oLa(this.tra),this.Am&&!this.nxa&&0<this.Bm.length?this.D$.insertBefore(c._element,this.D$.firstChild):(this.D$.appendChild(c._element),d=this.zJ.length),Array.add(this.zJ,c)):(this.Am&&!this.nxa?c=this.zJ[0]:(d=this.zJ.length-1,c=this.zJ[d]),c.zP(a));c.xf();this.jHb[a.eh]=c;Array.add(this.Bm,a);eFd(this,c,d);b&&this.Pbb()}},V_:function(a){var b=cFd(this);b&&this.VFa();this.DBb(a);this.Bm.length>=this.Pna&&this.zJ.length<this.Pna&&fFd(this);0>=this.Bm.length?this.Cd():b&&this.Pbb()},
DBb:function(a){var b=this.xFa(a);0>b||(a=this.Bm[b],Array.removeAt(this.Bm,b),b=this.jHb[a.eh],delete this.jHb[a.eh],b.V_(a.eh),eFd(this,b,0),0>=h6(b)&&(this.D$.removeChild(b._element),Array.remove(this.zJ,b),b.ha()))},ACb:function(){},xFa:function(a){for(var b=0;b<this.Bm.length;b++)if(this.Bm[b].eh===a)return b;return-1},VFa:function(){for(var a=0;a<this.Pna;a++)this.nP[a].Cd();this.hLb=!1},BGa:function(a,b){var c=window.$$as(dFd,a),c=c?gFd(this,c):-1;if(2===b.qh||1===b.qh&&-1!==c&&!this.nP[c].rj())bFd(this,
a,0);else if(1===b.qh)this.VFa(),this.zGb=!1;else if(3===b.qh){a=b.KEc.xb.rawEvent;a=a.relatedTarget||a.toElement;for(var c=!1,d=this.nP,e=d.length,f=0;f<e;++f)if(IU(d[f]._element,a)){c=!0;break}if(this.D$!==a&&IU(this.D$,a)||c)return;this.zGb||this.VFa()}this.Ha("InteractivityChanged",b,null)},H3c:function(a){this.Pna=a===this.Gja?1:Math.floor(a/(this.Gja+2));this.nxa?(this._element.style.height=a+"px",this._element.style.width=this.Gja+"px"):(this._element.style.width=a+"px",this._element.style.height=
this.Gja+"px")}};function gFd(a,b){var c=0;a=a.zJ;for(var d=a.length,e=0;e<d;++e){if(b===a[e])return c;c++}return-1}function eFd(a,b,c){var d;d=gFd(a,b);(d=!!a.HCc&&b===a.HCc&&-1!==d&&a.nP[d].rj())&&0>=h6(b)?a.nP[c].Cd():d?bFd(a,b,0):a.nP[c].Cd()}
function bFd(a,b,c){if(b)if(a.HCc=b,a.nxa){var d=a.Gja;if(1<b.Bm.length)a.nP[c].xf(b.Bm,d,a.Rm()-a.Gja);else for(var e=a.D$.children.length,f=0;f<a.D$.children.length;f++)b._element===a.D$.children[f]&&a.nP[c].xf(b.Bm,d,a.Rm()-(e-f)*(a.Gja+2)+2)}else a.nP[c].xf(b.Bm,a.$f(),0)}function aFd(a){for(var b=0;b<a.zJ.length;b++)a.zJ[b].xf()}
function fFd(a){var b=a.Am&&!a.nxa?a.zJ[0]:a.zJ[a.zJ.length-1];!b||1>=b.Bm.length||(b=Array.clone(a.Bm),Array.forEach(b,function(b){a.DBb(b.eh)}),Array.forEach(b,function(b){a.zP(b)}))}function cFd(a){if(!a.hLb)return!1;for(var b=0,c=a.nP,d=c.length,e=0;e<d;++e)c[e].rj()&&b++;a.hLb=0<b&&(a.Bm.length<=a.Pna?b===a.Bm.length:b===a.Pna);return a.hLb}function hFd(a){this.Zd=a;g6(this.Zd,10,Zh());g6(this.Zd,9,bi());g6(this.Zd,6,16);g6(this.Zd,13,li())}
hFd.prototype={Zd:null,mKf:function(a,b){return new YEd(a,b,this.Zd)},f5b:function(a){return new YEd(a,16,this.Zd)}};
function $Ed(a,b){this.nF=Function.createDelegate(this,this.EW);this.Aq=Function.createDelegate(this,this.oz);$Ed.initializeBase(this,[a]);this.X5=b.In(Boolean,8,!1);this.dna=b.In(Number,6,0);this._element=a;this._element.className=iFd;this.inc=this.Qi("ul");this._element.appendChild(this.inc);this.Bk=b.In(xd,10,null);this.Bk.Wa("click",this._element,this.Aq);this.Ut=b.In(zd,9,null);this.Ut.Wa("msospPointerOut",this._element,this.nF);this.Ut.Wa("msospPointerDown",this._element,this.mZ);this.zfa=b.In(nl,
13,null);this.zfa.Wa(this._element,this.mZ)}
$Ed.prototype={Bk:null,Ut:null,zfa:null,inc:null,dna:0,X5:!1,oLa:function(a){this.Ka("InteractivityChanged",a)},azc:function(a){this.eb("InteractivityChanged",a)},pEf:null,ha:function(){this._element&&(this.Bk.Sb("click",this._element,this.Aq),this.Ut.Sb("msospPointerDown",this._element,this.mZ),this.Ut.Sb("msospPointerOut",this._element,this.nF),this.zfa.Sb(this._element,this.mZ));a6.prototype.ha.call(this)},Cd:function(){this.hf(!1)},xf:function(a,b,c){this.Cd();if(a&&!(0>=a.length)){this.X5?this._element.style.right=
b+"px":this._element.style.left=b+"px";this._element.style.top=c+"px";this.pEf=a;Qd(this.inc);for(b=a.length-1;0<=b;b--)this.zP(a[b]);this.hf(!0)}},zP:function(a){var b=document.createElement("li");b.style.backgroundColor=a.Zz;b.style.height=this.dna+"px";b.id="fly_"+a.eh;b.style.lineHeight=this.dna+"px";IV(b,a.ku);b.setAttribute("dir","auto");this.inc.appendChild(b)},oz:function(){this.Cd();return!1},EW:function(a){this.Ha("InteractivityChanged",new b6(3,a),null);return!1}};
function dFd(a,b,c){this.Aq=Function.createDelegate(this,this.oz);this.nF=Function.createDelegate(this,this.EW);this.qK=Function.createDelegate(this,this.FW);this.Bm=[];dFd.initializeBase(this,[a]);this._element.className="prGlyph";this.Zd=b;this.WYa=this.Zd.In(zd,9,null);this.Xl=this.Zd.In(xd,10,null);this.zfa=this.Zd.In(nl,13,null);this._element&&(this.WYa.Wa("msospPointerDown",this._element,this.mZ),this.WYa.Wa("msospPointerOver",this._element,this.qK),this.WYa.Wa("msospPointerOut",this._element,
this.nF),this.Xl.Wa("dblclick",this._element,this.mZ),this.Xl.Wa("click",this._element,this.Aq),this.zfa.Wa(this._element,this.mZ));this.zP(c);this.jic=!1}
dFd.prototype={exa:null,Zd:null,jic:!0,Xl:null,WYa:null,zfa:null,oLa:function(a){this.Ka("InteractivityChanged",a)},ha:function(){this._element&&(this.WYa.Sb("msospPointerDown",this._element,this.mZ),this.WYa.Sb("msospPointerOver",this._element,this.qK),this.WYa.Sb("msospPointerOut",this._element,this.nF),this.Xl.Sb("dblclick",this._element,this.mZ),this.Xl.Sb("click",this._element,this.Aq),this.zfa.Sb(this._element,this.mZ));a6.prototype.ha.call(this)},zP:function(a){Array.add(this.Bm,a);2===h6(this)?
e_(this,!0):1===h6(this)?e_(this,!1):e_(this,this.jic)},V_:function(a){var b;a:{for(b=0;b<h6(this);b++)if(this.Bm[b].eh===a){a=this.Bm[b];Array.removeAt(this.Bm,b);b=a;break a}b=null}b&&(1<h6(this)&&e_(this,!0),1===h6(this)?e_(this,!1):1>h6(this)&&this.Cd())},xf:function(){e_(this,2<=h6(this));this.hf(!0)},Cd:function(){this.hf(!1)},FW:function(a){3!==a.ye&&this.Ha("InteractivityChanged",new b6(2,a),null);return!1},oz:function(a){this.Ha("InteractivityChanged",new b6(1,a),null);return!0},EW:function(a){3!==
a.ye&&this.Ha("InteractivityChanged",new b6(3,a),null);return!1}};function jFd(a,b,c){var d=a.Zd.In(Number,6,0),e=a.Zd.In(Object,14,null);return Wra(d,d,a.Zd.In(String,b,null),a.Zd.In(String,c,null),"cui-img-cont-float cui-img-16by16","",!1,"",a._element.ownerDocument,e?e.cloneNode(!0):null)}
function e_(a,b){if(a.jic!==b){a.exa&&a._element.removeChild(a.exa);var c;c=b?jFd(a,0,5):jFd(a,1,4);a.exa=c;a._element.appendChild(a.exa);a.jic=b}a.exa.childNodes[0].style.backgroundColor=a.Bm[a.Bm.length-1].Zz}function h6(a){return a.Bm.length}function kFd(){this.D0={}}kFd.prototype={In:function(a,b,c){a=w.Ca.XEa.Yab.toString(b);return"number"===typeof c?(c=this.D0[a])?Number.parseInvariant(c.toString()):0:this.D0[a]},ga:function(a,b,c){this.D0[w.Ca.XEa.Yab.toString(b)]=c}};
function g6(a,b,c){w.Ca.XEa.Yab.toString(b)in a.D0||(a.D0[w.Ca.XEa.Yab.toString(b)]=c)}a6.registerClass("Common.App.CollabControls.BasePresenceControl",re,Sys.IDisposable);b6.registerClass("Common.App.CollabControls.InteractivityChangedEventArgs",Sys.EventArgs);nEd.registerClass("Common.App.CollabControls.ModernPresenceTooltipControl",a6,kEd,Sys.IDisposable);(function(){}).registerClass("Common.App.CollabControls.ModernPresenceTooltipDancingDots");
GEd.registerClass("Common.App.CollabControls.ModernPresenceTooltipFactory",null,lEd);tEd.registerClass("Common.App.CollabControls.ModernPresenceTooltipFlyoutControl",a6);oEd.registerClass("Common.App.CollabControls.ModernPresenceTooltipPositioner");f6.registerClass("Common.App.CollabControls.FlyoutsPositioningInfo");qEd.registerClass("Common.App.CollabControls.ModernPresenceTooltipTarget");YEd.registerClass("Common.App.CollabControls.PresenceTooltipControl",a6,kEd,Sys.IDisposable);
hFd.registerClass("Common.App.CollabControls.PresenceTooltipFactory",null,lEd);$Ed.registerClass("Common.App.CollabControls.PresenceTooltipFlyoutControl",a6);dFd.registerClass("Common.App.CollabControls.PresenceTooltipGlyph",a6);kFd.registerClass("Common.App.CollabControls.PresenceTooltipSettings");
var pEd=0,CEd="http://www.w3.org/2000/svg",DEd="prDancingDots",FEd="prAnimateCircle",IEd="0 0 {0} {1}",BEd=40,AEd=120,HEd="prModernFlyout UIFont",OEd="flyoutIdle",LEd="flyoutExpanded",NEd="flyoutCollapsed",MEd="flyoutFromIdle",PEd="flyoutFromExpanded",REd="flyoutFromCollapsed",TEd="flyoutStacked",QEd="flyoutFromStacked",XEd="flyoutFadeOut",WEd="cui-img-cont-float cui-img-20by20",VEd="flyoutLtrDir",UEd="flyoutRtlDir",ZEd=0,iFd="prFlyout UIFont";Type.registerNamespace("PowerPointWebEditor.ShapePresence");
M=window.PowerPointWebEditor||{};M.j4c=M.j4c||{};function lFd(){}lFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapePawn");function mFd(){}mFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory");function nFd(){}nFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapePawnFactory");function oFd(){}oFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapePawnFlyout");function pFd(){}pFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory");
function qFd(){}qFd.registerInterface("PowerPointWebEditor.ShapePresence.IShapePawnView");function rFd(a,b,c,d,e,f){this.Yz=Function.createDelegate(this,this.tH);this.nF=Function.createDelegate(this,this.EW);this.qK=Function.createDelegate(this,this.FW);this.hu=window.$$as(sFd,new sFd(a,b,c,this.qK,this.nF,null,d,d.xba,d.vk,d.Lo,d.Yc,e));this.fwc=0;this.uc=f;qM(this.uc,this.Yz);this.Qe()}
rFd.prototype={hu:null,Mrc:null,fwc:0,uc:null,ha:function(){this.hu.ha();this.Mrc=null},Rsb:null,Iib:function(){return this.Rsb},vs:function(a){this.hu.vs(a)},iFf:function(a,b,c){this.Rsb=a;this.Mrc=b;tFd(this.hu,"UnreadNotification_16x16x32",this.Rsb,c)},Qe:function(){this.hu.Qe();this.Rsb="none"},DHa:function(){this.u9();var a=this.tnd();this.hu.Mha.ga(this.Rsb,a);a=this.hu;a.zOa.Ja.style.zIndex=a.eoc+1E5},u9:function(){this.hu.Mha.Qe();this.hu.zOa.Ja.style.zIndex=0},tH:function(){R(39068559,804,
15,"Canvas shape highlights pawn hovered count: {0};",this.fwc);0<this.fwc&&gk(1206905761,!0,"",0,0,0,null)},tnd:function(){return this.Mrc?this.Mrc():""},FW:function(){this.DHa();R(23606147,804,50,"Shape revision tracking pawn hovered");this.fwc+=1;return!0},EW:function(){this.u9();return!0}};
function sFd(a,b,c,d,e,f,g,h,k,l,m,n){this.Aq=Function.createDelegate(this,this.oz);this.mR=b;this.Gk=a;this.aKe=c;this.vk=k;this.Lo=l;this.Yc=m;this.xba=h;this.USb=e;this.VSb=d;this.wR=f;eM(this.Gk,"prControl");this.Gk.style.width=this.vk.h0(b);this.eu=new uFd(g.vk);this.Mha=new vFd(g.vk,g.zd);this.eu.KEa(a);this.Mha.KEa(a,b,0,b);this.zOa=n;this.jva()}
sFd.prototype={Gk:null,vk:null,Lo:null,Yc:null,eoc:1,eu:null,Mha:null,xba:null,mR:0,aKe:null,VSb:null,USb:null,wR:null,zOa:null,ha:function(){this.z6c();this.Qe();this.eu.ha();this.Mha.ha();rV(this.Gk,"prControl")},Iib:function(){return"none"},Qe:function(){this.QEa();this.Mha.Qe();this.zOa.Ja.style.zIndex=0},vs:function(a){this.Gk.style.zIndex=a},QEa:function(){this.eu.Qe()},oz:function(){return!0},jva:function(){this.VSb&&this.Lo.Wa("msospPointerOver",this.Gk,this.VSb);this.USb&&this.Lo.Wa("msospPointerOut",
this.Gk,this.USb);this.wR?this.Yc.Wa("click",this.Gk,this.wR):this.Yc.Wa("click",this.Gk,this.Aq);this.Yc.Wa("dblclick",this.Gk,this.Aq)},z6c:function(){this.VSb&&this.Lo.Sb("msospPointerOver",this.Gk,this.VSb);this.USb&&this.Lo.Sb("msospPointerOut",this.Gk,this.USb);this.wR?this.Yc.Sb("click",this.Gk,this.wR):this.Yc.Sb("click",this.Gk,this.Aq);this.Yc.Sb("dblclick",this.Gk,this.Aq)}};function tFd(a,b,c,d){b=a.xba.Y$d(a.mR,a.mR,a.aKe,b,"",d);a.eu.Gbb(b,c)}function uFd(a){this.vk=a}
uFd.prototype={vk:null,KQb:null,Bkb:null,ha:function(){this.Qe();this.KQb.parentNode.removeChild(this.KQb)},KEa:function(a){this.KQb=wFd(a,"prContainerHr");this.Bkb=wFd(this.KQb,"prGlyph")},Qe:function(){this.$Ua()},Gbb:function(a,b){a&&(this.$Ua(),this.Bkb.appendChild(a),this.Bkb.style.backgroundColor=b,this.KQb.style.visibility="visible")},$Ua:function(){this.Bkb.firstChild&&this.Bkb.removeChild(this.Bkb.firstChild)}};function wFd(a,b){var c=iM();eM(c,b);a.appendChild(c);return c}
rFd.registerClass("PowerPointWebEditor.ShapePresence.ShapeRevisionTrackingPawn",null,lFd);sFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawn",null,lFd);uFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawnGlyph");Type.registerNamespace("PowerPointWebEditor.ShapePresence");M=window.PowerPointWebEditor||{};M.j4c=M.j4c||{};function xFd(a){this.Dc=a}
xFd.prototype={Dc:null,Y$d:function(a,b,c,d,e,f){var g=this.Dc.Lk(c+".png");c=ck(c,d);return Wra(a,b,c,g,32===a&&32===b?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,e,null,f)}};function yFd(a,b,c,d,e){this.Lo=a;this.Yc=b;this.vk=c;this.xba=d;this.zd=e;this.rR=L.ia(S(1166))}yFd.prototype={Lo:null,Yc:null,vk:null,xba:null,zd:null,rR:!1,CKf:function(a,b,c,d){this.rR?eM(a,"ShapeModernCatchupPawnContainer"):eM(a,"ShapePawnContainer");return new rFd(a,b,"pegal",this,c,d)}};
function zFd(a,b,c,d){eM(b,"ShapePawnContainer");return new AFd(b,c,"per",a,d)}function vFd(a,b){this.vk=a;this.zd=b}
vFd.prototype={vk:null,zY:null,Tsc:null,sRe:0,xrd:0,zd:null,ha:function(){this.Qe();this.zY.parentNode.removeChild(this.zY)},ga:function(a,b){BFd(this,!1);var c=document.createElement("li");c.style.backgroundColor=a;c.style.lineHeight=this.vk.h0(this.sRe);IV(c,b);this.Tsc.appendChild(c);(a=0>JL(this.zY.style.left))||(a=this.vk.bla(c),b=this.vk.bla(XU(this.zd.ie())),a=a.x+a.width+this.xrd>b.x+b.width);a?CFd(this,-1*(Math.ceil(c.offsetWidth)+2)):CFd(this,this.xrd);BFd(this,!0)},Qe:function(){Qd(this.Tsc);
BFd(this,!1);CFd(this,0)},KEa:function(a,b,c,d){this.sRe=d;this.xrd=b;this.zY=iM();this.zY.className="prFlyout UISmallFont";a.appendChild(this.zY);this.Tsc=document.createElement("ul");this.zY.appendChild(this.Tsc)}};function CFd(a,b){a.zY.style.left=a.vk.h0(b)}function BFd(a,b){a.zY.style.visibility=b?"visible":"hidden"}function DFd(){}DFd.prototype={vQc:function(a,b,c,d,e,f){return new EFd(a,b,c,d,e,f)}};
function EFd(a,b,c,d,e,f){this.Vnb=this.li=this.ki=0;this.Bd=1;this.rkb=!1;this.mc=this.WOb=!0;this.tD=!1;this.HO=!0;this.msc=!1;this.mR=f;this.Iqa=new EL;this.xU=new XL;this.Mv=new YL;this.sD=new YL;this.YE=new YL;this.PY=new EL;this.oI=new zL;this.dB=new zL;this.wb=a;this.hu=b?b(this.PY.Ja,this.mR,e):null;this.va=c;this.gR=d}
EFd.prototype={Iqa:null,xU:null,Mv:null,sD:null,YE:null,PY:null,mR:0,WOb:!1,mc:!1,tD:!1,HO:!1,blb:!1,rkb:!1,msc:!1,Xn:null,ki:null,li:null,Bd:null,Vnb:0,oI:null,dB:null,wb:null,va:null,gR:null,hu:null,rR:!1,ha:function(){this.gR();this.Iqa&&(this.Iqa.Ja.parentNode&&this.Iqa.ns(),this.xU&&this.xU.Pj&&this.xU.Pj.ns(),this.Mv&&this.Mv.ns(),this.sD&&this.sD.ns(),this.YE&&this.sD.ns());this.hu&&this.hu.ha();this.PY=this.YE=this.sD=this.Mv=this.xU=this.Iqa=null;this.mc=!1},Cu:function(){return this.va},
zGg:function(a){this.mR=16;return this.rR=a},Mm:function(a){this.Iqa.jf(this.xU.Pj);this.Iqa.jf(this.PY);PL(this.Mv,"none");this.rR?ML(this.Mv,1):ML(this.Mv,3);PL(this.sD,"none");ML(this.sD,1);PL(this.YE,"none");ML(this.YE,7);this.xU.jf(this.YE);this.xU.jf(this.sD);this.xU.jf(this.Mv);this.Gf();FFd(this);a.jf(this.Iqa)},QC:function(){},$w:function(){return this.xU.$w(0)},JTa:function(){return!1},hx:function(){},Gf:function(){var a=this.mc&&(!this.tD||!this.HO);this.PY.pe(a);this.Mv.pe(a);this.sD.pe(a);
this.YE.pe(a);this.Iqa.pe(this.mc)},ez:function(){},dx:function(){return null},MC:function(){return[]},uB:function(){this.hf(!0);FFd(this)},rj:function(){return this.mc},hf:function(a){this.mc!==a&&(this.mc=a,this.Gf(),this.Nt());return a},LEd:function(a){this.WOb=a;this.Mv.pe(this.mc&&this.WOb);this.sD.pe(this.mc&&this.WOb);this.YE.pe(this.mc&&this.WOb);return a},te:function(a,b){this.ki=a;this.li=b;this.Nt()},$j:function(a){this.Bd=a;this.Nt()},pq:function(a){this.oI=a;this.Nt()},uu:function(a){this.dB=
a;this.Nt()},vs:function(a){this.Vnb=a;this.Iqa.eE(this.Vnb);this.xU.eE(this.Vnb);this.PY.eE(this.Vnb);this.hu&&this.hu.vs(this.Vnb)},ry:function(a,b){this.tD=a;this.HO=b;this.Gf()},ucb:function(a){this.hu&&OL(this.Mv,a||this.hu.Iib());this.Mv&&(NL(this.Mv,""),PL(this.Mv,"none"),this.rR?ML(this.Mv,1):ML(this.Mv,3),Uxb(this.Mv,""))},uIf:function(){this.Mv&&this.sD&&this.YE&&(this.msc=!1,Uxb(this.Mv,""),Uxb(this.sD,""),OL(this.Mv,"none"),LL(this.Mv,0),OL(this.sD,"none"),LL(this.sD,0),OL(this.YE,"none"),
LL(this.YE,0))},E6c:function(a,b){if(this.Mv&&this.sD&&this.YE){this.msc=!0;var c=!a;ML(this.Mv,1);ML(this.sD,2===a?2:1);ML(this.YE,7);OL(this.Mv,c?"none":"#FFFFFF");OL(this.sD,c?"none":"#731A7E");switch(a){case 2:OL(this.YE,"#E5C2E9");break;case 1:OL(this.YE,"#F2E1F4");break;default:OL(this.YE,"#F5E7F6")}1===a?GFd(this,0):b?GFd(this,0):(LL(this.Mv,1),LL(this.sD,1),LL(this.YE,1))}},Nt:function(){if(this.Xn){var a=this.Xn.Lh();this.oI.Fn(a);this.dB.Fn(a);a.oy(this.ki,this.li);EY(a,this.Bd,this.Bd);
if(this.Mv&&this.sD&&this.YE&&a){var b=HFd(-8,a),c=HFd(1,b);$L(this.YE,c.We);this.xU.qn();this.YE.pe(this.mc&&(!this.tD||!this.HO));$L(this.sD,b.We);this.xU.qn();this.sD.pe(this.mc&&(!this.tD||!this.HO));$L(this.Mv,a.We);this.xU.qn();this.Mv.pe(this.mc&&(!this.tD||!this.HO));qma()&&this.va&&ZO(this.va)&&nZb(this.wb)&&this.xU.Pj.vi(this.xU.Pj.ld,0)}if(a){var b=sJ(a,VJ),c=sJ(a,TJ),b=QJ(c,b),d=Ah(b),b=sJ(a,VJ),c=sJ(a,TJ);90<=d&&(b=sJ(a,TJ),c=sJ(a,ZJ));180<=d&&(b=sJ(a,ZJ),c=sJ(a,XJ));270<=d&&(b=sJ(a,
XJ),c=sJ(a,VJ));var d=QJ(c,b),e=(this.blb?10:15)-Ah(d)/6,a=Math.cos(d)*e,d=Math.sin(d)*e,e=this.blb?this.mR/2-1:this.rR?this.mR/2:this.mR;this.rR?this.PY.te(c.x-e,c.y-e):this.PY.te(b.x-a,b.y-d-e);this.PY.pe(this.mc&&(!this.tD||!this.HO));this.blb&&(this.rkb=!1,this.Bzb())}}},Bzb:function(){if(this.blb){var a=this.PY.ki,b=this.PY.li;uN(this.wb,this.va)&&!this.rkb&&(this.PY.te(a,b-18),this.rkb=!0)}},mXc:function(){if(this.blb){var a=this.PY.ki,b=this.PY.li;this.rkb&&!uN(this.wb,this.va)&&(this.PY.te(a,
b+18),this.rkb=!1)}}};function HFd(a,b){var c=sJ(b,VJ),d=sJ(b,TJ),c=QJ(d,c),c=Ah(c);b.Nea(-c);d=b.We;a=new mJ(new pJ(d[0].x+a,d[0].y+a),new pJ(d[1].x-a,d[1].y+a),new pJ(d[2].x-a,d[2].y-a),new pJ(d[3].x+a,d[3].y-a));a.Nea(c);b.Nea(c);return a}function GFd(a,b){a.Mv&&a.sD&&a.YE&&!(1<b)&&(b+=.05,LL(a.Mv,b),LL(a.sD,b),LL(a.YE,b),window.setTimeout(function(){GFd(a,b)},10))}function FFd(a){a.Xn=a.va.Hz().Lh();ML(a.Mv,a.msc?1:a.rR?1:3);ML(a.sD,1);ML(a.YE,7);a.Nt();a.Gf()}
function AFd(a,b,c,d,e){this.KBc=Function.createDelegate(this,this.d1c);this.nF=Function.createDelegate(this,this.EW);this.qK=Function.createDelegate(this,this.FW);this.JTb=[];this.dispose=this.ha;(this.At=L.ia("PPTCanvasPresenceBubbleUXEnabled"))?(this.Gk=a,this.zOa=e,a=this.eoc+1E5+1E5,b=new kFd,b.ga(String,0,ck(ak,"MoreUsersGlyph_16x16x32")),b.ga(String,5,bk),b.ga(String,1,ck(ak,"DoughboyWhiteGlyph_20x20x32")),b.ga(String,4,bk),b.ga(Number,6,20),b.ga(Boolean,8,Di),b.ga(Number,12,a),b.ga(Boolean,
11,!1),b.ga(Function,16,this.KBc),this.Ks=(new GEd(b)).f5b(this.Gk,!1),Sys.UI.DomElement.addCssClass(this.Ks.lh(),"ShapePawnContainer")):this.hu=window.$$as(sFd,new sFd(a,b,c,this.qK,this.nF,null,d,d.xba,d.vk,d.Lo,d.Yc,e))}
AFd.prototype={eoc:1,SJ:null,Bmb:!1,IPb:!1,hu:null,Ks:null,At:!1,Gk:null,zOa:null,Mda:function(){if(this.At)return this.Ks?this.Ks.TNb():null;var a=Array.clone(i6(this));if(this.SJ){for(var b=!1,c=i6(this),d=c.length,e=0;e<d;++e)if(c[e].eh===this.SJ.eh){b=!0;break}b||Array.add(a,this.SJ)}return a},ha:function(){this.At?this.Ks&&this.Ks.dispose():(this.JTb=this.SJ=null,this.hu.ha())},zP:function(a){if(this.At)a?this.Ks?(R(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",
a.eh),this.Ks.zP(a)):R(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):R(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser");else if(a){for(var b=i6(this),c=b.length,d=0;d<c;++d)if(b[d].eh===a.eh)return;Array.add(i6(this),a);this.NC()}},V_:function(a){if(this.At)a?this.Ks?(R(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",a.eh),this.Ks.V_(a.eh)):
R(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):R(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser");else if(a)for(var b=i6(this),c=b.length,d=0;d<c;++d){var e=b[d];if(e.eh===a.eh){Array.remove(i6(this),e);this.NC();break}}},Qe:function(){if(this.At)if(this.Ks){R(42472543,814,50,"ShapePresencePawn:Clear at PresencePawn ");var a=this.Mda();if(a)for(var b=a.length,c=0;c<b;++c)this.V_(a[c]);else R(42472545,
814,50,"ShapePresencePawn:Clear - Pawn has no users")}else R(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ");else this.JTb=[],this.hu.Qe()},N4c:function(){this.At||(this.SJ?(this.IPb=!0,IFd(this)):R(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))},$4c:function(){this.At?this.Ks&&(this.Ks.EHa(),this.Ks.Pbb()):(this.Bmb=!0,this.SJ&&(this.IPb=!0),IFd(this))},uUc:function(){this.At?this.Ks&&
this.Ks.EHa():(this.Bmb=!1,IFd(this))},vs:function(a){this.At?this.Gk.style.zIndex=a:this.hu.vs(a)},Iib:function(){return this.SJ?this.SJ.Zz:i6(this)&&i6(this).length?i6(this)[i6(this).length-1].Zz:"none"},EW:function(){JFd(this)&&(this.Bmb=!1,IFd(this));return!0},FW:function(){JFd(this)&&(this.Bmb=!0,IFd(this));return!0},NC:function(){JFd(this)?tFd(this.hu,1<this.JTb.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.Iib(),null):this.hu.QEa();IFd(this)},ACb:function(a,b){this.Ks&&
this.Ks.ACb(a,b)},d1c:function(){return e_b(document.body)}};
function IFd(a){a.hu.zOa.Ja.style.zIndex=0;a.hu.Mha.Qe();if(a.Bmb)if(a.SJ){var b=String.format(ResourceStrings.l_TypingHint,a.SJ.ku);a.hu.Mha.ga(a.SJ.Zz,b);for(var c=i6(a),d=c.length,e=0;e<d;++e)b=c[e],a.SJ.eh!==b.eh&&a.hu.Mha.ga(b.Zz,b.ku)}else for(c=i6(a),d=c.length,e=0;e<d;++e)b=c[e],a.hu.Mha.ga(b.Zz,b.ku);else a.IPb&&(a.SJ?(b=String.format(ResourceStrings.l_TypingHint,a.SJ.ku),a.hu.Mha.ga(a.SJ.Zz,b)):R(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));if(a.Bmb||
a.IPb)a=a.hu,a.zOa.Ja.style.zIndex=a.eoc+1E5}function i6(a){return a.At?a.Ks.TNb():a.JTb}function JFd(a){return!!a.SJ||0<a.JTb.length}function KFd(a,b){this.dispose=this.ha;this.Fg=a;this.va=this.Fg.Cu();this.va.sCa(!1);this.Fqd=new aJb(this.va);this.Wm=window.$$as(AFd,this.Fg.hu);this.RDd=b;(this.Hsd=L.ia("PPTCanvasPresenceBubbleUXEnabled"))&&this.Fg&&(a=this.Fg,a.mR=20,a.blb=!0)}
KFd.prototype={Fg:null,Wm:null,va:null,RDd:null,Fqd:null,Hsd:!1,Mm:function(a){this.Fg.Mm(a)},QC:function(a){this.Fg.QC(a)},$w:function(){return this.Fg.$w()},xB:function(a){return this.Fg.JTa(a)},hx:function(a){this.Fg.hx(a)},Bzb:function(){this.Fg.Bzb()},mXc:function(){this.Fg.mXc()},ha:function(){this.Fg.ha()},ez:function(){this.Fg.ez()},dx:function(a){return this.Fg.dx(a)},MC:function(a){return this.Fg.MC(a)},uB:function(a,b){this.Fg.uB(a,b)},rj:function(){return this.Fg.rj()},hf:function(a){this.Fg.hf(a);
return a},te:function(a,b){this.Fg.te(a,b)},$j:function(a){this.Fg.$j(a)},pq:function(a){this.Fg.pq(a)},uu:function(a){this.Fg.uu(a)},vs:function(a){this.Fg.vs(a)},ry:function(a,b){this.Fg.ry(a,b)},Hd:function(){},oka:function(a){a&&(this.z8a(),this.Wm.zP(a),this.Fg.ucb(null),this.Fg.Gf(),R(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",a.eh,this.Wm.Iib(),this.va?this.va.rt():"null_moniker"))},ZGa:function(a){if(a&&this.Wm){this.Wm.V_(a);
this.Fg.ucb(null);var b=this.Wm.Mda();b&&b.length?R(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",a.eh,this.Wm.Iib(),this.va?this.va.rt():""):R(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",a.eh,this.va?this.va.rt():"null_moniker");this.Fg.Gf();this.mSa()}},x$d:function(){this.Wm.Qe();this.Fg.ucb(null);this.mSa()},N4c:function(){this.Wm.N4c()},
Zng:function(){this.Wm.$4c()},u9:function(){this.Wm.uUc()},$dc:function(a){a&&this.z8a();if(this.Wm){var b=this.Wm;b.SJ!==a&&(b.SJ=a,b.SJ||(b.IPb=!1),b.At||b.NC())}this.Fg.ucb(null);if(this.Hsd&&this.Wm)if(this.Wm.SJ)this.Wm.ACb(a.eh,!0);else{var b=this.Wm,c=b.Mda();if(c)for(var d=c.length,e=0;e<d;++e)b.ACb(c[e].eh,!1)}a||this.mSa()},Gnd:function(){return JFd(this.Wm)},LEd:function(a){this.Fg.LEd(a);return a},z8a:function(){this.va.QL()||this.Gnd()||(this.va.sCa(!0),this.RDd.qa.Ha("PSC",this.Fqd,
null))},mSa:function(){this.va.QL()&&!this.Gnd()&&(this.va.sCa(!1),this.RDd.qa.Ha("PSC",this.Fqd,null))}};function LFd(){}
LFd.prototype={Xb:function(){return"PowerPointWebEditor.ShapePresence"},wc:function(a){C(D(a.ma(fR.$$(AQ),null)),function(){return new (lR.$$(AQ))(function(b,c){var d=null,e=window.$$as(tQ,Uy(b,a.H(Yv,null).Eb()));e&&!e.Hv()&&(b=a.H(pFd,null).vQc(a.H(UM,null),function(b,c,d){return window.$$as(lFd,zFd(a.H(nFd,null),b,c,d))},b,c,e.$r,16),d=new KFd(b,a.H(hR,null)),d.Mm(e.$r),TQ(e,d,1),d.hf(KQ(e)||e.Hw()));return d})});C(D(a.ma(nFd,null)),function(){return new yFd(a.H(zd,null),a.H(xd,null),a.H(aM,null),
a.H(mFd,null),a.H(wQ,null))});C(D(a.ma(mFd,null)),function(){return new xFd(a.H(sK,null))});C(D(a.ma(pFd,null)),function(){return new DFd})},ub:function(){},ha:function(){}};xFd.registerClass("PowerPointWebEditor.ShapePresence.ShapeGlyphImageFactory",null,mFd);yFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawnFactory",null,nFd);vFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawnFlyout",null,oFd);
DFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawnViewFactory",null,pFd);EFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePawnView",null,qFd);AFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePresencePawn",null,PIb,Sys.IDisposable,lFd);KFd.registerClass("PowerPointWebEditor.ShapePresence.ShapePresenceView",null,AQ,sQ,YK,Sys.IDisposable);LFd.registerClass("PowerPointWebEditor.ShapePresence.PPTWebEditorShapePresencePackage",null,yo,ec);zo(gj(),new LFd,0,!1);Type.registerNamespace("PowerPointWebEditor");
M=window.PowerPointWebEditor||{};function MFd(){this.hI=[new LFd]}MFd.prototype={J:null,hI:null,Xb:function(){return"PowerPointWebEditor.ExtCommonPackage"},wc:function(a){this.J=a;for(var b=this.hI,c=b.length,d=0;d<c;++d)b[d].wc(a)},ub:function(){for(var a=this.hI,b=a.length,c=0;c<b;++c)a[c].ub();a=this.J.H(AM,null);!0!==a.Qtc&&(a.Qtc=!0,a.Qtc&&a.Esd.Ha("OnExtCommonPackageLoadKey",null,null));ve().ed("ExtCommonPackageInitialized",(new Date).getTime())},ha:function(){}};
MFd.registerClass("PowerPointWebEditor.PptExtCommonPackage",null,yo,ec);ve().ed("ExtCommonPackageLoaded",(new Date).getTime());zo(gj(),new MFd,0,!1);
