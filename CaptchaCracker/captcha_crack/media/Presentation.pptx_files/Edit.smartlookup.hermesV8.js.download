function GRd(a){var b=F.gf;return new Promise(function(c){W5b(b.OW(new Uk(a,1,null,null,!0,2,null,null,null,!1,null,null,null,null,!1,null,null,null,null,null,null)),function(a){a&&a.Pa?a.Pa.Ce||(b1("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+a.Pa.kg,10),c("")):(b1("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),c(""));try{var b=ze(a.Pa.Ce);b.version&&c(b.version)}catch(f){b1("InsightsUtils - Failed to deserialize version: "+
f.toString(),10),c("")}},function(a){a&&a.Pa?b1("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+a.Pa.kg,10):b1("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);c("")})})}function HRd(a){return ETc()+(""!==a?a:"current")+"/scripts/microsoft.office.smartlookup.host.runtime.js"}
function IRd(){var a=PTc();if(a)return Promise.resolve(a);a=ETc().replace("SearchWeb","searchweb");a=L.fc("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?a+"next/":a+"current/";a+="version.json";if(Rj())return GRd(a);try{var b=new Sys.Net.WebRequest;b.set_httpVerb("GET");b.set_url(a);a={};a.method=b.get_httpVerb();return"function"!==typeof window.fetch?(b1("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(b.getResolvedUrl(),
a).then(function(a){return a.json()}).catch(function(){b1("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(function(a){a=ze(JSON.stringify(a));return a.version?a.version:""},function(a){b1("InsightsUtils - Failed to deserialize version: "+a.toString(),10);u(591971029,1303,15,"Insights: Failed to deserialize version: "+a.toString());return""}).then(function(a){return a})}catch(c){return b1("InsightsUtils - Failed to download version.json: "+c.toString(),10),u(591984149,
1303,50,"Insights: Call to Version JSON failed + "+c.toString()),Promise.resolve("")}}
function JRd(a){var b,c=(b=new SHa,b.channelId="SmartLookup",b.approvedOriginPattern=OTc()?"^(http)?://(localhost:8080)$":L.Va("SmartLookupApprovedOriginPattern"),b),d=a.Ea.H(mp,null),e=a.Ea.H(pp,null),f=a.Ea.H(np,null);b=new (Ca.$$(YHa));d&&b.ga(d);e&&b.ga(e);f&&b.ga(f);d=TTc();try{var g=new XTc,h=window.SmartLookupHostRuntime.setup(c,b.Jd(),!0,d,g,"");C(D(a.Ea.ma(wp,null)),function(){return new wp(h)});return!0}catch(k){return b1("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+k,
10),!1}}function KRd(a){if(L.ia("SmartLookupEnableInDocumentSearch")||L.fc("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1))if(gc(B(),wp)){var b=a.Ea.H(ZHa,null);a=a.Ea.H(UHa,null);hTc(b,null,a,0,99).then(function(a){hIa.prefetchZeroTerm(a,vp,kTc(),!0,"Indoc",null)})}else b1("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}
function LRd(a){IRd().then(function(b){""!==b&&gc(a.Ea,BTc)&&($0=b);a.H5b();a.gWa=a.Ea.H(mTc,null);b=HRd(b);b=lk(b);mk(b,function(b,d){d.$x?JRd(a)&&KRd(a):b1("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+d.cA,10);a.gWa.Wb()});nk(b)})}ATc.prototype.Nae=q(-79596164,function(){LRd(this)});Type.registerNamespace("PowerPointWebEditor.SmartLookup");M=window.PowerPointWebEditor||{};M.BVa=M.BVa||{};function W6(a,b,c){this.fa=a;this.pa=b;this.ra=c}
W6.prototype={fa:null,pa:null,ra:null};function MRd(a,b){var c;b=(c=new n5,c.ECb=!1,c.hQ=b.htmlText,c);a.fa.jb(1850078116,2,b,null)}W6.prototype.Xod=function(a){var b=window.$$as(TN,this.ra.Ma());if(a&&b){var c;a=(c=new pRd,c.Action="Insert",c.Caption=a.caption,c.OriginalUrl=a.sourceUrl,c.Height=a.height,c.Width=a.width,c.LicenseDisplayName=a.licenseDisplayName,c.LicenseUrl=a.licenseUrl,c.ThumbnailUrl=a.thumbnailUrl,c.PageUrl=a.pageUrl,c);this.fa.jb(2168883939,2,a,null)}};
W6.prototype.insertOnlinePicture=W6.prototype.Xod;W6.prototype.Wod=function(a){if(a)if(1===this.pa.Tb().length){var b=new Qf;J(b,dr,a.htmlText);J(b,SNa,!1);8===this.fa.jb(1336808253,2,b,null)&&MRd(this,a)}else MRd(this,a)};W6.prototype.insertHtmlText=W6.prototype.Wod;W6.prototype.Vod=function(a){a&&this.fa.jb(4065511728,2,new Jtd(a.streamUrl,a.objectType,a.formatType),null)};W6.prototype.insertContentFromStreamUrl=W6.prototype.Vod;W6.prototype.RX=function(){return"InsertContentExecutor"};
W6.prototype.getId=W6.prototype.RX;function X6(a){X6.initializeBase(this);this.fa=a}X6.prototype={fa:null};X6.prototype.nEd=function(a){this.fa.jb(2918242107,2,this.createFeedbackPropertiesFromData(a),null)};X6.prototype.openFeedbackPane=X6.prototype.nEd;X6.prototype.nFg=function(a){var b={};b.query="AssetID="+a;a={AP:"FA000000012"};a.AW=b;this.fa.jb(2123786558,2,a,null)};X6.prototype.openHelpTaskPane=X6.prototype.nFg;X6.prototype.Lmd=function(){this.fa.jb(1828157298,2,null,null)};
X6.prototype.browseFiles=X6.prototype.Lmd;function Y6(a,b,c,d,e,f,g){Y6.initializeBase(this);this.uTe=a;this.Mx=b;this.nUb=c;this.ec=d;this.Hb=e;this.ra=f;this.XVe=g}function NRd(a,b){a=J9b(a.fe," ");return b<a.length}Y6.prototype={uTe:null,Mx:null,nUb:null,ec:null,Hb:null,ra:null,XVe:null};function ORd(a){for(var b=I9b(a.uTe.Aa(),!1),c=new (Ca.$$(my)),b=b.$$lge();b.$$mn();){var d=b.$$cu(),e=a.ec.th(d);bO(e)||2147483648<=e.Pc()||c.ga(d)}return c}
Y6.prototype.gnd=function(){for(var a=ORd(this),b=new (Ca.$$(String)),a=a.$$lge();a.$$mn();){var c=a.$$cu();b.ga(J9b(c.fe," "))}return b.Jd()};Y6.prototype.getAllParagraphsInDocument=Y6.prototype.gnd;Y6.prototype.GEd=function(a,b,c,d){if(!(0>a||0>b||0>c||0>d||a>c||a===c&&b>d)){var e=ORd(this);e.Qa()<=c||(a=e.K(a),c=e.K(c),NRd(a,b)&&NRd(c,d)&&(e=this.ec.th(a),this.ra.Ma()!==e&&QUb(this.Hb,e),b=this.nUb.iFa(a,b),d=Ky(c,d+1),d=IB(b,d,!0),b=mx(this.Hb),t8a(this.Mx,b,d,null,!1)))}};
Y6.prototype.selectRange=Y6.prototype.GEd;
Y6.prototype.search=function(a,b){var c=new (Ca.$$(gIa));new (Ca.$$(String));for(var d=a.toLowerCase(),e=0,f=ORd(this).$$lge();f.$$mn();){for(var g=f.$$cu(),g=J9b(g.fe," "),h=g.toLowerCase(),k=0;-1<(k=h.indexOf(d,k));){var l=this.XVe.BKf(g,a,k,k+a.length,""),m,l=(m=new gIa,m.snippet=l.sqe,m.startOffsetInSnippet=l.MBe,m.endOffsetInSnippet=l.LBe-1,m.paragraphIndex=e,m.startOffsetInParagraph=k,m.endOffsetInParagraph=k+a.length-1,m);c.ga(l);k+=a.length}e++}c.Sc(function(a,b){return a.paragraphIndex===
b.paragraphIndex?a.startOffsetInParagraph-b.startOffsetInParagraph:a.paragraphIndex-b.paragraphIndex});b(c.Jd())};Y6.prototype.search=Y6.prototype.search;function PRd(){PRd.initializeBase(this)}PRd.prototype={yVc:function(){return nx(window.Box4.App.Pb().me)}};function QRd(a,b){QRd.initializeBase(this);this.vZa=a;this.Ea=b}
QRd.prototype={vZa:null,Ea:null,i5b:function(){var a=L.ia(S(822));return new YTc(new SRd,ri(),$f(),B().H(mp,null),B().H(pp,null),B().H(np,null),a,kc(B(),Ci),null)},Gda:function(){return rUc(this.vZa)},Gee:function(){var a=this.vZa,b=qUc();return 0<a.c7b(b).mentionLength}};function TRd(){TRd.initializeBase(this)}
TRd.prototype={Xb:function(){return"Ppt.SmartLookup"},ub:function(){F.CVa&&ATc.prototype.Nae.call(this)},wc:function(a){ATc.prototype.wc.call(this,a);C(D(lc(lc(a.ma(f1,null),dTc),oUc)),function(){return new f1(2E3)});C(D(lc(a.ma(QRd,null),$Sc)),function(){return new QRd(a.H(dTc,null),a)});C(D(lc(a.ma(mp,null),mp)),function(){return new Y6(new (ga.$$(f5a))(function(){return window.Box4.App.Pb()?window.Box4.App.Pb().me.oi():null}),qx(),a.H(hv,null),a.H(aN,null),a.H(tS,null),a.H(GN,null),new URd)});
C(D(lc(a.ma(pp,null),pp)),function(){return new X6(a.H(dd,null))});C(D(lc(a.ma(np,null),np)),function(){return new W6(Zf(),a.H(UM,null),a.H(GN,null))});C(D(a.ma(UHa,null)),function(){return new PRd})}};function SRd(){this.Uve=!!G()&&!!G().rb()&&G().rb().tib();this.$ve=L.fc("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}
SRd.prototype={Qcc:function(a){var b=this;window.Common.UISurfaces.rw().then(function(c){b.Uve||(a.width=320);b.$ve||(a.enableResize=!1);c.showTaskPane("InsightsTaskPane",a);return null})},IDb:function(a){var b=this;window.Common.UISurfaces.rw().then(function(c){c.setSelectedTaskPane("InsightsTaskPane",2);a&&(b.Uve||(a.width=320),b.$ve||(a.enableResize=!1),c.updateTaskPane("InsightsTaskPane",a));return null})},L7b:function(){window.Common.UISurfaces.rw().then(function(a){a.hideTaskPane("InsightsTaskPane",
2);return null})}};W6.registerClass("PowerPointWebEditor.SmartLookup.InsertContentExecutor",null,np,YHa);X6.registerClass("PowerPointWebEditor.SmartLookup.PPTSerpletExecutor",tp);Y6.registerClass("PowerPointWebEditor.SmartLookup.PPTDocumentContentExecutor",sp);PRd.registerClass("PowerPointWebEditor.SmartLookup.PptDocumentHelper",eIa);QRd.registerClass("PowerPointWebEditor.SmartLookup.SmartLookupManager",vTc);TRd.registerClass("PowerPointWebEditor.SmartLookup.PptSmartLookupPackage",ATc);
SRd.registerClass("PowerPointWebEditor.SmartLookup.PptReactSmartLookupPaneHandler",null,eTc);zo(gj(),new TRd,0,!1);
